const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./index-CckdlN3v.js","./index-DuAyiJnz.js","./@1inch-8aFH8gck.js","./web3-CuCGfqCq.js","./@sentry-C02iiIsL.js","./@safe-global-CsTz-vid.js","./@uniswap-j9167AqE.js","./index-BkMpxk-P.css"])))=>i.map(i=>d[i]);
import{a as ks,c as Ue,p as Fr,m as Ht,q as S0,x as $0,y as x0,z as is,A as uo,C as lo,D as I0,B as Nr,g as M0,u as Bf}from"./@1inch-8aFH8gck.js";import{b as ja,_ as h2,e as u2,d as l2}from"./index-DuAyiJnz.js";import{aa as ka,g as ne,ab as p2}from"./@safe-global-CsTz-vid.js";import"./web3-CuCGfqCq.js";import"./@sentry-C02iiIsL.js";import"./@uniswap-j9167AqE.js";var A0={},ki={};const b2=t=>JSON.stringify(t,(e,r)=>typeof r=="bigint"?r.toString()+"n":r),g2=t=>{const e=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,r=t.replace(e,'$1"$2n"$3');return JSON.parse(r,(i,n)=>typeof n=="string"&&n.match(/^\d+n$/)?BigInt(n.substring(0,n.length-1)):n)};function Vi(t){if(typeof t!="string")throw new Error(`Cannot safe json parse value of type ${typeof t}`);try{return g2(t)}catch{return t}}function Cr(t){return typeof t=="string"?t:b2(t)||""}const v2="PARSE_ERROR",y2="INVALID_REQUEST",m2="METHOD_NOT_FOUND",w2="INVALID_PARAMS",P0="INTERNAL_ERROR",qf="SERVER_ERROR",_2=[-32700,-32600,-32601,-32602,-32603],Fs={[v2]:{code:-32700,message:"Parse error"},[y2]:{code:-32600,message:"Invalid Request"},[m2]:{code:-32601,message:"Method not found"},[w2]:{code:-32602,message:"Invalid params"},[P0]:{code:-32603,message:"Internal error"},[qf]:{code:-32e3,message:"Server error"}},O0=qf;function E2(t){return _2.includes(t)}function Dd(t){return Object.keys(Fs).includes(t)?Fs[t]:Fs[O0]}function S2(t){const e=Object.values(Fs).find(r=>r.code===t);return e||Fs[O0]}function Lf(t,e,r){return t.message.includes("getaddrinfo ENOTFOUND")||t.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${r} RPC url at ${e}`):t}var R0={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Jc=function(t,e){return Jc=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)i.hasOwnProperty(n)&&(r[n]=i[n])},Jc(t,e)};function $2(t,e){Jc(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var Yc=function(){return Yc=Object.assign||function(e){for(var r,i=1,n=arguments.length;i<n;i++){r=arguments[i];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},Yc.apply(this,arguments)};function x2(t,e){var r={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(r[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,i=Object.getOwnPropertySymbols(t);n<i.length;n++)e.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(t,i[n])&&(r[i[n]]=t[i[n]]);return r}function I2(t,e,r,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,r):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(t,e,r,i);else for(var c=t.length-1;c>=0;c--)(a=t[c])&&(s=(n<3?a(s):n>3?a(e,r,s):a(e,r))||s);return n>3&&s&&Object.defineProperty(e,r,s),s}function M2(t,e){return function(r,i){e(r,i,t)}}function A2(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function P2(t,e,r,i){function n(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function c(l){try{u(i.next(l))}catch(g){a(g)}}function d(l){try{u(i.throw(l))}catch(g){a(g)}}function u(l){l.done?s(l.value):n(l.value).then(c,d)}u((i=i.apply(t,e||[])).next())})}function O2(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},i,n,s,a;return a={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(u){return function(l){return d([u,l])}}function d(u){if(i)throw new TypeError("Generator is already executing.");for(;r;)try{if(i=1,n&&(s=u[0]&2?n.return:u[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,u[1])).done)return s;switch(n=0,s&&(u=[u[0]&2,s.value]),u[0]){case 0:case 1:s=u;break;case 4:return r.label++,{value:u[1],done:!1};case 5:r.label++,n=u[1],u=[0];continue;case 7:u=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(u[0]===6||u[0]===2)){r=0;continue}if(u[0]===3&&(!s||u[1]>s[0]&&u[1]<s[3])){r.label=u[1];break}if(u[0]===6&&r.label<s[1]){r.label=s[1],s=u;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(u);break}s[2]&&r.ops.pop(),r.trys.pop();continue}u=e.call(t,r)}catch(l){u=[6,l],n=0}finally{i=s=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}function R2(t,e,r,i){i===void 0&&(i=r),t[i]=e[r]}function F2(t,e){for(var r in t)r!=="default"&&!e.hasOwnProperty(r)&&(e[r]=t[r])}function Zc(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],i=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function F0(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var i=r.call(t),n,s=[],a;try{for(;(e===void 0||e-- >0)&&!(n=i.next()).done;)s.push(n.value)}catch(c){a={error:c}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(a)throw a.error}}return s}function N2(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(F0(arguments[e]));return t}function C2(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var i=Array(t),n=0,e=0;e<r;e++)for(var s=arguments[e],a=0,c=s.length;a<c;a++,n++)i[n]=s[a];return i}function Ts(t){return this instanceof Ts?(this.v=t,this):new Ts(t)}function T2(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=r.apply(t,e||[]),n,s=[];return n={},a("next"),a("throw"),a("return"),n[Symbol.asyncIterator]=function(){return this},n;function a(w){i[w]&&(n[w]=function(E){return new Promise(function($,I){s.push([w,E,$,I])>1||c(w,E)})})}function c(w,E){try{d(i[w](E))}catch($){g(s[0][3],$)}}function d(w){w.value instanceof Ts?Promise.resolve(w.value.v).then(u,l):g(s[0][2],w)}function u(w){c("next",w)}function l(w){c("throw",w)}function g(w,E){w(E),s.shift(),s.length&&c(s[0][0],s[0][1])}}function B2(t){var e,r;return e={},i("next"),i("throw",function(n){throw n}),i("return"),e[Symbol.iterator]=function(){return this},e;function i(n,s){e[n]=t[n]?function(a){return(r=!r)?{value:Ts(t[n](a)),done:n==="return"}:s?s(a):a}:s}}function q2(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof Zc=="function"?Zc(t):t[Symbol.iterator](),r={},i("next"),i("throw"),i("return"),r[Symbol.asyncIterator]=function(){return this},r);function i(s){r[s]=t[s]&&function(a){return new Promise(function(c,d){a=t[s](a),n(c,d,a.done,a.value)})}}function n(s,a,c,d){Promise.resolve(d).then(function(u){s({value:u,done:c})},a)}}function L2(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function D2(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function U2(t){return t&&t.__esModule?t:{default:t}}function z2(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function j2(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r}const k2=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return Yc},__asyncDelegator:B2,__asyncGenerator:T2,__asyncValues:q2,__await:Ts,__awaiter:P2,__classPrivateFieldGet:z2,__classPrivateFieldSet:j2,__createBinding:R2,__decorate:I2,__exportStar:F2,__extends:$2,__generator:O2,__importDefault:U2,__importStar:D2,__makeTemplateObject:L2,__metadata:A2,__param:M2,__read:F0,__rest:x2,__spread:N2,__spreadArrays:C2,__values:Zc},Symbol.toStringTag,{value:"Module"})),H2=ks(k2);var hi={},Ud;function K2(){if(Ud)return hi;Ud=1,Object.defineProperty(hi,"__esModule",{value:!0}),hi.isBrowserCryptoAvailable=hi.getSubtleCrypto=hi.getBrowerCrypto=void 0;function t(){return(Ue===null||Ue===void 0?void 0:Ue.crypto)||(Ue===null||Ue===void 0?void 0:Ue.msCrypto)||{}}hi.getBrowerCrypto=t;function e(){const i=t();return i.subtle||i.webkitSubtle}hi.getSubtleCrypto=e;function r(){return!!t()&&!!e()}return hi.isBrowserCryptoAvailable=r,hi}var ui={},zd;function V2(){if(zd)return ui;zd=1,Object.defineProperty(ui,"__esModule",{value:!0}),ui.isBrowser=ui.isNode=ui.isReactNative=void 0;function t(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}ui.isReactNative=t;function e(){return typeof Fr<"u"&&typeof Fr.versions<"u"&&typeof Fr.versions.node<"u"}ui.isNode=e;function r(){return!t()&&!e()}return ui.isBrowser=r,ui}(function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=H2;e.__exportStar(K2(),t),e.__exportStar(V2(),t)})(R0);function wi(t=3){const e=Date.now()*Math.pow(10,t),r=Math.floor(Math.random()*Math.pow(10,t));return e+r}function Ui(t=6){return BigInt(wi(t))}function Ei(t,e,r){return{id:r||wi(),jsonrpc:"2.0",method:t,params:e}}function po(t,e){return{id:t,jsonrpc:"2.0",result:e}}function Hs(t,e,r){return{id:t,jsonrpc:"2.0",error:W2(e)}}function W2(t,e){return typeof t>"u"?Dd(P0):(typeof t=="string"&&(t=Object.assign(Object.assign({},Dd(qf)),{message:t})),E2(t.code)&&(t=S2(t.code)),t)}let G2=class{};class J2 extends G2{constructor(){super()}}class N0 extends J2{constructor(e){super()}}const Y2="^https?:",Z2="^wss?:";function X2(t){const e=t.match(new RegExp(/^\w+:/,"gi"));if(!(!e||!e.length))return e[0]}function C0(t,e){const r=X2(t);return typeof r>"u"?!1:new RegExp(e).test(r)}function Ha(t){return C0(t,Y2)}function jd(t){return C0(t,Z2)}function Q2(t){return new RegExp("wss?://localhost(:d{2,5})?").test(t)}function T0(t){return typeof t=="object"&&"id"in t&&"jsonrpc"in t&&t.jsonrpc==="2.0"}function Df(t){return T0(t)&&"method"in t}function Ks(t){return T0(t)&&(kr(t)||Xt(t))}function kr(t){return"result"in t}function Xt(t){return"error"in t}const eg={Accept:"application/json","Content-Type":"application/json"},tg="POST",kd={headers:eg,method:tg},Hd=10;class Kd{constructor(e,r=!1){if(this.url=e,this.disableProviderPing=r,this.events=new Ht.EventEmitter,this.isAvailable=!1,this.registering=!1,!Ha(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);this.url=e,this.disableProviderPing=r}get connected(){return this.isAvailable}get connecting(){return this.registering}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async open(e=this.url){await this.register(e)}async close(){if(!this.isAvailable)throw new Error("Connection already closed");this.onClose()}async send(e,r){this.isAvailable||await this.register();try{const i=Cr(e),s=await(await ka(this.url,Object.assign(Object.assign({},kd),{body:i}))).json();this.onPayload({data:s})}catch(i){this.onError(e.id,i)}}async register(e=this.url){if(!Ha(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((i,n)=>{this.events.once("register_error",s=>{this.resetMaxListeners(),n(s)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.isAvailable>"u")return n(new Error("HTTP connection is missing or invalid"));i()})})}this.url=e,this.registering=!0;try{if(!this.disableProviderPing){const r=Cr({id:1,jsonrpc:"2.0",method:"test",params:[]});await ka(e,Object.assign(Object.assign({},kd),{body:r}))}this.onOpen()}catch(r){const i=this.parseError(r);throw this.events.emit("register_error",i),this.onClose(),i}}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(e){if(typeof e.data>"u")return;const r=typeof e.data=="string"?Vi(e.data):e.data;this.events.emit("payload",r)}onError(e,r){const i=this.parseError(r),n=i.message||i.toString(),s=Hs(e,n);this.events.emit("payload",s)}parseError(e,r=this.url){return Lf(e,r,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>Hd&&this.events.setMaxListeners(Hd)}}const rg=Object.freeze(Object.defineProperty({__proto__:null,HttpConnection:Kd,default:Kd},Symbol.toStringTag,{value:"Module"})),ig=ks(rg);class Vd extends N0{constructor(e){super(e),this.events=new Ht.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(e),this.connection.connected&&this.registerEventListeners()}async connect(e=this.connection){await this.open(e)}async disconnect(){await this.close()}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async request(e,r){return this.requestStrict(Ei(e.method,e.params||[],e.id||Ui().toString()),r)}async requestStrict(e,r){return new Promise(async(i,n)=>{if(!this.connection.connected)try{await this.open()}catch(s){n(s)}this.events.on(`${e.id}`,s=>{Xt(s)?n(s.error):i(s.result)});try{await this.connection.send(e,r)}catch(s){n(s)}})}setConnection(e=this.connection){return e}onPayload(e){this.events.emit("payload",e),Ks(e)?this.events.emit(`${e.id}`,e):this.events.emit("message",{type:e.method,data:e.params})}onClose(e){e&&e.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${e.code} ${e.reason?`(${e.reason})`:""}`)),this.events.emit("disconnect")}async open(e=this.connection){this.connection===e&&this.connection.connected||(this.connection.connected&&this.close(),typeof e=="string"&&(await this.connection.open(e),e=this.connection),this.connection=this.setConnection(e),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",e=>this.onPayload(e)),this.connection.on("close",e=>this.onClose(e)),this.connection.on("error",e=>this.events.emit("error",e)),this.connection.on("register_error",e=>this.onClose()),this.hasRegisteredEventListeners=!0)}}const ng=Object.freeze(Object.defineProperty({__proto__:null,JsonRpcProvider:Vd,default:Vd},Symbol.toStringTag,{value:"Module"})),sg=ks(ng);var ag=Ue&&Ue.__createBinding||(Object.create?function(t,e,r,i){i===void 0&&(i=r);var n=Object.getOwnPropertyDescriptor(e,r);(!n||("get"in n?!e.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,i,n)}:function(t,e,r,i){i===void 0&&(i=r),t[i]=e[r]}),og=Ue&&Ue.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),Wd=Ue&&Ue.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)r!=="default"&&Object.prototype.hasOwnProperty.call(t,r)&&ag(e,t,r);return og(e,t),e},Xc=Ue&&Ue.__awaiter||function(t,e,r,i){function n(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function c(l){try{u(i.next(l))}catch(g){a(g)}}function d(l){try{u(i.throw(l))}catch(g){a(g)}}function u(l){l.done?s(l.value):n(l.value).then(c,d)}u((i=i.apply(t,e||[])).next())})};Object.defineProperty(ki,"__esModule",{value:!0});ki.getChainsWithDefault=ki.getBestUrlMap=ki.isArrayOneOrMore=void 0;function cg(t=[]){return t.length>0}ki.isArrayOneOrMore=cg;function fg(t,e){return Xc(this,void 0,void 0,function*(){return Object.fromEntries(yield Promise.all(Object.entries(t).map(([r,i])=>Xc(this,void 0,void 0,function*(){return[r,yield dg(i,e)]}))))})}ki.getBestUrlMap=fg;function dg(t,e){return Xc(this,void 0,void 0,function*(){if(typeof t=="string")return t;if(t.length===1)return t[0];const[r,i]=yield Promise.all([Promise.resolve().then(()=>Wd(ig)).then(({HttpConnection:n})=>n),Promise.resolve().then(()=>Wd(sg)).then(({JsonRpcProvider:n})=>n)]);return new Promise(n=>{let s=!1;const a={};t.forEach((c,d)=>{const u=new i(new r(c));new Promise((g,w)=>{u.request({method:"eth_chainId"}).then(()=>g()).catch(()=>w()),setTimeout(()=>{w()},e)}).then(()=>!0).catch(()=>!1).then(g=>{if(!s){if(a[d]=g,Object.keys(a).length===t.length){const w=Object.keys(a).findIndex(E=>a[Number(E)]);return n(t[w===-1?0:w])}new Array(t.length).fill(0).forEach((w,E)=>{a[E]&&new Array(E).fill(0).every(($,I)=>a[I]===!1)&&(s=!0,n(t[E]))})}})})})})}function hg(t,e){if(!t||!e||t.length===0)return t;const r=t.indexOf(e);if(r===-1)throw new Error(`Invalid chainId ${e}. Make sure default chain is included in "chains" - chains specified in "optionalChains" may not be selected as the default, as they may not be supported by the wallet.`);const i=[...t];return i.splice(r,1),[e,...i]}ki.getChainsWithDefault=hg;var Gd=function(t,e,r){if(r||arguments.length===2)for(var i=0,n=e.length,s;i<n;i++)(s||!(i in e))&&(s||(s=Array.prototype.slice.call(e,0,i)),s[i]=e[i]);return t.concat(s||Array.prototype.slice.call(e))},ug=function(){function t(e,r,i){this.name=e,this.version=r,this.os=i,this.type="browser"}return t}(),lg=function(){function t(e){this.version=e,this.type="node",this.name="node",this.os=Fr.platform}return t}(),pg=function(){function t(e,r,i,n){this.name=e,this.version=r,this.os=i,this.bot=n,this.type="bot-device"}return t}(),bg=function(){function t(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null}return t}(),gg=function(){function t(){this.type="react-native",this.name="react-native",this.version=null,this.os=null}return t}(),vg=/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/,yg=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,Jd=3,mg=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",vg]],Yd=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function wg(t){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"?new gg:typeof navigator<"u"?Eg(navigator.userAgent):$g()}function _g(t){return t!==""&&mg.reduce(function(e,r){var i=r[0],n=r[1];if(e)return e;var s=n.exec(t);return!!s&&[i,s]},!1)}function Eg(t){var e=_g(t);if(!e)return null;var r=e[0],i=e[1];if(r==="searchbot")return new bg;var n=i[1]&&i[1].split(".").join("_").split("_").slice(0,3);n?n.length<Jd&&(n=Gd(Gd([],n,!0),xg(Jd-n.length),!0)):n=[];var s=n.join("."),a=Sg(t),c=yg.exec(t);return c&&c[1]?new pg(r,s,a,c[1]):new ug(r,s,a)}function Sg(t){for(var e=0,r=Yd.length;e<r;e++){var i=Yd[e],n=i[0],s=i[1],a=s.exec(t);if(a)return n}return null}function $g(){var t=typeof Fr<"u"&&Fr.version;return t?new lg(Fr.version.slice(1)):null}function xg(t){for(var e=[],r=0;r<t;r++)e.push("0");return e}var G={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Qc=function(t,e){return Qc=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,i){r.__proto__=i}||function(r,i){for(var n in i)i.hasOwnProperty(n)&&(r[n]=i[n])},Qc(t,e)};function Ig(t,e){Qc(t,e);function r(){this.constructor=t}t.prototype=e===null?Object.create(e):(r.prototype=e.prototype,new r)}var ef=function(){return ef=Object.assign||function(e){for(var r,i=1,n=arguments.length;i<n;i++){r=arguments[i];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(e[s]=r[s])}return e},ef.apply(this,arguments)};function Mg(t,e){var r={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(r[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,i=Object.getOwnPropertySymbols(t);n<i.length;n++)e.indexOf(i[n])<0&&Object.prototype.propertyIsEnumerable.call(t,i[n])&&(r[i[n]]=t[i[n]]);return r}function Ag(t,e,r,i){var n=arguments.length,s=n<3?e:i===null?i=Object.getOwnPropertyDescriptor(e,r):i,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(t,e,r,i);else for(var c=t.length-1;c>=0;c--)(a=t[c])&&(s=(n<3?a(s):n>3?a(e,r,s):a(e,r))||s);return n>3&&s&&Object.defineProperty(e,r,s),s}function Pg(t,e){return function(r,i){e(r,i,t)}}function Og(t,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(t,e)}function Rg(t,e,r,i){function n(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function c(l){try{u(i.next(l))}catch(g){a(g)}}function d(l){try{u(i.throw(l))}catch(g){a(g)}}function u(l){l.done?s(l.value):n(l.value).then(c,d)}u((i=i.apply(t,e||[])).next())})}function Fg(t,e){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},i,n,s,a;return a={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(u){return function(l){return d([u,l])}}function d(u){if(i)throw new TypeError("Generator is already executing.");for(;r;)try{if(i=1,n&&(s=u[0]&2?n.return:u[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,u[1])).done)return s;switch(n=0,s&&(u=[u[0]&2,s.value]),u[0]){case 0:case 1:s=u;break;case 4:return r.label++,{value:u[1],done:!1};case 5:r.label++,n=u[1],u=[0];continue;case 7:u=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(u[0]===6||u[0]===2)){r=0;continue}if(u[0]===3&&(!s||u[1]>s[0]&&u[1]<s[3])){r.label=u[1];break}if(u[0]===6&&r.label<s[1]){r.label=s[1],s=u;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(u);break}s[2]&&r.ops.pop(),r.trys.pop();continue}u=e.call(t,r)}catch(l){u=[6,l],n=0}finally{i=s=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}function Ng(t,e,r,i){i===void 0&&(i=r),t[i]=e[r]}function Cg(t,e){for(var r in t)r!=="default"&&!e.hasOwnProperty(r)&&(e[r]=t[r])}function tf(t){var e=typeof Symbol=="function"&&Symbol.iterator,r=e&&t[e],i=0;if(r)return r.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function B0(t,e){var r=typeof Symbol=="function"&&t[Symbol.iterator];if(!r)return t;var i=r.call(t),n,s=[],a;try{for(;(e===void 0||e-- >0)&&!(n=i.next()).done;)s.push(n.value)}catch(c){a={error:c}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(a)throw a.error}}return s}function Tg(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(B0(arguments[e]));return t}function Bg(){for(var t=0,e=0,r=arguments.length;e<r;e++)t+=arguments[e].length;for(var i=Array(t),n=0,e=0;e<r;e++)for(var s=arguments[e],a=0,c=s.length;a<c;a++,n++)i[n]=s[a];return i}function Bs(t){return this instanceof Bs?(this.v=t,this):new Bs(t)}function qg(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=r.apply(t,e||[]),n,s=[];return n={},a("next"),a("throw"),a("return"),n[Symbol.asyncIterator]=function(){return this},n;function a(w){i[w]&&(n[w]=function(E){return new Promise(function($,I){s.push([w,E,$,I])>1||c(w,E)})})}function c(w,E){try{d(i[w](E))}catch($){g(s[0][3],$)}}function d(w){w.value instanceof Bs?Promise.resolve(w.value.v).then(u,l):g(s[0][2],w)}function u(w){c("next",w)}function l(w){c("throw",w)}function g(w,E){w(E),s.shift(),s.length&&c(s[0][0],s[0][1])}}function Lg(t){var e,r;return e={},i("next"),i("throw",function(n){throw n}),i("return"),e[Symbol.iterator]=function(){return this},e;function i(n,s){e[n]=t[n]?function(a){return(r=!r)?{value:Bs(t[n](a)),done:n==="return"}:s?s(a):a}:s}}function Dg(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof tf=="function"?tf(t):t[Symbol.iterator](),r={},i("next"),i("throw"),i("return"),r[Symbol.asyncIterator]=function(){return this},r);function i(s){r[s]=t[s]&&function(a){return new Promise(function(c,d){a=t[s](a),n(c,d,a.done,a.value)})}}function n(s,a,c,d){Promise.resolve(d).then(function(u){s({value:u,done:c})},a)}}function Ug(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function zg(t){if(t&&t.__esModule)return t;var e={};if(t!=null)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e}function jg(t){return t&&t.__esModule?t:{default:t}}function kg(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function Hg(t,e,r){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,r),r}const Kg=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return ef},__asyncDelegator:Lg,__asyncGenerator:qg,__asyncValues:Dg,__await:Bs,__awaiter:Rg,__classPrivateFieldGet:kg,__classPrivateFieldSet:Hg,__createBinding:Ng,__decorate:Ag,__exportStar:Cg,__extends:Ig,__generator:Fg,__importDefault:jg,__importStar:zg,__makeTemplateObject:Ug,__metadata:Og,__param:Pg,__read:B0,__rest:Mg,__spread:Tg,__spreadArrays:Bg,__values:tf},Symbol.toStringTag,{value:"Module"})),bo=ks(Kg);var Yo={},vs={},Zd;function Vg(){if(Zd)return vs;Zd=1,Object.defineProperty(vs,"__esModule",{value:!0}),vs.delay=void 0;function t(e){return new Promise(r=>{setTimeout(()=>{r(!0)},e)})}return vs.delay=t,vs}var nn={},Zo={},sn={},Xd;function Wg(){return Xd||(Xd=1,Object.defineProperty(sn,"__esModule",{value:!0}),sn.ONE_THOUSAND=sn.ONE_HUNDRED=void 0,sn.ONE_HUNDRED=100,sn.ONE_THOUSAND=1e3),sn}var Xo={},Qd;function Gg(){return Qd||(Qd=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.ONE_YEAR=t.FOUR_WEEKS=t.THREE_WEEKS=t.TWO_WEEKS=t.ONE_WEEK=t.THIRTY_DAYS=t.SEVEN_DAYS=t.FIVE_DAYS=t.THREE_DAYS=t.ONE_DAY=t.TWENTY_FOUR_HOURS=t.TWELVE_HOURS=t.SIX_HOURS=t.THREE_HOURS=t.ONE_HOUR=t.SIXTY_MINUTES=t.THIRTY_MINUTES=t.TEN_MINUTES=t.FIVE_MINUTES=t.ONE_MINUTE=t.SIXTY_SECONDS=t.THIRTY_SECONDS=t.TEN_SECONDS=t.FIVE_SECONDS=t.ONE_SECOND=void 0,t.ONE_SECOND=1,t.FIVE_SECONDS=5,t.TEN_SECONDS=10,t.THIRTY_SECONDS=30,t.SIXTY_SECONDS=60,t.ONE_MINUTE=t.SIXTY_SECONDS,t.FIVE_MINUTES=t.ONE_MINUTE*5,t.TEN_MINUTES=t.ONE_MINUTE*10,t.THIRTY_MINUTES=t.ONE_MINUTE*30,t.SIXTY_MINUTES=t.ONE_MINUTE*60,t.ONE_HOUR=t.SIXTY_MINUTES,t.THREE_HOURS=t.ONE_HOUR*3,t.SIX_HOURS=t.ONE_HOUR*6,t.TWELVE_HOURS=t.ONE_HOUR*12,t.TWENTY_FOUR_HOURS=t.ONE_HOUR*24,t.ONE_DAY=t.TWENTY_FOUR_HOURS,t.THREE_DAYS=t.ONE_DAY*3,t.FIVE_DAYS=t.ONE_DAY*5,t.SEVEN_DAYS=t.ONE_DAY*7,t.THIRTY_DAYS=t.ONE_DAY*30,t.ONE_WEEK=t.SEVEN_DAYS,t.TWO_WEEKS=t.ONE_WEEK*2,t.THREE_WEEKS=t.ONE_WEEK*3,t.FOUR_WEEKS=t.ONE_WEEK*4,t.ONE_YEAR=t.ONE_DAY*365}(Xo)),Xo}var eh;function q0(){return eh||(eh=1,function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=bo;e.__exportStar(Wg(),t),e.__exportStar(Gg(),t)}(Zo)),Zo}var th;function Jg(){if(th)return nn;th=1,Object.defineProperty(nn,"__esModule",{value:!0}),nn.fromMiliseconds=nn.toMiliseconds=void 0;const t=q0();function e(i){return i*t.ONE_THOUSAND}nn.toMiliseconds=e;function r(i){return Math.floor(i/t.ONE_THOUSAND)}return nn.fromMiliseconds=r,nn}var rh;function Yg(){return rh||(rh=1,function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=bo;e.__exportStar(Vg(),t),e.__exportStar(Jg(),t)}(Yo)),Yo}var An={},ih;function Zg(){if(ih)return An;ih=1,Object.defineProperty(An,"__esModule",{value:!0}),An.Watch=void 0;class t{constructor(){this.timestamps=new Map}start(r){if(this.timestamps.has(r))throw new Error(`Watch already started for label: ${r}`);this.timestamps.set(r,{started:Date.now()})}stop(r){const i=this.get(r);if(typeof i.elapsed<"u")throw new Error(`Watch already stopped for label: ${r}`);const n=Date.now()-i.started;this.timestamps.set(r,{started:i.started,elapsed:n})}get(r){const i=this.timestamps.get(r);if(typeof i>"u")throw new Error(`No timestamp found for label: ${r}`);return i}elapsed(r){const i=this.get(r);return i.elapsed||Date.now()-i.started}}return An.Watch=t,An.default=t,An}var Qo={},ys={},nh;function Xg(){if(nh)return ys;nh=1,Object.defineProperty(ys,"__esModule",{value:!0}),ys.IWatch=void 0;class t{}return ys.IWatch=t,ys}var sh;function Qg(){return sh||(sh=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),bo.__exportStar(Xg(),t)}(Qo)),Qo}(function(t){Object.defineProperty(t,"__esModule",{value:!0});const e=bo;e.__exportStar(Yg(),t),e.__exportStar(Zg(),t),e.__exportStar(Qg(),t),e.__exportStar(q0(),t)})(G);var Ke={};Object.defineProperty(Ke,"__esModule",{value:!0});Ke.getLocalStorage=Ke.getLocalStorageOrThrow=Ke.getCrypto=Ke.getCryptoOrThrow=L0=Ke.getLocation=Ke.getLocationOrThrow=Uf=Ke.getNavigator=Ke.getNavigatorOrThrow=Vs=Ke.getDocument=Ke.getDocumentOrThrow=Ke.getFromWindowOrThrow=Ke.getFromWindow=void 0;function mn(t){let e;return typeof window<"u"&&typeof window[t]<"u"&&(e=window[t]),e}Ke.getFromWindow=mn;function ns(t){const e=mn(t);if(!e)throw new Error(`${t} is not defined in Window`);return e}Ke.getFromWindowOrThrow=ns;function ev(){return ns("document")}Ke.getDocumentOrThrow=ev;function tv(){return mn("document")}var Vs=Ke.getDocument=tv;function rv(){return ns("navigator")}Ke.getNavigatorOrThrow=rv;function iv(){return mn("navigator")}var Uf=Ke.getNavigator=iv;function nv(){return ns("location")}Ke.getLocationOrThrow=nv;function sv(){return mn("location")}var L0=Ke.getLocation=sv;function av(){return ns("crypto")}Ke.getCryptoOrThrow=av;function ov(){return mn("crypto")}Ke.getCrypto=ov;function cv(){return ns("localStorage")}Ke.getLocalStorageOrThrow=cv;function fv(){return mn("localStorage")}Ke.getLocalStorage=fv;var zf={};Object.defineProperty(zf,"__esModule",{value:!0});var D0=zf.getWindowMetadata=void 0;const ah=Ke;function dv(){let t,e;try{t=ah.getDocumentOrThrow(),e=ah.getLocationOrThrow()}catch{return null}function r(){const g=t.getElementsByTagName("link"),w=[];for(let E=0;E<g.length;E++){const $=g[E],I=$.getAttribute("rel");if(I&&I.toLowerCase().indexOf("icon")>-1){const M=$.getAttribute("href");if(M)if(M.toLowerCase().indexOf("https:")===-1&&M.toLowerCase().indexOf("http:")===-1&&M.indexOf("//")!==0){let P=e.protocol+"//"+e.host;if(M.indexOf("/")===0)P+=M;else{const A=e.pathname.split("/");A.pop();const R=A.join("/");P+=R+"/"+M}w.push(P)}else if(M.indexOf("//")===0){const P=e.protocol+M;w.push(P)}else w.push(M)}}return w}function i(...g){const w=t.getElementsByTagName("meta");for(let E=0;E<w.length;E++){const $=w[E],I=["itemprop","property","name"].map(M=>$.getAttribute(M)).filter(M=>M?g.includes(M):!1);if(I.length&&I){const M=$.getAttribute("content");if(M)return M}}return""}function n(){let g=i("name","og:site_name","og:title","twitter:title");return g||(g=t.title),g}function s(){return i("description","og:description","twitter:description","keywords")}const a=n(),c=s(),d=e.origin,u=r();return{description:c,url:d,icons:u,name:a}}D0=zf.getWindowMetadata=dv;function hv(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function U0(t,...e){if(!hv(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error("Uint8Array expected of length "+e+", got length="+t.length)}function oh(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function uv(t,e){U0(t);const r=e.outputLen;if(t.length<r)throw new Error("digestInto() expects output buffer of length at least "+r)}const Pn=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */const ec=t=>new DataView(t.buffer,t.byteOffset,t.byteLength);function lv(t){if(typeof t!="string")throw new Error("utf8ToBytes expected string, got "+typeof t);return new Uint8Array(new TextEncoder().encode(t))}function z0(t){return typeof t=="string"&&(t=lv(t)),U0(t),t}let pv=class{clone(){return this._cloneInto()}};function bv(t){const e=i=>t().update(z0(i)).digest(),r=t();return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=()=>t(),e}function gv(t=32){if(Pn&&typeof Pn.getRandomValues=="function")return Pn.getRandomValues(new Uint8Array(t));if(Pn&&typeof Pn.randomBytes=="function")return Pn.randomBytes(t);throw new Error("crypto.getRandomValues must be defined")}function vv(t,e,r,i){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,r,i);const n=BigInt(32),s=BigInt(4294967295),a=Number(r>>n&s),c=Number(r&s),d=i?4:0,u=i?0:4;t.setUint32(e+d,a,i),t.setUint32(e+u,c,i)}let yv=class extends pv{constructor(e,r,i,n){super(),this.blockLen=e,this.outputLen=r,this.padOffset=i,this.isLE=n,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=ec(this.buffer)}update(e){oh(this);const{view:r,buffer:i,blockLen:n}=this;e=z0(e);const s=e.length;for(let a=0;a<s;){const c=Math.min(n-this.pos,s-a);if(c===n){const d=ec(e);for(;n<=s-a;a+=n)this.process(d,a);continue}i.set(e.subarray(a,a+c),this.pos),this.pos+=c,a+=c,this.pos===n&&(this.process(r,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){oh(this),uv(e,this),this.finished=!0;const{buffer:r,view:i,blockLen:n,isLE:s}=this;let{pos:a}=this;r[a++]=128,this.buffer.subarray(a).fill(0),this.padOffset>n-a&&(this.process(i,0),a=0);for(let g=a;g<n;g++)r[g]=0;vv(i,n-8,BigInt(this.length*8),s),this.process(i,0);const c=ec(e),d=this.outputLen;if(d%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const u=d/4,l=this.get();if(u>l.length)throw new Error("_sha2: outputLen bigger than state");for(let g=0;g<u;g++)c.setUint32(4*g,l[g],s)}digest(){const{buffer:e,outputLen:r}=this;this.digestInto(e);const i=e.slice(0,r);return this.destroy(),i}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:r,buffer:i,length:n,finished:s,destroyed:a,pos:c}=this;return e.length=n,e.pos=c,e.finished=s,e.destroyed=a,n%r&&e.buffer.set(i),e}};const pa=BigInt(2**32-1),rf=BigInt(32);function j0(t,e=!1){return e?{h:Number(t&pa),l:Number(t>>rf&pa)}:{h:Number(t>>rf&pa)|0,l:Number(t&pa)|0}}function mv(t,e=!1){let r=new Uint32Array(t.length),i=new Uint32Array(t.length);for(let n=0;n<t.length;n++){const{h:s,l:a}=j0(t[n],e);[r[n],i[n]]=[s,a]}return[r,i]}const wv=(t,e)=>BigInt(t>>>0)<<rf|BigInt(e>>>0),_v=(t,e,r)=>t>>>r,Ev=(t,e,r)=>t<<32-r|e>>>r,Sv=(t,e,r)=>t>>>r|e<<32-r,$v=(t,e,r)=>t<<32-r|e>>>r,xv=(t,e,r)=>t<<64-r|e>>>r-32,Iv=(t,e,r)=>t>>>r-32|e<<64-r,Mv=(t,e)=>e,Av=(t,e)=>t,Pv=(t,e,r)=>t<<r|e>>>32-r,Ov=(t,e,r)=>e<<r|t>>>32-r,Rv=(t,e,r)=>e<<r-32|t>>>64-r,Fv=(t,e,r)=>t<<r-32|e>>>64-r;function Nv(t,e,r,i){const n=(e>>>0)+(i>>>0);return{h:t+r+(n/2**32|0)|0,l:n|0}}const Cv=(t,e,r)=>(t>>>0)+(e>>>0)+(r>>>0),Tv=(t,e,r,i)=>e+r+i+(t/2**32|0)|0,Bv=(t,e,r,i)=>(t>>>0)+(e>>>0)+(r>>>0)+(i>>>0),qv=(t,e,r,i,n)=>e+r+i+n+(t/2**32|0)|0,Lv=(t,e,r,i,n)=>(t>>>0)+(e>>>0)+(r>>>0)+(i>>>0)+(n>>>0),Dv=(t,e,r,i,n,s)=>e+r+i+n+s+(t/2**32|0)|0,Te={fromBig:j0,split:mv,toBig:wv,shrSH:_v,shrSL:Ev,rotrSH:Sv,rotrSL:$v,rotrBH:xv,rotrBL:Iv,rotr32H:Mv,rotr32L:Av,rotlSH:Pv,rotlSL:Ov,rotlBH:Rv,rotlBL:Fv,add:Nv,add3L:Cv,add3H:Tv,add4L:Bv,add4H:qv,add5H:Dv,add5L:Lv},[Uv,zv]=Te.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(t=>BigInt(t))),Ri=new Uint32Array(80),Fi=new Uint32Array(80);let jv=class extends yv{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:e,Al:r,Bh:i,Bl:n,Ch:s,Cl:a,Dh:c,Dl:d,Eh:u,El:l,Fh:g,Fl:w,Gh:E,Gl:$,Hh:I,Hl:M}=this;return[e,r,i,n,s,a,c,d,u,l,g,w,E,$,I,M]}set(e,r,i,n,s,a,c,d,u,l,g,w,E,$,I,M){this.Ah=e|0,this.Al=r|0,this.Bh=i|0,this.Bl=n|0,this.Ch=s|0,this.Cl=a|0,this.Dh=c|0,this.Dl=d|0,this.Eh=u|0,this.El=l|0,this.Fh=g|0,this.Fl=w|0,this.Gh=E|0,this.Gl=$|0,this.Hh=I|0,this.Hl=M|0}process(e,r){for(let R=0;R<16;R++,r+=4)Ri[R]=e.getUint32(r),Fi[R]=e.getUint32(r+=4);for(let R=16;R<80;R++){const C=Ri[R-15]|0,D=Fi[R-15]|0,U=Te.rotrSH(C,D,1)^Te.rotrSH(C,D,8)^Te.shrSH(C,D,7),j=Te.rotrSL(C,D,1)^Te.rotrSL(C,D,8)^Te.shrSL(C,D,7),z=Ri[R-2]|0,q=Fi[R-2]|0,V=Te.rotrSH(z,q,19)^Te.rotrBH(z,q,61)^Te.shrSH(z,q,6),S=Te.rotrSL(z,q,19)^Te.rotrBL(z,q,61)^Te.shrSL(z,q,6),o=Te.add4L(j,S,Fi[R-7],Fi[R-16]),h=Te.add4H(o,U,V,Ri[R-7],Ri[R-16]);Ri[R]=h|0,Fi[R]=o|0}let{Ah:i,Al:n,Bh:s,Bl:a,Ch:c,Cl:d,Dh:u,Dl:l,Eh:g,El:w,Fh:E,Fl:$,Gh:I,Gl:M,Hh:P,Hl:A}=this;for(let R=0;R<80;R++){const C=Te.rotrSH(g,w,14)^Te.rotrSH(g,w,18)^Te.rotrBH(g,w,41),D=Te.rotrSL(g,w,14)^Te.rotrSL(g,w,18)^Te.rotrBL(g,w,41),U=g&E^~g&I,j=w&$^~w&M,z=Te.add5L(A,D,j,zv[R],Fi[R]),q=Te.add5H(z,P,C,U,Uv[R],Ri[R]),V=z|0,S=Te.rotrSH(i,n,28)^Te.rotrBH(i,n,34)^Te.rotrBH(i,n,39),o=Te.rotrSL(i,n,28)^Te.rotrBL(i,n,34)^Te.rotrBL(i,n,39),h=i&s^i&c^s&c,y=n&a^n&d^a&d;P=I|0,A=M|0,I=E|0,M=$|0,E=g|0,$=w|0,{h:g,l:w}=Te.add(u|0,l|0,q|0,V|0),u=c|0,l=d|0,c=s|0,d=a|0,s=i|0,a=n|0;const p=Te.add3L(V,o,y);i=Te.add3H(p,q,S,h),n=p|0}({h:i,l:n}=Te.add(this.Ah|0,this.Al|0,i|0,n|0)),{h:s,l:a}=Te.add(this.Bh|0,this.Bl|0,s|0,a|0),{h:c,l:d}=Te.add(this.Ch|0,this.Cl|0,c|0,d|0),{h:u,l}=Te.add(this.Dh|0,this.Dl|0,u|0,l|0),{h:g,l:w}=Te.add(this.Eh|0,this.El|0,g|0,w|0),{h:E,l:$}=Te.add(this.Fh|0,this.Fl|0,E|0,$|0),{h:I,l:M}=Te.add(this.Gh|0,this.Gl|0,I|0,M|0),{h:P,l:A}=Te.add(this.Hh|0,this.Hl|0,P|0,A|0),this.set(i,n,s,a,c,d,u,l,g,w,E,$,I,M,P,A)}roundClean(){Ri.fill(0),Fi.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}};const kv=bv(()=>new jv);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const jf=BigInt(0),k0=BigInt(1),Hv=BigInt(2);function kf(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function Hf(t){if(!kf(t))throw new Error("Uint8Array expected")}function tc(t,e){if(typeof e!="boolean")throw new Error(t+" boolean expected, got "+e)}const Kv=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function Kf(t){Hf(t);let e="";for(let r=0;r<t.length;r++)e+=Kv[t[r]];return e}function H0(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);return t===""?jf:BigInt("0x"+t)}const li={_0:48,_9:57,A:65,F:70,a:97,f:102};function ch(t){if(t>=li._0&&t<=li._9)return t-li._0;if(t>=li.A&&t<=li.F)return t-(li.A-10);if(t>=li.a&&t<=li.f)return t-(li.a-10)}function K0(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);const e=t.length,r=e/2;if(e%2)throw new Error("hex string expected, got unpadded hex of length "+e);const i=new Uint8Array(r);for(let n=0,s=0;n<r;n++,s+=2){const a=ch(t.charCodeAt(s)),c=ch(t.charCodeAt(s+1));if(a===void 0||c===void 0){const d=t[s]+t[s+1];throw new Error('hex string expected, got non-hex character "'+d+'" at index '+s)}i[n]=a*16+c}return i}function Vv(t){return H0(Kf(t))}function Ca(t){return Hf(t),H0(Kf(Uint8Array.from(t).reverse()))}function V0(t,e){return K0(t.toString(16).padStart(e*2,"0"))}function nf(t,e){return V0(t,e).reverse()}function pi(t,e,r){let i;if(typeof e=="string")try{i=K0(e)}catch(s){throw new Error(t+" must be hex string or Uint8Array, cause: "+s)}else if(kf(e))i=Uint8Array.from(e);else throw new Error(t+" must be hex string or Uint8Array");const n=i.length;if(typeof r=="number"&&n!==r)throw new Error(t+" of length "+r+" expected, got "+n);return i}function fh(...t){let e=0;for(let i=0;i<t.length;i++){const n=t[i];Hf(n),e+=n.length}const r=new Uint8Array(e);for(let i=0,n=0;i<t.length;i++){const s=t[i];r.set(s,n),n+=s.length}return r}const rc=t=>typeof t=="bigint"&&jf<=t;function Wv(t,e,r){return rc(t)&&rc(e)&&rc(r)&&e<=t&&t<r}function ms(t,e,r,i){if(!Wv(e,r,i))throw new Error("expected valid "+t+": "+r+" <= n < "+i+", got "+e)}function Gv(t){let e;for(e=0;t>jf;t>>=k0,e+=1);return e}const Jv=t=>(Hv<<BigInt(t-1))-k0,Yv={bigint:t=>typeof t=="bigint",function:t=>typeof t=="function",boolean:t=>typeof t=="boolean",string:t=>typeof t=="string",stringOrUint8Array:t=>typeof t=="string"||kf(t),isSafeInteger:t=>Number.isSafeInteger(t),array:t=>Array.isArray(t),field:(t,e)=>e.Fp.isValid(t),hash:t=>typeof t=="function"&&Number.isSafeInteger(t.outputLen)};function Vf(t,e,r={}){const i=(n,s,a)=>{const c=Yv[s];if(typeof c!="function")throw new Error("invalid validator function");const d=t[n];if(!(a&&d===void 0)&&!c(d,t))throw new Error("param "+String(n)+" is invalid. Expected "+s+", got "+d)};for(const[n,s]of Object.entries(e))i(n,s,!1);for(const[n,s]of Object.entries(r))i(n,s,!0);return t}function dh(t){const e=new WeakMap;return(r,...i)=>{const n=e.get(r);if(n!==void 0)return n;const s=t(r,...i);return e.set(r,s),s}}const ht=BigInt(0),rt=BigInt(1),hn=BigInt(2),Zv=BigInt(3),sf=BigInt(4),hh=BigInt(5),uh=BigInt(8);function st(t,e){const r=t%e;return r>=ht?r:e+r}function Xv(t,e,r){if(e<ht)throw new Error("invalid exponent, negatives unsupported");if(r<=ht)throw new Error("invalid modulus");if(r===rt)return ht;let i=rt;for(;e>ht;)e&rt&&(i=i*t%r),t=t*t%r,e>>=rt;return i}function qr(t,e,r){let i=t;for(;e-- >ht;)i*=i,i%=r;return i}function lh(t,e){if(t===ht)throw new Error("invert: expected non-zero number");if(e<=ht)throw new Error("invert: expected positive modulus, got "+e);let r=st(t,e),i=e,n=ht,s=rt;for(;r!==ht;){const a=i/r,c=i%r,d=n-s*a;i=r,r=c,n=s,s=d}if(i!==rt)throw new Error("invert: does not exist");return st(n,e)}function Qv(t){const e=(t-rt)/hn;let r,i,n;for(r=t-rt,i=0;r%hn===ht;r/=hn,i++);for(n=hn;n<t&&Xv(n,e,t)!==t-rt;n++)if(n>1e3)throw new Error("Cannot find square root: likely non-prime P");if(i===1){const a=(t+rt)/sf;return function(c,d){const u=c.pow(d,a);if(!c.eql(c.sqr(u),d))throw new Error("Cannot find square root");return u}}const s=(r+rt)/hn;return function(a,c){if(a.pow(c,e)===a.neg(a.ONE))throw new Error("Cannot find square root");let d=i,u=a.pow(a.mul(a.ONE,n),r),l=a.pow(c,s),g=a.pow(c,r);for(;!a.eql(g,a.ONE);){if(a.eql(g,a.ZERO))return a.ZERO;let w=1;for(let $=a.sqr(g);w<d&&!a.eql($,a.ONE);w++)$=a.sqr($);const E=a.pow(u,rt<<BigInt(d-w-1));u=a.sqr(E),l=a.mul(l,E),g=a.mul(g,u),d=w}return l}}function e3(t){if(t%sf===Zv){const e=(t+rt)/sf;return function(r,i){const n=r.pow(i,e);if(!r.eql(r.sqr(n),i))throw new Error("Cannot find square root");return n}}if(t%uh===hh){const e=(t-hh)/uh;return function(r,i){const n=r.mul(i,hn),s=r.pow(n,e),a=r.mul(i,s),c=r.mul(r.mul(a,hn),s),d=r.mul(a,r.sub(c,r.ONE));if(!r.eql(r.sqr(d),i))throw new Error("Cannot find square root");return d}}return Qv(t)}const t3=(t,e)=>(st(t,e)&rt)===rt,r3=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function i3(t){const e={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},r=r3.reduce((i,n)=>(i[n]="function",i),e);return Vf(t,r)}function n3(t,e,r){if(r<ht)throw new Error("invalid exponent, negatives unsupported");if(r===ht)return t.ONE;if(r===rt)return e;let i=t.ONE,n=e;for(;r>ht;)r&rt&&(i=t.mul(i,n)),n=t.sqr(n),r>>=rt;return i}function s3(t,e){const r=new Array(e.length),i=e.reduce((s,a,c)=>t.is0(a)?s:(r[c]=s,t.mul(s,a)),t.ONE),n=t.inv(i);return e.reduceRight((s,a,c)=>t.is0(a)?s:(r[c]=t.mul(s,r[c]),t.mul(s,a)),n),r}function W0(t,e){const r=e!==void 0?e:t.toString(2).length,i=Math.ceil(r/8);return{nBitLength:r,nByteLength:i}}function G0(t,e,r=!1,i={}){if(t<=ht)throw new Error("invalid field: expected ORDER > 0, got "+t);const{nBitLength:n,nByteLength:s}=W0(t,e);if(s>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let a;const c=Object.freeze({ORDER:t,isLE:r,BITS:n,BYTES:s,MASK:Jv(n),ZERO:ht,ONE:rt,create:d=>st(d,t),isValid:d=>{if(typeof d!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof d);return ht<=d&&d<t},is0:d=>d===ht,isOdd:d=>(d&rt)===rt,neg:d=>st(-d,t),eql:(d,u)=>d===u,sqr:d=>st(d*d,t),add:(d,u)=>st(d+u,t),sub:(d,u)=>st(d-u,t),mul:(d,u)=>st(d*u,t),pow:(d,u)=>n3(c,d,u),div:(d,u)=>st(d*lh(u,t),t),sqrN:d=>d*d,addN:(d,u)=>d+u,subN:(d,u)=>d-u,mulN:(d,u)=>d*u,inv:d=>lh(d,t),sqrt:i.sqrt||(d=>(a||(a=e3(t)),a(c,d))),invertBatch:d=>s3(c,d),cmov:(d,u,l)=>l?u:d,toBytes:d=>r?nf(d,s):V0(d,s),fromBytes:d=>{if(d.length!==s)throw new Error("Field.fromBytes: expected "+s+" bytes, got "+d.length);return r?Ca(d):Vv(d)}});return Object.freeze(c)}const ph=BigInt(0),ba=BigInt(1);function ic(t,e){const r=e.negate();return t?r:e}function J0(t,e){if(!Number.isSafeInteger(t)||t<=0||t>e)throw new Error("invalid window size, expected [1.."+e+"], got W="+t)}function nc(t,e){J0(t,e);const r=Math.ceil(e/t)+1,i=2**(t-1);return{windows:r,windowSize:i}}function a3(t,e){if(!Array.isArray(t))throw new Error("array expected");t.forEach((r,i)=>{if(!(r instanceof e))throw new Error("invalid point at index "+i)})}function o3(t,e){if(!Array.isArray(t))throw new Error("array of scalars expected");t.forEach((r,i)=>{if(!e.isValid(r))throw new Error("invalid scalar at index "+i)})}const sc=new WeakMap,Y0=new WeakMap;function ac(t){return Y0.get(t)||1}function c3(t,e){return{constTimeNegate:ic,hasPrecomputes(r){return ac(r)!==1},unsafeLadder(r,i,n=t.ZERO){let s=r;for(;i>ph;)i&ba&&(n=n.add(s)),s=s.double(),i>>=ba;return n},precomputeWindow(r,i){const{windows:n,windowSize:s}=nc(i,e),a=[];let c=r,d=c;for(let u=0;u<n;u++){d=c,a.push(d);for(let l=1;l<s;l++)d=d.add(c),a.push(d);c=d.double()}return a},wNAF(r,i,n){const{windows:s,windowSize:a}=nc(r,e);let c=t.ZERO,d=t.BASE;const u=BigInt(2**r-1),l=2**r,g=BigInt(r);for(let w=0;w<s;w++){const E=w*a;let $=Number(n&u);n>>=g,$>a&&($-=l,n+=ba);const I=E,M=E+Math.abs($)-1,P=w%2!==0,A=$<0;$===0?d=d.add(ic(P,i[I])):c=c.add(ic(A,i[M]))}return{p:c,f:d}},wNAFUnsafe(r,i,n,s=t.ZERO){const{windows:a,windowSize:c}=nc(r,e),d=BigInt(2**r-1),u=2**r,l=BigInt(r);for(let g=0;g<a;g++){const w=g*c;if(n===ph)break;let E=Number(n&d);if(n>>=l,E>c&&(E-=u,n+=ba),E===0)continue;let $=i[w+Math.abs(E)-1];E<0&&($=$.negate()),s=s.add($)}return s},getPrecomputes(r,i,n){let s=sc.get(i);return s||(s=this.precomputeWindow(i,r),r!==1&&sc.set(i,n(s))),s},wNAFCached(r,i,n){const s=ac(r);return this.wNAF(s,this.getPrecomputes(s,r,n),i)},wNAFCachedUnsafe(r,i,n,s){const a=ac(r);return a===1?this.unsafeLadder(r,i,s):this.wNAFUnsafe(a,this.getPrecomputes(a,r,n),i,s)},setWindowSize(r,i){J0(i,e),Y0.set(r,i),sc.delete(r)}}}function f3(t,e,r,i){if(a3(r,t),o3(i,e),r.length!==i.length)throw new Error("arrays of points and scalars must have equal length");const n=t.ZERO,s=Gv(BigInt(r.length)),a=s>12?s-3:s>4?s-2:s?2:1,c=(1<<a)-1,d=new Array(c+1).fill(n),u=Math.floor((e.BITS-1)/a)*a;let l=n;for(let g=u;g>=0;g-=a){d.fill(n);for(let E=0;E<i.length;E++){const $=i[E],I=Number($>>BigInt(g)&BigInt(c));d[I]=d[I].add(r[E])}let w=n;for(let E=d.length-1,$=n;E>0;E--)$=$.add(d[E]),w=w.add($);if(l=l.add(w),g!==0)for(let E=0;E<a;E++)l=l.double()}return l}function d3(t){return i3(t.Fp),Vf(t,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...W0(t.n,t.nBitLength),...t,p:t.Fp.ORDER})}const Sr=BigInt(0),Lt=BigInt(1),ga=BigInt(2),h3=BigInt(8),u3={zip215:!0};function l3(t){const e=d3(t);return Vf(t,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...e})}function p3(t){const e=l3(t),{Fp:r,n:i,prehash:n,hash:s,randomBytes:a,nByteLength:c,h:d}=e,u=ga<<BigInt(c*8)-Lt,l=r.create,g=G0(e.n,e.nBitLength),w=e.uvRatio||((p,v)=>{try{return{isValid:!0,value:r.sqrt(p*r.inv(v))}}catch{return{isValid:!1,value:Sr}}}),E=e.adjustScalarBytes||(p=>p),$=e.domain||((p,v,_)=>{if(tc("phflag",_),v.length||_)throw new Error("Contexts/pre-hash are not supported");return p});function I(p,v){ms("coordinate "+p,v,Sr,u)}function M(p){if(!(p instanceof R))throw new Error("ExtendedPoint expected")}const P=dh((p,v)=>{const{ex:_,ey:x,ez:b}=p,f=p.is0();v==null&&(v=f?h3:r.inv(b));const m=l(_*v),F=l(x*v),N=l(b*v);if(f)return{x:Sr,y:Lt};if(N!==Lt)throw new Error("invZ was invalid");return{x:m,y:F}}),A=dh(p=>{const{a:v,d:_}=e;if(p.is0())throw new Error("bad point: ZERO");const{ex:x,ey:b,ez:f,et:m}=p,F=l(x*x),N=l(b*b),T=l(f*f),L=l(T*T),k=l(F*v),W=l(T*l(k+N)),Z=l(L+l(_*l(F*N)));if(W!==Z)throw new Error("bad point: equation left != right (1)");const K=l(x*b),Y=l(f*m);if(K!==Y)throw new Error("bad point: equation left != right (2)");return!0});class R{constructor(v,_,x,b){this.ex=v,this.ey=_,this.ez=x,this.et=b,I("x",v),I("y",_),I("z",x),I("t",b),Object.freeze(this)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(v){if(v instanceof R)throw new Error("extended point not allowed");const{x:_,y:x}=v||{};return I("x",_),I("y",x),new R(_,x,Lt,l(_*x))}static normalizeZ(v){const _=r.invertBatch(v.map(x=>x.ez));return v.map((x,b)=>x.toAffine(_[b])).map(R.fromAffine)}static msm(v,_){return f3(R,g,v,_)}_setWindowSize(v){U.setWindowSize(this,v)}assertValidity(){A(this)}equals(v){M(v);const{ex:_,ey:x,ez:b}=this,{ex:f,ey:m,ez:F}=v,N=l(_*F),T=l(f*b),L=l(x*F),k=l(m*b);return N===T&&L===k}is0(){return this.equals(R.ZERO)}negate(){return new R(l(-this.ex),this.ey,this.ez,l(-this.et))}double(){const{a:v}=e,{ex:_,ey:x,ez:b}=this,f=l(_*_),m=l(x*x),F=l(ga*l(b*b)),N=l(v*f),T=_+x,L=l(l(T*T)-f-m),k=N+m,W=k-F,Z=N-m,K=l(L*W),Y=l(k*Z),ke=l(L*Z),Q=l(W*k);return new R(K,Y,Q,ke)}add(v){M(v);const{a:_,d:x}=e,{ex:b,ey:f,ez:m,et:F}=this,{ex:N,ey:T,ez:L,et:k}=v;if(_===BigInt(-1)){const se=l((f-b)*(T+N)),Vt=l((f+b)*(T-N)),re=l(Vt-se);if(re===Sr)return this.double();const ae=l(m*ga*k),Wt=l(F*ga*L),oe=Wt+ae,ce=Vt+se,Gt=Wt-ae,ie=l(oe*re),fe=l(ce*Gt),sr=l(oe*Gt),ee=l(re*ce);return new R(ie,fe,ee,sr)}const W=l(b*N),Z=l(f*T),K=l(F*x*k),Y=l(m*L),ke=l((b+f)*(N+T)-W-Z),Q=Y-K,te=Y+K,At=l(Z-_*W),he=l(ke*Q),ue=l(te*At),wr=l(ke*At),le=l(Q*te);return new R(he,ue,le,wr)}subtract(v){return this.add(v.negate())}wNAF(v){return U.wNAFCached(this,v,R.normalizeZ)}multiply(v){const _=v;ms("scalar",_,Lt,i);const{p:x,f:b}=this.wNAF(_);return R.normalizeZ([x,b])[0]}multiplyUnsafe(v,_=R.ZERO){const x=v;return ms("scalar",x,Sr,i),x===Sr?D:this.is0()||x===Lt?this:U.wNAFCachedUnsafe(this,x,R.normalizeZ,_)}isSmallOrder(){return this.multiplyUnsafe(d).is0()}isTorsionFree(){return U.unsafeLadder(this,i).is0()}toAffine(v){return P(this,v)}clearCofactor(){const{h:v}=e;return v===Lt?this:this.multiplyUnsafe(v)}static fromHex(v,_=!1){const{d:x,a:b}=e,f=r.BYTES;v=pi("pointHex",v,f),tc("zip215",_);const m=v.slice(),F=v[f-1];m[f-1]=F&-129;const N=Ca(m),T=_?u:r.ORDER;ms("pointHex.y",N,Sr,T);const L=l(N*N),k=l(L-Lt),W=l(x*L-b);let{isValid:Z,value:K}=w(k,W);if(!Z)throw new Error("Point.fromHex: invalid y coordinate");const Y=(K&Lt)===Lt,ke=(F&128)!==0;if(!_&&K===Sr&&ke)throw new Error("Point.fromHex: x=0 and x_0=1");return ke!==Y&&(K=l(-K)),R.fromAffine({x:K,y:N})}static fromPrivateKey(v){return q(v).point}toRawBytes(){const{x:v,y:_}=this.toAffine(),x=nf(_,r.BYTES);return x[x.length-1]|=v&Lt?128:0,x}toHex(){return Kf(this.toRawBytes())}}R.BASE=new R(e.Gx,e.Gy,Lt,l(e.Gx*e.Gy)),R.ZERO=new R(Sr,Lt,Lt,Sr);const{BASE:C,ZERO:D}=R,U=c3(R,c*8);function j(p){return st(p,i)}function z(p){return j(Ca(p))}function q(p){const v=r.BYTES;p=pi("private key",p,v);const _=pi("hashed private key",s(p),2*v),x=E(_.slice(0,v)),b=_.slice(v,2*v),f=z(x),m=C.multiply(f),F=m.toRawBytes();return{head:x,prefix:b,scalar:f,point:m,pointBytes:F}}function V(p){return q(p).pointBytes}function S(p=new Uint8Array,...v){const _=fh(...v);return z(s($(_,pi("context",p),!!n)))}function o(p,v,_={}){p=pi("message",p),n&&(p=n(p));const{prefix:x,scalar:b,pointBytes:f}=q(v),m=S(_.context,x,p),F=C.multiply(m).toRawBytes(),N=S(_.context,F,f,p),T=j(m+N*b);ms("signature.s",T,Sr,i);const L=fh(F,nf(T,r.BYTES));return pi("result",L,r.BYTES*2)}const h=u3;function y(p,v,_,x=h){const{context:b,zip215:f}=x,m=r.BYTES;p=pi("signature",p,2*m),v=pi("message",v),_=pi("publicKey",_,m),f!==void 0&&tc("zip215",f),n&&(v=n(v));const F=Ca(p.slice(m,2*m));let N,T,L;try{N=R.fromHex(_,f),T=R.fromHex(p.slice(0,m),f),L=C.multiplyUnsafe(F)}catch{return!1}if(!f&&N.isSmallOrder())return!1;const k=S(b,T.toRawBytes(),N.toRawBytes(),v);return T.add(N.multiplyUnsafe(k)).subtract(L).clearCofactor().equals(R.ZERO)}return C._setWindowSize(8),{CURVE:e,getPublicKey:V,sign:o,verify:y,ExtendedPoint:R,utils:{getExtendedPublicKey:q,randomPrivateKey:()=>a(r.BYTES),precompute(p=8,v=R.BASE){return v._setWindowSize(p),v.multiply(BigInt(3)),v}}}}BigInt(0),BigInt(1);const Wf=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),bh=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752");BigInt(0);const b3=BigInt(1),gh=BigInt(2);BigInt(3);const g3=BigInt(5),v3=BigInt(8);function y3(t){const e=BigInt(10),r=BigInt(20),i=BigInt(40),n=BigInt(80),s=Wf,a=t*t%s*t%s,c=qr(a,gh,s)*a%s,d=qr(c,b3,s)*t%s,u=qr(d,g3,s)*d%s,l=qr(u,e,s)*u%s,g=qr(l,r,s)*l%s,w=qr(g,i,s)*g%s,E=qr(w,n,s)*w%s,$=qr(E,n,s)*w%s,I=qr($,e,s)*u%s;return{pow_p_5_8:qr(I,gh,s)*t%s,b2:a}}function m3(t){return t[0]&=248,t[31]&=127,t[31]|=64,t}function w3(t,e){const r=Wf,i=st(e*e*e,r),n=st(i*i*e,r),s=y3(t*n).pow_p_5_8;let a=st(t*i*s,r);const c=st(e*a*a,r),d=a,u=st(a*bh,r),l=c===t,g=c===st(-t,r),w=c===st(-t*bh,r);return l&&(a=d),(g||w)&&(a=u),t3(a,r)&&(a=st(-a,r)),{isValid:l||g,value:a}}const _3=G0(Wf,void 0,!0),E3={a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:_3,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:v3,Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:kv,randomBytes:gv,adjustScalarBytes:m3,uvRatio:w3};p3(E3);function S3(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),i=0;i<r.length;i++)r[i]=255;for(var n=0;n<t.length;n++){var s=t.charAt(n),a=s.charCodeAt(0);if(r[a]!==255)throw new TypeError(s+" is ambiguous");r[a]=n}var c=t.length,d=t.charAt(0),u=Math.log(c)/Math.log(256),l=Math.log(256)/Math.log(c);function g($){if($ instanceof Uint8Array||(ArrayBuffer.isView($)?$=new Uint8Array($.buffer,$.byteOffset,$.byteLength):Array.isArray($)&&($=Uint8Array.from($))),!($ instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if($.length===0)return"";for(var I=0,M=0,P=0,A=$.length;P!==A&&$[P]===0;)P++,I++;for(var R=(A-P)*l+1>>>0,C=new Uint8Array(R);P!==A;){for(var D=$[P],U=0,j=R-1;(D!==0||U<M)&&j!==-1;j--,U++)D+=256*C[j]>>>0,C[j]=D%c>>>0,D=D/c>>>0;if(D!==0)throw new Error("Non-zero carry");M=U,P++}for(var z=R-M;z!==R&&C[z]===0;)z++;for(var q=d.repeat(I);z<R;++z)q+=t.charAt(C[z]);return q}function w($){if(typeof $!="string")throw new TypeError("Expected String");if($.length===0)return new Uint8Array;var I=0;if($[I]!==" "){for(var M=0,P=0;$[I]===d;)M++,I++;for(var A=($.length-I)*u+1>>>0,R=new Uint8Array(A);$[I];){var C=r[$.charCodeAt(I)];if(C===255)return;for(var D=0,U=A-1;(C!==0||D<P)&&U!==-1;U--,D++)C+=c*R[U]>>>0,R[U]=C%256>>>0,C=C/256>>>0;if(C!==0)throw new Error("Non-zero carry");P=D,I++}if($[I]!==" "){for(var j=A-P;j!==A&&R[j]===0;)j++;for(var z=new Uint8Array(M+(A-j)),q=M;j!==A;)z[q++]=R[j++];return z}}}function E($){var I=w($);if(I)return I;throw new Error(`Non-${e} character`)}return{encode:g,decodeUnsafe:w,decode:E}}var $3=S3,x3=$3;const Z0=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")},I3=t=>new TextEncoder().encode(t),M3=t=>new TextDecoder().decode(t);let A3=class{constructor(e,r,i){this.name=e,this.prefix=r,this.baseEncode=i}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},P3=class{constructor(e,r,i){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=i}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return X0(this,e)}},O3=class{constructor(e){this.decoders=e}or(e){return X0(this,e)}decode(e){const r=e[0],i=this.decoders[r];if(i)return i.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}};const X0=(t,e)=>new O3({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}});let R3=class{constructor(e,r,i,n){this.name=e,this.prefix=r,this.baseEncode=i,this.baseDecode=n,this.encoder=new A3(e,r,i),this.decoder=new P3(e,r,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}};const go=({name:t,prefix:e,encode:r,decode:i})=>new R3(t,e,r,i),Ws=({prefix:t,name:e,alphabet:r})=>{const{encode:i,decode:n}=x3(r,e);return go({prefix:t,name:e,encode:i,decode:s=>Z0(n(s))})},F3=(t,e,r,i)=>{const n={};for(let l=0;l<e.length;++l)n[e[l]]=l;let s=t.length;for(;t[s-1]==="=";)--s;const a=new Uint8Array(s*r/8|0);let c=0,d=0,u=0;for(let l=0;l<s;++l){const g=n[t[l]];if(g===void 0)throw new SyntaxError(`Non-${i} character`);d=d<<r|g,c+=r,c>=8&&(c-=8,a[u++]=255&d>>c)}if(c>=r||255&d<<8-c)throw new SyntaxError("Unexpected end of data");return a},N3=(t,e,r)=>{const i=e[e.length-1]==="=",n=(1<<r)-1;let s="",a=0,c=0;for(let d=0;d<t.length;++d)for(c=c<<8|t[d],a+=8;a>r;)a-=r,s+=e[n&c>>a];if(a&&(s+=e[n&c<<r-a]),i)for(;s.length*r&7;)s+="=";return s},St=({name:t,prefix:e,bitsPerChar:r,alphabet:i})=>go({prefix:e,name:t,encode(n){return N3(n,i,r)},decode(n){return F3(n,i,r,t)}}),C3=go({prefix:"\0",name:"identity",encode:t=>M3(t),decode:t=>I3(t)});var T3=Object.freeze({__proto__:null,identity:C3});const B3=St({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var q3=Object.freeze({__proto__:null,base2:B3});const L3=St({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var D3=Object.freeze({__proto__:null,base8:L3});const U3=Ws({prefix:"9",name:"base10",alphabet:"0123456789"});var z3=Object.freeze({__proto__:null,base10:U3});const j3=St({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),k3=St({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var H3=Object.freeze({__proto__:null,base16:j3,base16upper:k3});const K3=St({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),V3=St({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),W3=St({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),G3=St({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),J3=St({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Y3=St({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),Z3=St({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),X3=St({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Q3=St({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var e6=Object.freeze({__proto__:null,base32:K3,base32upper:V3,base32pad:W3,base32padupper:G3,base32hex:J3,base32hexupper:Y3,base32hexpad:Z3,base32hexpadupper:X3,base32z:Q3});const t6=Ws({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),r6=Ws({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var i6=Object.freeze({__proto__:null,base36:t6,base36upper:r6});const n6=Ws({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),s6=Ws({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var a6=Object.freeze({__proto__:null,base58btc:n6,base58flickr:s6});const o6=St({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),c6=St({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),f6=St({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),d6=St({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var h6=Object.freeze({__proto__:null,base64:o6,base64pad:c6,base64url:f6,base64urlpad:d6});const Q0=Array.from(""),u6=Q0.reduce((t,e,r)=>(t[r]=e,t),[]),l6=Q0.reduce((t,e,r)=>(t[e.codePointAt(0)]=r,t),[]);function p6(t){return t.reduce((e,r)=>(e+=u6[r],e),"")}function b6(t){const e=[];for(const r of t){const i=l6[r.codePointAt(0)];if(i===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(i)}return new Uint8Array(e)}const g6=go({prefix:"",name:"base256emoji",encode:p6,decode:b6});var v6=Object.freeze({__proto__:null,base256emoji:g6}),y6=ep,vh=128,m6=-128,w6=Math.pow(2,31);function ep(t,e,r){e=e||[],r=r||0;for(var i=r;t>=w6;)e[r++]=t&255|vh,t/=128;for(;t&m6;)e[r++]=t&255|vh,t>>>=7;return e[r]=t|0,ep.bytes=r-i+1,e}var _6=af,E6=128,yh=127;function af(t,i){var r=0,i=i||0,n=0,s=i,a,c=t.length;do{if(s>=c)throw af.bytes=0,new RangeError("Could not decode varint");a=t[s++],r+=n<28?(a&yh)<<n:(a&yh)*Math.pow(2,n),n+=7}while(a>=E6);return af.bytes=s-i,r}var S6=Math.pow(2,7),$6=Math.pow(2,14),x6=Math.pow(2,21),I6=Math.pow(2,28),M6=Math.pow(2,35),A6=Math.pow(2,42),P6=Math.pow(2,49),O6=Math.pow(2,56),R6=Math.pow(2,63),F6=function(t){return t<S6?1:t<$6?2:t<x6?3:t<I6?4:t<M6?5:t<A6?6:t<P6?7:t<O6?8:t<R6?9:10},N6={encode:y6,decode:_6,encodingLength:F6},tp=N6;const mh=(t,e,r=0)=>(tp.encode(t,e,r),e),wh=t=>tp.encodingLength(t),of=(t,e)=>{const r=e.byteLength,i=wh(t),n=i+wh(r),s=new Uint8Array(n+r);return mh(t,s,0),mh(r,s,i),s.set(e,n),new C6(t,r,e,s)};let C6=class{constructor(e,r,i,n){this.code=e,this.size=r,this.digest=i,this.bytes=n}};const rp=({name:t,code:e,encode:r})=>new T6(t,e,r);let T6=class{constructor(e,r,i){this.name=e,this.code=r,this.encode=i}digest(e){if(e instanceof Uint8Array){const r=this.encode(e);return r instanceof Uint8Array?of(this.code,r):r.then(i=>of(this.code,i))}else throw Error("Unknown type, must be binary type")}};const ip=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),B6=rp({name:"sha2-256",code:18,encode:ip("SHA-256")}),q6=rp({name:"sha2-512",code:19,encode:ip("SHA-512")});var L6=Object.freeze({__proto__:null,sha256:B6,sha512:q6});const np=0,D6="identity",sp=Z0,U6=t=>of(np,sp(t)),z6={code:np,name:D6,encode:sp,digest:U6};var j6=Object.freeze({__proto__:null,identity:z6});new TextEncoder,new TextDecoder;({...T3,...q3,...D3,...z3,...H3,...e6,...i6,...a6,...h6,...v6});({...L6,...j6});({hex:ja.base16,...ja});var k6={};const H6="6.6.1",K6={version:H6};var ir={},Gf={exports:{}};Gf.exports;(function(t){(function(e,r){function i(S,o){if(!S)throw new Error(o||"Assertion failed")}function n(S,o){S.super_=o;var h=function(){};h.prototype=o.prototype,S.prototype=new h,S.prototype.constructor=S}function s(S,o,h){if(s.isBN(S))return S;this.negative=0,this.words=null,this.length=0,this.red=null,S!==null&&((o==="le"||o==="be")&&(h=o,o=10),this._init(S||0,o||10,h||"be"))}typeof e=="object"?e.exports=s:r.BN=s,s.BN=s,s.wordSize=26;var a;try{typeof window<"u"&&typeof window.Buffer<"u"?a=window.Buffer:a=S0.Buffer}catch{}s.isBN=function(o){return o instanceof s?!0:o!==null&&typeof o=="object"&&o.constructor.wordSize===s.wordSize&&Array.isArray(o.words)},s.max=function(o,h){return o.cmp(h)>0?o:h},s.min=function(o,h){return o.cmp(h)<0?o:h},s.prototype._init=function(o,h,y){if(typeof o=="number")return this._initNumber(o,h,y);if(typeof o=="object")return this._initArray(o,h,y);h==="hex"&&(h=16),i(h===(h|0)&&h>=2&&h<=36),o=o.toString().replace(/\s+/g,"");var p=0;o[0]==="-"&&(p++,this.negative=1),p<o.length&&(h===16?this._parseHex(o,p,y):(this._parseBase(o,h,p),y==="le"&&this._initArray(this.toArray(),h,y)))},s.prototype._initNumber=function(o,h,y){o<0&&(this.negative=1,o=-o),o<67108864?(this.words=[o&67108863],this.length=1):o<4503599627370496?(this.words=[o&67108863,o/67108864&67108863],this.length=2):(i(o<9007199254740992),this.words=[o&67108863,o/67108864&67108863,1],this.length=3),y==="le"&&this._initArray(this.toArray(),h,y)},s.prototype._initArray=function(o,h,y){if(i(typeof o.length=="number"),o.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(o.length/3),this.words=new Array(this.length);for(var p=0;p<this.length;p++)this.words[p]=0;var v,_,x=0;if(y==="be")for(p=o.length-1,v=0;p>=0;p-=3)_=o[p]|o[p-1]<<8|o[p-2]<<16,this.words[v]|=_<<x&67108863,this.words[v+1]=_>>>26-x&67108863,x+=24,x>=26&&(x-=26,v++);else if(y==="le")for(p=0,v=0;p<o.length;p+=3)_=o[p]|o[p+1]<<8|o[p+2]<<16,this.words[v]|=_<<x&67108863,this.words[v+1]=_>>>26-x&67108863,x+=24,x>=26&&(x-=26,v++);return this.strip()};function c(S,o){var h=S.charCodeAt(o);return h>=65&&h<=70?h-55:h>=97&&h<=102?h-87:h-48&15}function d(S,o,h){var y=c(S,h);return h-1>=o&&(y|=c(S,h-1)<<4),y}s.prototype._parseHex=function(o,h,y){this.length=Math.ceil((o.length-h)/6),this.words=new Array(this.length);for(var p=0;p<this.length;p++)this.words[p]=0;var v=0,_=0,x;if(y==="be")for(p=o.length-1;p>=h;p-=2)x=d(o,h,p)<<v,this.words[_]|=x&67108863,v>=18?(v-=18,_+=1,this.words[_]|=x>>>26):v+=8;else{var b=o.length-h;for(p=b%2===0?h+1:h;p<o.length;p+=2)x=d(o,h,p)<<v,this.words[_]|=x&67108863,v>=18?(v-=18,_+=1,this.words[_]|=x>>>26):v+=8}this.strip()};function u(S,o,h,y){for(var p=0,v=Math.min(S.length,h),_=o;_<v;_++){var x=S.charCodeAt(_)-48;p*=y,x>=49?p+=x-49+10:x>=17?p+=x-17+10:p+=x}return p}s.prototype._parseBase=function(o,h,y){this.words=[0],this.length=1;for(var p=0,v=1;v<=67108863;v*=h)p++;p--,v=v/h|0;for(var _=o.length-y,x=_%p,b=Math.min(_,_-x)+y,f=0,m=y;m<b;m+=p)f=u(o,m,m+p,h),this.imuln(v),this.words[0]+f<67108864?this.words[0]+=f:this._iaddn(f);if(x!==0){var F=1;for(f=u(o,m,o.length,h),m=0;m<x;m++)F*=h;this.imuln(F),this.words[0]+f<67108864?this.words[0]+=f:this._iaddn(f)}this.strip()},s.prototype.copy=function(o){o.words=new Array(this.length);for(var h=0;h<this.length;h++)o.words[h]=this.words[h];o.length=this.length,o.negative=this.negative,o.red=this.red},s.prototype.clone=function(){var o=new s(null);return this.copy(o),o},s.prototype._expand=function(o){for(;this.length<o;)this.words[this.length++]=0;return this},s.prototype.strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},s.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},s.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var l=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],g=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],w=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];s.prototype.toString=function(o,h){o=o||10,h=h|0||1;var y;if(o===16||o==="hex"){y="";for(var p=0,v=0,_=0;_<this.length;_++){var x=this.words[_],b=((x<<p|v)&16777215).toString(16);v=x>>>24-p&16777215,v!==0||_!==this.length-1?y=l[6-b.length]+b+y:y=b+y,p+=2,p>=26&&(p-=26,_--)}for(v!==0&&(y=v.toString(16)+y);y.length%h!==0;)y="0"+y;return this.negative!==0&&(y="-"+y),y}if(o===(o|0)&&o>=2&&o<=36){var f=g[o],m=w[o];y="";var F=this.clone();for(F.negative=0;!F.isZero();){var N=F.modn(m).toString(o);F=F.idivn(m),F.isZero()?y=N+y:y=l[f-N.length]+N+y}for(this.isZero()&&(y="0"+y);y.length%h!==0;)y="0"+y;return this.negative!==0&&(y="-"+y),y}i(!1,"Base should be between 2 and 36")},s.prototype.toNumber=function(){var o=this.words[0];return this.length===2?o+=this.words[1]*67108864:this.length===3&&this.words[2]===1?o+=4503599627370496+this.words[1]*67108864:this.length>2&&i(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-o:o},s.prototype.toJSON=function(){return this.toString(16)},s.prototype.toBuffer=function(o,h){return i(typeof a<"u"),this.toArrayLike(a,o,h)},s.prototype.toArray=function(o,h){return this.toArrayLike(Array,o,h)},s.prototype.toArrayLike=function(o,h,y){var p=this.byteLength(),v=y||Math.max(1,p);i(p<=v,"byte array longer than desired length"),i(v>0,"Requested array length <= 0"),this.strip();var _=h==="le",x=new o(v),b,f,m=this.clone();if(_){for(f=0;!m.isZero();f++)b=m.andln(255),m.iushrn(8),x[f]=b;for(;f<v;f++)x[f]=0}else{for(f=0;f<v-p;f++)x[f]=0;for(f=0;!m.isZero();f++)b=m.andln(255),m.iushrn(8),x[v-f-1]=b}return x},Math.clz32?s.prototype._countBits=function(o){return 32-Math.clz32(o)}:s.prototype._countBits=function(o){var h=o,y=0;return h>=4096&&(y+=13,h>>>=13),h>=64&&(y+=7,h>>>=7),h>=8&&(y+=4,h>>>=4),h>=2&&(y+=2,h>>>=2),y+h},s.prototype._zeroBits=function(o){if(o===0)return 26;var h=o,y=0;return h&8191||(y+=13,h>>>=13),h&127||(y+=7,h>>>=7),h&15||(y+=4,h>>>=4),h&3||(y+=2,h>>>=2),h&1||y++,y},s.prototype.bitLength=function(){var o=this.words[this.length-1],h=this._countBits(o);return(this.length-1)*26+h};function E(S){for(var o=new Array(S.bitLength()),h=0;h<o.length;h++){var y=h/26|0,p=h%26;o[h]=(S.words[y]&1<<p)>>>p}return o}s.prototype.zeroBits=function(){if(this.isZero())return 0;for(var o=0,h=0;h<this.length;h++){var y=this._zeroBits(this.words[h]);if(o+=y,y!==26)break}return o},s.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},s.prototype.toTwos=function(o){return this.negative!==0?this.abs().inotn(o).iaddn(1):this.clone()},s.prototype.fromTwos=function(o){return this.testn(o-1)?this.notn(o).iaddn(1).ineg():this.clone()},s.prototype.isNeg=function(){return this.negative!==0},s.prototype.neg=function(){return this.clone().ineg()},s.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},s.prototype.iuor=function(o){for(;this.length<o.length;)this.words[this.length++]=0;for(var h=0;h<o.length;h++)this.words[h]=this.words[h]|o.words[h];return this.strip()},s.prototype.ior=function(o){return i((this.negative|o.negative)===0),this.iuor(o)},s.prototype.or=function(o){return this.length>o.length?this.clone().ior(o):o.clone().ior(this)},s.prototype.uor=function(o){return this.length>o.length?this.clone().iuor(o):o.clone().iuor(this)},s.prototype.iuand=function(o){var h;this.length>o.length?h=o:h=this;for(var y=0;y<h.length;y++)this.words[y]=this.words[y]&o.words[y];return this.length=h.length,this.strip()},s.prototype.iand=function(o){return i((this.negative|o.negative)===0),this.iuand(o)},s.prototype.and=function(o){return this.length>o.length?this.clone().iand(o):o.clone().iand(this)},s.prototype.uand=function(o){return this.length>o.length?this.clone().iuand(o):o.clone().iuand(this)},s.prototype.iuxor=function(o){var h,y;this.length>o.length?(h=this,y=o):(h=o,y=this);for(var p=0;p<y.length;p++)this.words[p]=h.words[p]^y.words[p];if(this!==h)for(;p<h.length;p++)this.words[p]=h.words[p];return this.length=h.length,this.strip()},s.prototype.ixor=function(o){return i((this.negative|o.negative)===0),this.iuxor(o)},s.prototype.xor=function(o){return this.length>o.length?this.clone().ixor(o):o.clone().ixor(this)},s.prototype.uxor=function(o){return this.length>o.length?this.clone().iuxor(o):o.clone().iuxor(this)},s.prototype.inotn=function(o){i(typeof o=="number"&&o>=0);var h=Math.ceil(o/26)|0,y=o%26;this._expand(h),y>0&&h--;for(var p=0;p<h;p++)this.words[p]=~this.words[p]&67108863;return y>0&&(this.words[p]=~this.words[p]&67108863>>26-y),this.strip()},s.prototype.notn=function(o){return this.clone().inotn(o)},s.prototype.setn=function(o,h){i(typeof o=="number"&&o>=0);var y=o/26|0,p=o%26;return this._expand(y+1),h?this.words[y]=this.words[y]|1<<p:this.words[y]=this.words[y]&~(1<<p),this.strip()},s.prototype.iadd=function(o){var h;if(this.negative!==0&&o.negative===0)return this.negative=0,h=this.isub(o),this.negative^=1,this._normSign();if(this.negative===0&&o.negative!==0)return o.negative=0,h=this.isub(o),o.negative=1,h._normSign();var y,p;this.length>o.length?(y=this,p=o):(y=o,p=this);for(var v=0,_=0;_<p.length;_++)h=(y.words[_]|0)+(p.words[_]|0)+v,this.words[_]=h&67108863,v=h>>>26;for(;v!==0&&_<y.length;_++)h=(y.words[_]|0)+v,this.words[_]=h&67108863,v=h>>>26;if(this.length=y.length,v!==0)this.words[this.length]=v,this.length++;else if(y!==this)for(;_<y.length;_++)this.words[_]=y.words[_];return this},s.prototype.add=function(o){var h;return o.negative!==0&&this.negative===0?(o.negative=0,h=this.sub(o),o.negative^=1,h):o.negative===0&&this.negative!==0?(this.negative=0,h=o.sub(this),this.negative=1,h):this.length>o.length?this.clone().iadd(o):o.clone().iadd(this)},s.prototype.isub=function(o){if(o.negative!==0){o.negative=0;var h=this.iadd(o);return o.negative=1,h._normSign()}else if(this.negative!==0)return this.negative=0,this.iadd(o),this.negative=1,this._normSign();var y=this.cmp(o);if(y===0)return this.negative=0,this.length=1,this.words[0]=0,this;var p,v;y>0?(p=this,v=o):(p=o,v=this);for(var _=0,x=0;x<v.length;x++)h=(p.words[x]|0)-(v.words[x]|0)+_,_=h>>26,this.words[x]=h&67108863;for(;_!==0&&x<p.length;x++)h=(p.words[x]|0)+_,_=h>>26,this.words[x]=h&67108863;if(_===0&&x<p.length&&p!==this)for(;x<p.length;x++)this.words[x]=p.words[x];return this.length=Math.max(this.length,x),p!==this&&(this.negative=1),this.strip()},s.prototype.sub=function(o){return this.clone().isub(o)};function $(S,o,h){h.negative=o.negative^S.negative;var y=S.length+o.length|0;h.length=y,y=y-1|0;var p=S.words[0]|0,v=o.words[0]|0,_=p*v,x=_&67108863,b=_/67108864|0;h.words[0]=x;for(var f=1;f<y;f++){for(var m=b>>>26,F=b&67108863,N=Math.min(f,o.length-1),T=Math.max(0,f-S.length+1);T<=N;T++){var L=f-T|0;p=S.words[L]|0,v=o.words[T]|0,_=p*v+F,m+=_/67108864|0,F=_&67108863}h.words[f]=F|0,b=m|0}return b!==0?h.words[f]=b|0:h.length--,h.strip()}var I=function(o,h,y){var p=o.words,v=h.words,_=y.words,x=0,b,f,m,F=p[0]|0,N=F&8191,T=F>>>13,L=p[1]|0,k=L&8191,W=L>>>13,Z=p[2]|0,K=Z&8191,Y=Z>>>13,ke=p[3]|0,Q=ke&8191,te=ke>>>13,At=p[4]|0,he=At&8191,ue=At>>>13,wr=p[5]|0,le=wr&8191,se=wr>>>13,Vt=p[6]|0,re=Vt&8191,ae=Vt>>>13,Wt=p[7]|0,oe=Wt&8191,ce=Wt>>>13,Gt=p[8]|0,ie=Gt&8191,fe=Gt>>>13,sr=p[9]|0,ee=sr&8191,me=sr>>>13,Ai=v[0]|0,xe=Ai&8191,we=Ai>>>13,Br=v[1]|0,_e=Br&8191,Ee=Br>>>13,Yi=v[2]|0,de=Yi&8191,Se=Yi>>>13,Zi=v[3]|0,Ie=Zi&8191,be=Zi>>>13,_r=v[4]|0,ge=_r&8191,ve=_r>>>13,Gr=v[5]|0,pe=Gr&8191,Me=Gr>>>13,Xi=v[6]|0,Ae=Xi&8191,Pe=Xi>>>13,Qi=v[7]|0,$e=Qi&8191,ye=Qi>>>13,Jt=v[8]|0,Oe=Jt&8191,Re=Jt>>>13,en=v[9]|0,Fe=en&8191,Ne=en>>>13;y.negative=o.negative^h.negative,y.length=19,b=Math.imul(N,xe),f=Math.imul(N,we),f=f+Math.imul(T,xe)|0,m=Math.imul(T,we);var mt=(x+b|0)+((f&8191)<<13)|0;x=(m+(f>>>13)|0)+(mt>>>26)|0,mt&=67108863,b=Math.imul(k,xe),f=Math.imul(k,we),f=f+Math.imul(W,xe)|0,m=Math.imul(W,we),b=b+Math.imul(N,_e)|0,f=f+Math.imul(N,Ee)|0,f=f+Math.imul(T,_e)|0,m=m+Math.imul(T,Ee)|0;var Jr=(x+b|0)+((f&8191)<<13)|0;x=(m+(f>>>13)|0)+(Jr>>>26)|0,Jr&=67108863,b=Math.imul(K,xe),f=Math.imul(K,we),f=f+Math.imul(Y,xe)|0,m=Math.imul(Y,we),b=b+Math.imul(k,_e)|0,f=f+Math.imul(k,Ee)|0,f=f+Math.imul(W,_e)|0,m=m+Math.imul(W,Ee)|0,b=b+Math.imul(N,de)|0,f=f+Math.imul(N,Se)|0,f=f+Math.imul(T,de)|0,m=m+Math.imul(T,Se)|0;var Yr=(x+b|0)+((f&8191)<<13)|0;x=(m+(f>>>13)|0)+(Yr>>>26)|0,Yr&=67108863,b=Math.imul(Q,xe),f=Math.imul(Q,we),f=f+Math.imul(te,xe)|0,m=Math.imul(te,we),b=b+Math.imul(K,_e)|0,f=f+Math.imul(K,Ee)|0,f=f+Math.imul(Y,_e)|0,m=m+Math.imul(Y,Ee)|0,b=b+Math.imul(k,de)|0,f=f+Math.imul(k,Se)|0,f=f+Math.imul(W,de)|0,m=m+Math.imul(W,Se)|0,b=b+Math.imul(N,Ie)|0,f=f+Math.imul(N,be)|0,f=f+Math.imul(T,Ie)|0,m=m+Math.imul(T,be)|0;var Zr=(x+b|0)+((f&8191)<<13)|0;x=(m+(f>>>13)|0)+(Zr>>>26)|0,Zr&=67108863,b=Math.imul(he,xe),f=Math.imul(he,we),f=f+Math.imul(ue,xe)|0,m=Math.imul(ue,we),b=b+Math.imul(Q,_e)|0,f=f+Math.imul(Q,Ee)|0,f=f+Math.imul(te,_e)|0,m=m+Math.imul(te,Ee)|0,b=b+Math.imul(K,de)|0,f=f+Math.imul(K,Se)|0,f=f+Math.imul(Y,de)|0,m=m+Math.imul(Y,Se)|0,b=b+Math.imul(k,Ie)|0,f=f+Math.imul(k,be)|0,f=f+Math.imul(W,Ie)|0,m=m+Math.imul(W,be)|0,b=b+Math.imul(N,ge)|0,f=f+Math.imul(N,ve)|0,f=f+Math.imul(T,ge)|0,m=m+Math.imul(T,ve)|0;var Xr=(x+b|0)+((f&8191)<<13)|0;x=(m+(f>>>13)|0)+(Xr>>>26)|0,Xr&=67108863,b=Math.imul(le,xe),f=Math.imul(le,we),f=f+Math.imul(se,xe)|0,m=Math.imul(se,we),b=b+Math.imul(he,_e)|0,f=f+Math.imul(he,Ee)|0,f=f+Math.imul(ue,_e)|0,m=m+Math.imul(ue,Ee)|0,b=b+Math.imul(Q,de)|0,f=f+Math.imul(Q,Se)|0,f=f+Math.imul(te,de)|0,m=m+Math.imul(te,Se)|0,b=b+Math.imul(K,Ie)|0,f=f+Math.imul(K,be)|0,f=f+Math.imul(Y,Ie)|0,m=m+Math.imul(Y,be)|0,b=b+Math.imul(k,ge)|0,f=f+Math.imul(k,ve)|0,f=f+Math.imul(W,ge)|0,m=m+Math.imul(W,ve)|0,b=b+Math.imul(N,pe)|0,f=f+Math.imul(N,Me)|0,f=f+Math.imul(T,pe)|0,m=m+Math.imul(T,Me)|0;var Qr=(x+b|0)+((f&8191)<<13)|0;x=(m+(f>>>13)|0)+(Qr>>>26)|0,Qr&=67108863,b=Math.imul(re,xe),f=Math.imul(re,we),f=f+Math.imul(ae,xe)|0,m=Math.imul(ae,we),b=b+Math.imul(le,_e)|0,f=f+Math.imul(le,Ee)|0,f=f+Math.imul(se,_e)|0,m=m+Math.imul(se,Ee)|0,b=b+Math.imul(he,de)|0,f=f+Math.imul(he,Se)|0,f=f+Math.imul(ue,de)|0,m=m+Math.imul(ue,Se)|0,b=b+Math.imul(Q,Ie)|0,f=f+Math.imul(Q,be)|0,f=f+Math.imul(te,Ie)|0,m=m+Math.imul(te,be)|0,b=b+Math.imul(K,ge)|0,f=f+Math.imul(K,ve)|0,f=f+Math.imul(Y,ge)|0,m=m+Math.imul(Y,ve)|0,b=b+Math.imul(k,pe)|0,f=f+Math.imul(k,Me)|0,f=f+Math.imul(W,pe)|0,m=m+Math.imul(W,Me)|0,b=b+Math.imul(N,Ae)|0,f=f+Math.imul(N,Pe)|0,f=f+Math.imul(T,Ae)|0,m=m+Math.imul(T,Pe)|0;var Ct=(x+b|0)+((f&8191)<<13)|0;x=(m+(f>>>13)|0)+(Ct>>>26)|0,Ct&=67108863,b=Math.imul(oe,xe),f=Math.imul(oe,we),f=f+Math.imul(ce,xe)|0,m=Math.imul(ce,we),b=b+Math.imul(re,_e)|0,f=f+Math.imul(re,Ee)|0,f=f+Math.imul(ae,_e)|0,m=m+Math.imul(ae,Ee)|0,b=b+Math.imul(le,de)|0,f=f+Math.imul(le,Se)|0,f=f+Math.imul(se,de)|0,m=m+Math.imul(se,Se)|0,b=b+Math.imul(he,Ie)|0,f=f+Math.imul(he,be)|0,f=f+Math.imul(ue,Ie)|0,m=m+Math.imul(ue,be)|0,b=b+Math.imul(Q,ge)|0,f=f+Math.imul(Q,ve)|0,f=f+Math.imul(te,ge)|0,m=m+Math.imul(te,ve)|0,b=b+Math.imul(K,pe)|0,f=f+Math.imul(K,Me)|0,f=f+Math.imul(Y,pe)|0,m=m+Math.imul(Y,Me)|0,b=b+Math.imul(k,Ae)|0,f=f+Math.imul(k,Pe)|0,f=f+Math.imul(W,Ae)|0,m=m+Math.imul(W,Pe)|0,b=b+Math.imul(N,$e)|0,f=f+Math.imul(N,ye)|0,f=f+Math.imul(T,$e)|0,m=m+Math.imul(T,ye)|0;var ei=(x+b|0)+((f&8191)<<13)|0;x=(m+(f>>>13)|0)+(ei>>>26)|0,ei&=67108863,b=Math.imul(ie,xe),f=Math.imul(ie,we),f=f+Math.imul(fe,xe)|0,m=Math.imul(fe,we),b=b+Math.imul(oe,_e)|0,f=f+Math.imul(oe,Ee)|0,f=f+Math.imul(ce,_e)|0,m=m+Math.imul(ce,Ee)|0,b=b+Math.imul(re,de)|0,f=f+Math.imul(re,Se)|0,f=f+Math.imul(ae,de)|0,m=m+Math.imul(ae,Se)|0,b=b+Math.imul(le,Ie)|0,f=f+Math.imul(le,be)|0,f=f+Math.imul(se,Ie)|0,m=m+Math.imul(se,be)|0,b=b+Math.imul(he,ge)|0,f=f+Math.imul(he,ve)|0,f=f+Math.imul(ue,ge)|0,m=m+Math.imul(ue,ve)|0,b=b+Math.imul(Q,pe)|0,f=f+Math.imul(Q,Me)|0,f=f+Math.imul(te,pe)|0,m=m+Math.imul(te,Me)|0,b=b+Math.imul(K,Ae)|0,f=f+Math.imul(K,Pe)|0,f=f+Math.imul(Y,Ae)|0,m=m+Math.imul(Y,Pe)|0,b=b+Math.imul(k,$e)|0,f=f+Math.imul(k,ye)|0,f=f+Math.imul(W,$e)|0,m=m+Math.imul(W,ye)|0,b=b+Math.imul(N,Oe)|0,f=f+Math.imul(N,Re)|0,f=f+Math.imul(T,Oe)|0,m=m+Math.imul(T,Re)|0;var ti=(x+b|0)+((f&8191)<<13)|0;x=(m+(f>>>13)|0)+(ti>>>26)|0,ti&=67108863,b=Math.imul(ee,xe),f=Math.imul(ee,we),f=f+Math.imul(me,xe)|0,m=Math.imul(me,we),b=b+Math.imul(ie,_e)|0,f=f+Math.imul(ie,Ee)|0,f=f+Math.imul(fe,_e)|0,m=m+Math.imul(fe,Ee)|0,b=b+Math.imul(oe,de)|0,f=f+Math.imul(oe,Se)|0,f=f+Math.imul(ce,de)|0,m=m+Math.imul(ce,Se)|0,b=b+Math.imul(re,Ie)|0,f=f+Math.imul(re,be)|0,f=f+Math.imul(ae,Ie)|0,m=m+Math.imul(ae,be)|0,b=b+Math.imul(le,ge)|0,f=f+Math.imul(le,ve)|0,f=f+Math.imul(se,ge)|0,m=m+Math.imul(se,ve)|0,b=b+Math.imul(he,pe)|0,f=f+Math.imul(he,Me)|0,f=f+Math.imul(ue,pe)|0,m=m+Math.imul(ue,Me)|0,b=b+Math.imul(Q,Ae)|0,f=f+Math.imul(Q,Pe)|0,f=f+Math.imul(te,Ae)|0,m=m+Math.imul(te,Pe)|0,b=b+Math.imul(K,$e)|0,f=f+Math.imul(K,ye)|0,f=f+Math.imul(Y,$e)|0,m=m+Math.imul(Y,ye)|0,b=b+Math.imul(k,Oe)|0,f=f+Math.imul(k,Re)|0,f=f+Math.imul(W,Oe)|0,m=m+Math.imul(W,Re)|0,b=b+Math.imul(N,Fe)|0,f=f+Math.imul(N,Ne)|0,f=f+Math.imul(T,Fe)|0,m=m+Math.imul(T,Ne)|0;var ri=(x+b|0)+((f&8191)<<13)|0;x=(m+(f>>>13)|0)+(ri>>>26)|0,ri&=67108863,b=Math.imul(ee,_e),f=Math.imul(ee,Ee),f=f+Math.imul(me,_e)|0,m=Math.imul(me,Ee),b=b+Math.imul(ie,de)|0,f=f+Math.imul(ie,Se)|0,f=f+Math.imul(fe,de)|0,m=m+Math.imul(fe,Se)|0,b=b+Math.imul(oe,Ie)|0,f=f+Math.imul(oe,be)|0,f=f+Math.imul(ce,Ie)|0,m=m+Math.imul(ce,be)|0,b=b+Math.imul(re,ge)|0,f=f+Math.imul(re,ve)|0,f=f+Math.imul(ae,ge)|0,m=m+Math.imul(ae,ve)|0,b=b+Math.imul(le,pe)|0,f=f+Math.imul(le,Me)|0,f=f+Math.imul(se,pe)|0,m=m+Math.imul(se,Me)|0,b=b+Math.imul(he,Ae)|0,f=f+Math.imul(he,Pe)|0,f=f+Math.imul(ue,Ae)|0,m=m+Math.imul(ue,Pe)|0,b=b+Math.imul(Q,$e)|0,f=f+Math.imul(Q,ye)|0,f=f+Math.imul(te,$e)|0,m=m+Math.imul(te,ye)|0,b=b+Math.imul(K,Oe)|0,f=f+Math.imul(K,Re)|0,f=f+Math.imul(Y,Oe)|0,m=m+Math.imul(Y,Re)|0,b=b+Math.imul(k,Fe)|0,f=f+Math.imul(k,Ne)|0,f=f+Math.imul(W,Fe)|0,m=m+Math.imul(W,Ne)|0;var ii=(x+b|0)+((f&8191)<<13)|0;x=(m+(f>>>13)|0)+(ii>>>26)|0,ii&=67108863,b=Math.imul(ee,de),f=Math.imul(ee,Se),f=f+Math.imul(me,de)|0,m=Math.imul(me,Se),b=b+Math.imul(ie,Ie)|0,f=f+Math.imul(ie,be)|0,f=f+Math.imul(fe,Ie)|0,m=m+Math.imul(fe,be)|0,b=b+Math.imul(oe,ge)|0,f=f+Math.imul(oe,ve)|0,f=f+Math.imul(ce,ge)|0,m=m+Math.imul(ce,ve)|0,b=b+Math.imul(re,pe)|0,f=f+Math.imul(re,Me)|0,f=f+Math.imul(ae,pe)|0,m=m+Math.imul(ae,Me)|0,b=b+Math.imul(le,Ae)|0,f=f+Math.imul(le,Pe)|0,f=f+Math.imul(se,Ae)|0,m=m+Math.imul(se,Pe)|0,b=b+Math.imul(he,$e)|0,f=f+Math.imul(he,ye)|0,f=f+Math.imul(ue,$e)|0,m=m+Math.imul(ue,ye)|0,b=b+Math.imul(Q,Oe)|0,f=f+Math.imul(Q,Re)|0,f=f+Math.imul(te,Oe)|0,m=m+Math.imul(te,Re)|0,b=b+Math.imul(K,Fe)|0,f=f+Math.imul(K,Ne)|0,f=f+Math.imul(Y,Fe)|0,m=m+Math.imul(Y,Ne)|0;var ni=(x+b|0)+((f&8191)<<13)|0;x=(m+(f>>>13)|0)+(ni>>>26)|0,ni&=67108863,b=Math.imul(ee,Ie),f=Math.imul(ee,be),f=f+Math.imul(me,Ie)|0,m=Math.imul(me,be),b=b+Math.imul(ie,ge)|0,f=f+Math.imul(ie,ve)|0,f=f+Math.imul(fe,ge)|0,m=m+Math.imul(fe,ve)|0,b=b+Math.imul(oe,pe)|0,f=f+Math.imul(oe,Me)|0,f=f+Math.imul(ce,pe)|0,m=m+Math.imul(ce,Me)|0,b=b+Math.imul(re,Ae)|0,f=f+Math.imul(re,Pe)|0,f=f+Math.imul(ae,Ae)|0,m=m+Math.imul(ae,Pe)|0,b=b+Math.imul(le,$e)|0,f=f+Math.imul(le,ye)|0,f=f+Math.imul(se,$e)|0,m=m+Math.imul(se,ye)|0,b=b+Math.imul(he,Oe)|0,f=f+Math.imul(he,Re)|0,f=f+Math.imul(ue,Oe)|0,m=m+Math.imul(ue,Re)|0,b=b+Math.imul(Q,Fe)|0,f=f+Math.imul(Q,Ne)|0,f=f+Math.imul(te,Fe)|0,m=m+Math.imul(te,Ne)|0;var ar=(x+b|0)+((f&8191)<<13)|0;x=(m+(f>>>13)|0)+(ar>>>26)|0,ar&=67108863,b=Math.imul(ee,ge),f=Math.imul(ee,ve),f=f+Math.imul(me,ge)|0,m=Math.imul(me,ve),b=b+Math.imul(ie,pe)|0,f=f+Math.imul(ie,Me)|0,f=f+Math.imul(fe,pe)|0,m=m+Math.imul(fe,Me)|0,b=b+Math.imul(oe,Ae)|0,f=f+Math.imul(oe,Pe)|0,f=f+Math.imul(ce,Ae)|0,m=m+Math.imul(ce,Pe)|0,b=b+Math.imul(re,$e)|0,f=f+Math.imul(re,ye)|0,f=f+Math.imul(ae,$e)|0,m=m+Math.imul(ae,ye)|0,b=b+Math.imul(le,Oe)|0,f=f+Math.imul(le,Re)|0,f=f+Math.imul(se,Oe)|0,m=m+Math.imul(se,Re)|0,b=b+Math.imul(he,Fe)|0,f=f+Math.imul(he,Ne)|0,f=f+Math.imul(ue,Fe)|0,m=m+Math.imul(ue,Ne)|0;var si=(x+b|0)+((f&8191)<<13)|0;x=(m+(f>>>13)|0)+(si>>>26)|0,si&=67108863,b=Math.imul(ee,pe),f=Math.imul(ee,Me),f=f+Math.imul(me,pe)|0,m=Math.imul(me,Me),b=b+Math.imul(ie,Ae)|0,f=f+Math.imul(ie,Pe)|0,f=f+Math.imul(fe,Ae)|0,m=m+Math.imul(fe,Pe)|0,b=b+Math.imul(oe,$e)|0,f=f+Math.imul(oe,ye)|0,f=f+Math.imul(ce,$e)|0,m=m+Math.imul(ce,ye)|0,b=b+Math.imul(re,Oe)|0,f=f+Math.imul(re,Re)|0,f=f+Math.imul(ae,Oe)|0,m=m+Math.imul(ae,Re)|0,b=b+Math.imul(le,Fe)|0,f=f+Math.imul(le,Ne)|0,f=f+Math.imul(se,Fe)|0,m=m+Math.imul(se,Ne)|0;var ai=(x+b|0)+((f&8191)<<13)|0;x=(m+(f>>>13)|0)+(ai>>>26)|0,ai&=67108863,b=Math.imul(ee,Ae),f=Math.imul(ee,Pe),f=f+Math.imul(me,Ae)|0,m=Math.imul(me,Pe),b=b+Math.imul(ie,$e)|0,f=f+Math.imul(ie,ye)|0,f=f+Math.imul(fe,$e)|0,m=m+Math.imul(fe,ye)|0,b=b+Math.imul(oe,Oe)|0,f=f+Math.imul(oe,Re)|0,f=f+Math.imul(ce,Oe)|0,m=m+Math.imul(ce,Re)|0,b=b+Math.imul(re,Fe)|0,f=f+Math.imul(re,Ne)|0,f=f+Math.imul(ae,Fe)|0,m=m+Math.imul(ae,Ne)|0;var Pt=(x+b|0)+((f&8191)<<13)|0;x=(m+(f>>>13)|0)+(Pt>>>26)|0,Pt&=67108863,b=Math.imul(ee,$e),f=Math.imul(ee,ye),f=f+Math.imul(me,$e)|0,m=Math.imul(me,ye),b=b+Math.imul(ie,Oe)|0,f=f+Math.imul(ie,Re)|0,f=f+Math.imul(fe,Oe)|0,m=m+Math.imul(fe,Re)|0,b=b+Math.imul(oe,Fe)|0,f=f+Math.imul(oe,Ne)|0,f=f+Math.imul(ce,Fe)|0,m=m+Math.imul(ce,Ne)|0;var oi=(x+b|0)+((f&8191)<<13)|0;x=(m+(f>>>13)|0)+(oi>>>26)|0,oi&=67108863,b=Math.imul(ee,Oe),f=Math.imul(ee,Re),f=f+Math.imul(me,Oe)|0,m=Math.imul(me,Re),b=b+Math.imul(ie,Fe)|0,f=f+Math.imul(ie,Ne)|0,f=f+Math.imul(fe,Fe)|0,m=m+Math.imul(fe,Ne)|0;var ci=(x+b|0)+((f&8191)<<13)|0;x=(m+(f>>>13)|0)+(ci>>>26)|0,ci&=67108863,b=Math.imul(ee,Fe),f=Math.imul(ee,Ne),f=f+Math.imul(me,Fe)|0,m=Math.imul(me,Ne);var fi=(x+b|0)+((f&8191)<<13)|0;return x=(m+(f>>>13)|0)+(fi>>>26)|0,fi&=67108863,_[0]=mt,_[1]=Jr,_[2]=Yr,_[3]=Zr,_[4]=Xr,_[5]=Qr,_[6]=Ct,_[7]=ei,_[8]=ti,_[9]=ri,_[10]=ii,_[11]=ni,_[12]=ar,_[13]=si,_[14]=ai,_[15]=Pt,_[16]=oi,_[17]=ci,_[18]=fi,x!==0&&(_[19]=x,y.length++),y};Math.imul||(I=$);function M(S,o,h){h.negative=o.negative^S.negative,h.length=S.length+o.length;for(var y=0,p=0,v=0;v<h.length-1;v++){var _=p;p=0;for(var x=y&67108863,b=Math.min(v,o.length-1),f=Math.max(0,v-S.length+1);f<=b;f++){var m=v-f,F=S.words[m]|0,N=o.words[f]|0,T=F*N,L=T&67108863;_=_+(T/67108864|0)|0,L=L+x|0,x=L&67108863,_=_+(L>>>26)|0,p+=_>>>26,_&=67108863}h.words[v]=x,y=_,_=p}return y!==0?h.words[v]=y:h.length--,h.strip()}function P(S,o,h){var y=new A;return y.mulp(S,o,h)}s.prototype.mulTo=function(o,h){var y,p=this.length+o.length;return this.length===10&&o.length===10?y=I(this,o,h):p<63?y=$(this,o,h):p<1024?y=M(this,o,h):y=P(this,o,h),y};function A(S,o){this.x=S,this.y=o}A.prototype.makeRBT=function(o){for(var h=new Array(o),y=s.prototype._countBits(o)-1,p=0;p<o;p++)h[p]=this.revBin(p,y,o);return h},A.prototype.revBin=function(o,h,y){if(o===0||o===y-1)return o;for(var p=0,v=0;v<h;v++)p|=(o&1)<<h-v-1,o>>=1;return p},A.prototype.permute=function(o,h,y,p,v,_){for(var x=0;x<_;x++)p[x]=h[o[x]],v[x]=y[o[x]]},A.prototype.transform=function(o,h,y,p,v,_){this.permute(_,o,h,y,p,v);for(var x=1;x<v;x<<=1)for(var b=x<<1,f=Math.cos(2*Math.PI/b),m=Math.sin(2*Math.PI/b),F=0;F<v;F+=b)for(var N=f,T=m,L=0;L<x;L++){var k=y[F+L],W=p[F+L],Z=y[F+L+x],K=p[F+L+x],Y=N*Z-T*K;K=N*K+T*Z,Z=Y,y[F+L]=k+Z,p[F+L]=W+K,y[F+L+x]=k-Z,p[F+L+x]=W-K,L!==b&&(Y=f*N-m*T,T=f*T+m*N,N=Y)}},A.prototype.guessLen13b=function(o,h){var y=Math.max(h,o)|1,p=y&1,v=0;for(y=y/2|0;y;y=y>>>1)v++;return 1<<v+1+p},A.prototype.conjugate=function(o,h,y){if(!(y<=1))for(var p=0;p<y/2;p++){var v=o[p];o[p]=o[y-p-1],o[y-p-1]=v,v=h[p],h[p]=-h[y-p-1],h[y-p-1]=-v}},A.prototype.normalize13b=function(o,h){for(var y=0,p=0;p<h/2;p++){var v=Math.round(o[2*p+1]/h)*8192+Math.round(o[2*p]/h)+y;o[p]=v&67108863,v<67108864?y=0:y=v/67108864|0}return o},A.prototype.convert13b=function(o,h,y,p){for(var v=0,_=0;_<h;_++)v=v+(o[_]|0),y[2*_]=v&8191,v=v>>>13,y[2*_+1]=v&8191,v=v>>>13;for(_=2*h;_<p;++_)y[_]=0;i(v===0),i((v&-8192)===0)},A.prototype.stub=function(o){for(var h=new Array(o),y=0;y<o;y++)h[y]=0;return h},A.prototype.mulp=function(o,h,y){var p=2*this.guessLen13b(o.length,h.length),v=this.makeRBT(p),_=this.stub(p),x=new Array(p),b=new Array(p),f=new Array(p),m=new Array(p),F=new Array(p),N=new Array(p),T=y.words;T.length=p,this.convert13b(o.words,o.length,x,p),this.convert13b(h.words,h.length,m,p),this.transform(x,_,b,f,p,v),this.transform(m,_,F,N,p,v);for(var L=0;L<p;L++){var k=b[L]*F[L]-f[L]*N[L];f[L]=b[L]*N[L]+f[L]*F[L],b[L]=k}return this.conjugate(b,f,p),this.transform(b,f,T,_,p,v),this.conjugate(T,_,p),this.normalize13b(T,p),y.negative=o.negative^h.negative,y.length=o.length+h.length,y.strip()},s.prototype.mul=function(o){var h=new s(null);return h.words=new Array(this.length+o.length),this.mulTo(o,h)},s.prototype.mulf=function(o){var h=new s(null);return h.words=new Array(this.length+o.length),P(this,o,h)},s.prototype.imul=function(o){return this.clone().mulTo(o,this)},s.prototype.imuln=function(o){i(typeof o=="number"),i(o<67108864);for(var h=0,y=0;y<this.length;y++){var p=(this.words[y]|0)*o,v=(p&67108863)+(h&67108863);h>>=26,h+=p/67108864|0,h+=v>>>26,this.words[y]=v&67108863}return h!==0&&(this.words[y]=h,this.length++),this},s.prototype.muln=function(o){return this.clone().imuln(o)},s.prototype.sqr=function(){return this.mul(this)},s.prototype.isqr=function(){return this.imul(this.clone())},s.prototype.pow=function(o){var h=E(o);if(h.length===0)return new s(1);for(var y=this,p=0;p<h.length&&h[p]===0;p++,y=y.sqr());if(++p<h.length)for(var v=y.sqr();p<h.length;p++,v=v.sqr())h[p]!==0&&(y=y.mul(v));return y},s.prototype.iushln=function(o){i(typeof o=="number"&&o>=0);var h=o%26,y=(o-h)/26,p=67108863>>>26-h<<26-h,v;if(h!==0){var _=0;for(v=0;v<this.length;v++){var x=this.words[v]&p,b=(this.words[v]|0)-x<<h;this.words[v]=b|_,_=x>>>26-h}_&&(this.words[v]=_,this.length++)}if(y!==0){for(v=this.length-1;v>=0;v--)this.words[v+y]=this.words[v];for(v=0;v<y;v++)this.words[v]=0;this.length+=y}return this.strip()},s.prototype.ishln=function(o){return i(this.negative===0),this.iushln(o)},s.prototype.iushrn=function(o,h,y){i(typeof o=="number"&&o>=0);var p;h?p=(h-h%26)/26:p=0;var v=o%26,_=Math.min((o-v)/26,this.length),x=67108863^67108863>>>v<<v,b=y;if(p-=_,p=Math.max(0,p),b){for(var f=0;f<_;f++)b.words[f]=this.words[f];b.length=_}if(_!==0)if(this.length>_)for(this.length-=_,f=0;f<this.length;f++)this.words[f]=this.words[f+_];else this.words[0]=0,this.length=1;var m=0;for(f=this.length-1;f>=0&&(m!==0||f>=p);f--){var F=this.words[f]|0;this.words[f]=m<<26-v|F>>>v,m=F&x}return b&&m!==0&&(b.words[b.length++]=m),this.length===0&&(this.words[0]=0,this.length=1),this.strip()},s.prototype.ishrn=function(o,h,y){return i(this.negative===0),this.iushrn(o,h,y)},s.prototype.shln=function(o){return this.clone().ishln(o)},s.prototype.ushln=function(o){return this.clone().iushln(o)},s.prototype.shrn=function(o){return this.clone().ishrn(o)},s.prototype.ushrn=function(o){return this.clone().iushrn(o)},s.prototype.testn=function(o){i(typeof o=="number"&&o>=0);var h=o%26,y=(o-h)/26,p=1<<h;if(this.length<=y)return!1;var v=this.words[y];return!!(v&p)},s.prototype.imaskn=function(o){i(typeof o=="number"&&o>=0);var h=o%26,y=(o-h)/26;if(i(this.negative===0,"imaskn works only with positive numbers"),this.length<=y)return this;if(h!==0&&y++,this.length=Math.min(y,this.length),h!==0){var p=67108863^67108863>>>h<<h;this.words[this.length-1]&=p}return this.strip()},s.prototype.maskn=function(o){return this.clone().imaskn(o)},s.prototype.iaddn=function(o){return i(typeof o=="number"),i(o<67108864),o<0?this.isubn(-o):this.negative!==0?this.length===1&&(this.words[0]|0)<o?(this.words[0]=o-(this.words[0]|0),this.negative=0,this):(this.negative=0,this.isubn(o),this.negative=1,this):this._iaddn(o)},s.prototype._iaddn=function(o){this.words[0]+=o;for(var h=0;h<this.length&&this.words[h]>=67108864;h++)this.words[h]-=67108864,h===this.length-1?this.words[h+1]=1:this.words[h+1]++;return this.length=Math.max(this.length,h+1),this},s.prototype.isubn=function(o){if(i(typeof o=="number"),i(o<67108864),o<0)return this.iaddn(-o);if(this.negative!==0)return this.negative=0,this.iaddn(o),this.negative=1,this;if(this.words[0]-=o,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var h=0;h<this.length&&this.words[h]<0;h++)this.words[h]+=67108864,this.words[h+1]-=1;return this.strip()},s.prototype.addn=function(o){return this.clone().iaddn(o)},s.prototype.subn=function(o){return this.clone().isubn(o)},s.prototype.iabs=function(){return this.negative=0,this},s.prototype.abs=function(){return this.clone().iabs()},s.prototype._ishlnsubmul=function(o,h,y){var p=o.length+y,v;this._expand(p);var _,x=0;for(v=0;v<o.length;v++){_=(this.words[v+y]|0)+x;var b=(o.words[v]|0)*h;_-=b&67108863,x=(_>>26)-(b/67108864|0),this.words[v+y]=_&67108863}for(;v<this.length-y;v++)_=(this.words[v+y]|0)+x,x=_>>26,this.words[v+y]=_&67108863;if(x===0)return this.strip();for(i(x===-1),x=0,v=0;v<this.length;v++)_=-(this.words[v]|0)+x,x=_>>26,this.words[v]=_&67108863;return this.negative=1,this.strip()},s.prototype._wordDiv=function(o,h){var y=this.length-o.length,p=this.clone(),v=o,_=v.words[v.length-1]|0,x=this._countBits(_);y=26-x,y!==0&&(v=v.ushln(y),p.iushln(y),_=v.words[v.length-1]|0);var b=p.length-v.length,f;if(h!=="mod"){f=new s(null),f.length=b+1,f.words=new Array(f.length);for(var m=0;m<f.length;m++)f.words[m]=0}var F=p.clone()._ishlnsubmul(v,1,b);F.negative===0&&(p=F,f&&(f.words[b]=1));for(var N=b-1;N>=0;N--){var T=(p.words[v.length+N]|0)*67108864+(p.words[v.length+N-1]|0);for(T=Math.min(T/_|0,67108863),p._ishlnsubmul(v,T,N);p.negative!==0;)T--,p.negative=0,p._ishlnsubmul(v,1,N),p.isZero()||(p.negative^=1);f&&(f.words[N]=T)}return f&&f.strip(),p.strip(),h!=="div"&&y!==0&&p.iushrn(y),{div:f||null,mod:p}},s.prototype.divmod=function(o,h,y){if(i(!o.isZero()),this.isZero())return{div:new s(0),mod:new s(0)};var p,v,_;return this.negative!==0&&o.negative===0?(_=this.neg().divmod(o,h),h!=="mod"&&(p=_.div.neg()),h!=="div"&&(v=_.mod.neg(),y&&v.negative!==0&&v.iadd(o)),{div:p,mod:v}):this.negative===0&&o.negative!==0?(_=this.divmod(o.neg(),h),h!=="mod"&&(p=_.div.neg()),{div:p,mod:_.mod}):this.negative&o.negative?(_=this.neg().divmod(o.neg(),h),h!=="div"&&(v=_.mod.neg(),y&&v.negative!==0&&v.isub(o)),{div:_.div,mod:v}):o.length>this.length||this.cmp(o)<0?{div:new s(0),mod:this}:o.length===1?h==="div"?{div:this.divn(o.words[0]),mod:null}:h==="mod"?{div:null,mod:new s(this.modn(o.words[0]))}:{div:this.divn(o.words[0]),mod:new s(this.modn(o.words[0]))}:this._wordDiv(o,h)},s.prototype.div=function(o){return this.divmod(o,"div",!1).div},s.prototype.mod=function(o){return this.divmod(o,"mod",!1).mod},s.prototype.umod=function(o){return this.divmod(o,"mod",!0).mod},s.prototype.divRound=function(o){var h=this.divmod(o);if(h.mod.isZero())return h.div;var y=h.div.negative!==0?h.mod.isub(o):h.mod,p=o.ushrn(1),v=o.andln(1),_=y.cmp(p);return _<0||v===1&&_===0?h.div:h.div.negative!==0?h.div.isubn(1):h.div.iaddn(1)},s.prototype.modn=function(o){i(o<=67108863);for(var h=(1<<26)%o,y=0,p=this.length-1;p>=0;p--)y=(h*y+(this.words[p]|0))%o;return y},s.prototype.idivn=function(o){i(o<=67108863);for(var h=0,y=this.length-1;y>=0;y--){var p=(this.words[y]|0)+h*67108864;this.words[y]=p/o|0,h=p%o}return this.strip()},s.prototype.divn=function(o){return this.clone().idivn(o)},s.prototype.egcd=function(o){i(o.negative===0),i(!o.isZero());var h=this,y=o.clone();h.negative!==0?h=h.umod(o):h=h.clone();for(var p=new s(1),v=new s(0),_=new s(0),x=new s(1),b=0;h.isEven()&&y.isEven();)h.iushrn(1),y.iushrn(1),++b;for(var f=y.clone(),m=h.clone();!h.isZero();){for(var F=0,N=1;!(h.words[0]&N)&&F<26;++F,N<<=1);if(F>0)for(h.iushrn(F);F-- >0;)(p.isOdd()||v.isOdd())&&(p.iadd(f),v.isub(m)),p.iushrn(1),v.iushrn(1);for(var T=0,L=1;!(y.words[0]&L)&&T<26;++T,L<<=1);if(T>0)for(y.iushrn(T);T-- >0;)(_.isOdd()||x.isOdd())&&(_.iadd(f),x.isub(m)),_.iushrn(1),x.iushrn(1);h.cmp(y)>=0?(h.isub(y),p.isub(_),v.isub(x)):(y.isub(h),_.isub(p),x.isub(v))}return{a:_,b:x,gcd:y.iushln(b)}},s.prototype._invmp=function(o){i(o.negative===0),i(!o.isZero());var h=this,y=o.clone();h.negative!==0?h=h.umod(o):h=h.clone();for(var p=new s(1),v=new s(0),_=y.clone();h.cmpn(1)>0&&y.cmpn(1)>0;){for(var x=0,b=1;!(h.words[0]&b)&&x<26;++x,b<<=1);if(x>0)for(h.iushrn(x);x-- >0;)p.isOdd()&&p.iadd(_),p.iushrn(1);for(var f=0,m=1;!(y.words[0]&m)&&f<26;++f,m<<=1);if(f>0)for(y.iushrn(f);f-- >0;)v.isOdd()&&v.iadd(_),v.iushrn(1);h.cmp(y)>=0?(h.isub(y),p.isub(v)):(y.isub(h),v.isub(p))}var F;return h.cmpn(1)===0?F=p:F=v,F.cmpn(0)<0&&F.iadd(o),F},s.prototype.gcd=function(o){if(this.isZero())return o.abs();if(o.isZero())return this.abs();var h=this.clone(),y=o.clone();h.negative=0,y.negative=0;for(var p=0;h.isEven()&&y.isEven();p++)h.iushrn(1),y.iushrn(1);do{for(;h.isEven();)h.iushrn(1);for(;y.isEven();)y.iushrn(1);var v=h.cmp(y);if(v<0){var _=h;h=y,y=_}else if(v===0||y.cmpn(1)===0)break;h.isub(y)}while(!0);return y.iushln(p)},s.prototype.invm=function(o){return this.egcd(o).a.umod(o)},s.prototype.isEven=function(){return(this.words[0]&1)===0},s.prototype.isOdd=function(){return(this.words[0]&1)===1},s.prototype.andln=function(o){return this.words[0]&o},s.prototype.bincn=function(o){i(typeof o=="number");var h=o%26,y=(o-h)/26,p=1<<h;if(this.length<=y)return this._expand(y+1),this.words[y]|=p,this;for(var v=p,_=y;v!==0&&_<this.length;_++){var x=this.words[_]|0;x+=v,v=x>>>26,x&=67108863,this.words[_]=x}return v!==0&&(this.words[_]=v,this.length++),this},s.prototype.isZero=function(){return this.length===1&&this.words[0]===0},s.prototype.cmpn=function(o){var h=o<0;if(this.negative!==0&&!h)return-1;if(this.negative===0&&h)return 1;this.strip();var y;if(this.length>1)y=1;else{h&&(o=-o),i(o<=67108863,"Number is too big");var p=this.words[0]|0;y=p===o?0:p<o?-1:1}return this.negative!==0?-y|0:y},s.prototype.cmp=function(o){if(this.negative!==0&&o.negative===0)return-1;if(this.negative===0&&o.negative!==0)return 1;var h=this.ucmp(o);return this.negative!==0?-h|0:h},s.prototype.ucmp=function(o){if(this.length>o.length)return 1;if(this.length<o.length)return-1;for(var h=0,y=this.length-1;y>=0;y--){var p=this.words[y]|0,v=o.words[y]|0;if(p!==v){p<v?h=-1:p>v&&(h=1);break}}return h},s.prototype.gtn=function(o){return this.cmpn(o)===1},s.prototype.gt=function(o){return this.cmp(o)===1},s.prototype.gten=function(o){return this.cmpn(o)>=0},s.prototype.gte=function(o){return this.cmp(o)>=0},s.prototype.ltn=function(o){return this.cmpn(o)===-1},s.prototype.lt=function(o){return this.cmp(o)===-1},s.prototype.lten=function(o){return this.cmpn(o)<=0},s.prototype.lte=function(o){return this.cmp(o)<=0},s.prototype.eqn=function(o){return this.cmpn(o)===0},s.prototype.eq=function(o){return this.cmp(o)===0},s.red=function(o){return new q(o)},s.prototype.toRed=function(o){return i(!this.red,"Already a number in reduction context"),i(this.negative===0,"red works only with positives"),o.convertTo(this)._forceRed(o)},s.prototype.fromRed=function(){return i(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},s.prototype._forceRed=function(o){return this.red=o,this},s.prototype.forceRed=function(o){return i(!this.red,"Already a number in reduction context"),this._forceRed(o)},s.prototype.redAdd=function(o){return i(this.red,"redAdd works only with red numbers"),this.red.add(this,o)},s.prototype.redIAdd=function(o){return i(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,o)},s.prototype.redSub=function(o){return i(this.red,"redSub works only with red numbers"),this.red.sub(this,o)},s.prototype.redISub=function(o){return i(this.red,"redISub works only with red numbers"),this.red.isub(this,o)},s.prototype.redShl=function(o){return i(this.red,"redShl works only with red numbers"),this.red.shl(this,o)},s.prototype.redMul=function(o){return i(this.red,"redMul works only with red numbers"),this.red._verify2(this,o),this.red.mul(this,o)},s.prototype.redIMul=function(o){return i(this.red,"redMul works only with red numbers"),this.red._verify2(this,o),this.red.imul(this,o)},s.prototype.redSqr=function(){return i(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},s.prototype.redISqr=function(){return i(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},s.prototype.redSqrt=function(){return i(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},s.prototype.redInvm=function(){return i(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},s.prototype.redNeg=function(){return i(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},s.prototype.redPow=function(o){return i(this.red&&!o.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,o)};var R={k256:null,p224:null,p192:null,p25519:null};function C(S,o){this.name=S,this.p=new s(o,16),this.n=this.p.bitLength(),this.k=new s(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}C.prototype._tmp=function(){var o=new s(null);return o.words=new Array(Math.ceil(this.n/13)),o},C.prototype.ireduce=function(o){var h=o,y;do this.split(h,this.tmp),h=this.imulK(h),h=h.iadd(this.tmp),y=h.bitLength();while(y>this.n);var p=y<this.n?-1:h.ucmp(this.p);return p===0?(h.words[0]=0,h.length=1):p>0?h.isub(this.p):h.strip!==void 0?h.strip():h._strip(),h},C.prototype.split=function(o,h){o.iushrn(this.n,0,h)},C.prototype.imulK=function(o){return o.imul(this.k)};function D(){C.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}n(D,C),D.prototype.split=function(o,h){for(var y=4194303,p=Math.min(o.length,9),v=0;v<p;v++)h.words[v]=o.words[v];if(h.length=p,o.length<=9){o.words[0]=0,o.length=1;return}var _=o.words[9];for(h.words[h.length++]=_&y,v=10;v<o.length;v++){var x=o.words[v]|0;o.words[v-10]=(x&y)<<4|_>>>22,_=x}_>>>=22,o.words[v-10]=_,_===0&&o.length>10?o.length-=10:o.length-=9},D.prototype.imulK=function(o){o.words[o.length]=0,o.words[o.length+1]=0,o.length+=2;for(var h=0,y=0;y<o.length;y++){var p=o.words[y]|0;h+=p*977,o.words[y]=h&67108863,h=p*64+(h/67108864|0)}return o.words[o.length-1]===0&&(o.length--,o.words[o.length-1]===0&&o.length--),o};function U(){C.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}n(U,C);function j(){C.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}n(j,C);function z(){C.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}n(z,C),z.prototype.imulK=function(o){for(var h=0,y=0;y<o.length;y++){var p=(o.words[y]|0)*19+h,v=p&67108863;p>>>=26,o.words[y]=v,h=p}return h!==0&&(o.words[o.length++]=h),o},s._prime=function(o){if(R[o])return R[o];var h;if(o==="k256")h=new D;else if(o==="p224")h=new U;else if(o==="p192")h=new j;else if(o==="p25519")h=new z;else throw new Error("Unknown prime "+o);return R[o]=h,h};function q(S){if(typeof S=="string"){var o=s._prime(S);this.m=o.p,this.prime=o}else i(S.gtn(1),"modulus must be greater than 1"),this.m=S,this.prime=null}q.prototype._verify1=function(o){i(o.negative===0,"red works only with positives"),i(o.red,"red works only with red numbers")},q.prototype._verify2=function(o,h){i((o.negative|h.negative)===0,"red works only with positives"),i(o.red&&o.red===h.red,"red works only with red numbers")},q.prototype.imod=function(o){return this.prime?this.prime.ireduce(o)._forceRed(this):o.umod(this.m)._forceRed(this)},q.prototype.neg=function(o){return o.isZero()?o.clone():this.m.sub(o)._forceRed(this)},q.prototype.add=function(o,h){this._verify2(o,h);var y=o.add(h);return y.cmp(this.m)>=0&&y.isub(this.m),y._forceRed(this)},q.prototype.iadd=function(o,h){this._verify2(o,h);var y=o.iadd(h);return y.cmp(this.m)>=0&&y.isub(this.m),y},q.prototype.sub=function(o,h){this._verify2(o,h);var y=o.sub(h);return y.cmpn(0)<0&&y.iadd(this.m),y._forceRed(this)},q.prototype.isub=function(o,h){this._verify2(o,h);var y=o.isub(h);return y.cmpn(0)<0&&y.iadd(this.m),y},q.prototype.shl=function(o,h){return this._verify1(o),this.imod(o.ushln(h))},q.prototype.imul=function(o,h){return this._verify2(o,h),this.imod(o.imul(h))},q.prototype.mul=function(o,h){return this._verify2(o,h),this.imod(o.mul(h))},q.prototype.isqr=function(o){return this.imul(o,o.clone())},q.prototype.sqr=function(o){return this.mul(o,o)},q.prototype.sqrt=function(o){if(o.isZero())return o.clone();var h=this.m.andln(3);if(i(h%2===1),h===3){var y=this.m.add(new s(1)).iushrn(2);return this.pow(o,y)}for(var p=this.m.subn(1),v=0;!p.isZero()&&p.andln(1)===0;)v++,p.iushrn(1);i(!p.isZero());var _=new s(1).toRed(this),x=_.redNeg(),b=this.m.subn(1).iushrn(1),f=this.m.bitLength();for(f=new s(2*f*f).toRed(this);this.pow(f,b).cmp(x)!==0;)f.redIAdd(x);for(var m=this.pow(f,p),F=this.pow(o,p.addn(1).iushrn(1)),N=this.pow(o,p),T=v;N.cmp(_)!==0;){for(var L=N,k=0;L.cmp(_)!==0;k++)L=L.redSqr();i(k<T);var W=this.pow(m,new s(1).iushln(T-k-1));F=F.redMul(W),m=W.redSqr(),N=N.redMul(m),T=k}return F},q.prototype.invm=function(o){var h=o._invmp(this.m);return h.negative!==0?(h.negative=0,this.imod(h).redNeg()):this.imod(h)},q.prototype.pow=function(o,h){if(h.isZero())return new s(1).toRed(this);if(h.cmpn(1)===0)return o.clone();var y=4,p=new Array(1<<y);p[0]=new s(1).toRed(this),p[1]=o;for(var v=2;v<p.length;v++)p[v]=this.mul(p[v-1],o);var _=p[0],x=0,b=0,f=h.bitLength()%26;for(f===0&&(f=26),v=h.length-1;v>=0;v--){for(var m=h.words[v],F=f-1;F>=0;F--){var N=m>>F&1;if(_!==p[0]&&(_=this.sqr(_)),N===0&&x===0){b=0;continue}x<<=1,x|=N,b++,!(b!==y&&(v!==0||F!==0))&&(_=this.mul(_,p[x]),b=0,x=0)}f=26}return _},q.prototype.convertTo=function(o){var h=o.umod(this.m);return h===o?h.clone():h},q.prototype.convertFrom=function(o){var h=o.clone();return h.red=null,h},s.mont=function(o){return new V(o)};function V(S){q.call(this,S),this.shift=this.m.bitLength(),this.shift%26!==0&&(this.shift+=26-this.shift%26),this.r=new s(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}n(V,q),V.prototype.convertTo=function(o){return this.imod(o.ushln(this.shift))},V.prototype.convertFrom=function(o){var h=this.imod(o.mul(this.rinv));return h.red=null,h},V.prototype.imul=function(o,h){if(o.isZero()||h.isZero())return o.words[0]=0,o.length=1,o;var y=o.imul(h),p=y.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),v=y.isub(p).iushrn(this.shift),_=v;return v.cmp(this.m)>=0?_=v.isub(this.m):v.cmpn(0)<0&&(_=v.iadd(this.m)),_._forceRed(this)},V.prototype.mul=function(o,h){if(o.isZero()||h.isZero())return new s(0)._forceRed(this);var y=o.mul(h),p=y.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),v=y.isub(p).iushrn(this.shift),_=v;return v.cmp(this.m)>=0?_=v.isub(this.m):v.cmpn(0)<0&&(_=v.iadd(this.m)),_._forceRed(this)},V.prototype.invm=function(o){var h=this.imod(o._invmp(this.m).mul(this.r2));return h._forceRed(this)}})(t,Ue)})(Gf);var Ii=Gf.exports;(function(t){var e=t,r=Ii,i=$0,n=x0;e.assert=i,e.toArray=n.toArray,e.zero2=n.zero2,e.toHex=n.toHex,e.encode=n.encode;function s(l,g,w){var E=new Array(Math.max(l.bitLength(),w)+1),$;for($=0;$<E.length;$+=1)E[$]=0;var I=1<<g+1,M=l.clone();for($=0;$<E.length;$++){var P,A=M.andln(I-1);M.isOdd()?(A>(I>>1)-1?P=(I>>1)-A:P=A,M.isubn(P)):P=0,E[$]=P,M.iushrn(1)}return E}e.getNAF=s;function a(l,g){var w=[[],[]];l=l.clone(),g=g.clone();for(var E=0,$=0,I;l.cmpn(-E)>0||g.cmpn(-$)>0;){var M=l.andln(3)+E&3,P=g.andln(3)+$&3;M===3&&(M=-1),P===3&&(P=-1);var A;M&1?(I=l.andln(7)+E&7,(I===3||I===5)&&P===2?A=-M:A=M):A=0,w[0].push(A);var R;P&1?(I=g.andln(7)+$&7,(I===3||I===5)&&M===2?R=-P:R=P):R=0,w[1].push(R),2*E===A+1&&(E=1-E),2*$===R+1&&($=1-$),l.iushrn(1),g.iushrn(1)}return w}e.getJSF=a;function c(l,g,w){var E="_"+g;l.prototype[g]=function(){return this[E]!==void 0?this[E]:this[E]=w.call(this)}}e.cachedProperty=c;function d(l){return typeof l=="string"?e.toArray(l,"hex"):l}e.parseBytes=d;function u(l){return new r(l,"hex","le")}e.intFromLE=u})(ir);var Jf={},an=Ii,Gs=ir,Ka=Gs.getNAF,V6=Gs.getJSF,Va=Gs.assert;function Wi(t,e){this.type=t,this.p=new an(e.p,16),this.red=e.prime?an.red(e.prime):an.mont(this.p),this.zero=new an(0).toRed(this.red),this.one=new an(1).toRed(this.red),this.two=new an(2).toRed(this.red),this.n=e.n&&new an(e.n,16),this.g=e.g&&this.pointFromJSON(e.g,e.gRed),this._wnafT1=new Array(4),this._wnafT2=new Array(4),this._wnafT3=new Array(4),this._wnafT4=new Array(4),this._bitLength=this.n?this.n.bitLength():0;var r=this.n&&this.p.div(this.n);!r||r.cmpn(100)>0?this.redN=null:(this._maxwellTrick=!0,this.redN=this.n.toRed(this.red))}var vo=Wi;Wi.prototype.point=function(){throw new Error("Not implemented")};Wi.prototype.validate=function(){throw new Error("Not implemented")};Wi.prototype._fixedNafMul=function(e,r){Va(e.precomputed);var i=e._getDoubles(),n=Ka(r,1,this._bitLength),s=(1<<i.step+1)-(i.step%2===0?2:1);s/=3;var a=[],c,d;for(c=0;c<n.length;c+=i.step){d=0;for(var u=c+i.step-1;u>=c;u--)d=(d<<1)+n[u];a.push(d)}for(var l=this.jpoint(null,null,null),g=this.jpoint(null,null,null),w=s;w>0;w--){for(c=0;c<a.length;c++)d=a[c],d===w?g=g.mixedAdd(i.points[c]):d===-w&&(g=g.mixedAdd(i.points[c].neg()));l=l.add(g)}return l.toP()};Wi.prototype._wnafMul=function(e,r){var i=4,n=e._getNAFPoints(i);i=n.wnd;for(var s=n.points,a=Ka(r,i,this._bitLength),c=this.jpoint(null,null,null),d=a.length-1;d>=0;d--){for(var u=0;d>=0&&a[d]===0;d--)u++;if(d>=0&&u++,c=c.dblp(u),d<0)break;var l=a[d];Va(l!==0),e.type==="affine"?l>0?c=c.mixedAdd(s[l-1>>1]):c=c.mixedAdd(s[-l-1>>1].neg()):l>0?c=c.add(s[l-1>>1]):c=c.add(s[-l-1>>1].neg())}return e.type==="affine"?c.toP():c};Wi.prototype._wnafMulAdd=function(e,r,i,n,s){var a=this._wnafT1,c=this._wnafT2,d=this._wnafT3,u=0,l,g,w;for(l=0;l<n;l++){w=r[l];var E=w._getNAFPoints(e);a[l]=E.wnd,c[l]=E.points}for(l=n-1;l>=1;l-=2){var $=l-1,I=l;if(a[$]!==1||a[I]!==1){d[$]=Ka(i[$],a[$],this._bitLength),d[I]=Ka(i[I],a[I],this._bitLength),u=Math.max(d[$].length,u),u=Math.max(d[I].length,u);continue}var M=[r[$],null,null,r[I]];r[$].y.cmp(r[I].y)===0?(M[1]=r[$].add(r[I]),M[2]=r[$].toJ().mixedAdd(r[I].neg())):r[$].y.cmp(r[I].y.redNeg())===0?(M[1]=r[$].toJ().mixedAdd(r[I]),M[2]=r[$].add(r[I].neg())):(M[1]=r[$].toJ().mixedAdd(r[I]),M[2]=r[$].toJ().mixedAdd(r[I].neg()));var P=[-3,-1,-5,-7,0,7,5,1,3],A=V6(i[$],i[I]);for(u=Math.max(A[0].length,u),d[$]=new Array(u),d[I]=new Array(u),g=0;g<u;g++){var R=A[0][g]|0,C=A[1][g]|0;d[$][g]=P[(R+1)*3+(C+1)],d[I][g]=0,c[$]=M}}var D=this.jpoint(null,null,null),U=this._wnafT4;for(l=u;l>=0;l--){for(var j=0;l>=0;){var z=!0;for(g=0;g<n;g++)U[g]=d[g][l]|0,U[g]!==0&&(z=!1);if(!z)break;j++,l--}if(l>=0&&j++,D=D.dblp(j),l<0)break;for(g=0;g<n;g++){var q=U[g];q!==0&&(q>0?w=c[g][q-1>>1]:q<0&&(w=c[g][-q-1>>1].neg()),w.type==="affine"?D=D.mixedAdd(w):D=D.add(w))}}for(l=0;l<n;l++)c[l]=null;return s?D:D.toP()};function pr(t,e){this.curve=t,this.type=e,this.precomputed=null}Wi.BasePoint=pr;pr.prototype.eq=function(){throw new Error("Not implemented")};pr.prototype.validate=function(){return this.curve.validate(this)};Wi.prototype.decodePoint=function(e,r){e=Gs.toArray(e,r);var i=this.p.byteLength();if((e[0]===4||e[0]===6||e[0]===7)&&e.length-1===2*i){e[0]===6?Va(e[e.length-1]%2===0):e[0]===7&&Va(e[e.length-1]%2===1);var n=this.point(e.slice(1,1+i),e.slice(1+i,1+2*i));return n}else if((e[0]===2||e[0]===3)&&e.length-1===i)return this.pointFromX(e.slice(1,1+i),e[0]===3);throw new Error("Unknown point format")};pr.prototype.encodeCompressed=function(e){return this.encode(e,!0)};pr.prototype._encode=function(e){var r=this.curve.p.byteLength(),i=this.getX().toArray("be",r);return e?[this.getY().isEven()?2:3].concat(i):[4].concat(i,this.getY().toArray("be",r))};pr.prototype.encode=function(e,r){return Gs.encode(this._encode(r),e)};pr.prototype.precompute=function(e){if(this.precomputed)return this;var r={doubles:null,naf:null,beta:null};return r.naf=this._getNAFPoints(8),r.doubles=this._getDoubles(4,e),r.beta=this._getBeta(),this.precomputed=r,this};pr.prototype._hasDoubles=function(e){if(!this.precomputed)return!1;var r=this.precomputed.doubles;return r?r.points.length>=Math.ceil((e.bitLength()+1)/r.step):!1};pr.prototype._getDoubles=function(e,r){if(this.precomputed&&this.precomputed.doubles)return this.precomputed.doubles;for(var i=[this],n=this,s=0;s<r;s+=e){for(var a=0;a<e;a++)n=n.dbl();i.push(n)}return{step:e,points:i}};pr.prototype._getNAFPoints=function(e){if(this.precomputed&&this.precomputed.naf)return this.precomputed.naf;for(var r=[this],i=(1<<e)-1,n=i===1?null:this.dbl(),s=1;s<i;s++)r[s]=r[s-1].add(n);return{wnd:e,points:r}};pr.prototype._getBeta=function(){return null};pr.prototype.dblp=function(e){for(var r=this,i=0;i<e;i++)r=r.dbl();return r};var W6=ir,Qe=Ii,Yf=is,ss=vo,G6=W6.assert;function br(t){ss.call(this,"short",t),this.a=new Qe(t.a,16).toRed(this.red),this.b=new Qe(t.b,16).toRed(this.red),this.tinv=this.two.redInvm(),this.zeroA=this.a.fromRed().cmpn(0)===0,this.threeA=this.a.fromRed().sub(this.p).cmpn(-3)===0,this.endo=this._getEndomorphism(t),this._endoWnafT1=new Array(4),this._endoWnafT2=new Array(4)}Yf(br,ss);var J6=br;br.prototype._getEndomorphism=function(e){if(!(!this.zeroA||!this.g||!this.n||this.p.modn(3)!==1)){var r,i;if(e.beta)r=new Qe(e.beta,16).toRed(this.red);else{var n=this._getEndoRoots(this.p);r=n[0].cmp(n[1])<0?n[0]:n[1],r=r.toRed(this.red)}if(e.lambda)i=new Qe(e.lambda,16);else{var s=this._getEndoRoots(this.n);this.g.mul(s[0]).x.cmp(this.g.x.redMul(r))===0?i=s[0]:(i=s[1],G6(this.g.mul(i).x.cmp(this.g.x.redMul(r))===0))}var a;return e.basis?a=e.basis.map(function(c){return{a:new Qe(c.a,16),b:new Qe(c.b,16)}}):a=this._getEndoBasis(i),{beta:r,lambda:i,basis:a}}};br.prototype._getEndoRoots=function(e){var r=e===this.p?this.red:Qe.mont(e),i=new Qe(2).toRed(r).redInvm(),n=i.redNeg(),s=new Qe(3).toRed(r).redNeg().redSqrt().redMul(i),a=n.redAdd(s).fromRed(),c=n.redSub(s).fromRed();return[a,c]};br.prototype._getEndoBasis=function(e){for(var r=this.n.ushrn(Math.floor(this.n.bitLength()/2)),i=e,n=this.n.clone(),s=new Qe(1),a=new Qe(0),c=new Qe(0),d=new Qe(1),u,l,g,w,E,$,I,M=0,P,A;i.cmpn(0)!==0;){var R=n.div(i);P=n.sub(R.mul(i)),A=c.sub(R.mul(s));var C=d.sub(R.mul(a));if(!g&&P.cmp(r)<0)u=I.neg(),l=s,g=P.neg(),w=A;else if(g&&++M===2)break;I=P,n=i,i=P,c=s,s=A,d=a,a=C}E=P.neg(),$=A;var D=g.sqr().add(w.sqr()),U=E.sqr().add($.sqr());return U.cmp(D)>=0&&(E=u,$=l),g.negative&&(g=g.neg(),w=w.neg()),E.negative&&(E=E.neg(),$=$.neg()),[{a:g,b:w},{a:E,b:$}]};br.prototype._endoSplit=function(e){var r=this.endo.basis,i=r[0],n=r[1],s=n.b.mul(e).divRound(this.n),a=i.b.neg().mul(e).divRound(this.n),c=s.mul(i.a),d=a.mul(n.a),u=s.mul(i.b),l=a.mul(n.b),g=e.sub(c).sub(d),w=u.add(l).neg();return{k1:g,k2:w}};br.prototype.pointFromX=function(e,r){e=new Qe(e,16),e.red||(e=e.toRed(this.red));var i=e.redSqr().redMul(e).redIAdd(e.redMul(this.a)).redIAdd(this.b),n=i.redSqrt();if(n.redSqr().redSub(i).cmp(this.zero)!==0)throw new Error("invalid point");var s=n.fromRed().isOdd();return(r&&!s||!r&&s)&&(n=n.redNeg()),this.point(e,n)};br.prototype.validate=function(e){if(e.inf)return!0;var r=e.x,i=e.y,n=this.a.redMul(r),s=r.redSqr().redMul(r).redIAdd(n).redIAdd(this.b);return i.redSqr().redISub(s).cmpn(0)===0};br.prototype._endoWnafMulAdd=function(e,r,i){for(var n=this._endoWnafT1,s=this._endoWnafT2,a=0;a<e.length;a++){var c=this._endoSplit(r[a]),d=e[a],u=d._getBeta();c.k1.negative&&(c.k1.ineg(),d=d.neg(!0)),c.k2.negative&&(c.k2.ineg(),u=u.neg(!0)),n[a*2]=d,n[a*2+1]=u,s[a*2]=c.k1,s[a*2+1]=c.k2}for(var l=this._wnafMulAdd(1,n,s,a*2,i),g=0;g<a*2;g++)n[g]=null,s[g]=null;return l};function vt(t,e,r,i){ss.BasePoint.call(this,t,"affine"),e===null&&r===null?(this.x=null,this.y=null,this.inf=!0):(this.x=new Qe(e,16),this.y=new Qe(r,16),i&&(this.x.forceRed(this.curve.red),this.y.forceRed(this.curve.red)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.inf=!1)}Yf(vt,ss.BasePoint);br.prototype.point=function(e,r,i){return new vt(this,e,r,i)};br.prototype.pointFromJSON=function(e,r){return vt.fromJSON(this,e,r)};vt.prototype._getBeta=function(){if(this.curve.endo){var e=this.precomputed;if(e&&e.beta)return e.beta;var r=this.curve.point(this.x.redMul(this.curve.endo.beta),this.y);if(e){var i=this.curve,n=function(s){return i.point(s.x.redMul(i.endo.beta),s.y)};e.beta=r,r.precomputed={beta:null,naf:e.naf&&{wnd:e.naf.wnd,points:e.naf.points.map(n)},doubles:e.doubles&&{step:e.doubles.step,points:e.doubles.points.map(n)}}}return r}};vt.prototype.toJSON=function(){return this.precomputed?[this.x,this.y,this.precomputed&&{doubles:this.precomputed.doubles&&{step:this.precomputed.doubles.step,points:this.precomputed.doubles.points.slice(1)},naf:this.precomputed.naf&&{wnd:this.precomputed.naf.wnd,points:this.precomputed.naf.points.slice(1)}}]:[this.x,this.y]};vt.fromJSON=function(e,r,i){typeof r=="string"&&(r=JSON.parse(r));var n=e.point(r[0],r[1],i);if(!r[2])return n;function s(c){return e.point(c[0],c[1],i)}var a=r[2];return n.precomputed={beta:null,doubles:a.doubles&&{step:a.doubles.step,points:[n].concat(a.doubles.points.map(s))},naf:a.naf&&{wnd:a.naf.wnd,points:[n].concat(a.naf.points.map(s))}},n};vt.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+">"};vt.prototype.isInfinity=function(){return this.inf};vt.prototype.add=function(e){if(this.inf)return e;if(e.inf)return this;if(this.eq(e))return this.dbl();if(this.neg().eq(e))return this.curve.point(null,null);if(this.x.cmp(e.x)===0)return this.curve.point(null,null);var r=this.y.redSub(e.y);r.cmpn(0)!==0&&(r=r.redMul(this.x.redSub(e.x).redInvm()));var i=r.redSqr().redISub(this.x).redISub(e.x),n=r.redMul(this.x.redSub(i)).redISub(this.y);return this.curve.point(i,n)};vt.prototype.dbl=function(){if(this.inf)return this;var e=this.y.redAdd(this.y);if(e.cmpn(0)===0)return this.curve.point(null,null);var r=this.curve.a,i=this.x.redSqr(),n=e.redInvm(),s=i.redAdd(i).redIAdd(i).redIAdd(r).redMul(n),a=s.redSqr().redISub(this.x.redAdd(this.x)),c=s.redMul(this.x.redSub(a)).redISub(this.y);return this.curve.point(a,c)};vt.prototype.getX=function(){return this.x.fromRed()};vt.prototype.getY=function(){return this.y.fromRed()};vt.prototype.mul=function(e){return e=new Qe(e,16),this.isInfinity()?this:this._hasDoubles(e)?this.curve._fixedNafMul(this,e):this.curve.endo?this.curve._endoWnafMulAdd([this],[e]):this.curve._wnafMul(this,e)};vt.prototype.mulAdd=function(e,r,i){var n=[this,r],s=[e,i];return this.curve.endo?this.curve._endoWnafMulAdd(n,s):this.curve._wnafMulAdd(1,n,s,2)};vt.prototype.jmulAdd=function(e,r,i){var n=[this,r],s=[e,i];return this.curve.endo?this.curve._endoWnafMulAdd(n,s,!0):this.curve._wnafMulAdd(1,n,s,2,!0)};vt.prototype.eq=function(e){return this===e||this.inf===e.inf&&(this.inf||this.x.cmp(e.x)===0&&this.y.cmp(e.y)===0)};vt.prototype.neg=function(e){if(this.inf)return this;var r=this.curve.point(this.x,this.y.redNeg());if(e&&this.precomputed){var i=this.precomputed,n=function(s){return s.neg()};r.precomputed={naf:i.naf&&{wnd:i.naf.wnd,points:i.naf.points.map(n)},doubles:i.doubles&&{step:i.doubles.step,points:i.doubles.points.map(n)}}}return r};vt.prototype.toJ=function(){if(this.inf)return this.curve.jpoint(null,null,null);var e=this.curve.jpoint(this.x,this.y,this.curve.one);return e};function $t(t,e,r,i){ss.BasePoint.call(this,t,"jacobian"),e===null&&r===null&&i===null?(this.x=this.curve.one,this.y=this.curve.one,this.z=new Qe(0)):(this.x=new Qe(e,16),this.y=new Qe(r,16),this.z=new Qe(i,16)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.zOne=this.z===this.curve.one}Yf($t,ss.BasePoint);br.prototype.jpoint=function(e,r,i){return new $t(this,e,r,i)};$t.prototype.toP=function(){if(this.isInfinity())return this.curve.point(null,null);var e=this.z.redInvm(),r=e.redSqr(),i=this.x.redMul(r),n=this.y.redMul(r).redMul(e);return this.curve.point(i,n)};$t.prototype.neg=function(){return this.curve.jpoint(this.x,this.y.redNeg(),this.z)};$t.prototype.add=function(e){if(this.isInfinity())return e;if(e.isInfinity())return this;var r=e.z.redSqr(),i=this.z.redSqr(),n=this.x.redMul(r),s=e.x.redMul(i),a=this.y.redMul(r.redMul(e.z)),c=e.y.redMul(i.redMul(this.z)),d=n.redSub(s),u=a.redSub(c);if(d.cmpn(0)===0)return u.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var l=d.redSqr(),g=l.redMul(d),w=n.redMul(l),E=u.redSqr().redIAdd(g).redISub(w).redISub(w),$=u.redMul(w.redISub(E)).redISub(a.redMul(g)),I=this.z.redMul(e.z).redMul(d);return this.curve.jpoint(E,$,I)};$t.prototype.mixedAdd=function(e){if(this.isInfinity())return e.toJ();if(e.isInfinity())return this;var r=this.z.redSqr(),i=this.x,n=e.x.redMul(r),s=this.y,a=e.y.redMul(r).redMul(this.z),c=i.redSub(n),d=s.redSub(a);if(c.cmpn(0)===0)return d.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var u=c.redSqr(),l=u.redMul(c),g=i.redMul(u),w=d.redSqr().redIAdd(l).redISub(g).redISub(g),E=d.redMul(g.redISub(w)).redISub(s.redMul(l)),$=this.z.redMul(c);return this.curve.jpoint(w,E,$)};$t.prototype.dblp=function(e){if(e===0)return this;if(this.isInfinity())return this;if(!e)return this.dbl();var r;if(this.curve.zeroA||this.curve.threeA){var i=this;for(r=0;r<e;r++)i=i.dbl();return i}var n=this.curve.a,s=this.curve.tinv,a=this.x,c=this.y,d=this.z,u=d.redSqr().redSqr(),l=c.redAdd(c);for(r=0;r<e;r++){var g=a.redSqr(),w=l.redSqr(),E=w.redSqr(),$=g.redAdd(g).redIAdd(g).redIAdd(n.redMul(u)),I=a.redMul(w),M=$.redSqr().redISub(I.redAdd(I)),P=I.redISub(M),A=$.redMul(P);A=A.redIAdd(A).redISub(E);var R=l.redMul(d);r+1<e&&(u=u.redMul(E)),a=M,d=R,l=A}return this.curve.jpoint(a,l.redMul(s),d)};$t.prototype.dbl=function(){return this.isInfinity()?this:this.curve.zeroA?this._zeroDbl():this.curve.threeA?this._threeDbl():this._dbl()};$t.prototype._zeroDbl=function(){var e,r,i;if(this.zOne){var n=this.x.redSqr(),s=this.y.redSqr(),a=s.redSqr(),c=this.x.redAdd(s).redSqr().redISub(n).redISub(a);c=c.redIAdd(c);var d=n.redAdd(n).redIAdd(n),u=d.redSqr().redISub(c).redISub(c),l=a.redIAdd(a);l=l.redIAdd(l),l=l.redIAdd(l),e=u,r=d.redMul(c.redISub(u)).redISub(l),i=this.y.redAdd(this.y)}else{var g=this.x.redSqr(),w=this.y.redSqr(),E=w.redSqr(),$=this.x.redAdd(w).redSqr().redISub(g).redISub(E);$=$.redIAdd($);var I=g.redAdd(g).redIAdd(g),M=I.redSqr(),P=E.redIAdd(E);P=P.redIAdd(P),P=P.redIAdd(P),e=M.redISub($).redISub($),r=I.redMul($.redISub(e)).redISub(P),i=this.y.redMul(this.z),i=i.redIAdd(i)}return this.curve.jpoint(e,r,i)};$t.prototype._threeDbl=function(){var e,r,i;if(this.zOne){var n=this.x.redSqr(),s=this.y.redSqr(),a=s.redSqr(),c=this.x.redAdd(s).redSqr().redISub(n).redISub(a);c=c.redIAdd(c);var d=n.redAdd(n).redIAdd(n).redIAdd(this.curve.a),u=d.redSqr().redISub(c).redISub(c);e=u;var l=a.redIAdd(a);l=l.redIAdd(l),l=l.redIAdd(l),r=d.redMul(c.redISub(u)).redISub(l),i=this.y.redAdd(this.y)}else{var g=this.z.redSqr(),w=this.y.redSqr(),E=this.x.redMul(w),$=this.x.redSub(g).redMul(this.x.redAdd(g));$=$.redAdd($).redIAdd($);var I=E.redIAdd(E);I=I.redIAdd(I);var M=I.redAdd(I);e=$.redSqr().redISub(M),i=this.y.redAdd(this.z).redSqr().redISub(w).redISub(g);var P=w.redSqr();P=P.redIAdd(P),P=P.redIAdd(P),P=P.redIAdd(P),r=$.redMul(I.redISub(e)).redISub(P)}return this.curve.jpoint(e,r,i)};$t.prototype._dbl=function(){var e=this.curve.a,r=this.x,i=this.y,n=this.z,s=n.redSqr().redSqr(),a=r.redSqr(),c=i.redSqr(),d=a.redAdd(a).redIAdd(a).redIAdd(e.redMul(s)),u=r.redAdd(r);u=u.redIAdd(u);var l=u.redMul(c),g=d.redSqr().redISub(l.redAdd(l)),w=l.redISub(g),E=c.redSqr();E=E.redIAdd(E),E=E.redIAdd(E),E=E.redIAdd(E);var $=d.redMul(w).redISub(E),I=i.redAdd(i).redMul(n);return this.curve.jpoint(g,$,I)};$t.prototype.trpl=function(){if(!this.curve.zeroA)return this.dbl().add(this);var e=this.x.redSqr(),r=this.y.redSqr(),i=this.z.redSqr(),n=r.redSqr(),s=e.redAdd(e).redIAdd(e),a=s.redSqr(),c=this.x.redAdd(r).redSqr().redISub(e).redISub(n);c=c.redIAdd(c),c=c.redAdd(c).redIAdd(c),c=c.redISub(a);var d=c.redSqr(),u=n.redIAdd(n);u=u.redIAdd(u),u=u.redIAdd(u),u=u.redIAdd(u);var l=s.redIAdd(c).redSqr().redISub(a).redISub(d).redISub(u),g=r.redMul(l);g=g.redIAdd(g),g=g.redIAdd(g);var w=this.x.redMul(d).redISub(g);w=w.redIAdd(w),w=w.redIAdd(w);var E=this.y.redMul(l.redMul(u.redISub(l)).redISub(c.redMul(d)));E=E.redIAdd(E),E=E.redIAdd(E),E=E.redIAdd(E);var $=this.z.redAdd(c).redSqr().redISub(i).redISub(d);return this.curve.jpoint(w,E,$)};$t.prototype.mul=function(e,r){return e=new Qe(e,r),this.curve._wnafMul(this,e)};$t.prototype.eq=function(e){if(e.type==="affine")return this.eq(e.toJ());if(this===e)return!0;var r=this.z.redSqr(),i=e.z.redSqr();if(this.x.redMul(i).redISub(e.x.redMul(r)).cmpn(0)!==0)return!1;var n=r.redMul(this.z),s=i.redMul(e.z);return this.y.redMul(s).redISub(e.y.redMul(n)).cmpn(0)===0};$t.prototype.eqXToP=function(e){var r=this.z.redSqr(),i=e.toRed(this.curve.red).redMul(r);if(this.x.cmp(i)===0)return!0;for(var n=e.clone(),s=this.curve.redN.redMul(r);;){if(n.iadd(this.curve.n),n.cmp(this.curve.p)>=0)return!1;if(i.redIAdd(s),this.x.cmp(i)===0)return!0}};$t.prototype.inspect=function(){return this.isInfinity()?"<EC JPoint Infinity>":"<EC JPoint x: "+this.x.toString(16,2)+" y: "+this.y.toString(16,2)+" z: "+this.z.toString(16,2)+">"};$t.prototype.isInfinity=function(){return this.z.cmpn(0)===0};var Kn=Ii,ap=is,yo=vo,Y6=ir;function as(t){yo.call(this,"mont",t),this.a=new Kn(t.a,16).toRed(this.red),this.b=new Kn(t.b,16).toRed(this.red),this.i4=new Kn(4).toRed(this.red).redInvm(),this.two=new Kn(2).toRed(this.red),this.a24=this.i4.redMul(this.a.redAdd(this.two))}ap(as,yo);var Z6=as;as.prototype.validate=function(e){var r=e.normalize().x,i=r.redSqr(),n=i.redMul(r).redAdd(i.redMul(this.a)).redAdd(r),s=n.redSqrt();return s.redSqr().cmp(n)===0};function bt(t,e,r){yo.BasePoint.call(this,t,"projective"),e===null&&r===null?(this.x=this.curve.one,this.z=this.curve.zero):(this.x=new Kn(e,16),this.z=new Kn(r,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)))}ap(bt,yo.BasePoint);as.prototype.decodePoint=function(e,r){return this.point(Y6.toArray(e,r),1)};as.prototype.point=function(e,r){return new bt(this,e,r)};as.prototype.pointFromJSON=function(e){return bt.fromJSON(this,e)};bt.prototype.precompute=function(){};bt.prototype._encode=function(){return this.getX().toArray("be",this.curve.p.byteLength())};bt.fromJSON=function(e,r){return new bt(e,r[0],r[1]||e.one)};bt.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"};bt.prototype.isInfinity=function(){return this.z.cmpn(0)===0};bt.prototype.dbl=function(){var e=this.x.redAdd(this.z),r=e.redSqr(),i=this.x.redSub(this.z),n=i.redSqr(),s=r.redSub(n),a=r.redMul(n),c=s.redMul(n.redAdd(this.curve.a24.redMul(s)));return this.curve.point(a,c)};bt.prototype.add=function(){throw new Error("Not supported on Montgomery curve")};bt.prototype.diffAdd=function(e,r){var i=this.x.redAdd(this.z),n=this.x.redSub(this.z),s=e.x.redAdd(e.z),a=e.x.redSub(e.z),c=a.redMul(i),d=s.redMul(n),u=r.z.redMul(c.redAdd(d).redSqr()),l=r.x.redMul(c.redISub(d).redSqr());return this.curve.point(u,l)};bt.prototype.mul=function(e){for(var r=e.clone(),i=this,n=this.curve.point(null,null),s=this,a=[];r.cmpn(0)!==0;r.iushrn(1))a.push(r.andln(1));for(var c=a.length-1;c>=0;c--)a[c]===0?(i=i.diffAdd(n,s),n=n.dbl()):(n=i.diffAdd(n,s),i=i.dbl());return n};bt.prototype.mulAdd=function(){throw new Error("Not supported on Montgomery curve")};bt.prototype.jumlAdd=function(){throw new Error("Not supported on Montgomery curve")};bt.prototype.eq=function(e){return this.getX().cmp(e.getX())===0};bt.prototype.normalize=function(){return this.x=this.x.redMul(this.z.redInvm()),this.z=this.curve.one,this};bt.prototype.getX=function(){return this.normalize(),this.x.fromRed()};var X6=ir,Si=Ii,op=is,mo=vo,Q6=X6.assert;function Vr(t){this.twisted=(t.a|0)!==1,this.mOneA=this.twisted&&(t.a|0)===-1,this.extended=this.mOneA,mo.call(this,"edwards",t),this.a=new Si(t.a,16).umod(this.red.m),this.a=this.a.toRed(this.red),this.c=new Si(t.c,16).toRed(this.red),this.c2=this.c.redSqr(),this.d=new Si(t.d,16).toRed(this.red),this.dd=this.d.redAdd(this.d),Q6(!this.twisted||this.c.fromRed().cmpn(1)===0),this.oneC=(t.c|0)===1}op(Vr,mo);var e4=Vr;Vr.prototype._mulA=function(e){return this.mOneA?e.redNeg():this.a.redMul(e)};Vr.prototype._mulC=function(e){return this.oneC?e:this.c.redMul(e)};Vr.prototype.jpoint=function(e,r,i,n){return this.point(e,r,i,n)};Vr.prototype.pointFromX=function(e,r){e=new Si(e,16),e.red||(e=e.toRed(this.red));var i=e.redSqr(),n=this.c2.redSub(this.a.redMul(i)),s=this.one.redSub(this.c2.redMul(this.d).redMul(i)),a=n.redMul(s.redInvm()),c=a.redSqrt();if(c.redSqr().redSub(a).cmp(this.zero)!==0)throw new Error("invalid point");var d=c.fromRed().isOdd();return(r&&!d||!r&&d)&&(c=c.redNeg()),this.point(e,c)};Vr.prototype.pointFromY=function(e,r){e=new Si(e,16),e.red||(e=e.toRed(this.red));var i=e.redSqr(),n=i.redSub(this.c2),s=i.redMul(this.d).redMul(this.c2).redSub(this.a),a=n.redMul(s.redInvm());if(a.cmp(this.zero)===0){if(r)throw new Error("invalid point");return this.point(this.zero,e)}var c=a.redSqrt();if(c.redSqr().redSub(a).cmp(this.zero)!==0)throw new Error("invalid point");return c.fromRed().isOdd()!==r&&(c=c.redNeg()),this.point(c,e)};Vr.prototype.validate=function(e){if(e.isInfinity())return!0;e.normalize();var r=e.x.redSqr(),i=e.y.redSqr(),n=r.redMul(this.a).redAdd(i),s=this.c2.redMul(this.one.redAdd(this.d.redMul(r).redMul(i)));return n.cmp(s)===0};function Ve(t,e,r,i,n){mo.BasePoint.call(this,t,"projective"),e===null&&r===null&&i===null?(this.x=this.curve.zero,this.y=this.curve.one,this.z=this.curve.one,this.t=this.curve.zero,this.zOne=!0):(this.x=new Si(e,16),this.y=new Si(r,16),this.z=i?new Si(i,16):this.curve.one,this.t=n&&new Si(n,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.t&&!this.t.red&&(this.t=this.t.toRed(this.curve.red)),this.zOne=this.z===this.curve.one,this.curve.extended&&!this.t&&(this.t=this.x.redMul(this.y),this.zOne||(this.t=this.t.redMul(this.z.redInvm()))))}op(Ve,mo.BasePoint);Vr.prototype.pointFromJSON=function(e){return Ve.fromJSON(this,e)};Vr.prototype.point=function(e,r,i,n){return new Ve(this,e,r,i,n)};Ve.fromJSON=function(e,r){return new Ve(e,r[0],r[1],r[2])};Ve.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"};Ve.prototype.isInfinity=function(){return this.x.cmpn(0)===0&&(this.y.cmp(this.z)===0||this.zOne&&this.y.cmp(this.curve.c)===0)};Ve.prototype._extDbl=function(){var e=this.x.redSqr(),r=this.y.redSqr(),i=this.z.redSqr();i=i.redIAdd(i);var n=this.curve._mulA(e),s=this.x.redAdd(this.y).redSqr().redISub(e).redISub(r),a=n.redAdd(r),c=a.redSub(i),d=n.redSub(r),u=s.redMul(c),l=a.redMul(d),g=s.redMul(d),w=c.redMul(a);return this.curve.point(u,l,w,g)};Ve.prototype._projDbl=function(){var e=this.x.redAdd(this.y).redSqr(),r=this.x.redSqr(),i=this.y.redSqr(),n,s,a,c,d,u;if(this.curve.twisted){c=this.curve._mulA(r);var l=c.redAdd(i);this.zOne?(n=e.redSub(r).redSub(i).redMul(l.redSub(this.curve.two)),s=l.redMul(c.redSub(i)),a=l.redSqr().redSub(l).redSub(l)):(d=this.z.redSqr(),u=l.redSub(d).redISub(d),n=e.redSub(r).redISub(i).redMul(u),s=l.redMul(c.redSub(i)),a=l.redMul(u))}else c=r.redAdd(i),d=this.curve._mulC(this.z).redSqr(),u=c.redSub(d).redSub(d),n=this.curve._mulC(e.redISub(c)).redMul(u),s=this.curve._mulC(c).redMul(r.redISub(i)),a=c.redMul(u);return this.curve.point(n,s,a)};Ve.prototype.dbl=function(){return this.isInfinity()?this:this.curve.extended?this._extDbl():this._projDbl()};Ve.prototype._extAdd=function(e){var r=this.y.redSub(this.x).redMul(e.y.redSub(e.x)),i=this.y.redAdd(this.x).redMul(e.y.redAdd(e.x)),n=this.t.redMul(this.curve.dd).redMul(e.t),s=this.z.redMul(e.z.redAdd(e.z)),a=i.redSub(r),c=s.redSub(n),d=s.redAdd(n),u=i.redAdd(r),l=a.redMul(c),g=d.redMul(u),w=a.redMul(u),E=c.redMul(d);return this.curve.point(l,g,E,w)};Ve.prototype._projAdd=function(e){var r=this.z.redMul(e.z),i=r.redSqr(),n=this.x.redMul(e.x),s=this.y.redMul(e.y),a=this.curve.d.redMul(n).redMul(s),c=i.redSub(a),d=i.redAdd(a),u=this.x.redAdd(this.y).redMul(e.x.redAdd(e.y)).redISub(n).redISub(s),l=r.redMul(c).redMul(u),g,w;return this.curve.twisted?(g=r.redMul(d).redMul(s.redSub(this.curve._mulA(n))),w=c.redMul(d)):(g=r.redMul(d).redMul(s.redSub(n)),w=this.curve._mulC(c).redMul(d)),this.curve.point(l,g,w)};Ve.prototype.add=function(e){return this.isInfinity()?e:e.isInfinity()?this:this.curve.extended?this._extAdd(e):this._projAdd(e)};Ve.prototype.mul=function(e){return this._hasDoubles(e)?this.curve._fixedNafMul(this,e):this.curve._wnafMul(this,e)};Ve.prototype.mulAdd=function(e,r,i){return this.curve._wnafMulAdd(1,[this,r],[e,i],2,!1)};Ve.prototype.jmulAdd=function(e,r,i){return this.curve._wnafMulAdd(1,[this,r],[e,i],2,!0)};Ve.prototype.normalize=function(){if(this.zOne)return this;var e=this.z.redInvm();return this.x=this.x.redMul(e),this.y=this.y.redMul(e),this.t&&(this.t=this.t.redMul(e)),this.z=this.curve.one,this.zOne=!0,this};Ve.prototype.neg=function(){return this.curve.point(this.x.redNeg(),this.y,this.z,this.t&&this.t.redNeg())};Ve.prototype.getX=function(){return this.normalize(),this.x.fromRed()};Ve.prototype.getY=function(){return this.normalize(),this.y.fromRed()};Ve.prototype.eq=function(e){return this===e||this.getX().cmp(e.getX())===0&&this.getY().cmp(e.getY())===0};Ve.prototype.eqXToP=function(e){var r=e.toRed(this.curve.red).redMul(this.z);if(this.x.cmp(r)===0)return!0;for(var i=e.clone(),n=this.curve.redN.redMul(this.z);;){if(i.iadd(this.curve.n),i.cmp(this.curve.p)>=0)return!1;if(r.redIAdd(n),this.x.cmp(r)===0)return!0}};Ve.prototype.toP=Ve.prototype.normalize;Ve.prototype.mixedAdd=Ve.prototype.add;(function(t){var e=t;e.base=vo,e.short=J6,e.mont=Z6,e.edwards=e4})(Jf);var wo={},oc,_h;function t4(){return _h||(_h=1,oc={doubles:{step:4,points:[["e60fce93b59e9ec53011aabc21c23e97b2a31369b87a5ae9c44ee89e2a6dec0a","f7e3507399e595929db99f34f57937101296891e44d23f0be1f32cce69616821"],["8282263212c609d9ea2a6e3e172de238d8c39cabd5ac1ca10646e23fd5f51508","11f8a8098557dfe45e8256e830b60ace62d613ac2f7b17bed31b6eaff6e26caf"],["175e159f728b865a72f99cc6c6fc846de0b93833fd2222ed73fce5b551e5b739","d3506e0d9e3c79eba4ef97a51ff71f5eacb5955add24345c6efa6ffee9fed695"],["363d90d447b00c9c99ceac05b6262ee053441c7e55552ffe526bad8f83ff4640","4e273adfc732221953b445397f3363145b9a89008199ecb62003c7f3bee9de9"],["8b4b5f165df3c2be8c6244b5b745638843e4a781a15bcd1b69f79a55dffdf80c","4aad0a6f68d308b4b3fbd7813ab0da04f9e336546162ee56b3eff0c65fd4fd36"],["723cbaa6e5db996d6bf771c00bd548c7b700dbffa6c0e77bcb6115925232fcda","96e867b5595cc498a921137488824d6e2660a0653779494801dc069d9eb39f5f"],["eebfa4d493bebf98ba5feec812c2d3b50947961237a919839a533eca0e7dd7fa","5d9a8ca3970ef0f269ee7edaf178089d9ae4cdc3a711f712ddfd4fdae1de8999"],["100f44da696e71672791d0a09b7bde459f1215a29b3c03bfefd7835b39a48db0","cdd9e13192a00b772ec8f3300c090666b7ff4a18ff5195ac0fbd5cd62bc65a09"],["e1031be262c7ed1b1dc9227a4a04c017a77f8d4464f3b3852c8acde6e534fd2d","9d7061928940405e6bb6a4176597535af292dd419e1ced79a44f18f29456a00d"],["feea6cae46d55b530ac2839f143bd7ec5cf8b266a41d6af52d5e688d9094696d","e57c6b6c97dce1bab06e4e12bf3ecd5c981c8957cc41442d3155debf18090088"],["da67a91d91049cdcb367be4be6ffca3cfeed657d808583de33fa978bc1ec6cb1","9bacaa35481642bc41f463f7ec9780e5dec7adc508f740a17e9ea8e27a68be1d"],["53904faa0b334cdda6e000935ef22151ec08d0f7bb11069f57545ccc1a37b7c0","5bc087d0bc80106d88c9eccac20d3c1c13999981e14434699dcb096b022771c8"],["8e7bcd0bd35983a7719cca7764ca906779b53a043a9b8bcaeff959f43ad86047","10b7770b2a3da4b3940310420ca9514579e88e2e47fd68b3ea10047e8460372a"],["385eed34c1cdff21e6d0818689b81bde71a7f4f18397e6690a841e1599c43862","283bebc3e8ea23f56701de19e9ebf4576b304eec2086dc8cc0458fe5542e5453"],["6f9d9b803ecf191637c73a4413dfa180fddf84a5947fbc9c606ed86c3fac3a7","7c80c68e603059ba69b8e2a30e45c4d47ea4dd2f5c281002d86890603a842160"],["3322d401243c4e2582a2147c104d6ecbf774d163db0f5e5313b7e0e742d0e6bd","56e70797e9664ef5bfb019bc4ddaf9b72805f63ea2873af624f3a2e96c28b2a0"],["85672c7d2de0b7da2bd1770d89665868741b3f9af7643397721d74d28134ab83","7c481b9b5b43b2eb6374049bfa62c2e5e77f17fcc5298f44c8e3094f790313a6"],["948bf809b1988a46b06c9f1919413b10f9226c60f668832ffd959af60c82a0a","53a562856dcb6646dc6b74c5d1c3418c6d4dff08c97cd2bed4cb7f88d8c8e589"],["6260ce7f461801c34f067ce0f02873a8f1b0e44dfc69752accecd819f38fd8e8","bc2da82b6fa5b571a7f09049776a1ef7ecd292238051c198c1a84e95b2b4ae17"],["e5037de0afc1d8d43d8348414bbf4103043ec8f575bfdc432953cc8d2037fa2d","4571534baa94d3b5f9f98d09fb990bddbd5f5b03ec481f10e0e5dc841d755bda"],["e06372b0f4a207adf5ea905e8f1771b4e7e8dbd1c6a6c5b725866a0ae4fce725","7a908974bce18cfe12a27bb2ad5a488cd7484a7787104870b27034f94eee31dd"],["213c7a715cd5d45358d0bbf9dc0ce02204b10bdde2a3f58540ad6908d0559754","4b6dad0b5ae462507013ad06245ba190bb4850f5f36a7eeddff2c27534b458f2"],["4e7c272a7af4b34e8dbb9352a5419a87e2838c70adc62cddf0cc3a3b08fbd53c","17749c766c9d0b18e16fd09f6def681b530b9614bff7dd33e0b3941817dcaae6"],["fea74e3dbe778b1b10f238ad61686aa5c76e3db2be43057632427e2840fb27b6","6e0568db9b0b13297cf674deccb6af93126b596b973f7b77701d3db7f23cb96f"],["76e64113f677cf0e10a2570d599968d31544e179b760432952c02a4417bdde39","c90ddf8dee4e95cf577066d70681f0d35e2a33d2b56d2032b4b1752d1901ac01"],["c738c56b03b2abe1e8281baa743f8f9a8f7cc643df26cbee3ab150242bcbb891","893fb578951ad2537f718f2eacbfbbbb82314eef7880cfe917e735d9699a84c3"],["d895626548b65b81e264c7637c972877d1d72e5f3a925014372e9f6588f6c14b","febfaa38f2bc7eae728ec60818c340eb03428d632bb067e179363ed75d7d991f"],["b8da94032a957518eb0f6433571e8761ceffc73693e84edd49150a564f676e03","2804dfa44805a1e4d7c99cc9762808b092cc584d95ff3b511488e4e74efdf6e7"],["e80fea14441fb33a7d8adab9475d7fab2019effb5156a792f1a11778e3c0df5d","eed1de7f638e00771e89768ca3ca94472d155e80af322ea9fcb4291b6ac9ec78"],["a301697bdfcd704313ba48e51d567543f2a182031efd6915ddc07bbcc4e16070","7370f91cfb67e4f5081809fa25d40f9b1735dbf7c0a11a130c0d1a041e177ea1"],["90ad85b389d6b936463f9d0512678de208cc330b11307fffab7ac63e3fb04ed4","e507a3620a38261affdcbd9427222b839aefabe1582894d991d4d48cb6ef150"],["8f68b9d2f63b5f339239c1ad981f162ee88c5678723ea3351b7b444c9ec4c0da","662a9f2dba063986de1d90c2b6be215dbbea2cfe95510bfdf23cbf79501fff82"],["e4f3fb0176af85d65ff99ff9198c36091f48e86503681e3e6686fd5053231e11","1e63633ad0ef4f1c1661a6d0ea02b7286cc7e74ec951d1c9822c38576feb73bc"],["8c00fa9b18ebf331eb961537a45a4266c7034f2f0d4e1d0716fb6eae20eae29e","efa47267fea521a1a9dc343a3736c974c2fadafa81e36c54e7d2a4c66702414b"],["e7a26ce69dd4829f3e10cec0a9e98ed3143d084f308b92c0997fddfc60cb3e41","2a758e300fa7984b471b006a1aafbb18d0a6b2c0420e83e20e8a9421cf2cfd51"],["b6459e0ee3662ec8d23540c223bcbdc571cbcb967d79424f3cf29eb3de6b80ef","67c876d06f3e06de1dadf16e5661db3c4b3ae6d48e35b2ff30bf0b61a71ba45"],["d68a80c8280bb840793234aa118f06231d6f1fc67e73c5a5deda0f5b496943e8","db8ba9fff4b586d00c4b1f9177b0e28b5b0e7b8f7845295a294c84266b133120"],["324aed7df65c804252dc0270907a30b09612aeb973449cea4095980fc28d3d5d","648a365774b61f2ff130c0c35aec1f4f19213b0c7e332843967224af96ab7c84"],["4df9c14919cde61f6d51dfdbe5fee5dceec4143ba8d1ca888e8bd373fd054c96","35ec51092d8728050974c23a1d85d4b5d506cdc288490192ebac06cad10d5d"],["9c3919a84a474870faed8a9c1cc66021523489054d7f0308cbfc99c8ac1f98cd","ddb84f0f4a4ddd57584f044bf260e641905326f76c64c8e6be7e5e03d4fc599d"],["6057170b1dd12fdf8de05f281d8e06bb91e1493a8b91d4cc5a21382120a959e5","9a1af0b26a6a4807add9a2daf71df262465152bc3ee24c65e899be932385a2a8"],["a576df8e23a08411421439a4518da31880cef0fba7d4df12b1a6973eecb94266","40a6bf20e76640b2c92b97afe58cd82c432e10a7f514d9f3ee8be11ae1b28ec8"],["7778a78c28dec3e30a05fe9629de8c38bb30d1f5cf9a3a208f763889be58ad71","34626d9ab5a5b22ff7098e12f2ff580087b38411ff24ac563b513fc1fd9f43ac"],["928955ee637a84463729fd30e7afd2ed5f96274e5ad7e5cb09eda9c06d903ac","c25621003d3f42a827b78a13093a95eeac3d26efa8a8d83fc5180e935bcd091f"],["85d0fef3ec6db109399064f3a0e3b2855645b4a907ad354527aae75163d82751","1f03648413a38c0be29d496e582cf5663e8751e96877331582c237a24eb1f962"],["ff2b0dce97eece97c1c9b6041798b85dfdfb6d8882da20308f5404824526087e","493d13fef524ba188af4c4dc54d07936c7b7ed6fb90e2ceb2c951e01f0c29907"],["827fbbe4b1e880ea9ed2b2e6301b212b57f1ee148cd6dd28780e5e2cf856e241","c60f9c923c727b0b71bef2c67d1d12687ff7a63186903166d605b68baec293ec"],["eaa649f21f51bdbae7be4ae34ce6e5217a58fdce7f47f9aa7f3b58fa2120e2b3","be3279ed5bbbb03ac69a80f89879aa5a01a6b965f13f7e59d47a5305ba5ad93d"],["e4a42d43c5cf169d9391df6decf42ee541b6d8f0c9a137401e23632dda34d24f","4d9f92e716d1c73526fc99ccfb8ad34ce886eedfa8d8e4f13a7f7131deba9414"],["1ec80fef360cbdd954160fadab352b6b92b53576a88fea4947173b9d4300bf19","aeefe93756b5340d2f3a4958a7abbf5e0146e77f6295a07b671cdc1cc107cefd"],["146a778c04670c2f91b00af4680dfa8bce3490717d58ba889ddb5928366642be","b318e0ec3354028add669827f9d4b2870aaa971d2f7e5ed1d0b297483d83efd0"],["fa50c0f61d22e5f07e3acebb1aa07b128d0012209a28b9776d76a8793180eef9","6b84c6922397eba9b72cd2872281a68a5e683293a57a213b38cd8d7d3f4f2811"],["da1d61d0ca721a11b1a5bf6b7d88e8421a288ab5d5bba5220e53d32b5f067ec2","8157f55a7c99306c79c0766161c91e2966a73899d279b48a655fba0f1ad836f1"],["a8e282ff0c9706907215ff98e8fd416615311de0446f1e062a73b0610d064e13","7f97355b8db81c09abfb7f3c5b2515888b679a3e50dd6bd6cef7c73111f4cc0c"],["174a53b9c9a285872d39e56e6913cab15d59b1fa512508c022f382de8319497c","ccc9dc37abfc9c1657b4155f2c47f9e6646b3a1d8cb9854383da13ac079afa73"],["959396981943785c3d3e57edf5018cdbe039e730e4918b3d884fdff09475b7ba","2e7e552888c331dd8ba0386a4b9cd6849c653f64c8709385e9b8abf87524f2fd"],["d2a63a50ae401e56d645a1153b109a8fcca0a43d561fba2dbb51340c9d82b151","e82d86fb6443fcb7565aee58b2948220a70f750af484ca52d4142174dcf89405"],["64587e2335471eb890ee7896d7cfdc866bacbdbd3839317b3436f9b45617e073","d99fcdd5bf6902e2ae96dd6447c299a185b90a39133aeab358299e5e9faf6589"],["8481bde0e4e4d885b3a546d3e549de042f0aa6cea250e7fd358d6c86dd45e458","38ee7b8cba5404dd84a25bf39cecb2ca900a79c42b262e556d64b1b59779057e"],["13464a57a78102aa62b6979ae817f4637ffcfed3c4b1ce30bcd6303f6caf666b","69be159004614580ef7e433453ccb0ca48f300a81d0942e13f495a907f6ecc27"],["bc4a9df5b713fe2e9aef430bcc1dc97a0cd9ccede2f28588cada3a0d2d83f366","d3a81ca6e785c06383937adf4b798caa6e8a9fbfa547b16d758d666581f33c1"],["8c28a97bf8298bc0d23d8c749452a32e694b65e30a9472a3954ab30fe5324caa","40a30463a3305193378fedf31f7cc0eb7ae784f0451cb9459e71dc73cbef9482"],["8ea9666139527a8c1dd94ce4f071fd23c8b350c5a4bb33748c4ba111faccae0","620efabbc8ee2782e24e7c0cfb95c5d735b783be9cf0f8e955af34a30e62b945"],["dd3625faef5ba06074669716bbd3788d89bdde815959968092f76cc4eb9a9787","7a188fa3520e30d461da2501045731ca941461982883395937f68d00c644a573"],["f710d79d9eb962297e4f6232b40e8f7feb2bc63814614d692c12de752408221e","ea98e67232d3b3295d3b535532115ccac8612c721851617526ae47a9c77bfc82"]]},naf:{wnd:7,points:[["f9308a019258c31049344f85f89d5229b531c845836f99b08601f113bce036f9","388f7b0f632de8140fe337e62a37f3566500a99934c2231b6cb9fd7584b8e672"],["2f8bde4d1a07209355b4a7250a5c5128e88b84bddc619ab7cba8d569b240efe4","d8ac222636e5e3d6d4dba9dda6c9c426f788271bab0d6840dca87d3aa6ac62d6"],["5cbdf0646e5db4eaa398f365f2ea7a0e3d419b7e0330e39ce92bddedcac4f9bc","6aebca40ba255960a3178d6d861a54dba813d0b813fde7b5a5082628087264da"],["acd484e2f0c7f65309ad178a9f559abde09796974c57e714c35f110dfc27ccbe","cc338921b0a7d9fd64380971763b61e9add888a4375f8e0f05cc262ac64f9c37"],["774ae7f858a9411e5ef4246b70c65aac5649980be5c17891bbec17895da008cb","d984a032eb6b5e190243dd56d7b7b365372db1e2dff9d6a8301d74c9c953c61b"],["f28773c2d975288bc7d1d205c3748651b075fbc6610e58cddeeddf8f19405aa8","ab0902e8d880a89758212eb65cdaf473a1a06da521fa91f29b5cb52db03ed81"],["d7924d4f7d43ea965a465ae3095ff41131e5946f3c85f79e44adbcf8e27e080e","581e2872a86c72a683842ec228cc6defea40af2bd896d3a5c504dc9ff6a26b58"],["defdea4cdb677750a420fee807eacf21eb9898ae79b9768766e4faa04a2d4a34","4211ab0694635168e997b0ead2a93daeced1f4a04a95c0f6cfb199f69e56eb77"],["2b4ea0a797a443d293ef5cff444f4979f06acfebd7e86d277475656138385b6c","85e89bc037945d93b343083b5a1c86131a01f60c50269763b570c854e5c09b7a"],["352bbf4a4cdd12564f93fa332ce333301d9ad40271f8107181340aef25be59d5","321eb4075348f534d59c18259dda3e1f4a1b3b2e71b1039c67bd3d8bcf81998c"],["2fa2104d6b38d11b0230010559879124e42ab8dfeff5ff29dc9cdadd4ecacc3f","2de1068295dd865b64569335bd5dd80181d70ecfc882648423ba76b532b7d67"],["9248279b09b4d68dab21a9b066edda83263c3d84e09572e269ca0cd7f5453714","73016f7bf234aade5d1aa71bdea2b1ff3fc0de2a887912ffe54a32ce97cb3402"],["daed4f2be3a8bf278e70132fb0beb7522f570e144bf615c07e996d443dee8729","a69dce4a7d6c98e8d4a1aca87ef8d7003f83c230f3afa726ab40e52290be1c55"],["c44d12c7065d812e8acf28d7cbb19f9011ecd9e9fdf281b0e6a3b5e87d22e7db","2119a460ce326cdc76c45926c982fdac0e106e861edf61c5a039063f0e0e6482"],["6a245bf6dc698504c89a20cfded60853152b695336c28063b61c65cbd269e6b4","e022cf42c2bd4a708b3f5126f16a24ad8b33ba48d0423b6efd5e6348100d8a82"],["1697ffa6fd9de627c077e3d2fe541084ce13300b0bec1146f95ae57f0d0bd6a5","b9c398f186806f5d27561506e4557433a2cf15009e498ae7adee9d63d01b2396"],["605bdb019981718b986d0f07e834cb0d9deb8360ffb7f61df982345ef27a7479","2972d2de4f8d20681a78d93ec96fe23c26bfae84fb14db43b01e1e9056b8c49"],["62d14dab4150bf497402fdc45a215e10dcb01c354959b10cfe31c7e9d87ff33d","80fc06bd8cc5b01098088a1950eed0db01aa132967ab472235f5642483b25eaf"],["80c60ad0040f27dade5b4b06c408e56b2c50e9f56b9b8b425e555c2f86308b6f","1c38303f1cc5c30f26e66bad7fe72f70a65eed4cbe7024eb1aa01f56430bd57a"],["7a9375ad6167ad54aa74c6348cc54d344cc5dc9487d847049d5eabb0fa03c8fb","d0e3fa9eca8726909559e0d79269046bdc59ea10c70ce2b02d499ec224dc7f7"],["d528ecd9b696b54c907a9ed045447a79bb408ec39b68df504bb51f459bc3ffc9","eecf41253136e5f99966f21881fd656ebc4345405c520dbc063465b521409933"],["49370a4b5f43412ea25f514e8ecdad05266115e4a7ecb1387231808f8b45963","758f3f41afd6ed428b3081b0512fd62a54c3f3afbb5b6764b653052a12949c9a"],["77f230936ee88cbbd73df930d64702ef881d811e0e1498e2f1c13eb1fc345d74","958ef42a7886b6400a08266e9ba1b37896c95330d97077cbbe8eb3c7671c60d6"],["f2dac991cc4ce4b9ea44887e5c7c0bce58c80074ab9d4dbaeb28531b7739f530","e0dedc9b3b2f8dad4da1f32dec2531df9eb5fbeb0598e4fd1a117dba703a3c37"],["463b3d9f662621fb1b4be8fbbe2520125a216cdfc9dae3debcba4850c690d45b","5ed430d78c296c3543114306dd8622d7c622e27c970a1de31cb377b01af7307e"],["f16f804244e46e2a09232d4aff3b59976b98fac14328a2d1a32496b49998f247","cedabd9b82203f7e13d206fcdf4e33d92a6c53c26e5cce26d6579962c4e31df6"],["caf754272dc84563b0352b7a14311af55d245315ace27c65369e15f7151d41d1","cb474660ef35f5f2a41b643fa5e460575f4fa9b7962232a5c32f908318a04476"],["2600ca4b282cb986f85d0f1709979d8b44a09c07cb86d7c124497bc86f082120","4119b88753c15bd6a693b03fcddbb45d5ac6be74ab5f0ef44b0be9475a7e4b40"],["7635ca72d7e8432c338ec53cd12220bc01c48685e24f7dc8c602a7746998e435","91b649609489d613d1d5e590f78e6d74ecfc061d57048bad9e76f302c5b9c61"],["754e3239f325570cdbbf4a87deee8a66b7f2b33479d468fbc1a50743bf56cc18","673fb86e5bda30fb3cd0ed304ea49a023ee33d0197a695d0c5d98093c536683"],["e3e6bd1071a1e96aff57859c82d570f0330800661d1c952f9fe2694691d9b9e8","59c9e0bba394e76f40c0aa58379a3cb6a5a2283993e90c4167002af4920e37f5"],["186b483d056a033826ae73d88f732985c4ccb1f32ba35f4b4cc47fdcf04aa6eb","3b952d32c67cf77e2e17446e204180ab21fb8090895138b4a4a797f86e80888b"],["df9d70a6b9876ce544c98561f4be4f725442e6d2b737d9c91a8321724ce0963f","55eb2dafd84d6ccd5f862b785dc39d4ab157222720ef9da217b8c45cf2ba2417"],["5edd5cc23c51e87a497ca815d5dce0f8ab52554f849ed8995de64c5f34ce7143","efae9c8dbc14130661e8cec030c89ad0c13c66c0d17a2905cdc706ab7399a868"],["290798c2b6476830da12fe02287e9e777aa3fba1c355b17a722d362f84614fba","e38da76dcd440621988d00bcf79af25d5b29c094db2a23146d003afd41943e7a"],["af3c423a95d9f5b3054754efa150ac39cd29552fe360257362dfdecef4053b45","f98a3fd831eb2b749a93b0e6f35cfb40c8cd5aa667a15581bc2feded498fd9c6"],["766dbb24d134e745cccaa28c99bf274906bb66b26dcf98df8d2fed50d884249a","744b1152eacbe5e38dcc887980da38b897584a65fa06cedd2c924f97cbac5996"],["59dbf46f8c94759ba21277c33784f41645f7b44f6c596a58ce92e666191abe3e","c534ad44175fbc300f4ea6ce648309a042ce739a7919798cd85e216c4a307f6e"],["f13ada95103c4537305e691e74e9a4a8dd647e711a95e73cb62dc6018cfd87b8","e13817b44ee14de663bf4bc808341f326949e21a6a75c2570778419bdaf5733d"],["7754b4fa0e8aced06d4167a2c59cca4cda1869c06ebadfb6488550015a88522c","30e93e864e669d82224b967c3020b8fa8d1e4e350b6cbcc537a48b57841163a2"],["948dcadf5990e048aa3874d46abef9d701858f95de8041d2a6828c99e2262519","e491a42537f6e597d5d28a3224b1bc25df9154efbd2ef1d2cbba2cae5347d57e"],["7962414450c76c1689c7b48f8202ec37fb224cf5ac0bfa1570328a8a3d7c77ab","100b610ec4ffb4760d5c1fc133ef6f6b12507a051f04ac5760afa5b29db83437"],["3514087834964b54b15b160644d915485a16977225b8847bb0dd085137ec47ca","ef0afbb2056205448e1652c48e8127fc6039e77c15c2378b7e7d15a0de293311"],["d3cc30ad6b483e4bc79ce2c9dd8bc54993e947eb8df787b442943d3f7b527eaf","8b378a22d827278d89c5e9be8f9508ae3c2ad46290358630afb34db04eede0a4"],["1624d84780732860ce1c78fcbfefe08b2b29823db913f6493975ba0ff4847610","68651cf9b6da903e0914448c6cd9d4ca896878f5282be4c8cc06e2a404078575"],["733ce80da955a8a26902c95633e62a985192474b5af207da6df7b4fd5fc61cd4","f5435a2bd2badf7d485a4d8b8db9fcce3e1ef8e0201e4578c54673bc1dc5ea1d"],["15d9441254945064cf1a1c33bbd3b49f8966c5092171e699ef258dfab81c045c","d56eb30b69463e7234f5137b73b84177434800bacebfc685fc37bbe9efe4070d"],["a1d0fcf2ec9de675b612136e5ce70d271c21417c9d2b8aaaac138599d0717940","edd77f50bcb5a3cab2e90737309667f2641462a54070f3d519212d39c197a629"],["e22fbe15c0af8ccc5780c0735f84dbe9a790badee8245c06c7ca37331cb36980","a855babad5cd60c88b430a69f53a1a7a38289154964799be43d06d77d31da06"],["311091dd9860e8e20ee13473c1155f5f69635e394704eaa74009452246cfa9b3","66db656f87d1f04fffd1f04788c06830871ec5a64feee685bd80f0b1286d8374"],["34c1fd04d301be89b31c0442d3e6ac24883928b45a9340781867d4232ec2dbdf","9414685e97b1b5954bd46f730174136d57f1ceeb487443dc5321857ba73abee"],["f219ea5d6b54701c1c14de5b557eb42a8d13f3abbcd08affcc2a5e6b049b8d63","4cb95957e83d40b0f73af4544cccf6b1f4b08d3c07b27fb8d8c2962a400766d1"],["d7b8740f74a8fbaab1f683db8f45de26543a5490bca627087236912469a0b448","fa77968128d9c92ee1010f337ad4717eff15db5ed3c049b3411e0315eaa4593b"],["32d31c222f8f6f0ef86f7c98d3a3335ead5bcd32abdd94289fe4d3091aa824bf","5f3032f5892156e39ccd3d7915b9e1da2e6dac9e6f26e961118d14b8462e1661"],["7461f371914ab32671045a155d9831ea8793d77cd59592c4340f86cbc18347b5","8ec0ba238b96bec0cbdddcae0aa442542eee1ff50c986ea6b39847b3cc092ff6"],["ee079adb1df1860074356a25aa38206a6d716b2c3e67453d287698bad7b2b2d6","8dc2412aafe3be5c4c5f37e0ecc5f9f6a446989af04c4e25ebaac479ec1c8c1e"],["16ec93e447ec83f0467b18302ee620f7e65de331874c9dc72bfd8616ba9da6b5","5e4631150e62fb40d0e8c2a7ca5804a39d58186a50e497139626778e25b0674d"],["eaa5f980c245f6f038978290afa70b6bd8855897f98b6aa485b96065d537bd99","f65f5d3e292c2e0819a528391c994624d784869d7e6ea67fb18041024edc07dc"],["78c9407544ac132692ee1910a02439958ae04877151342ea96c4b6b35a49f51","f3e0319169eb9b85d5404795539a5e68fa1fbd583c064d2462b675f194a3ddb4"],["494f4be219a1a77016dcd838431aea0001cdc8ae7a6fc688726578d9702857a5","42242a969283a5f339ba7f075e36ba2af925ce30d767ed6e55f4b031880d562c"],["a598a8030da6d86c6bc7f2f5144ea549d28211ea58faa70ebf4c1e665c1fe9b5","204b5d6f84822c307e4b4a7140737aec23fc63b65b35f86a10026dbd2d864e6b"],["c41916365abb2b5d09192f5f2dbeafec208f020f12570a184dbadc3e58595997","4f14351d0087efa49d245b328984989d5caf9450f34bfc0ed16e96b58fa9913"],["841d6063a586fa475a724604da03bc5b92a2e0d2e0a36acfe4c73a5514742881","73867f59c0659e81904f9a1c7543698e62562d6744c169ce7a36de01a8d6154"],["5e95bb399a6971d376026947f89bde2f282b33810928be4ded112ac4d70e20d5","39f23f366809085beebfc71181313775a99c9aed7d8ba38b161384c746012865"],["36e4641a53948fd476c39f8a99fd974e5ec07564b5315d8bf99471bca0ef2f66","d2424b1b1abe4eb8164227b085c9aa9456ea13493fd563e06fd51cf5694c78fc"],["336581ea7bfbbb290c191a2f507a41cf5643842170e914faeab27c2c579f726","ead12168595fe1be99252129b6e56b3391f7ab1410cd1e0ef3dcdcabd2fda224"],["8ab89816dadfd6b6a1f2634fcf00ec8403781025ed6890c4849742706bd43ede","6fdcef09f2f6d0a044e654aef624136f503d459c3e89845858a47a9129cdd24e"],["1e33f1a746c9c5778133344d9299fcaa20b0938e8acff2544bb40284b8c5fb94","60660257dd11b3aa9c8ed618d24edff2306d320f1d03010e33a7d2057f3b3b6"],["85b7c1dcb3cec1b7ee7f30ded79dd20a0ed1f4cc18cbcfcfa410361fd8f08f31","3d98a9cdd026dd43f39048f25a8847f4fcafad1895d7a633c6fed3c35e999511"],["29df9fbd8d9e46509275f4b125d6d45d7fbe9a3b878a7af872a2800661ac5f51","b4c4fe99c775a606e2d8862179139ffda61dc861c019e55cd2876eb2a27d84b"],["a0b1cae06b0a847a3fea6e671aaf8adfdfe58ca2f768105c8082b2e449fce252","ae434102edde0958ec4b19d917a6a28e6b72da1834aff0e650f049503a296cf2"],["4e8ceafb9b3e9a136dc7ff67e840295b499dfb3b2133e4ba113f2e4c0e121e5","cf2174118c8b6d7a4b48f6d534ce5c79422c086a63460502b827ce62a326683c"],["d24a44e047e19b6f5afb81c7ca2f69080a5076689a010919f42725c2b789a33b","6fb8d5591b466f8fc63db50f1c0f1c69013f996887b8244d2cdec417afea8fa3"],["ea01606a7a6c9cdd249fdfcfacb99584001edd28abbab77b5104e98e8e3b35d4","322af4908c7312b0cfbfe369f7a7b3cdb7d4494bc2823700cfd652188a3ea98d"],["af8addbf2b661c8a6c6328655eb96651252007d8c5ea31be4ad196de8ce2131f","6749e67c029b85f52a034eafd096836b2520818680e26ac8f3dfbcdb71749700"],["e3ae1974566ca06cc516d47e0fb165a674a3dabcfca15e722f0e3450f45889","2aeabe7e4531510116217f07bf4d07300de97e4874f81f533420a72eeb0bd6a4"],["591ee355313d99721cf6993ffed1e3e301993ff3ed258802075ea8ced397e246","b0ea558a113c30bea60fc4775460c7901ff0b053d25ca2bdeee98f1a4be5d196"],["11396d55fda54c49f19aa97318d8da61fa8584e47b084945077cf03255b52984","998c74a8cd45ac01289d5833a7beb4744ff536b01b257be4c5767bea93ea57a4"],["3c5d2a1ba39c5a1790000738c9e0c40b8dcdfd5468754b6405540157e017aa7a","b2284279995a34e2f9d4de7396fc18b80f9b8b9fdd270f6661f79ca4c81bd257"],["cc8704b8a60a0defa3a99a7299f2e9c3fbc395afb04ac078425ef8a1793cc030","bdd46039feed17881d1e0862db347f8cf395b74fc4bcdc4e940b74e3ac1f1b13"],["c533e4f7ea8555aacd9777ac5cad29b97dd4defccc53ee7ea204119b2889b197","6f0a256bc5efdf429a2fb6242f1a43a2d9b925bb4a4b3a26bb8e0f45eb596096"],["c14f8f2ccb27d6f109f6d08d03cc96a69ba8c34eec07bbcf566d48e33da6593","c359d6923bb398f7fd4473e16fe1c28475b740dd098075e6c0e8649113dc3a38"],["a6cbc3046bc6a450bac24789fa17115a4c9739ed75f8f21ce441f72e0b90e6ef","21ae7f4680e889bb130619e2c0f95a360ceb573c70603139862afd617fa9b9f"],["347d6d9a02c48927ebfb86c1359b1caf130a3c0267d11ce6344b39f99d43cc38","60ea7f61a353524d1c987f6ecec92f086d565ab687870cb12689ff1e31c74448"],["da6545d2181db8d983f7dcb375ef5866d47c67b1bf31c8cf855ef7437b72656a","49b96715ab6878a79e78f07ce5680c5d6673051b4935bd897fea824b77dc208a"],["c40747cc9d012cb1a13b8148309c6de7ec25d6945d657146b9d5994b8feb1111","5ca560753be2a12fc6de6caf2cb489565db936156b9514e1bb5e83037e0fa2d4"],["4e42c8ec82c99798ccf3a610be870e78338c7f713348bd34c8203ef4037f3502","7571d74ee5e0fb92a7a8b33a07783341a5492144cc54bcc40a94473693606437"],["3775ab7089bc6af823aba2e1af70b236d251cadb0c86743287522a1b3b0dedea","be52d107bcfa09d8bcb9736a828cfa7fac8db17bf7a76a2c42ad961409018cf7"],["cee31cbf7e34ec379d94fb814d3d775ad954595d1314ba8846959e3e82f74e26","8fd64a14c06b589c26b947ae2bcf6bfa0149ef0be14ed4d80f448a01c43b1c6d"],["b4f9eaea09b6917619f6ea6a4eb5464efddb58fd45b1ebefcdc1a01d08b47986","39e5c9925b5a54b07433a4f18c61726f8bb131c012ca542eb24a8ac07200682a"],["d4263dfc3d2df923a0179a48966d30ce84e2515afc3dccc1b77907792ebcc60e","62dfaf07a0f78feb30e30d6295853ce189e127760ad6cf7fae164e122a208d54"],["48457524820fa65a4f8d35eb6930857c0032acc0a4a2de422233eeda897612c4","25a748ab367979d98733c38a1fa1c2e7dc6cc07db2d60a9ae7a76aaa49bd0f77"],["dfeeef1881101f2cb11644f3a2afdfc2045e19919152923f367a1767c11cceda","ecfb7056cf1de042f9420bab396793c0c390bde74b4bbdff16a83ae09a9a7517"],["6d7ef6b17543f8373c573f44e1f389835d89bcbc6062ced36c82df83b8fae859","cd450ec335438986dfefa10c57fea9bcc521a0959b2d80bbf74b190dca712d10"],["e75605d59102a5a2684500d3b991f2e3f3c88b93225547035af25af66e04541f","f5c54754a8f71ee540b9b48728473e314f729ac5308b06938360990e2bfad125"],["eb98660f4c4dfaa06a2be453d5020bc99a0c2e60abe388457dd43fefb1ed620c","6cb9a8876d9cb8520609af3add26cd20a0a7cd8a9411131ce85f44100099223e"],["13e87b027d8514d35939f2e6892b19922154596941888336dc3563e3b8dba942","fef5a3c68059a6dec5d624114bf1e91aac2b9da568d6abeb2570d55646b8adf1"],["ee163026e9fd6fe017c38f06a5be6fc125424b371ce2708e7bf4491691e5764a","1acb250f255dd61c43d94ccc670d0f58f49ae3fa15b96623e5430da0ad6c62b2"],["b268f5ef9ad51e4d78de3a750c2dc89b1e626d43505867999932e5db33af3d80","5f310d4b3c99b9ebb19f77d41c1dee018cf0d34fd4191614003e945a1216e423"],["ff07f3118a9df035e9fad85eb6c7bfe42b02f01ca99ceea3bf7ffdba93c4750d","438136d603e858a3a5c440c38eccbaddc1d2942114e2eddd4740d098ced1f0d8"],["8d8b9855c7c052a34146fd20ffb658bea4b9f69e0d825ebec16e8c3ce2b526a1","cdb559eedc2d79f926baf44fb84ea4d44bcf50fee51d7ceb30e2e7f463036758"],["52db0b5384dfbf05bfa9d472d7ae26dfe4b851ceca91b1eba54263180da32b63","c3b997d050ee5d423ebaf66a6db9f57b3180c902875679de924b69d84a7b375"],["e62f9490d3d51da6395efd24e80919cc7d0f29c3f3fa48c6fff543becbd43352","6d89ad7ba4876b0b22c2ca280c682862f342c8591f1daf5170e07bfd9ccafa7d"],["7f30ea2476b399b4957509c88f77d0191afa2ff5cb7b14fd6d8e7d65aaab1193","ca5ef7d4b231c94c3b15389a5f6311e9daff7bb67b103e9880ef4bff637acaec"],["5098ff1e1d9f14fb46a210fada6c903fef0fb7b4a1dd1d9ac60a0361800b7a00","9731141d81fc8f8084d37c6e7542006b3ee1b40d60dfe5362a5b132fd17ddc0"],["32b78c7de9ee512a72895be6b9cbefa6e2f3c4ccce445c96b9f2c81e2778ad58","ee1849f513df71e32efc3896ee28260c73bb80547ae2275ba497237794c8753c"],["e2cb74fddc8e9fbcd076eef2a7c72b0ce37d50f08269dfc074b581550547a4f7","d3aa2ed71c9dd2247a62df062736eb0baddea9e36122d2be8641abcb005cc4a4"],["8438447566d4d7bedadc299496ab357426009a35f235cb141be0d99cd10ae3a8","c4e1020916980a4da5d01ac5e6ad330734ef0d7906631c4f2390426b2edd791f"],["4162d488b89402039b584c6fc6c308870587d9c46f660b878ab65c82c711d67e","67163e903236289f776f22c25fb8a3afc1732f2b84b4e95dbda47ae5a0852649"],["3fad3fa84caf0f34f0f89bfd2dcf54fc175d767aec3e50684f3ba4a4bf5f683d","cd1bc7cb6cc407bb2f0ca647c718a730cf71872e7d0d2a53fa20efcdfe61826"],["674f2600a3007a00568c1a7ce05d0816c1fb84bf1370798f1c69532faeb1a86b","299d21f9413f33b3edf43b257004580b70db57da0b182259e09eecc69e0d38a5"],["d32f4da54ade74abb81b815ad1fb3b263d82d6c692714bcff87d29bd5ee9f08f","f9429e738b8e53b968e99016c059707782e14f4535359d582fc416910b3eea87"],["30e4e670435385556e593657135845d36fbb6931f72b08cb1ed954f1e3ce3ff6","462f9bce619898638499350113bbc9b10a878d35da70740dc695a559eb88db7b"],["be2062003c51cc3004682904330e4dee7f3dcd10b01e580bf1971b04d4cad297","62188bc49d61e5428573d48a74e1c655b1c61090905682a0d5558ed72dccb9bc"],["93144423ace3451ed29e0fb9ac2af211cb6e84a601df5993c419859fff5df04a","7c10dfb164c3425f5c71a3f9d7992038f1065224f72bb9d1d902a6d13037b47c"],["b015f8044f5fcbdcf21ca26d6c34fb8197829205c7b7d2a7cb66418c157b112c","ab8c1e086d04e813744a655b2df8d5f83b3cdc6faa3088c1d3aea1454e3a1d5f"],["d5e9e1da649d97d89e4868117a465a3a4f8a18de57a140d36b3f2af341a21b52","4cb04437f391ed73111a13cc1d4dd0db1693465c2240480d8955e8592f27447a"],["d3ae41047dd7ca065dbf8ed77b992439983005cd72e16d6f996a5316d36966bb","bd1aeb21ad22ebb22a10f0303417c6d964f8cdd7df0aca614b10dc14d125ac46"],["463e2763d885f958fc66cdd22800f0a487197d0a82e377b49f80af87c897b065","bfefacdb0e5d0fd7df3a311a94de062b26b80c61fbc97508b79992671ef7ca7f"],["7985fdfd127c0567c6f53ec1bb63ec3158e597c40bfe747c83cddfc910641917","603c12daf3d9862ef2b25fe1de289aed24ed291e0ec6708703a5bd567f32ed03"],["74a1ad6b5f76e39db2dd249410eac7f99e74c59cb83d2d0ed5ff1543da7703e9","cc6157ef18c9c63cd6193d83631bbea0093e0968942e8c33d5737fd790e0db08"],["30682a50703375f602d416664ba19b7fc9bab42c72747463a71d0896b22f6da3","553e04f6b018b4fa6c8f39e7f311d3176290d0e0f19ca73f17714d9977a22ff8"],["9e2158f0d7c0d5f26c3791efefa79597654e7a2b2464f52b1ee6c1347769ef57","712fcdd1b9053f09003a3481fa7762e9ffd7c8ef35a38509e2fbf2629008373"],["176e26989a43c9cfeba4029c202538c28172e566e3c4fce7322857f3be327d66","ed8cc9d04b29eb877d270b4878dc43c19aefd31f4eee09ee7b47834c1fa4b1c3"],["75d46efea3771e6e68abb89a13ad747ecf1892393dfc4f1b7004788c50374da8","9852390a99507679fd0b86fd2b39a868d7efc22151346e1a3ca4726586a6bed8"],["809a20c67d64900ffb698c4c825f6d5f2310fb0451c869345b7319f645605721","9e994980d9917e22b76b061927fa04143d096ccc54963e6a5ebfa5f3f8e286c1"],["1b38903a43f7f114ed4500b4eac7083fdefece1cf29c63528d563446f972c180","4036edc931a60ae889353f77fd53de4a2708b26b6f5da72ad3394119daf408f9"]]}}),oc}(function(t){var e=t,r=uo,i=Jf,n=ir,s=n.assert;function a(u){u.type==="short"?this.curve=new i.short(u):u.type==="edwards"?this.curve=new i.edwards(u):this.curve=new i.mont(u),this.g=this.curve.g,this.n=this.curve.n,this.hash=u.hash,s(this.g.validate(),"Invalid curve"),s(this.g.mul(this.n).isInfinity(),"Invalid curve, G*N != O")}e.PresetCurve=a;function c(u,l){Object.defineProperty(e,u,{configurable:!0,enumerable:!0,get:function(){var g=new a(l);return Object.defineProperty(e,u,{configurable:!0,enumerable:!0,value:g}),g}})}c("p192",{type:"short",prime:"p192",p:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff",a:"ffffffff ffffffff ffffffff fffffffe ffffffff fffffffc",b:"64210519 e59c80e7 0fa7e9ab 72243049 feb8deec c146b9b1",n:"ffffffff ffffffff ffffffff 99def836 146bc9b1 b4d22831",hash:r.sha256,gRed:!1,g:["188da80e b03090f6 7cbf20eb 43a18800 f4ff0afd 82ff1012","07192b95 ffc8da78 631011ed 6b24cdd5 73f977a1 1e794811"]}),c("p224",{type:"short",prime:"p224",p:"ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001",a:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff fffffffe",b:"b4050a85 0c04b3ab f5413256 5044b0b7 d7bfd8ba 270b3943 2355ffb4",n:"ffffffff ffffffff ffffffff ffff16a2 e0b8f03e 13dd2945 5c5c2a3d",hash:r.sha256,gRed:!1,g:["b70e0cbd 6bb4bf7f 321390b9 4a03c1d3 56c21122 343280d6 115c1d21","bd376388 b5f723fb 4c22dfe6 cd4375a0 5a074764 44d58199 85007e34"]}),c("p256",{type:"short",prime:null,p:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff ffffffff",a:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff fffffffc",b:"5ac635d8 aa3a93e7 b3ebbd55 769886bc 651d06b0 cc53b0f6 3bce3c3e 27d2604b",n:"ffffffff 00000000 ffffffff ffffffff bce6faad a7179e84 f3b9cac2 fc632551",hash:r.sha256,gRed:!1,g:["6b17d1f2 e12c4247 f8bce6e5 63a440f2 77037d81 2deb33a0 f4a13945 d898c296","4fe342e2 fe1a7f9b 8ee7eb4a 7c0f9e16 2bce3357 6b315ece cbb64068 37bf51f5"]}),c("p384",{type:"short",prime:null,p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 ffffffff",a:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 fffffffc",b:"b3312fa7 e23ee7e4 988e056b e3f82d19 181d9c6e fe814112 0314088f 5013875a c656398d 8a2ed19d 2a85c8ed d3ec2aef",n:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff c7634d81 f4372ddf 581a0db2 48b0a77a ecec196a ccc52973",hash:r.sha384,gRed:!1,g:["aa87ca22 be8b0537 8eb1c71e f320ad74 6e1d3b62 8ba79b98 59f741e0 82542a38 5502f25d bf55296c 3a545e38 72760ab7","3617de4a 96262c6f 5d9e98bf 9292dc29 f8f41dbd 289a147c e9da3113 b5f0b8c0 0a60b1ce 1d7e819d 7a431d7c 90ea0e5f"]}),c("p521",{type:"short",prime:null,p:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff",a:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffc",b:"00000051 953eb961 8e1c9a1f 929a21a0 b68540ee a2da725b 99b315f3 b8b48991 8ef109e1 56193951 ec7e937b 1652c0bd 3bb1bf07 3573df88 3d2c34f1 ef451fd4 6b503f00",n:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffa 51868783 bf2f966b 7fcc0148 f709a5d0 3bb5c9b8 899c47ae bb6fb71e 91386409",hash:r.sha512,gRed:!1,g:["000000c6 858e06b7 0404e9cd 9e3ecb66 2395b442 9c648139 053fb521 f828af60 6b4d3dba a14b5e77 efe75928 fe1dc127 a2ffa8de 3348b3c1 856a429b f97e7e31 c2e5bd66","00000118 39296a78 9a3bc004 5c8a5fb4 2c7d1bd9 98f54449 579b4468 17afbd17 273e662c 97ee7299 5ef42640 c550b901 3fad0761 353c7086 a272c240 88be9476 9fd16650"]}),c("curve25519",{type:"mont",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"76d06",b:"1",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:r.sha256,gRed:!1,g:["9"]}),c("ed25519",{type:"edwards",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"-1",c:"1",d:"52036cee2b6ffe73 8cc740797779e898 00700a4d4141d8ab 75eb4dca135978a3",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:r.sha256,gRed:!1,g:["216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a","6666666666666666666666666666666666666666666666666666666666666658"]});var d;try{d=t4()}catch{d=void 0}c("secp256k1",{type:"short",prime:"k256",p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f",a:"0",b:"7",n:"ffffffff ffffffff ffffffff fffffffe baaedce6 af48a03b bfd25e8c d0364141",h:"1",hash:r.sha256,beta:"7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee",lambda:"5363ad4cc05c30e0a5261c028812645a122e22ea20816678df02967c1b23bd72",basis:[{a:"3086d221a7d46bcde86c90e49284eb15",b:"-e4437ed6010e88286f547fa90abfe4c3"},{a:"114ca50f7a8e2f3f657c1108d9d44cfd8",b:"3086d221a7d46bcde86c90e49284eb15"}],gRed:!1,g:["79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798","483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8",d]})})(wo);var r4=Ii,i4=ir,cf=i4.assert;function Rt(t,e){this.ec=t,this.priv=null,this.pub=null,e.priv&&this._importPrivate(e.priv,e.privEnc),e.pub&&this._importPublic(e.pub,e.pubEnc)}var n4=Rt;Rt.fromPublic=function(e,r,i){return r instanceof Rt?r:new Rt(e,{pub:r,pubEnc:i})};Rt.fromPrivate=function(e,r,i){return r instanceof Rt?r:new Rt(e,{priv:r,privEnc:i})};Rt.prototype.validate=function(){var e=this.getPublic();return e.isInfinity()?{result:!1,reason:"Invalid public key"}:e.validate()?e.mul(this.ec.curve.n).isInfinity()?{result:!0,reason:null}:{result:!1,reason:"Public key * N != O"}:{result:!1,reason:"Public key is not a point"}};Rt.prototype.getPublic=function(e,r){return typeof e=="string"&&(r=e,e=null),this.pub||(this.pub=this.ec.g.mul(this.priv)),r?this.pub.encode(r,e):this.pub};Rt.prototype.getPrivate=function(e){return e==="hex"?this.priv.toString(16,2):this.priv};Rt.prototype._importPrivate=function(e,r){this.priv=new r4(e,r||16),this.priv=this.priv.umod(this.ec.curve.n)};Rt.prototype._importPublic=function(e,r){if(e.x||e.y){this.ec.curve.type==="mont"?cf(e.x,"Need x coordinate"):(this.ec.curve.type==="short"||this.ec.curve.type==="edwards")&&cf(e.x&&e.y,"Need both x and y coordinate"),this.pub=this.ec.curve.point(e.x,e.y);return}this.pub=this.ec.curve.decodePoint(e,r)};Rt.prototype.derive=function(e){return e.validate()||cf(e.validate(),"public point not validated"),e.mul(this.priv).getX()};Rt.prototype.sign=function(e,r,i){return this.ec.sign(e,this,r,i)};Rt.prototype.verify=function(e,r,i){return this.ec.verify(e,r,this,void 0,i)};Rt.prototype.inspect=function(){return"<Key priv: "+(this.priv&&this.priv.toString(16,2))+" pub: "+(this.pub&&this.pub.inspect())+" >"};var Wa=Ii,Zf=ir,s4=Zf.assert;function _o(t,e){if(t instanceof _o)return t;this._importDER(t,e)||(s4(t.r&&t.s,"Signature without r or s"),this.r=new Wa(t.r,16),this.s=new Wa(t.s,16),t.recoveryParam===void 0?this.recoveryParam=null:this.recoveryParam=t.recoveryParam)}var a4=_o;function o4(){this.place=0}function cc(t,e){var r=t[e.place++];if(!(r&128))return r;var i=r&15;if(i===0||i>4||t[e.place]===0)return!1;for(var n=0,s=0,a=e.place;s<i;s++,a++)n<<=8,n|=t[a],n>>>=0;return n<=127?!1:(e.place=a,n)}function Eh(t){for(var e=0,r=t.length-1;!t[e]&&!(t[e+1]&128)&&e<r;)e++;return e===0?t:t.slice(e)}_o.prototype._importDER=function(e,r){e=Zf.toArray(e,r);var i=new o4;if(e[i.place++]!==48)return!1;var n=cc(e,i);if(n===!1||n+i.place!==e.length||e[i.place++]!==2)return!1;var s=cc(e,i);if(s===!1||e[i.place]&128)return!1;var a=e.slice(i.place,s+i.place);if(i.place+=s,e[i.place++]!==2)return!1;var c=cc(e,i);if(c===!1||e.length!==c+i.place||e[i.place]&128)return!1;var d=e.slice(i.place,c+i.place);if(a[0]===0)if(a[1]&128)a=a.slice(1);else return!1;if(d[0]===0)if(d[1]&128)d=d.slice(1);else return!1;return this.r=new Wa(a),this.s=new Wa(d),this.recoveryParam=null,!0};function fc(t,e){if(e<128){t.push(e);return}var r=1+(Math.log(e)/Math.LN2>>>3);for(t.push(r|128);--r;)t.push(e>>>(r<<3)&255);t.push(e)}_o.prototype.toDER=function(e){var r=this.r.toArray(),i=this.s.toArray();for(r[0]&128&&(r=[0].concat(r)),i[0]&128&&(i=[0].concat(i)),r=Eh(r),i=Eh(i);!i[0]&&!(i[1]&128);)i=i.slice(1);var n=[2];fc(n,r.length),n=n.concat(r),n.push(2),fc(n,i.length);var s=n.concat(i),a=[48];return fc(a,s.length),a=a.concat(s),Zf.encode(a,e)};var Or=Ii,cp=I0,c4=ir,dc=wo,f4=lo(),un=c4.assert,Xf=n4,Eo=a4;function ur(t){if(!(this instanceof ur))return new ur(t);typeof t=="string"&&(un(Object.prototype.hasOwnProperty.call(dc,t),"Unknown curve "+t),t=dc[t]),t instanceof dc.PresetCurve&&(t={curve:t}),this.curve=t.curve.curve,this.n=this.curve.n,this.nh=this.n.ushrn(1),this.g=this.curve.g,this.g=t.curve.g,this.g.precompute(t.curve.n.bitLength()+1),this.hash=t.hash||t.curve.hash}var d4=ur;ur.prototype.keyPair=function(e){return new Xf(this,e)};ur.prototype.keyFromPrivate=function(e,r){return Xf.fromPrivate(this,e,r)};ur.prototype.keyFromPublic=function(e,r){return Xf.fromPublic(this,e,r)};ur.prototype.genKeyPair=function(e){e||(e={});for(var r=new cp({hash:this.hash,pers:e.pers,persEnc:e.persEnc||"utf8",entropy:e.entropy||f4(this.hash.hmacStrength),entropyEnc:e.entropy&&e.entropyEnc||"utf8",nonce:this.n.toArray()}),i=this.n.byteLength(),n=this.n.sub(new Or(2));;){var s=new Or(r.generate(i));if(!(s.cmp(n)>0))return s.iaddn(1),this.keyFromPrivate(s)}};ur.prototype._truncateToN=function(e,r,i){var n;if(Or.isBN(e)||typeof e=="number")e=new Or(e,16),n=e.byteLength();else if(typeof e=="object")n=e.length,e=new Or(e,16);else{var s=e.toString();n=s.length+1>>>1,e=new Or(s,16)}typeof i!="number"&&(i=n*8);var a=i-this.n.bitLength();return a>0&&(e=e.ushrn(a)),!r&&e.cmp(this.n)>=0?e.sub(this.n):e};ur.prototype.sign=function(e,r,i,n){if(typeof i=="object"&&(n=i,i=null),n||(n={}),typeof e!="string"&&typeof e!="number"&&!Or.isBN(e)){un(typeof e=="object"&&e&&typeof e.length=="number","Expected message to be an array-like, a hex string, or a BN instance"),un(e.length>>>0===e.length);for(var s=0;s<e.length;s++)un((e[s]&255)===e[s])}r=this.keyFromPrivate(r,i),e=this._truncateToN(e,!1,n.msgBitLength),un(!e.isNeg(),"Can not sign a negative message");var a=this.n.byteLength(),c=r.getPrivate().toArray("be",a),d=e.toArray("be",a);un(new Or(d).eq(e),"Can not sign message");for(var u=new cp({hash:this.hash,entropy:c,nonce:d,pers:n.pers,persEnc:n.persEnc||"utf8"}),l=this.n.sub(new Or(1)),g=0;;g++){var w=n.k?n.k(g):new Or(u.generate(this.n.byteLength()));if(w=this._truncateToN(w,!0),!(w.cmpn(1)<=0||w.cmp(l)>=0)){var E=this.g.mul(w);if(!E.isInfinity()){var $=E.getX(),I=$.umod(this.n);if(I.cmpn(0)!==0){var M=w.invm(this.n).mul(I.mul(r.getPrivate()).iadd(e));if(M=M.umod(this.n),M.cmpn(0)!==0){var P=(E.getY().isOdd()?1:0)|($.cmp(I)!==0?2:0);return n.canonical&&M.cmp(this.nh)>0&&(M=this.n.sub(M),P^=1),new Eo({r:I,s:M,recoveryParam:P})}}}}}};ur.prototype.verify=function(e,r,i,n,s){s||(s={}),e=this._truncateToN(e,!1,s.msgBitLength),i=this.keyFromPublic(i,n),r=new Eo(r,"hex");var a=r.r,c=r.s;if(a.cmpn(1)<0||a.cmp(this.n)>=0||c.cmpn(1)<0||c.cmp(this.n)>=0)return!1;var d=c.invm(this.n),u=d.mul(e).umod(this.n),l=d.mul(a).umod(this.n),g;return this.curve._maxwellTrick?(g=this.g.jmulAdd(u,i.getPublic(),l),g.isInfinity()?!1:g.eqXToP(a)):(g=this.g.mulAdd(u,i.getPublic(),l),g.isInfinity()?!1:g.getX().umod(this.n).cmp(a)===0)};ur.prototype.recoverPubKey=function(t,e,r,i){un((3&r)===r,"The recovery param is more than two bits"),e=new Eo(e,i);var n=this.n,s=new Or(t),a=e.r,c=e.s,d=r&1,u=r>>1;if(a.cmp(this.curve.p.umod(this.curve.n))>=0&&u)throw new Error("Unable to find sencond key candinate");u?a=this.curve.pointFromX(a.add(this.curve.n),d):a=this.curve.pointFromX(a,d);var l=e.r.invm(n),g=n.sub(s).mul(l).umod(n),w=c.mul(l).umod(n);return this.g.mulAdd(g,a,w)};ur.prototype.getKeyRecoveryParam=function(t,e,r,i){if(e=new Eo(e,i),e.recoveryParam!==null)return e.recoveryParam;for(var n=0;n<4;n++){var s;try{s=this.recoverPubKey(t,e,n)}catch{continue}if(s.eq(r))return n}throw new Error("Unable to find valid recovery factor")};var Js=ir,fp=Js.assert,Sh=Js.parseBytes,os=Js.cachedProperty;function lt(t,e){this.eddsa=t,this._secret=Sh(e.secret),t.isPoint(e.pub)?this._pub=e.pub:this._pubBytes=Sh(e.pub)}lt.fromPublic=function(e,r){return r instanceof lt?r:new lt(e,{pub:r})};lt.fromSecret=function(e,r){return r instanceof lt?r:new lt(e,{secret:r})};lt.prototype.secret=function(){return this._secret};os(lt,"pubBytes",function(){return this.eddsa.encodePoint(this.pub())});os(lt,"pub",function(){return this._pubBytes?this.eddsa.decodePoint(this._pubBytes):this.eddsa.g.mul(this.priv())});os(lt,"privBytes",function(){var e=this.eddsa,r=this.hash(),i=e.encodingLength-1,n=r.slice(0,e.encodingLength);return n[0]&=248,n[i]&=127,n[i]|=64,n});os(lt,"priv",function(){return this.eddsa.decodeInt(this.privBytes())});os(lt,"hash",function(){return this.eddsa.hash().update(this.secret()).digest()});os(lt,"messagePrefix",function(){return this.hash().slice(this.eddsa.encodingLength)});lt.prototype.sign=function(e){return fp(this._secret,"KeyPair can only verify"),this.eddsa.sign(e,this)};lt.prototype.verify=function(e,r){return this.eddsa.verify(e,r,this)};lt.prototype.getSecret=function(e){return fp(this._secret,"KeyPair is public only"),Js.encode(this.secret(),e)};lt.prototype.getPublic=function(e){return Js.encode(this.pubBytes(),e)};var h4=lt,u4=Ii,So=ir,$h=So.assert,$o=So.cachedProperty,l4=So.parseBytes;function wn(t,e){this.eddsa=t,typeof e!="object"&&(e=l4(e)),Array.isArray(e)&&($h(e.length===t.encodingLength*2,"Signature has invalid size"),e={R:e.slice(0,t.encodingLength),S:e.slice(t.encodingLength)}),$h(e.R&&e.S,"Signature without R or S"),t.isPoint(e.R)&&(this._R=e.R),e.S instanceof u4&&(this._S=e.S),this._Rencoded=Array.isArray(e.R)?e.R:e.Rencoded,this._Sencoded=Array.isArray(e.S)?e.S:e.Sencoded}$o(wn,"S",function(){return this.eddsa.decodeInt(this.Sencoded())});$o(wn,"R",function(){return this.eddsa.decodePoint(this.Rencoded())});$o(wn,"Rencoded",function(){return this.eddsa.encodePoint(this.R())});$o(wn,"Sencoded",function(){return this.eddsa.encodeInt(this.S())});wn.prototype.toBytes=function(){return this.Rencoded().concat(this.Sencoded())};wn.prototype.toHex=function(){return So.encode(this.toBytes(),"hex").toUpperCase()};var p4=wn,b4=uo,g4=wo,Yn=ir,v4=Yn.assert,dp=Yn.parseBytes,hp=h4,xh=p4;function jt(t){if(v4(t==="ed25519","only tested with ed25519 so far"),!(this instanceof jt))return new jt(t);t=g4[t].curve,this.curve=t,this.g=t.g,this.g.precompute(t.n.bitLength()+1),this.pointClass=t.point().constructor,this.encodingLength=Math.ceil(t.n.bitLength()/8),this.hash=b4.sha512}var y4=jt;jt.prototype.sign=function(e,r){e=dp(e);var i=this.keyFromSecret(r),n=this.hashInt(i.messagePrefix(),e),s=this.g.mul(n),a=this.encodePoint(s),c=this.hashInt(a,i.pubBytes(),e).mul(i.priv()),d=n.add(c).umod(this.curve.n);return this.makeSignature({R:s,S:d,Rencoded:a})};jt.prototype.verify=function(e,r,i){if(e=dp(e),r=this.makeSignature(r),r.S().gte(r.eddsa.curve.n)||r.S().isNeg())return!1;var n=this.keyFromPublic(i),s=this.hashInt(r.Rencoded(),n.pubBytes(),e),a=this.g.mul(r.S()),c=r.R().add(n.pub().mul(s));return c.eq(a)};jt.prototype.hashInt=function(){for(var e=this.hash(),r=0;r<arguments.length;r++)e.update(arguments[r]);return Yn.intFromLE(e.digest()).umod(this.curve.n)};jt.prototype.keyFromPublic=function(e){return hp.fromPublic(this,e)};jt.prototype.keyFromSecret=function(e){return hp.fromSecret(this,e)};jt.prototype.makeSignature=function(e){return e instanceof xh?e:new xh(this,e)};jt.prototype.encodePoint=function(e){var r=e.getY().toArray("le",this.encodingLength);return r[this.encodingLength-1]|=e.getX().isOdd()?128:0,r};jt.prototype.decodePoint=function(e){e=Yn.parseBytes(e);var r=e.length-1,i=e.slice(0,r).concat(e[r]&-129),n=(e[r]&128)!==0,s=Yn.intFromLE(i);return this.curve.pointFromY(s,n)};jt.prototype.encodeInt=function(e){return e.toArray("le",this.encodingLength)};jt.prototype.decodeInt=function(e){return Yn.intFromLE(e)};jt.prototype.isPoint=function(e){return e instanceof this.pointClass};(function(t){var e=t;e.version=K6.version,e.utils=ir,e.rand=lo(),e.curve=Jf,e.curves=wo,e.ec=d4,e.eddsa=y4})(k6);function Ih(t,e=[]){const r=[];return Object.keys(t).forEach(i=>{if(e.length&&!e.includes(i))return;const n=t[i];r.push(...n.accounts)}),r}function Mh(t){if(!Number.isSafeInteger(t)||t<0)throw new Error("positive integer expected, got "+t)}function m4(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function Qf(t,...e){if(!m4(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error("Uint8Array expected of length "+e+", got length="+t.length)}function Ga(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function up(t,e){Qf(t);const r=e.outputLen;if(t.length<r)throw new Error("digestInto() expects output buffer of length at least "+r)}const va=BigInt(2**32-1),Ah=BigInt(32);function w4(t,e=!1){return e?{h:Number(t&va),l:Number(t>>Ah&va)}:{h:Number(t>>Ah&va)|0,l:Number(t&va)|0}}function _4(t,e=!1){let r=new Uint32Array(t.length),i=new Uint32Array(t.length);for(let n=0;n<t.length;n++){const{h:s,l:a}=w4(t[n],e);[r[n],i[n]]=[s,a]}return[r,i]}const E4=(t,e,r)=>t<<r|e>>>32-r,S4=(t,e,r)=>e<<r|t>>>32-r,$4=(t,e,r)=>e<<r-32|t>>>64-r,x4=(t,e,r)=>t<<r-32|e>>>64-r,On=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;function I4(t){return new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4))}function hc(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function Lr(t,e){return t<<32-e|t>>>e}const Ph=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function M4(t){return t<<24&4278190080|t<<8&16711680|t>>>8&65280|t>>>24&255}function Oh(t){for(let e=0;e<t.length;e++)t[e]=M4(t[e])}function A4(t){if(typeof t!="string")throw new Error("utf8ToBytes expected string, got "+typeof t);return new Uint8Array(new TextEncoder().encode(t))}function ed(t){return typeof t=="string"&&(t=A4(t)),Qf(t),t}let lp=class{clone(){return this._cloneInto()}};function pp(t){const e=i=>t().update(ed(i)).digest(),r=t();return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=()=>t(),e}function P4(t=32){if(On&&typeof On.getRandomValues=="function")return On.getRandomValues(new Uint8Array(t));if(On&&typeof On.randomBytes=="function")return On.randomBytes(t);throw new Error("crypto.getRandomValues must be defined")}const bp=[],gp=[],vp=[],O4=BigInt(0),ws=BigInt(1),R4=BigInt(2),F4=BigInt(7),N4=BigInt(256),C4=BigInt(113);for(let t=0,e=ws,r=1,i=0;t<24;t++){[r,i]=[i,(2*r+3*i)%5],bp.push(2*(5*i+r)),gp.push((t+1)*(t+2)/2%64);let n=O4;for(let s=0;s<7;s++)e=(e<<ws^(e>>F4)*C4)%N4,e&R4&&(n^=ws<<(ws<<BigInt(s))-ws);vp.push(n)}const[T4,B4]=_4(vp,!0),Rh=(t,e,r)=>r>32?$4(t,e,r):E4(t,e,r),Fh=(t,e,r)=>r>32?x4(t,e,r):S4(t,e,r);function q4(t,e=24){const r=new Uint32Array(10);for(let i=24-e;i<24;i++){for(let a=0;a<10;a++)r[a]=t[a]^t[a+10]^t[a+20]^t[a+30]^t[a+40];for(let a=0;a<10;a+=2){const c=(a+8)%10,d=(a+2)%10,u=r[d],l=r[d+1],g=Rh(u,l,1)^r[c],w=Fh(u,l,1)^r[c+1];for(let E=0;E<50;E+=10)t[a+E]^=g,t[a+E+1]^=w}let n=t[2],s=t[3];for(let a=0;a<24;a++){const c=gp[a],d=Rh(n,s,c),u=Fh(n,s,c),l=bp[a];n=t[l],s=t[l+1],t[l]=d,t[l+1]=u}for(let a=0;a<50;a+=10){for(let c=0;c<10;c++)r[c]=t[a+c];for(let c=0;c<10;c++)t[a+c]^=~r[(c+2)%10]&r[(c+4)%10]}t[0]^=T4[i],t[1]^=B4[i]}r.fill(0)}let L4=class yp extends lp{constructor(e,r,i,n=!1,s=24){if(super(),this.blockLen=e,this.suffix=r,this.outputLen=i,this.enableXOF=n,this.rounds=s,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,Mh(i),0>=this.blockLen||this.blockLen>=200)throw new Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=I4(this.state)}keccak(){Ph||Oh(this.state32),q4(this.state32,this.rounds),Ph||Oh(this.state32),this.posOut=0,this.pos=0}update(e){Ga(this);const{blockLen:r,state:i}=this;e=ed(e);const n=e.length;for(let s=0;s<n;){const a=Math.min(r-this.pos,n-s);for(let c=0;c<a;c++)i[this.pos++]^=e[s++];this.pos===r&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:r,pos:i,blockLen:n}=this;e[i]^=r,r&128&&i===n-1&&this.keccak(),e[n-1]^=128,this.keccak()}writeInto(e){Ga(this,!1),Qf(e),this.finish();const r=this.state,{blockLen:i}=this;for(let n=0,s=e.length;n<s;){this.posOut>=i&&this.keccak();const a=Math.min(i-this.posOut,s-n);e.set(r.subarray(this.posOut,this.posOut+a),n),this.posOut+=a,n+=a}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return Mh(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(up(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(e){const{blockLen:r,suffix:i,outputLen:n,rounds:s,enableXOF:a}=this;return e||(e=new yp(r,i,n,a,s)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=s,e.suffix=i,e.outputLen=n,e.enableXOF=a,e.destroyed=this.destroyed,e}};const D4=(t,e,r)=>pp(()=>new L4(e,t,r));D4(1,136,256/8);function uc(t){if(!Number.isSafeInteger(t)||t<0)throw new Error("positive integer expected, got "+t)}function mp(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function Qt(t,...e){if(!mp(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error("Uint8Array expected of length "+e+", got length="+t.length)}function Nh(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function U4(t,e){Qt(t);const r=e.outputLen;if(t.length<r)throw new Error("digestInto() expects output buffer of length at least "+r)}function Ch(t){if(typeof t!="boolean")throw new Error(`boolean expected, not ${t}`)}const Hi=t=>new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4)),z4=t=>new DataView(t.buffer,t.byteOffset,t.byteLength),j4=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!j4)throw new Error("Non little-endian hardware is not supported");function k4(t){if(typeof t!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(t))}function ff(t){if(typeof t=="string")t=k4(t);else if(mp(t))t=df(t);else throw new Error("Uint8Array expected, got "+typeof t);return t}function H4(t,e){if(e==null||typeof e!="object")throw new Error("options must be defined");return Object.assign(t,e)}function K4(t,e){if(t.length!==e.length)return!1;let r=0;for(let i=0;i<t.length;i++)r|=t[i]^e[i];return r===0}const V4=(t,e)=>{function r(i,...n){if(Qt(i),t.nonceLength!==void 0){const u=n[0];if(!u)throw new Error("nonce / iv required");t.varSizeNonce?Qt(u):Qt(u,t.nonceLength)}const s=t.tagLength;s&&n[1]!==void 0&&Qt(n[1]);const a=e(i,...n),c=(u,l)=>{if(l!==void 0){if(u!==2)throw new Error("cipher output not supported");Qt(l)}};let d=!1;return{encrypt(u,l){if(d)throw new Error("cannot encrypt() twice with same key + nonce");return d=!0,Qt(u),c(a.encrypt.length,l),a.encrypt(u,l)},decrypt(u,l){if(Qt(u),s&&u.length<s)throw new Error("invalid ciphertext length: smaller than tagLength="+s);return c(a.decrypt.length,l),a.decrypt(u,l)}}}return Object.assign(r,t),r};function Th(t,e,r=!0){if(e===void 0)return new Uint8Array(t);if(e.length!==t)throw new Error("invalid output length, expected "+t+", got: "+e.length);if(r&&!W4(e))throw new Error("invalid output, must be aligned");return e}function Bh(t,e,r,i){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,r,i);const n=BigInt(32),s=BigInt(4294967295),a=Number(r>>n&s),c=Number(r&s);t.setUint32(e+4,a,i),t.setUint32(e+0,c,i)}function W4(t){return t.byteOffset%4===0}function df(t){return Uint8Array.from(t)}function Zn(...t){for(let e=0;e<t.length;e++)t[e].fill(0)}const wp=t=>Uint8Array.from(t.split("").map(e=>e.charCodeAt(0))),G4=wp("expand 16-byte k"),J4=wp("expand 32-byte k"),Y4=Hi(G4),Z4=Hi(J4);function Le(t,e){return t<<e|t>>>32-e}function hf(t){return t.byteOffset%4===0}const ya=64,X4=16,_p=2**32-1,qh=new Uint32Array;function Q4(t,e,r,i,n,s,a,c){const d=n.length,u=new Uint8Array(ya),l=Hi(u),g=hf(n)&&hf(s),w=g?Hi(n):qh,E=g?Hi(s):qh;for(let $=0;$<d;a++){if(t(e,r,i,l,a,c),a>=_p)throw new Error("arx: counter overflow");const I=Math.min(ya,d-$);if(g&&I===ya){const M=$/4;if($%4!==0)throw new Error("arx: invalid block position");for(let P=0,A;P<X4;P++)A=M+P,E[A]=w[A]^l[P];$+=ya;continue}for(let M=0,P;M<I;M++)P=$+M,s[P]=n[P]^u[M];$+=I}}function ey(t,e){const{allowShortKeys:r,extendNonceFn:i,counterLength:n,counterRight:s,rounds:a}=H4({allowShortKeys:!1,counterLength:8,counterRight:!1,rounds:20},e);if(typeof t!="function")throw new Error("core must be a function");return uc(n),uc(a),Ch(s),Ch(r),(c,d,u,l,g=0)=>{Qt(c),Qt(d),Qt(u);const w=u.length;if(l===void 0&&(l=new Uint8Array(w)),Qt(l),uc(g),g<0||g>=_p)throw new Error("arx: counter overflow");if(l.length<w)throw new Error(`arx: output (${l.length}) is shorter than data (${w})`);const E=[];let $=c.length,I,M;if($===32)E.push(I=df(c)),M=Z4;else if($===16&&r)I=new Uint8Array(32),I.set(c),I.set(c,16),M=Y4,E.push(I);else throw new Error(`arx: invalid 32-byte key, got length=${$}`);hf(d)||E.push(d=df(d));const P=Hi(I);if(i){if(d.length!==24)throw new Error("arx: extended nonce must be 24 bytes");i(M,P,Hi(d.subarray(0,16)),P),d=d.subarray(16)}const A=16-n;if(A!==d.length)throw new Error(`arx: nonce must be ${A} or 16 bytes`);if(A!==12){const C=new Uint8Array(12);C.set(d,s?0:12-d.length),d=C,E.push(d)}const R=Hi(d);return Q4(t,M,P,R,u,l,g,a),Zn(...E),l}}const _t=(t,e)=>t[e++]&255|(t[e++]&255)<<8;let ty=class{constructor(e){this.blockLen=16,this.outputLen=16,this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.pos=0,this.finished=!1,e=ff(e),Qt(e,32);const r=_t(e,0),i=_t(e,2),n=_t(e,4),s=_t(e,6),a=_t(e,8),c=_t(e,10),d=_t(e,12),u=_t(e,14);this.r[0]=r&8191,this.r[1]=(r>>>13|i<<3)&8191,this.r[2]=(i>>>10|n<<6)&7939,this.r[3]=(n>>>7|s<<9)&8191,this.r[4]=(s>>>4|a<<12)&255,this.r[5]=a>>>1&8190,this.r[6]=(a>>>14|c<<2)&8191,this.r[7]=(c>>>11|d<<5)&8065,this.r[8]=(d>>>8|u<<8)&8191,this.r[9]=u>>>5&127;for(let l=0;l<8;l++)this.pad[l]=_t(e,16+2*l)}process(e,r,i=!1){const n=i?0:2048,{h:s,r:a}=this,c=a[0],d=a[1],u=a[2],l=a[3],g=a[4],w=a[5],E=a[6],$=a[7],I=a[8],M=a[9],P=_t(e,r+0),A=_t(e,r+2),R=_t(e,r+4),C=_t(e,r+6),D=_t(e,r+8),U=_t(e,r+10),j=_t(e,r+12),z=_t(e,r+14);let q=s[0]+(P&8191),V=s[1]+((P>>>13|A<<3)&8191),S=s[2]+((A>>>10|R<<6)&8191),o=s[3]+((R>>>7|C<<9)&8191),h=s[4]+((C>>>4|D<<12)&8191),y=s[5]+(D>>>1&8191),p=s[6]+((D>>>14|U<<2)&8191),v=s[7]+((U>>>11|j<<5)&8191),_=s[8]+((j>>>8|z<<8)&8191),x=s[9]+(z>>>5|n),b=0,f=b+q*c+V*(5*M)+S*(5*I)+o*(5*$)+h*(5*E);b=f>>>13,f&=8191,f+=y*(5*w)+p*(5*g)+v*(5*l)+_*(5*u)+x*(5*d),b+=f>>>13,f&=8191;let m=b+q*d+V*c+S*(5*M)+o*(5*I)+h*(5*$);b=m>>>13,m&=8191,m+=y*(5*E)+p*(5*w)+v*(5*g)+_*(5*l)+x*(5*u),b+=m>>>13,m&=8191;let F=b+q*u+V*d+S*c+o*(5*M)+h*(5*I);b=F>>>13,F&=8191,F+=y*(5*$)+p*(5*E)+v*(5*w)+_*(5*g)+x*(5*l),b+=F>>>13,F&=8191;let N=b+q*l+V*u+S*d+o*c+h*(5*M);b=N>>>13,N&=8191,N+=y*(5*I)+p*(5*$)+v*(5*E)+_*(5*w)+x*(5*g),b+=N>>>13,N&=8191;let T=b+q*g+V*l+S*u+o*d+h*c;b=T>>>13,T&=8191,T+=y*(5*M)+p*(5*I)+v*(5*$)+_*(5*E)+x*(5*w),b+=T>>>13,T&=8191;let L=b+q*w+V*g+S*l+o*u+h*d;b=L>>>13,L&=8191,L+=y*c+p*(5*M)+v*(5*I)+_*(5*$)+x*(5*E),b+=L>>>13,L&=8191;let k=b+q*E+V*w+S*g+o*l+h*u;b=k>>>13,k&=8191,k+=y*d+p*c+v*(5*M)+_*(5*I)+x*(5*$),b+=k>>>13,k&=8191;let W=b+q*$+V*E+S*w+o*g+h*l;b=W>>>13,W&=8191,W+=y*u+p*d+v*c+_*(5*M)+x*(5*I),b+=W>>>13,W&=8191;let Z=b+q*I+V*$+S*E+o*w+h*g;b=Z>>>13,Z&=8191,Z+=y*l+p*u+v*d+_*c+x*(5*M),b+=Z>>>13,Z&=8191;let K=b+q*M+V*I+S*$+o*E+h*w;b=K>>>13,K&=8191,K+=y*g+p*l+v*u+_*d+x*c,b+=K>>>13,K&=8191,b=(b<<2)+b|0,b=b+f|0,f=b&8191,b=b>>>13,m+=b,s[0]=f,s[1]=m,s[2]=F,s[3]=N,s[4]=T,s[5]=L,s[6]=k,s[7]=W,s[8]=Z,s[9]=K}finalize(){const{h:e,pad:r}=this,i=new Uint16Array(10);let n=e[1]>>>13;e[1]&=8191;for(let c=2;c<10;c++)e[c]+=n,n=e[c]>>>13,e[c]&=8191;e[0]+=n*5,n=e[0]>>>13,e[0]&=8191,e[1]+=n,n=e[1]>>>13,e[1]&=8191,e[2]+=n,i[0]=e[0]+5,n=i[0]>>>13,i[0]&=8191;for(let c=1;c<10;c++)i[c]=e[c]+n,n=i[c]>>>13,i[c]&=8191;i[9]-=8192;let s=(n^1)-1;for(let c=0;c<10;c++)i[c]&=s;s=~s;for(let c=0;c<10;c++)e[c]=e[c]&s|i[c];e[0]=(e[0]|e[1]<<13)&65535,e[1]=(e[1]>>>3|e[2]<<10)&65535,e[2]=(e[2]>>>6|e[3]<<7)&65535,e[3]=(e[3]>>>9|e[4]<<4)&65535,e[4]=(e[4]>>>12|e[5]<<1|e[6]<<14)&65535,e[5]=(e[6]>>>2|e[7]<<11)&65535,e[6]=(e[7]>>>5|e[8]<<8)&65535,e[7]=(e[8]>>>8|e[9]<<5)&65535;let a=e[0]+r[0];e[0]=a&65535;for(let c=1;c<8;c++)a=(e[c]+r[c]|0)+(a>>>16)|0,e[c]=a&65535;Zn(i)}update(e){Nh(this);const{buffer:r,blockLen:i}=this;e=ff(e);const n=e.length;for(let s=0;s<n;){const a=Math.min(i-this.pos,n-s);if(a===i){for(;i<=n-s;s+=i)this.process(e,s);continue}r.set(e.subarray(s,s+a),this.pos),this.pos+=a,s+=a,this.pos===i&&(this.process(r,0,!1),this.pos=0)}return this}destroy(){Zn(this.h,this.r,this.buffer,this.pad)}digestInto(e){Nh(this),U4(e,this),this.finished=!0;const{buffer:r,h:i}=this;let{pos:n}=this;if(n){for(r[n++]=1;n<16;n++)r[n]=0;this.process(r,0,!0)}this.finalize();let s=0;for(let a=0;a<8;a++)e[s++]=i[a]>>>0,e[s++]=i[a]>>>8;return e}digest(){const{buffer:e,outputLen:r}=this;this.digestInto(e);const i=e.slice(0,r);return this.destroy(),i}};function ry(t){const e=(i,n)=>t(n).update(ff(i)).digest(),r=t(new Uint8Array(32));return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=i=>t(i),e}const iy=ry(t=>new ty(t));function ny(t,e,r,i,n,s=20){let a=t[0],c=t[1],d=t[2],u=t[3],l=e[0],g=e[1],w=e[2],E=e[3],$=e[4],I=e[5],M=e[6],P=e[7],A=n,R=r[0],C=r[1],D=r[2],U=a,j=c,z=d,q=u,V=l,S=g,o=w,h=E,y=$,p=I,v=M,_=P,x=A,b=R,f=C,m=D;for(let N=0;N<s;N+=2)U=U+V|0,x=Le(x^U,16),y=y+x|0,V=Le(V^y,12),U=U+V|0,x=Le(x^U,8),y=y+x|0,V=Le(V^y,7),j=j+S|0,b=Le(b^j,16),p=p+b|0,S=Le(S^p,12),j=j+S|0,b=Le(b^j,8),p=p+b|0,S=Le(S^p,7),z=z+o|0,f=Le(f^z,16),v=v+f|0,o=Le(o^v,12),z=z+o|0,f=Le(f^z,8),v=v+f|0,o=Le(o^v,7),q=q+h|0,m=Le(m^q,16),_=_+m|0,h=Le(h^_,12),q=q+h|0,m=Le(m^q,8),_=_+m|0,h=Le(h^_,7),U=U+S|0,m=Le(m^U,16),v=v+m|0,S=Le(S^v,12),U=U+S|0,m=Le(m^U,8),v=v+m|0,S=Le(S^v,7),j=j+o|0,x=Le(x^j,16),_=_+x|0,o=Le(o^_,12),j=j+o|0,x=Le(x^j,8),_=_+x|0,o=Le(o^_,7),z=z+h|0,b=Le(b^z,16),y=y+b|0,h=Le(h^y,12),z=z+h|0,b=Le(b^z,8),y=y+b|0,h=Le(h^y,7),q=q+V|0,f=Le(f^q,16),p=p+f|0,V=Le(V^p,12),q=q+V|0,f=Le(f^q,8),p=p+f|0,V=Le(V^p,7);let F=0;i[F++]=a+U|0,i[F++]=c+j|0,i[F++]=d+z|0,i[F++]=u+q|0,i[F++]=l+V|0,i[F++]=g+S|0,i[F++]=w+o|0,i[F++]=E+h|0,i[F++]=$+y|0,i[F++]=I+p|0,i[F++]=M+v|0,i[F++]=P+_|0,i[F++]=A+x|0,i[F++]=R+b|0,i[F++]=C+f|0,i[F++]=D+m|0}const sy=ey(ny,{counterRight:!1,counterLength:4,allowShortKeys:!1}),ay=new Uint8Array(16),Lh=(t,e)=>{t.update(e);const r=e.length%16;r&&t.update(ay.subarray(r))},oy=new Uint8Array(32);function Dh(t,e,r,i,n){const s=t(e,r,oy),a=iy.create(s);n&&Lh(a,n),Lh(a,i);const c=new Uint8Array(16),d=z4(c);Bh(d,0,BigInt(n?n.length:0),!0),Bh(d,8,BigInt(i.length),!0),a.update(c);const u=a.digest();return Zn(s,c),u}const cy=t=>(e,r,i)=>({encrypt(n,s){const a=n.length;s=Th(a+16,s,!1),s.set(n);const c=s.subarray(0,-16);t(e,r,c,c,1);const d=Dh(t,e,r,c,i);return s.set(d,a),Zn(d),s},decrypt(n,s){s=Th(n.length-16,s,!1);const a=n.subarray(0,-16),c=n.subarray(-16),d=Dh(t,e,r,a,i);if(!K4(c,d))throw new Error("invalid tag");return s.set(n.subarray(0,-16)),t(e,r,s,s,1),Zn(d),s}});V4({blockSize:64,nonceLength:12,tagLength:16},cy(sy));function fy(t,e,r,i){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,r,i);const n=BigInt(32),s=BigInt(4294967295),a=Number(r>>n&s),c=Number(r&s),d=i?4:0,u=i?0:4;t.setUint32(e+d,a,i),t.setUint32(e+u,c,i)}function dy(t,e,r){return t&e^~t&r}function hy(t,e,r){return t&e^t&r^e&r}let uy=class extends lp{constructor(e,r,i,n){super(),this.blockLen=e,this.outputLen=r,this.padOffset=i,this.isLE=n,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=hc(this.buffer)}update(e){Ga(this);const{view:r,buffer:i,blockLen:n}=this;e=ed(e);const s=e.length;for(let a=0;a<s;){const c=Math.min(n-this.pos,s-a);if(c===n){const d=hc(e);for(;n<=s-a;a+=n)this.process(d,a);continue}i.set(e.subarray(a,a+c),this.pos),this.pos+=c,a+=c,this.pos===n&&(this.process(r,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){Ga(this),up(e,this),this.finished=!0;const{buffer:r,view:i,blockLen:n,isLE:s}=this;let{pos:a}=this;r[a++]=128,this.buffer.subarray(a).fill(0),this.padOffset>n-a&&(this.process(i,0),a=0);for(let g=a;g<n;g++)r[g]=0;fy(i,n-8,BigInt(this.length*8),s),this.process(i,0);const c=hc(e),d=this.outputLen;if(d%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const u=d/4,l=this.get();if(u>l.length)throw new Error("_sha2: outputLen bigger than state");for(let g=0;g<u;g++)c.setUint32(4*g,l[g],s)}digest(){const{buffer:e,outputLen:r}=this;this.digestInto(e);const i=e.slice(0,r);return this.destroy(),i}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:r,buffer:i,length:n,finished:s,destroyed:a,pos:c}=this;return e.length=n,e.pos=c,e.finished=s,e.destroyed=a,n%r&&e.buffer.set(i),e}};const ly=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Ni=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Ci=new Uint32Array(64);let py=class extends uy{constructor(){super(64,32,8,!1),this.A=Ni[0]|0,this.B=Ni[1]|0,this.C=Ni[2]|0,this.D=Ni[3]|0,this.E=Ni[4]|0,this.F=Ni[5]|0,this.G=Ni[6]|0,this.H=Ni[7]|0}get(){const{A:e,B:r,C:i,D:n,E:s,F:a,G:c,H:d}=this;return[e,r,i,n,s,a,c,d]}set(e,r,i,n,s,a,c,d){this.A=e|0,this.B=r|0,this.C=i|0,this.D=n|0,this.E=s|0,this.F=a|0,this.G=c|0,this.H=d|0}process(e,r){for(let g=0;g<16;g++,r+=4)Ci[g]=e.getUint32(r,!1);for(let g=16;g<64;g++){const w=Ci[g-15],E=Ci[g-2],$=Lr(w,7)^Lr(w,18)^w>>>3,I=Lr(E,17)^Lr(E,19)^E>>>10;Ci[g]=I+Ci[g-7]+$+Ci[g-16]|0}let{A:i,B:n,C:s,D:a,E:c,F:d,G:u,H:l}=this;for(let g=0;g<64;g++){const w=Lr(c,6)^Lr(c,11)^Lr(c,25),E=l+w+dy(c,d,u)+ly[g]+Ci[g]|0,$=(Lr(i,2)^Lr(i,13)^Lr(i,22))+hy(i,n,s)|0;l=u,u=d,d=c,c=a+E|0,a=s,s=n,n=i,i=E+$|0}i=i+this.A|0,n=n+this.B|0,s=s+this.C|0,a=a+this.D|0,c=c+this.E|0,d=d+this.F|0,u=u+this.G|0,l=l+this.H|0,this.set(i,n,s,a,c,d,u,l)}roundClean(){Ci.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}};pp(()=>new py);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Ep=BigInt(0);function td(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function Sp(t){if(!td(t))throw new Error("Uint8Array expected")}const by=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function gy(t){Sp(t);let e="";for(let r=0;r<t.length;r++)e+=by[t[r]];return e}function vy(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);return t===""?Ep:BigInt("0x"+t)}const bi={_0:48,_9:57,A:65,F:70,a:97,f:102};function Uh(t){if(t>=bi._0&&t<=bi._9)return t-bi._0;if(t>=bi.A&&t<=bi.F)return t-(bi.A-10);if(t>=bi.a&&t<=bi.f)return t-(bi.a-10)}function $p(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);const e=t.length,r=e/2;if(e%2)throw new Error("hex string expected, got unpadded hex of length "+e);const i=new Uint8Array(r);for(let n=0,s=0;n<r;n++,s+=2){const a=Uh(t.charCodeAt(s)),c=Uh(t.charCodeAt(s+1));if(a===void 0||c===void 0){const d=t[s]+t[s+1];throw new Error('hex string expected, got non-hex character "'+d+'" at index '+s)}i[n]=a*16+c}return i}function zh(t){return Sp(t),vy(gy(Uint8Array.from(t).reverse()))}function yy(t,e){return $p(t.toString(16).padStart(e*2,"0"))}function my(t,e){return yy(t,e).reverse()}function jh(t,e,r){let i;if(typeof e=="string")try{i=$p(e)}catch(s){throw new Error(t+" must be hex string or Uint8Array, cause: "+s)}else if(td(e))i=Uint8Array.from(e);else throw new Error(t+" must be hex string or Uint8Array");const n=i.length;if(typeof r=="number"&&n!==r)throw new Error(t+" of length "+r+" expected, got "+n);return i}const lc=t=>typeof t=="bigint"&&Ep<=t;function wy(t,e,r){return lc(t)&&lc(e)&&lc(r)&&e<=t&&t<r}function kh(t,e,r,i){if(!wy(e,r,i))throw new Error("expected valid "+t+": "+r+" <= n < "+i+", got "+e)}const _y={bigint:t=>typeof t=="bigint",function:t=>typeof t=="function",boolean:t=>typeof t=="boolean",string:t=>typeof t=="string",stringOrUint8Array:t=>typeof t=="string"||td(t),isSafeInteger:t=>Number.isSafeInteger(t),array:t=>Array.isArray(t),field:(t,e)=>e.Fp.isValid(t),hash:t=>typeof t=="function"&&Number.isSafeInteger(t.outputLen)};function Ey(t,e,r={}){const i=(n,s,a)=>{const c=_y[s];if(typeof c!="function")throw new Error("invalid validator function");const d=t[n];if(!(a&&d===void 0)&&!c(d,t))throw new Error("param "+String(n)+" is invalid. Expected "+s+", got "+d)};for(const[n,s]of Object.entries(e))i(n,s,!1);for(const[n,s]of Object.entries(r))i(n,s,!0);return t}const Vn=BigInt(0),ma=BigInt(1);function xp(t,e){const r=t%e;return r>=Vn?r:e+r}function Sy(t,e,r){if(e<Vn)throw new Error("invalid exponent, negatives unsupported");if(r<=Vn)throw new Error("invalid modulus");if(r===ma)return Vn;let i=ma;for(;e>Vn;)e&ma&&(i=i*t%r),t=t*t%r,e>>=ma;return i}function Ar(t,e,r){let i=t;for(;e-- >Vn;)i*=i,i%=r;return i}BigInt(0),BigInt(1),BigInt(0),BigInt(1),BigInt(2),BigInt(8);const Rn=BigInt(0),pc=BigInt(1);function $y(t){return Ey(t,{a:"bigint"},{montgomeryBits:"isSafeInteger",nByteLength:"isSafeInteger",adjustScalarBytes:"function",domain:"function",powPminus2:"function",Gu:"bigint"}),Object.freeze({...t})}function xy(t){const e=$y(t),{P:r}=e,i=A=>xp(A,r),n=e.montgomeryBits,s=Math.ceil(n/8),a=e.nByteLength,c=e.adjustScalarBytes||(A=>A),d=e.powPminus2||(A=>Sy(A,r-BigInt(2),r));function u(A,R,C){const D=i(A*(R-C));return R=i(R-D),C=i(C+D),[R,C]}const l=(e.a-BigInt(2))/BigInt(4);function g(A,R){kh("u",A,Rn,r),kh("scalar",R,Rn,r);const C=R,D=A;let U=pc,j=Rn,z=A,q=pc,V=Rn,S;for(let h=BigInt(n-1);h>=Rn;h--){const y=C>>h&pc;V^=y,S=u(V,U,z),U=S[0],z=S[1],S=u(V,j,q),j=S[0],q=S[1],V=y;const p=U+j,v=i(p*p),_=U-j,x=i(_*_),b=v-x,f=z+q,m=z-q,F=i(m*p),N=i(f*_),T=F+N,L=F-N;z=i(T*T),q=i(D*i(L*L)),U=i(v*x),j=i(b*(v+i(l*b)))}S=u(V,U,z),U=S[0],z=S[1],S=u(V,j,q),j=S[0],q=S[1];const o=d(j);return i(U*o)}function w(A){return my(i(A),s)}function E(A){const R=jh("u coordinate",A,s);return a===32&&(R[31]&=127),zh(R)}function $(A){const R=jh("scalar",A),C=R.length;if(C!==s&&C!==a){let D=""+s+" or "+a;throw new Error("invalid scalar, expected "+D+" bytes, got "+C)}return zh(c(R))}function I(A,R){const C=E(R),D=$(A),U=g(C,D);if(U===Rn)throw new Error("invalid private or public key received");return w(U)}const M=w(e.Gu);function P(A){return I(A,M)}return{scalarMult:I,scalarMultBase:P,getSharedSecret:(A,R)=>I(A,R),getPublicKey:A=>P(A),utils:{randomPrivateKey:()=>e.randomBytes(e.nByteLength)},GuBytes:M}}const uf=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949");BigInt(0);const Iy=BigInt(1),Hh=BigInt(2),My=BigInt(3),Ay=BigInt(5);BigInt(8);function Py(t){const e=BigInt(10),r=BigInt(20),i=BigInt(40),n=BigInt(80),s=uf,a=t*t%s*t%s,c=Ar(a,Hh,s)*a%s,d=Ar(c,Iy,s)*t%s,u=Ar(d,Ay,s)*d%s,l=Ar(u,e,s)*u%s,g=Ar(l,r,s)*l%s,w=Ar(g,i,s)*g%s,E=Ar(w,n,s)*w%s,$=Ar(E,n,s)*w%s,I=Ar($,e,s)*u%s;return{pow_p_5_8:Ar(I,Hh,s)*t%s,b2:a}}function Oy(t){return t[0]&=248,t[31]&=127,t[31]|=64,t}xy({P:uf,a:BigInt(486662),montgomeryBits:255,nByteLength:32,Gu:BigInt(9),powPminus2:t=>{const e=uf,{pow_p_5_8:r,b2:i}=Py(t);return xp(Ar(r,My,e)*i,e)},adjustScalarBytes:Oy,randomBytes:P4});const Ry={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}};function Fy(t,e){const{message:r,code:i}=Ry[t];return{message:r,code:i}}function lf(t,e){return!!Array.isArray(t)}class _n{}let Ny=class extends _n{constructor(e){super()}};const Kh=G.FIVE_SECONDS,cs={pulse:"heartbeat_pulse"};let Cy=class Ip extends Ny{constructor(e){super(e),this.events=new Ht.EventEmitter,this.interval=Kh,this.interval=(e==null?void 0:e.interval)||Kh}static async init(e){const r=new Ip(e);return await r.init(),r}async init(){await this.initialize()}stop(){clearInterval(this.intervalRef)}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async initialize(){this.intervalRef=setInterval(()=>this.pulse(),G.toMiliseconds(this.interval))}pulse(){this.events.emit(cs.pulse)}};const Ty=/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,By=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,qy=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/;function Ly(t,e){if(t==="__proto__"||t==="constructor"&&e&&typeof e=="object"&&"prototype"in e){Dy(t);return}return e}function Dy(t){console.warn(`[destr] Dropping "${t}" key to prevent prototype pollution.`)}function wa(t,e={}){if(typeof t!="string")return t;const r=t.trim();if(t[0]==='"'&&t.at(-1)==='"'&&!t.includes("\\"))return r.slice(1,-1);if(r.length<=9){const i=r.toLowerCase();if(i==="true")return!0;if(i==="false")return!1;if(i==="undefined")return;if(i==="null")return null;if(i==="nan")return Number.NaN;if(i==="infinity")return Number.POSITIVE_INFINITY;if(i==="-infinity")return Number.NEGATIVE_INFINITY}if(!qy.test(t)){if(e.strict)throw new SyntaxError("[destr] Invalid JSON");return t}try{if(Ty.test(t)||By.test(t)){if(e.strict)throw new Error("[destr] Possible prototype pollution");return JSON.parse(t,Ly)}return JSON.parse(t)}catch(i){if(e.strict)throw i;return t}}function Uy(t){return!t||typeof t.then!="function"?Promise.resolve(t):t}function ft(t,...e){try{return Uy(t(...e))}catch(r){return Promise.reject(r)}}function zy(t){const e=typeof t;return t===null||e!=="object"&&e!=="function"}function jy(t){const e=Object.getPrototypeOf(t);return!e||e.isPrototypeOf(Object)}function Ta(t){if(zy(t))return String(t);if(jy(t)||Array.isArray(t))return JSON.stringify(t);if(typeof t.toJSON=="function")return Ta(t.toJSON());throw new Error("[unstorage] Cannot stringify value!")}function Mp(){if(typeof Nr===void 0)throw new TypeError("[unstorage] Buffer is not supported!")}const pf="base64:";function ky(t){if(typeof t=="string")return t;Mp();const e=Nr.from(t).toString("base64");return pf+e}function Hy(t){return typeof t!="string"||!t.startsWith(pf)?t:(Mp(),Nr.from(t.slice(pf.length),"base64"))}function Ut(t){return t?t.split("?")[0].replace(/[/\\]/g,":").replace(/:+/g,":").replace(/^:|:$/g,""):""}function Ky(...t){return Ut(t.join(":"))}function _a(t){return t=Ut(t),t?t+":":""}const Vy="memory",Wy=()=>{const t=new Map;return{name:Vy,options:{},hasItem(e){return t.has(e)},getItem(e){return t.get(e)??null},getItemRaw(e){return t.get(e)??null},setItem(e,r){t.set(e,r)},setItemRaw(e,r){t.set(e,r)},removeItem(e){t.delete(e)},getKeys(){return Array.from(t.keys())},clear(){t.clear()},dispose(){t.clear()}}};function Gy(t={}){const e={mounts:{"":t.driver||Wy()},mountpoints:[""],watching:!1,watchListeners:[],unwatch:{}},r=u=>{for(const l of e.mountpoints)if(u.startsWith(l))return{base:l,relativeKey:u.slice(l.length),driver:e.mounts[l]};return{base:"",relativeKey:u,driver:e.mounts[""]}},i=(u,l)=>e.mountpoints.filter(g=>g.startsWith(u)||l&&u.startsWith(g)).map(g=>({relativeBase:u.length>g.length?u.slice(g.length):void 0,mountpoint:g,driver:e.mounts[g]})),n=(u,l)=>{if(e.watching){l=Ut(l);for(const g of e.watchListeners)g(u,l)}},s=async()=>{if(!e.watching){e.watching=!0;for(const u in e.mounts)e.unwatch[u]=await Vh(e.mounts[u],n,u)}},a=async()=>{if(e.watching){for(const u in e.unwatch)await e.unwatch[u]();e.unwatch={},e.watching=!1}},c=(u,l,g)=>{const w=new Map,E=$=>{let I=w.get($.base);return I||(I={driver:$.driver,base:$.base,items:[]},w.set($.base,I)),I};for(const $ of u){const I=typeof $=="string",M=Ut(I?$:$.key),P=I?void 0:$.value,A=I||!$.options?l:{...l,...$.options},R=r(M);E(R).items.push({key:M,value:P,relativeKey:R.relativeKey,options:A})}return Promise.all([...w.values()].map($=>g($))).then($=>$.flat())},d={hasItem(u,l={}){u=Ut(u);const{relativeKey:g,driver:w}=r(u);return ft(w.hasItem,g,l)},getItem(u,l={}){u=Ut(u);const{relativeKey:g,driver:w}=r(u);return ft(w.getItem,g,l).then(E=>wa(E))},getItems(u,l){return c(u,l,g=>g.driver.getItems?ft(g.driver.getItems,g.items.map(w=>({key:w.relativeKey,options:w.options})),l).then(w=>w.map(E=>({key:Ky(g.base,E.key),value:wa(E.value)}))):Promise.all(g.items.map(w=>ft(g.driver.getItem,w.relativeKey,w.options).then(E=>({key:w.key,value:wa(E)})))))},getItemRaw(u,l={}){u=Ut(u);const{relativeKey:g,driver:w}=r(u);return w.getItemRaw?ft(w.getItemRaw,g,l):ft(w.getItem,g,l).then(E=>Hy(E))},async setItem(u,l,g={}){if(l===void 0)return d.removeItem(u);u=Ut(u);const{relativeKey:w,driver:E}=r(u);E.setItem&&(await ft(E.setItem,w,Ta(l),g),E.watch||n("update",u))},async setItems(u,l){await c(u,l,async g=>{g.driver.setItems&&await ft(g.driver.setItems,g.items.map(w=>({key:w.relativeKey,value:Ta(w.value),options:w.options})),l),g.driver.setItem&&await Promise.all(g.items.map(w=>ft(g.driver.setItem,w.relativeKey,Ta(w.value),w.options)))})},async setItemRaw(u,l,g={}){if(l===void 0)return d.removeItem(u,g);u=Ut(u);const{relativeKey:w,driver:E}=r(u);if(E.setItemRaw)await ft(E.setItemRaw,w,l,g);else if(E.setItem)await ft(E.setItem,w,ky(l),g);else return;E.watch||n("update",u)},async removeItem(u,l={}){typeof l=="boolean"&&(l={removeMeta:l}),u=Ut(u);const{relativeKey:g,driver:w}=r(u);w.removeItem&&(await ft(w.removeItem,g,l),(l.removeMeta||l.removeMata)&&await ft(w.removeItem,g+"$",l),w.watch||n("remove",u))},async getMeta(u,l={}){typeof l=="boolean"&&(l={nativeOnly:l}),u=Ut(u);const{relativeKey:g,driver:w}=r(u),E=Object.create(null);if(w.getMeta&&Object.assign(E,await ft(w.getMeta,g,l)),!l.nativeOnly){const $=await ft(w.getItem,g+"$",l).then(I=>wa(I));$&&typeof $=="object"&&(typeof $.atime=="string"&&($.atime=new Date($.atime)),typeof $.mtime=="string"&&($.mtime=new Date($.mtime)),Object.assign(E,$))}return E},setMeta(u,l,g={}){return this.setItem(u+"$",l,g)},removeMeta(u,l={}){return this.removeItem(u+"$",l)},async getKeys(u,l={}){u=_a(u);const g=i(u,!0);let w=[];const E=[];for(const $ of g){const M=(await ft($.driver.getKeys,$.relativeBase,l)).map(P=>$.mountpoint+Ut(P)).filter(P=>!w.some(A=>P.startsWith(A)));E.push(...M),w=[$.mountpoint,...w.filter(P=>!P.startsWith($.mountpoint))]}return u?E.filter($=>$.startsWith(u)&&!$.endsWith("$")):E.filter($=>!$.endsWith("$"))},async clear(u,l={}){u=_a(u),await Promise.all(i(u,!1).map(async g=>{if(g.driver.clear)return ft(g.driver.clear,g.relativeBase,l);if(g.driver.removeItem){const w=await g.driver.getKeys(g.relativeBase||"",l);return Promise.all(w.map(E=>g.driver.removeItem(E,l)))}}))},async dispose(){await Promise.all(Object.values(e.mounts).map(u=>Wh(u)))},async watch(u){return await s(),e.watchListeners.push(u),async()=>{e.watchListeners=e.watchListeners.filter(l=>l!==u),e.watchListeners.length===0&&await a()}},async unwatch(){e.watchListeners=[],await a()},mount(u,l){if(u=_a(u),u&&e.mounts[u])throw new Error(`already mounted at ${u}`);return u&&(e.mountpoints.push(u),e.mountpoints.sort((g,w)=>w.length-g.length)),e.mounts[u]=l,e.watching&&Promise.resolve(Vh(l,n,u)).then(g=>{e.unwatch[u]=g}).catch(console.error),d},async unmount(u,l=!0){u=_a(u),!(!u||!e.mounts[u])&&(e.watching&&u in e.unwatch&&(e.unwatch[u](),delete e.unwatch[u]),l&&await Wh(e.mounts[u]),e.mountpoints=e.mountpoints.filter(g=>g!==u),delete e.mounts[u])},getMount(u=""){u=Ut(u)+":";const l=r(u);return{driver:l.driver,base:l.base}},getMounts(u="",l={}){return u=Ut(u),i(u,l.parents).map(w=>({driver:w.driver,base:w.mountpoint}))}};return d}function Vh(t,e,r){return t.watch?t.watch((i,n)=>e(i,r+n)):()=>{}}async function Wh(t){typeof t.dispose=="function"&&await ft(t.dispose)}function En(t){return new Promise((e,r)=>{t.oncomplete=t.onsuccess=()=>e(t.result),t.onabort=t.onerror=()=>r(t.error)})}function Ap(t,e){const r=indexedDB.open(t);r.onupgradeneeded=()=>r.result.createObjectStore(e);const i=En(r);return(n,s)=>i.then(a=>s(a.transaction(e,n).objectStore(e)))}let bc;function Ys(){return bc||(bc=Ap("keyval-store","keyval")),bc}function Gh(t,e=Ys()){return e("readonly",r=>En(r.get(t)))}function Jy(t,e,r=Ys()){return r("readwrite",i=>(i.put(e,t),En(i.transaction)))}function Yy(t,e=Ys()){return e("readwrite",r=>(r.delete(t),En(r.transaction)))}function Zy(t=Ys()){return t("readwrite",e=>(e.clear(),En(e.transaction)))}function Xy(t,e){return t.openCursor().onsuccess=function(){this.result&&(e(this.result),this.result.continue())},En(t.transaction)}function Qy(t=Ys()){return t("readonly",e=>{if(e.getAllKeys)return En(e.getAllKeys());const r=[];return Xy(e,i=>r.push(i.key)).then(()=>r)})}const em="idb-keyval";var tm=(t={})=>{const e=t.base&&t.base.length>0?`${t.base}:`:"",r=n=>e+n;let i;return t.dbName&&t.storeName&&(i=Ap(t.dbName,t.storeName)),{name:em,options:t,async hasItem(n){return!(typeof await Gh(r(n),i)>"u")},async getItem(n){return await Gh(r(n),i)??null},setItem(n,s){return Jy(r(n),s,i)},removeItem(n){return Yy(r(n),i)},getKeys(){return Qy(i)},clear(){return Zy(i)}}};const rm="WALLET_CONNECT_V2_INDEXED_DB",im="keyvaluestorage";let nm=class{constructor(){this.indexedDb=Gy({driver:tm({dbName:rm,storeName:im})})}async getKeys(){return this.indexedDb.getKeys()}async getEntries(){return(await this.indexedDb.getItems(await this.indexedDb.getKeys())).map(e=>[e.key,e.value])}async getItem(e){const r=await this.indexedDb.getItem(e);if(r!==null)return r}async setItem(e,r){await this.indexedDb.setItem(e,Cr(r))}async removeItem(e){await this.indexedDb.removeItem(e)}};var gc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof ne<"u"?ne:typeof self<"u"?self:{},Ba={exports:{}};(function(){let t;function e(){}t=e,t.prototype.getItem=function(r){return this.hasOwnProperty(r)?String(this[r]):null},t.prototype.setItem=function(r,i){this[r]=String(i)},t.prototype.removeItem=function(r){delete this[r]},t.prototype.clear=function(){const r=this;Object.keys(r).forEach(function(i){r[i]=void 0,delete r[i]})},t.prototype.key=function(r){return r=r||0,Object.keys(this)[r]},t.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof gc<"u"&&gc.localStorage?Ba.exports=gc.localStorage:typeof window<"u"&&window.localStorage?Ba.exports=window.localStorage:Ba.exports=new e})();function sm(t){var e;return[t[0],Vi((e=t[1])!=null?e:"")]}let am=class{constructor(){this.localStorage=Ba.exports}async getKeys(){return Object.keys(this.localStorage)}async getEntries(){return Object.entries(this.localStorage).map(sm)}async getItem(e){const r=this.localStorage.getItem(e);if(r!==null)return Vi(r)}async setItem(e,r){this.localStorage.setItem(e,Cr(r))}async removeItem(e){this.localStorage.removeItem(e)}};const om="wc_storage_version",Jh=1,cm=async(t,e,r)=>{const i=om,n=await e.getItem(i);if(n&&n>=Jh){r(e);return}const s=await t.getKeys();if(!s.length){r(e);return}const a=[];for(;s.length;){const c=s.shift();if(!c)continue;const d=c.toLowerCase();if(d.includes("wc@")||d.includes("walletconnect")||d.includes("wc_")||d.includes("wallet_connect")){const u=await t.getItem(c);await e.setItem(c,u),a.push(c)}}await e.setItem(i,Jh),r(e),fm(t,a)},fm=async(t,e)=>{e.length&&e.forEach(async r=>{await t.removeItem(r)})};let dm=class{constructor(){this.initialized=!1,this.setInitialized=r=>{this.storage=r,this.initialized=!0};const e=new am;this.storage=e;try{const r=new nm;cm(e,r,this.setInitialized)}catch{this.initialized=!0}}async getKeys(){return await this.initialize(),this.storage.getKeys()}async getEntries(){return await this.initialize(),this.storage.getEntries()}async getItem(e){return await this.initialize(),this.storage.getItem(e)}async setItem(e,r){return await this.initialize(),this.storage.setItem(e,r)}async removeItem(e){return await this.initialize(),this.storage.removeItem(e)}async initialize(){this.initialized||await new Promise(e=>{const r=setInterval(()=>{this.initialized&&(clearInterval(r),e())},20)})}};function hm(t){try{return JSON.stringify(t)}catch{return'"[Circular]"'}}var um=lm;function lm(t,e,r){var i=r&&r.stringify||hm,n=1;if(typeof t=="object"&&t!==null){var s=e.length+n;if(s===1)return t;var a=new Array(s);a[0]=i(t);for(var c=1;c<s;c++)a[c]=i(e[c]);return a.join(" ")}if(typeof t!="string")return t;var d=e.length;if(d===0)return t;for(var u="",l=1-n,g=-1,w=t&&t.length||0,E=0;E<w;){if(t.charCodeAt(E)===37&&E+1<w){switch(g=g>-1?g:0,t.charCodeAt(E+1)){case 100:case 102:if(l>=d||e[l]==null)break;g<E&&(u+=t.slice(g,E)),u+=Number(e[l]),g=E+2,E++;break;case 105:if(l>=d||e[l]==null)break;g<E&&(u+=t.slice(g,E)),u+=Math.floor(Number(e[l])),g=E+2,E++;break;case 79:case 111:case 106:if(l>=d||e[l]===void 0)break;g<E&&(u+=t.slice(g,E));var $=typeof e[l];if($==="string"){u+="'"+e[l]+"'",g=E+2,E++;break}if($==="function"){u+=e[l].name||"<anonymous>",g=E+2,E++;break}u+=i(e[l]),g=E+2,E++;break;case 115:if(l>=d)break;g<E&&(u+=t.slice(g,E)),u+=String(e[l]),g=E+2,E++;break;case 37:g<E&&(u+=t.slice(g,E)),u+="%",g=E+2,E++,l--;break}++l}++E}return g===-1?t:(g<w&&(u+=t.slice(g)),u)}const Yh=um;var Ln=Hr;const qs=Sm().console||{},pm={mapHttpRequest:Ea,mapHttpResponse:Ea,wrapRequestSerializer:vc,wrapResponseSerializer:vc,wrapErrorSerializer:vc,req:Ea,res:Ea,err:mm};function bm(t,e){return Array.isArray(t)?t.filter(function(i){return i!=="!stdSerializers.err"}):t===!0?Object.keys(e):!1}function Hr(t){t=t||{},t.browser=t.browser||{};const e=t.browser.transmit;if(e&&typeof e.send!="function")throw Error("pino: transmit option must have a send function");const r=t.browser.write||qs;t.browser.write&&(t.browser.asObject=!0);const i=t.serializers||{},n=bm(t.browser.serialize,i);let s=t.browser.serialize;Array.isArray(t.browser.serialize)&&t.browser.serialize.indexOf("!stdSerializers.err")>-1&&(s=!1);const a=["error","fatal","warn","info","debug","trace"];typeof r=="function"&&(r.error=r.fatal=r.warn=r.info=r.debug=r.trace=r),t.enabled===!1&&(t.level="silent");const c=t.level||"info",d=Object.create(r);d.log||(d.log=Ls),Object.defineProperty(d,"levelVal",{get:l}),Object.defineProperty(d,"level",{get:g,set:w});const u={transmit:e,serialize:n,asObject:t.browser.asObject,levels:a,timestamp:wm(t)};d.levels=Hr.levels,d.level=c,d.setMaxListeners=d.getMaxListeners=d.emit=d.addListener=d.on=d.prependListener=d.once=d.prependOnceListener=d.removeListener=d.removeAllListeners=d.listeners=d.listenerCount=d.eventNames=d.write=d.flush=Ls,d.serializers=i,d._serialize=n,d._stdErrSerialize=s,d.child=E,e&&(d._logEvent=bf());function l(){return this.level==="silent"?1/0:this.levels.values[this.level]}function g(){return this._level}function w($){if($!=="silent"&&!this.levels.values[$])throw Error("unknown level "+$);this._level=$,Fn(u,d,"error","log"),Fn(u,d,"fatal","error"),Fn(u,d,"warn","error"),Fn(u,d,"info","log"),Fn(u,d,"debug","log"),Fn(u,d,"trace","log")}function E($,I){if(!$)throw new Error("missing bindings for child Pino");I=I||{},n&&$.serializers&&(I.serializers=$.serializers);const M=I.serializers;if(n&&M){var P=Object.assign({},i,M),A=t.browser.serialize===!0?Object.keys(P):n;delete $.serializers,xo([$],A,P,this._stdErrSerialize)}function R(C){this._childLevel=(C._childLevel|0)+1,this.error=Nn(C,$,"error"),this.fatal=Nn(C,$,"fatal"),this.warn=Nn(C,$,"warn"),this.info=Nn(C,$,"info"),this.debug=Nn(C,$,"debug"),this.trace=Nn(C,$,"trace"),P&&(this.serializers=P,this._serialize=A),e&&(this._logEvent=bf([].concat(C._logEvent.bindings,$)))}return R.prototype=this,new R(this)}return d}Hr.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}};Hr.stdSerializers=pm;Hr.stdTimeFunctions=Object.assign({},{nullTime:Pp,epochTime:Op,unixTime:_m,isoTime:Em});function Fn(t,e,r,i){const n=Object.getPrototypeOf(e);e[r]=e.levelVal>e.levels.values[r]?Ls:n[r]?n[r]:qs[r]||qs[i]||Ls,gm(t,e,r)}function gm(t,e,r){!t.transmit&&e[r]===Ls||(e[r]=function(i){return function(){const s=t.timestamp(),a=new Array(arguments.length),c=Object.getPrototypeOf&&Object.getPrototypeOf(this)===qs?qs:this;for(var d=0;d<a.length;d++)a[d]=arguments[d];if(t.serialize&&!t.asObject&&xo(a,this._serialize,this.serializers,this._stdErrSerialize),t.asObject?i.call(c,vm(this,r,a,s)):i.apply(c,a),t.transmit){const u=t.transmit.level||e.level,l=Hr.levels.values[u],g=Hr.levels.values[r];if(g<l)return;ym(this,{ts:s,methodLevel:r,methodValue:g,transmitValue:Hr.levels.values[t.transmit.level||e.level],send:t.transmit.send,val:e.levelVal},a)}}}(e[r]))}function vm(t,e,r,i){t._serialize&&xo(r,t._serialize,t.serializers,t._stdErrSerialize);const n=r.slice();let s=n[0];const a={};i&&(a.time=i),a.level=Hr.levels.values[e];let c=(t._childLevel|0)+1;if(c<1&&(c=1),s!==null&&typeof s=="object"){for(;c--&&typeof n[0]=="object";)Object.assign(a,n.shift());s=n.length?Yh(n.shift(),n):void 0}else typeof s=="string"&&(s=Yh(n.shift(),n));return s!==void 0&&(a.msg=s),a}function xo(t,e,r,i){for(const n in t)if(i&&t[n]instanceof Error)t[n]=Hr.stdSerializers.err(t[n]);else if(typeof t[n]=="object"&&!Array.isArray(t[n]))for(const s in t[n])e&&e.indexOf(s)>-1&&s in r&&(t[n][s]=r[s](t[n][s]))}function Nn(t,e,r){return function(){const i=new Array(1+arguments.length);i[0]=e;for(var n=1;n<i.length;n++)i[n]=arguments[n-1];return t[r].apply(this,i)}}function ym(t,e,r){const i=e.send,n=e.ts,s=e.methodLevel,a=e.methodValue,c=e.val,d=t._logEvent.bindings;xo(r,t._serialize||Object.keys(t.serializers),t.serializers,t._stdErrSerialize===void 0?!0:t._stdErrSerialize),t._logEvent.ts=n,t._logEvent.messages=r.filter(function(u){return d.indexOf(u)===-1}),t._logEvent.level.label=s,t._logEvent.level.value=a,i(s,t._logEvent,c),t._logEvent=bf(d)}function bf(t){return{ts:0,messages:[],bindings:t||[],level:{label:"",value:0}}}function mm(t){const e={type:t.constructor.name,msg:t.message,stack:t.stack};for(const r in t)e[r]===void 0&&(e[r]=t[r]);return e}function wm(t){return typeof t.timestamp=="function"?t.timestamp:t.timestamp===!1?Pp:Op}function Ea(){return{}}function vc(t){return t}function Ls(){}function Pp(){return!1}function Op(){return Date.now()}function _m(){return Math.round(Date.now()/1e3)}function Em(){return new Date(Date.now()).toISOString()}function Sm(){function t(e){return typeof e<"u"&&e}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return t(self)||t(window)||t(this)||{}}}const Zs=M0(Ln),$m={level:"info"},Xs="custom_context",rd=1e3*1024;let xm=class{constructor(e){this.nodeValue=e,this.sizeInBytes=new TextEncoder().encode(this.nodeValue).length,this.next=null}get value(){return this.nodeValue}get size(){return this.sizeInBytes}},Zh=class{constructor(e){this.head=null,this.tail=null,this.lengthInNodes=0,this.maxSizeInBytes=e,this.sizeInBytes=0}append(e){const r=new xm(e);if(r.size>this.maxSizeInBytes)throw new Error(`[LinkedList] Value too big to insert into list: ${e} with size ${r.size}`);for(;this.size+r.size>this.maxSizeInBytes;)this.shift();this.head?(this.tail&&(this.tail.next=r),this.tail=r):(this.head=r,this.tail=r),this.lengthInNodes++,this.sizeInBytes+=r.size}shift(){if(!this.head)return;const e=this.head;this.head=this.head.next,this.head||(this.tail=null),this.lengthInNodes--,this.sizeInBytes-=e.size}toArray(){const e=[];let r=this.head;for(;r!==null;)e.push(r.value),r=r.next;return e}get length(){return this.lengthInNodes}get size(){return this.sizeInBytes}toOrderedArray(){return Array.from(this)}[Symbol.iterator](){let e=this.head;return{next:()=>{if(!e)return{done:!0,value:null};const r=e.value;return e=e.next,{done:!1,value:r}}}}},Rp=class{constructor(e,r=rd){this.level=e??"error",this.levelValue=Ln.levels.values[this.level],this.MAX_LOG_SIZE_IN_BYTES=r,this.logs=new Zh(this.MAX_LOG_SIZE_IN_BYTES)}forwardToConsole(e,r){r===Ln.levels.values.error?console.error(e):r===Ln.levels.values.warn?console.warn(e):r===Ln.levels.values.debug?console.debug(e):r===Ln.levels.values.trace?console.trace(e):console.log(e)}appendToLogs(e){this.logs.append(Cr({timestamp:new Date().toISOString(),log:e}));const r=typeof e=="string"?JSON.parse(e).level:e.level;r>=this.levelValue&&this.forwardToConsole(e,r)}getLogs(){return this.logs}clearLogs(){this.logs=new Zh(this.MAX_LOG_SIZE_IN_BYTES)}getLogArray(){return Array.from(this.logs)}logsToBlob(e){const r=this.getLogArray();return r.push(Cr({extraMetadata:e})),new Blob(r,{type:"application/json"})}},Im=class{constructor(e,r=rd){this.baseChunkLogger=new Rp(e,r)}write(e){this.baseChunkLogger.appendToLogs(e)}getLogs(){return this.baseChunkLogger.getLogs()}clearLogs(){this.baseChunkLogger.clearLogs()}getLogArray(){return this.baseChunkLogger.getLogArray()}logsToBlob(e){return this.baseChunkLogger.logsToBlob(e)}downloadLogsBlobInBrowser(e){const r=URL.createObjectURL(this.logsToBlob(e)),i=document.createElement("a");i.href=r,i.download=`walletconnect-logs-${new Date().toISOString()}.txt`,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(r)}},Mm=class{constructor(e,r=rd){this.baseChunkLogger=new Rp(e,r)}write(e){this.baseChunkLogger.appendToLogs(e)}getLogs(){return this.baseChunkLogger.getLogs()}clearLogs(){this.baseChunkLogger.clearLogs()}getLogArray(){return this.baseChunkLogger.getLogArray()}logsToBlob(e){return this.baseChunkLogger.logsToBlob(e)}};var Am=Object.defineProperty,Pm=Object.defineProperties,Om=Object.getOwnPropertyDescriptors,Xh=Object.getOwnPropertySymbols,Rm=Object.prototype.hasOwnProperty,Fm=Object.prototype.propertyIsEnumerable,Qh=(t,e,r)=>e in t?Am(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Ja=(t,e)=>{for(var r in e||(e={}))Rm.call(e,r)&&Qh(t,r,e[r]);if(Xh)for(var r of Xh(e))Fm.call(e,r)&&Qh(t,r,e[r]);return t},Ya=(t,e)=>Pm(t,Om(e));function Io(t){return Ya(Ja({},t),{level:(t==null?void 0:t.level)||$m.level})}function Nm(t,e=Xs){return t[e]||""}function Cm(t,e,r=Xs){return t[r]=e,t}function Kt(t,e=Xs){let r="";return typeof t.bindings>"u"?r=Nm(t,e):r=t.bindings().context||"",r}function Tm(t,e,r=Xs){const i=Kt(t,r);return i.trim()?`${i}/${e}`:e}function qt(t,e,r=Xs){const i=Tm(t,e,r),n=t.child({context:i});return Cm(n,i,r)}function Bm(t){var e,r;const i=new Im((e=t.opts)==null?void 0:e.level,t.maxSizeInBytes);return{logger:Zs(Ya(Ja({},t.opts),{level:"trace",browser:Ya(Ja({},(r=t.opts)==null?void 0:r.browser),{write:n=>i.write(n)})})),chunkLoggerController:i}}function qm(t){var e;const r=new Mm((e=t.opts)==null?void 0:e.level,t.maxSizeInBytes);return{logger:Zs(Ya(Ja({},t.opts),{level:"trace"}),r),chunkLoggerController:r}}function Lm(t){return typeof t.loggerOverride<"u"&&typeof t.loggerOverride!="string"?{logger:t.loggerOverride,chunkLoggerController:null}:typeof window<"u"?Bm(t):qm(t)}class Dm extends _n{constructor(e){super(),this.opts=e,this.protocol="wc",this.version=2}}let Um=class extends _n{constructor(e,r){super(),this.core=e,this.logger=r,this.records=new Map}};class zm{constructor(e,r){this.logger=e,this.core=r}}let jm=class extends _n{constructor(e,r){super(),this.relayer=e,this.logger=r}},km=class extends _n{constructor(e){super()}},Hm=class{constructor(e,r,i,n){this.core=e,this.logger=r,this.name=i}},Km=class extends _n{constructor(e,r){super(),this.relayer=e,this.logger=r}},Vm=class extends _n{constructor(e,r){super(),this.core=e,this.logger=r}},Wm=class{constructor(e,r,i){this.core=e,this.logger=r,this.store=i}},Gm=class{constructor(e,r){this.projectId=e,this.logger=r}},Jm=class{constructor(e,r,i){this.core=e,this.logger=r,this.telemetryEnabled=i}},Ym=class{constructor(e){this.opts=e,this.protocol="wc",this.version=2}},Zm=class{constructor(e){this.client=e}};function Xm(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function Fp(t,...e){if(!Xm(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error("Uint8Array expected of length "+e+", got length="+t.length)}function eu(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function Qm(t,e){Fp(t);const r=e.outputLen;if(t.length<r)throw new Error("digestInto() expects output buffer of length at least "+r)}const Cn=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */const yc=t=>new DataView(t.buffer,t.byteOffset,t.byteLength);function e8(t){if(typeof t!="string")throw new Error("utf8ToBytes expected string, got "+typeof t);return new Uint8Array(new TextEncoder().encode(t))}function Np(t){return typeof t=="string"&&(t=e8(t)),Fp(t),t}let t8=class{clone(){return this._cloneInto()}};function r8(t){const e=i=>t().update(Np(i)).digest(),r=t();return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=()=>t(),e}function Cp(t=32){if(Cn&&typeof Cn.getRandomValues=="function")return Cn.getRandomValues(new Uint8Array(t));if(Cn&&typeof Cn.randomBytes=="function")return Cn.randomBytes(t);throw new Error("crypto.getRandomValues must be defined")}function i8(t,e,r,i){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,r,i);const n=BigInt(32),s=BigInt(4294967295),a=Number(r>>n&s),c=Number(r&s),d=i?4:0,u=i?0:4;t.setUint32(e+d,a,i),t.setUint32(e+u,c,i)}let n8=class extends t8{constructor(e,r,i,n){super(),this.blockLen=e,this.outputLen=r,this.padOffset=i,this.isLE=n,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=yc(this.buffer)}update(e){eu(this);const{view:r,buffer:i,blockLen:n}=this;e=Np(e);const s=e.length;for(let a=0;a<s;){const c=Math.min(n-this.pos,s-a);if(c===n){const d=yc(e);for(;n<=s-a;a+=n)this.process(d,a);continue}i.set(e.subarray(a,a+c),this.pos),this.pos+=c,a+=c,this.pos===n&&(this.process(r,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){eu(this),Qm(e,this),this.finished=!0;const{buffer:r,view:i,blockLen:n,isLE:s}=this;let{pos:a}=this;r[a++]=128,this.buffer.subarray(a).fill(0),this.padOffset>n-a&&(this.process(i,0),a=0);for(let g=a;g<n;g++)r[g]=0;i8(i,n-8,BigInt(this.length*8),s),this.process(i,0);const c=yc(e),d=this.outputLen;if(d%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const u=d/4,l=this.get();if(u>l.length)throw new Error("_sha2: outputLen bigger than state");for(let g=0;g<u;g++)c.setUint32(4*g,l[g],s)}digest(){const{buffer:e,outputLen:r}=this;this.digestInto(e);const i=e.slice(0,r);return this.destroy(),i}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:r,buffer:i,length:n,finished:s,destroyed:a,pos:c}=this;return e.length=n,e.pos=c,e.finished=s,e.destroyed=a,n%r&&e.buffer.set(i),e}};const Sa=BigInt(2**32-1),gf=BigInt(32);function Tp(t,e=!1){return e?{h:Number(t&Sa),l:Number(t>>gf&Sa)}:{h:Number(t>>gf&Sa)|0,l:Number(t&Sa)|0}}function s8(t,e=!1){let r=new Uint32Array(t.length),i=new Uint32Array(t.length);for(let n=0;n<t.length;n++){const{h:s,l:a}=Tp(t[n],e);[r[n],i[n]]=[s,a]}return[r,i]}const a8=(t,e)=>BigInt(t>>>0)<<gf|BigInt(e>>>0),o8=(t,e,r)=>t>>>r,c8=(t,e,r)=>t<<32-r|e>>>r,f8=(t,e,r)=>t>>>r|e<<32-r,d8=(t,e,r)=>t<<32-r|e>>>r,h8=(t,e,r)=>t<<64-r|e>>>r-32,u8=(t,e,r)=>t>>>r-32|e<<64-r,l8=(t,e)=>e,p8=(t,e)=>t,b8=(t,e,r)=>t<<r|e>>>32-r,g8=(t,e,r)=>e<<r|t>>>32-r,v8=(t,e,r)=>e<<r-32|t>>>64-r,y8=(t,e,r)=>t<<r-32|e>>>64-r;function m8(t,e,r,i){const n=(e>>>0)+(i>>>0);return{h:t+r+(n/2**32|0)|0,l:n|0}}const w8=(t,e,r)=>(t>>>0)+(e>>>0)+(r>>>0),_8=(t,e,r,i)=>e+r+i+(t/2**32|0)|0,E8=(t,e,r,i)=>(t>>>0)+(e>>>0)+(r>>>0)+(i>>>0),S8=(t,e,r,i,n)=>e+r+i+n+(t/2**32|0)|0,$8=(t,e,r,i,n)=>(t>>>0)+(e>>>0)+(r>>>0)+(i>>>0)+(n>>>0),x8=(t,e,r,i,n,s)=>e+r+i+n+s+(t/2**32|0)|0,Be={fromBig:Tp,split:s8,toBig:a8,shrSH:o8,shrSL:c8,rotrSH:f8,rotrSL:d8,rotrBH:h8,rotrBL:u8,rotr32H:l8,rotr32L:p8,rotlSH:b8,rotlSL:g8,rotlBH:v8,rotlBL:y8,add:m8,add3L:w8,add3H:_8,add4L:E8,add4H:S8,add5H:x8,add5L:$8},[I8,M8]=Be.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(t=>BigInt(t))),Ti=new Uint32Array(80),Bi=new Uint32Array(80);let A8=class extends n8{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:e,Al:r,Bh:i,Bl:n,Ch:s,Cl:a,Dh:c,Dl:d,Eh:u,El:l,Fh:g,Fl:w,Gh:E,Gl:$,Hh:I,Hl:M}=this;return[e,r,i,n,s,a,c,d,u,l,g,w,E,$,I,M]}set(e,r,i,n,s,a,c,d,u,l,g,w,E,$,I,M){this.Ah=e|0,this.Al=r|0,this.Bh=i|0,this.Bl=n|0,this.Ch=s|0,this.Cl=a|0,this.Dh=c|0,this.Dl=d|0,this.Eh=u|0,this.El=l|0,this.Fh=g|0,this.Fl=w|0,this.Gh=E|0,this.Gl=$|0,this.Hh=I|0,this.Hl=M|0}process(e,r){for(let R=0;R<16;R++,r+=4)Ti[R]=e.getUint32(r),Bi[R]=e.getUint32(r+=4);for(let R=16;R<80;R++){const C=Ti[R-15]|0,D=Bi[R-15]|0,U=Be.rotrSH(C,D,1)^Be.rotrSH(C,D,8)^Be.shrSH(C,D,7),j=Be.rotrSL(C,D,1)^Be.rotrSL(C,D,8)^Be.shrSL(C,D,7),z=Ti[R-2]|0,q=Bi[R-2]|0,V=Be.rotrSH(z,q,19)^Be.rotrBH(z,q,61)^Be.shrSH(z,q,6),S=Be.rotrSL(z,q,19)^Be.rotrBL(z,q,61)^Be.shrSL(z,q,6),o=Be.add4L(j,S,Bi[R-7],Bi[R-16]),h=Be.add4H(o,U,V,Ti[R-7],Ti[R-16]);Ti[R]=h|0,Bi[R]=o|0}let{Ah:i,Al:n,Bh:s,Bl:a,Ch:c,Cl:d,Dh:u,Dl:l,Eh:g,El:w,Fh:E,Fl:$,Gh:I,Gl:M,Hh:P,Hl:A}=this;for(let R=0;R<80;R++){const C=Be.rotrSH(g,w,14)^Be.rotrSH(g,w,18)^Be.rotrBH(g,w,41),D=Be.rotrSL(g,w,14)^Be.rotrSL(g,w,18)^Be.rotrBL(g,w,41),U=g&E^~g&I,j=w&$^~w&M,z=Be.add5L(A,D,j,M8[R],Bi[R]),q=Be.add5H(z,P,C,U,I8[R],Ti[R]),V=z|0,S=Be.rotrSH(i,n,28)^Be.rotrBH(i,n,34)^Be.rotrBH(i,n,39),o=Be.rotrSL(i,n,28)^Be.rotrBL(i,n,34)^Be.rotrBL(i,n,39),h=i&s^i&c^s&c,y=n&a^n&d^a&d;P=I|0,A=M|0,I=E|0,M=$|0,E=g|0,$=w|0,{h:g,l:w}=Be.add(u|0,l|0,q|0,V|0),u=c|0,l=d|0,c=s|0,d=a|0,s=i|0,a=n|0;const p=Be.add3L(V,o,y);i=Be.add3H(p,q,S,h),n=p|0}({h:i,l:n}=Be.add(this.Ah|0,this.Al|0,i|0,n|0)),{h:s,l:a}=Be.add(this.Bh|0,this.Bl|0,s|0,a|0),{h:c,l:d}=Be.add(this.Ch|0,this.Cl|0,c|0,d|0),{h:u,l}=Be.add(this.Dh|0,this.Dl|0,u|0,l|0),{h:g,l:w}=Be.add(this.Eh|0,this.El|0,g|0,w|0),{h:E,l:$}=Be.add(this.Fh|0,this.Fl|0,E|0,$|0),{h:I,l:M}=Be.add(this.Gh|0,this.Gl|0,I|0,M|0),{h:P,l:A}=Be.add(this.Hh|0,this.Hl|0,P|0,A|0),this.set(i,n,s,a,c,d,u,l,g,w,E,$,I,M,P,A)}roundClean(){Ti.fill(0),Bi.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}};const P8=r8(()=>new A8);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const id=BigInt(0),Bp=BigInt(1),O8=BigInt(2);function nd(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function sd(t){if(!nd(t))throw new Error("Uint8Array expected")}function mc(t,e){if(typeof e!="boolean")throw new Error(t+" boolean expected, got "+e)}const R8=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function ad(t){sd(t);let e="";for(let r=0;r<t.length;r++)e+=R8[t[r]];return e}function qp(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);return t===""?id:BigInt("0x"+t)}const gi={_0:48,_9:57,A:65,F:70,a:97,f:102};function tu(t){if(t>=gi._0&&t<=gi._9)return t-gi._0;if(t>=gi.A&&t<=gi.F)return t-(gi.A-10);if(t>=gi.a&&t<=gi.f)return t-(gi.a-10)}function Lp(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);const e=t.length,r=e/2;if(e%2)throw new Error("hex string expected, got unpadded hex of length "+e);const i=new Uint8Array(r);for(let n=0,s=0;n<r;n++,s+=2){const a=tu(t.charCodeAt(s)),c=tu(t.charCodeAt(s+1));if(a===void 0||c===void 0){const d=t[s]+t[s+1];throw new Error('hex string expected, got non-hex character "'+d+'" at index '+s)}i[n]=a*16+c}return i}function F8(t){return qp(ad(t))}function qa(t){return sd(t),qp(ad(Uint8Array.from(t).reverse()))}function Dp(t,e){return Lp(t.toString(16).padStart(e*2,"0"))}function vf(t,e){return Dp(t,e).reverse()}function vi(t,e,r){let i;if(typeof e=="string")try{i=Lp(e)}catch(s){throw new Error(t+" must be hex string or Uint8Array, cause: "+s)}else if(nd(e))i=Uint8Array.from(e);else throw new Error(t+" must be hex string or Uint8Array");const n=i.length;if(typeof r=="number"&&n!==r)throw new Error(t+" of length "+r+" expected, got "+n);return i}function ru(...t){let e=0;for(let i=0;i<t.length;i++){const n=t[i];sd(n),e+=n.length}const r=new Uint8Array(e);for(let i=0,n=0;i<t.length;i++){const s=t[i];r.set(s,n),n+=s.length}return r}const wc=t=>typeof t=="bigint"&&id<=t;function N8(t,e,r){return wc(t)&&wc(e)&&wc(r)&&e<=t&&t<r}function _s(t,e,r,i){if(!N8(e,r,i))throw new Error("expected valid "+t+": "+r+" <= n < "+i+", got "+e)}function C8(t){let e;for(e=0;t>id;t>>=Bp,e+=1);return e}const T8=t=>(O8<<BigInt(t-1))-Bp,B8={bigint:t=>typeof t=="bigint",function:t=>typeof t=="function",boolean:t=>typeof t=="boolean",string:t=>typeof t=="string",stringOrUint8Array:t=>typeof t=="string"||nd(t),isSafeInteger:t=>Number.isSafeInteger(t),array:t=>Array.isArray(t),field:(t,e)=>e.Fp.isValid(t),hash:t=>typeof t=="function"&&Number.isSafeInteger(t.outputLen)};function od(t,e,r={}){const i=(n,s,a)=>{const c=B8[s];if(typeof c!="function")throw new Error("invalid validator function");const d=t[n];if(!(a&&d===void 0)&&!c(d,t))throw new Error("param "+String(n)+" is invalid. Expected "+s+", got "+d)};for(const[n,s]of Object.entries(e))i(n,s,!1);for(const[n,s]of Object.entries(r))i(n,s,!0);return t}function iu(t){const e=new WeakMap;return(r,...i)=>{const n=e.get(r);if(n!==void 0)return n;const s=t(r,...i);return e.set(r,s),s}}const ut=BigInt(0),it=BigInt(1),ln=BigInt(2),q8=BigInt(3),yf=BigInt(4),nu=BigInt(5),su=BigInt(8);function at(t,e){const r=t%e;return r>=ut?r:e+r}function L8(t,e,r){if(e<ut)throw new Error("invalid exponent, negatives unsupported");if(r<=ut)throw new Error("invalid modulus");if(r===it)return ut;let i=it;for(;e>ut;)e&it&&(i=i*t%r),t=t*t%r,e>>=it;return i}function Dr(t,e,r){let i=t;for(;e-- >ut;)i*=i,i%=r;return i}function au(t,e){if(t===ut)throw new Error("invert: expected non-zero number");if(e<=ut)throw new Error("invert: expected positive modulus, got "+e);let r=at(t,e),i=e,n=ut,s=it;for(;r!==ut;){const a=i/r,c=i%r,d=n-s*a;i=r,r=c,n=s,s=d}if(i!==it)throw new Error("invert: does not exist");return at(n,e)}function D8(t){const e=(t-it)/ln;let r,i,n;for(r=t-it,i=0;r%ln===ut;r/=ln,i++);for(n=ln;n<t&&L8(n,e,t)!==t-it;n++)if(n>1e3)throw new Error("Cannot find square root: likely non-prime P");if(i===1){const a=(t+it)/yf;return function(c,d){const u=c.pow(d,a);if(!c.eql(c.sqr(u),d))throw new Error("Cannot find square root");return u}}const s=(r+it)/ln;return function(a,c){if(a.pow(c,e)===a.neg(a.ONE))throw new Error("Cannot find square root");let d=i,u=a.pow(a.mul(a.ONE,n),r),l=a.pow(c,s),g=a.pow(c,r);for(;!a.eql(g,a.ONE);){if(a.eql(g,a.ZERO))return a.ZERO;let w=1;for(let $=a.sqr(g);w<d&&!a.eql($,a.ONE);w++)$=a.sqr($);const E=a.pow(u,it<<BigInt(d-w-1));u=a.sqr(E),l=a.mul(l,E),g=a.mul(g,u),d=w}return l}}function U8(t){if(t%yf===q8){const e=(t+it)/yf;return function(r,i){const n=r.pow(i,e);if(!r.eql(r.sqr(n),i))throw new Error("Cannot find square root");return n}}if(t%su===nu){const e=(t-nu)/su;return function(r,i){const n=r.mul(i,ln),s=r.pow(n,e),a=r.mul(i,s),c=r.mul(r.mul(a,ln),s),d=r.mul(a,r.sub(c,r.ONE));if(!r.eql(r.sqr(d),i))throw new Error("Cannot find square root");return d}}return D8(t)}const z8=(t,e)=>(at(t,e)&it)===it,j8=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function k8(t){const e={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},r=j8.reduce((i,n)=>(i[n]="function",i),e);return od(t,r)}function H8(t,e,r){if(r<ut)throw new Error("invalid exponent, negatives unsupported");if(r===ut)return t.ONE;if(r===it)return e;let i=t.ONE,n=e;for(;r>ut;)r&it&&(i=t.mul(i,n)),n=t.sqr(n),r>>=it;return i}function K8(t,e){const r=new Array(e.length),i=e.reduce((s,a,c)=>t.is0(a)?s:(r[c]=s,t.mul(s,a)),t.ONE),n=t.inv(i);return e.reduceRight((s,a,c)=>t.is0(a)?s:(r[c]=t.mul(s,r[c]),t.mul(s,a)),n),r}function Up(t,e){const r=e!==void 0?e:t.toString(2).length,i=Math.ceil(r/8);return{nBitLength:r,nByteLength:i}}function zp(t,e,r=!1,i={}){if(t<=ut)throw new Error("invalid field: expected ORDER > 0, got "+t);const{nBitLength:n,nByteLength:s}=Up(t,e);if(s>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let a;const c=Object.freeze({ORDER:t,isLE:r,BITS:n,BYTES:s,MASK:T8(n),ZERO:ut,ONE:it,create:d=>at(d,t),isValid:d=>{if(typeof d!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof d);return ut<=d&&d<t},is0:d=>d===ut,isOdd:d=>(d&it)===it,neg:d=>at(-d,t),eql:(d,u)=>d===u,sqr:d=>at(d*d,t),add:(d,u)=>at(d+u,t),sub:(d,u)=>at(d-u,t),mul:(d,u)=>at(d*u,t),pow:(d,u)=>H8(c,d,u),div:(d,u)=>at(d*au(u,t),t),sqrN:d=>d*d,addN:(d,u)=>d+u,subN:(d,u)=>d-u,mulN:(d,u)=>d*u,inv:d=>au(d,t),sqrt:i.sqrt||(d=>(a||(a=U8(t)),a(c,d))),invertBatch:d=>K8(c,d),cmov:(d,u,l)=>l?u:d,toBytes:d=>r?vf(d,s):Dp(d,s),fromBytes:d=>{if(d.length!==s)throw new Error("Field.fromBytes: expected "+s+" bytes, got "+d.length);return r?qa(d):F8(d)}});return Object.freeze(c)}const ou=BigInt(0),$a=BigInt(1);function _c(t,e){const r=e.negate();return t?r:e}function jp(t,e){if(!Number.isSafeInteger(t)||t<=0||t>e)throw new Error("invalid window size, expected [1.."+e+"], got W="+t)}function Ec(t,e){jp(t,e);const r=Math.ceil(e/t)+1,i=2**(t-1);return{windows:r,windowSize:i}}function V8(t,e){if(!Array.isArray(t))throw new Error("array expected");t.forEach((r,i)=>{if(!(r instanceof e))throw new Error("invalid point at index "+i)})}function W8(t,e){if(!Array.isArray(t))throw new Error("array of scalars expected");t.forEach((r,i)=>{if(!e.isValid(r))throw new Error("invalid scalar at index "+i)})}const Sc=new WeakMap,kp=new WeakMap;function $c(t){return kp.get(t)||1}function G8(t,e){return{constTimeNegate:_c,hasPrecomputes(r){return $c(r)!==1},unsafeLadder(r,i,n=t.ZERO){let s=r;for(;i>ou;)i&$a&&(n=n.add(s)),s=s.double(),i>>=$a;return n},precomputeWindow(r,i){const{windows:n,windowSize:s}=Ec(i,e),a=[];let c=r,d=c;for(let u=0;u<n;u++){d=c,a.push(d);for(let l=1;l<s;l++)d=d.add(c),a.push(d);c=d.double()}return a},wNAF(r,i,n){const{windows:s,windowSize:a}=Ec(r,e);let c=t.ZERO,d=t.BASE;const u=BigInt(2**r-1),l=2**r,g=BigInt(r);for(let w=0;w<s;w++){const E=w*a;let $=Number(n&u);n>>=g,$>a&&($-=l,n+=$a);const I=E,M=E+Math.abs($)-1,P=w%2!==0,A=$<0;$===0?d=d.add(_c(P,i[I])):c=c.add(_c(A,i[M]))}return{p:c,f:d}},wNAFUnsafe(r,i,n,s=t.ZERO){const{windows:a,windowSize:c}=Ec(r,e),d=BigInt(2**r-1),u=2**r,l=BigInt(r);for(let g=0;g<a;g++){const w=g*c;if(n===ou)break;let E=Number(n&d);if(n>>=l,E>c&&(E-=u,n+=$a),E===0)continue;let $=i[w+Math.abs(E)-1];E<0&&($=$.negate()),s=s.add($)}return s},getPrecomputes(r,i,n){let s=Sc.get(i);return s||(s=this.precomputeWindow(i,r),r!==1&&Sc.set(i,n(s))),s},wNAFCached(r,i,n){const s=$c(r);return this.wNAF(s,this.getPrecomputes(s,r,n),i)},wNAFCachedUnsafe(r,i,n,s){const a=$c(r);return a===1?this.unsafeLadder(r,i,s):this.wNAFUnsafe(a,this.getPrecomputes(a,r,n),i,s)},setWindowSize(r,i){jp(i,e),kp.set(r,i),Sc.delete(r)}}}function J8(t,e,r,i){if(V8(r,t),W8(i,e),r.length!==i.length)throw new Error("arrays of points and scalars must have equal length");const n=t.ZERO,s=C8(BigInt(r.length)),a=s>12?s-3:s>4?s-2:s?2:1,c=(1<<a)-1,d=new Array(c+1).fill(n),u=Math.floor((e.BITS-1)/a)*a;let l=n;for(let g=u;g>=0;g-=a){d.fill(n);for(let E=0;E<i.length;E++){const $=i[E],I=Number($>>BigInt(g)&BigInt(c));d[I]=d[I].add(r[E])}let w=n;for(let E=d.length-1,$=n;E>0;E--)$=$.add(d[E]),w=w.add($);if(l=l.add(w),g!==0)for(let E=0;E<a;E++)l=l.double()}return l}function Y8(t){return k8(t.Fp),od(t,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...Up(t.n,t.nBitLength),...t,p:t.Fp.ORDER})}const $r=BigInt(0),Dt=BigInt(1),xa=BigInt(2),Z8=BigInt(8),X8={zip215:!0};function Q8(t){const e=Y8(t);return od(t,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...e})}function e5(t){const e=Q8(t),{Fp:r,n:i,prehash:n,hash:s,randomBytes:a,nByteLength:c,h:d}=e,u=xa<<BigInt(c*8)-Dt,l=r.create,g=zp(e.n,e.nBitLength),w=e.uvRatio||((p,v)=>{try{return{isValid:!0,value:r.sqrt(p*r.inv(v))}}catch{return{isValid:!1,value:$r}}}),E=e.adjustScalarBytes||(p=>p),$=e.domain||((p,v,_)=>{if(mc("phflag",_),v.length||_)throw new Error("Contexts/pre-hash are not supported");return p});function I(p,v){_s("coordinate "+p,v,$r,u)}function M(p){if(!(p instanceof R))throw new Error("ExtendedPoint expected")}const P=iu((p,v)=>{const{ex:_,ey:x,ez:b}=p,f=p.is0();v==null&&(v=f?Z8:r.inv(b));const m=l(_*v),F=l(x*v),N=l(b*v);if(f)return{x:$r,y:Dt};if(N!==Dt)throw new Error("invZ was invalid");return{x:m,y:F}}),A=iu(p=>{const{a:v,d:_}=e;if(p.is0())throw new Error("bad point: ZERO");const{ex:x,ey:b,ez:f,et:m}=p,F=l(x*x),N=l(b*b),T=l(f*f),L=l(T*T),k=l(F*v),W=l(T*l(k+N)),Z=l(L+l(_*l(F*N)));if(W!==Z)throw new Error("bad point: equation left != right (1)");const K=l(x*b),Y=l(f*m);if(K!==Y)throw new Error("bad point: equation left != right (2)");return!0});class R{constructor(v,_,x,b){this.ex=v,this.ey=_,this.ez=x,this.et=b,I("x",v),I("y",_),I("z",x),I("t",b),Object.freeze(this)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(v){if(v instanceof R)throw new Error("extended point not allowed");const{x:_,y:x}=v||{};return I("x",_),I("y",x),new R(_,x,Dt,l(_*x))}static normalizeZ(v){const _=r.invertBatch(v.map(x=>x.ez));return v.map((x,b)=>x.toAffine(_[b])).map(R.fromAffine)}static msm(v,_){return J8(R,g,v,_)}_setWindowSize(v){U.setWindowSize(this,v)}assertValidity(){A(this)}equals(v){M(v);const{ex:_,ey:x,ez:b}=this,{ex:f,ey:m,ez:F}=v,N=l(_*F),T=l(f*b),L=l(x*F),k=l(m*b);return N===T&&L===k}is0(){return this.equals(R.ZERO)}negate(){return new R(l(-this.ex),this.ey,this.ez,l(-this.et))}double(){const{a:v}=e,{ex:_,ey:x,ez:b}=this,f=l(_*_),m=l(x*x),F=l(xa*l(b*b)),N=l(v*f),T=_+x,L=l(l(T*T)-f-m),k=N+m,W=k-F,Z=N-m,K=l(L*W),Y=l(k*Z),ke=l(L*Z),Q=l(W*k);return new R(K,Y,Q,ke)}add(v){M(v);const{a:_,d:x}=e,{ex:b,ey:f,ez:m,et:F}=this,{ex:N,ey:T,ez:L,et:k}=v;if(_===BigInt(-1)){const se=l((f-b)*(T+N)),Vt=l((f+b)*(T-N)),re=l(Vt-se);if(re===$r)return this.double();const ae=l(m*xa*k),Wt=l(F*xa*L),oe=Wt+ae,ce=Vt+se,Gt=Wt-ae,ie=l(oe*re),fe=l(ce*Gt),sr=l(oe*Gt),ee=l(re*ce);return new R(ie,fe,ee,sr)}const W=l(b*N),Z=l(f*T),K=l(F*x*k),Y=l(m*L),ke=l((b+f)*(N+T)-W-Z),Q=Y-K,te=Y+K,At=l(Z-_*W),he=l(ke*Q),ue=l(te*At),wr=l(ke*At),le=l(Q*te);return new R(he,ue,le,wr)}subtract(v){return this.add(v.negate())}wNAF(v){return U.wNAFCached(this,v,R.normalizeZ)}multiply(v){const _=v;_s("scalar",_,Dt,i);const{p:x,f:b}=this.wNAF(_);return R.normalizeZ([x,b])[0]}multiplyUnsafe(v,_=R.ZERO){const x=v;return _s("scalar",x,$r,i),x===$r?D:this.is0()||x===Dt?this:U.wNAFCachedUnsafe(this,x,R.normalizeZ,_)}isSmallOrder(){return this.multiplyUnsafe(d).is0()}isTorsionFree(){return U.unsafeLadder(this,i).is0()}toAffine(v){return P(this,v)}clearCofactor(){const{h:v}=e;return v===Dt?this:this.multiplyUnsafe(v)}static fromHex(v,_=!1){const{d:x,a:b}=e,f=r.BYTES;v=vi("pointHex",v,f),mc("zip215",_);const m=v.slice(),F=v[f-1];m[f-1]=F&-129;const N=qa(m),T=_?u:r.ORDER;_s("pointHex.y",N,$r,T);const L=l(N*N),k=l(L-Dt),W=l(x*L-b);let{isValid:Z,value:K}=w(k,W);if(!Z)throw new Error("Point.fromHex: invalid y coordinate");const Y=(K&Dt)===Dt,ke=(F&128)!==0;if(!_&&K===$r&&ke)throw new Error("Point.fromHex: x=0 and x_0=1");return ke!==Y&&(K=l(-K)),R.fromAffine({x:K,y:N})}static fromPrivateKey(v){return q(v).point}toRawBytes(){const{x:v,y:_}=this.toAffine(),x=vf(_,r.BYTES);return x[x.length-1]|=v&Dt?128:0,x}toHex(){return ad(this.toRawBytes())}}R.BASE=new R(e.Gx,e.Gy,Dt,l(e.Gx*e.Gy)),R.ZERO=new R($r,Dt,Dt,$r);const{BASE:C,ZERO:D}=R,U=G8(R,c*8);function j(p){return at(p,i)}function z(p){return j(qa(p))}function q(p){const v=r.BYTES;p=vi("private key",p,v);const _=vi("hashed private key",s(p),2*v),x=E(_.slice(0,v)),b=_.slice(v,2*v),f=z(x),m=C.multiply(f),F=m.toRawBytes();return{head:x,prefix:b,scalar:f,point:m,pointBytes:F}}function V(p){return q(p).pointBytes}function S(p=new Uint8Array,...v){const _=ru(...v);return z(s($(_,vi("context",p),!!n)))}function o(p,v,_={}){p=vi("message",p),n&&(p=n(p));const{prefix:x,scalar:b,pointBytes:f}=q(v),m=S(_.context,x,p),F=C.multiply(m).toRawBytes(),N=S(_.context,F,f,p),T=j(m+N*b);_s("signature.s",T,$r,i);const L=ru(F,vf(T,r.BYTES));return vi("result",L,r.BYTES*2)}const h=X8;function y(p,v,_,x=h){const{context:b,zip215:f}=x,m=r.BYTES;p=vi("signature",p,2*m),v=vi("message",v),_=vi("publicKey",_,m),f!==void 0&&mc("zip215",f),n&&(v=n(v));const F=qa(p.slice(m,2*m));let N,T,L;try{N=R.fromHex(_,f),T=R.fromHex(p.slice(0,m),f),L=C.multiplyUnsafe(F)}catch{return!1}if(!f&&N.isSmallOrder())return!1;const k=S(b,T.toRawBytes(),N.toRawBytes(),v);return T.add(N.multiplyUnsafe(k)).subtract(L).clearCofactor().equals(R.ZERO)}return C._setWindowSize(8),{CURVE:e,getPublicKey:V,sign:o,verify:y,ExtendedPoint:R,utils:{getExtendedPublicKey:q,randomPrivateKey:()=>a(r.BYTES),precompute(p=8,v=R.BASE){return v._setWindowSize(p),v.multiply(BigInt(3)),v}}}}BigInt(0),BigInt(1);const cd=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),cu=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752");BigInt(0);const t5=BigInt(1),fu=BigInt(2);BigInt(3);const r5=BigInt(5),i5=BigInt(8);function n5(t){const e=BigInt(10),r=BigInt(20),i=BigInt(40),n=BigInt(80),s=cd,a=t*t%s*t%s,c=Dr(a,fu,s)*a%s,d=Dr(c,t5,s)*t%s,u=Dr(d,r5,s)*d%s,l=Dr(u,e,s)*u%s,g=Dr(l,r,s)*l%s,w=Dr(g,i,s)*g%s,E=Dr(w,n,s)*w%s,$=Dr(E,n,s)*w%s,I=Dr($,e,s)*u%s;return{pow_p_5_8:Dr(I,fu,s)*t%s,b2:a}}function s5(t){return t[0]&=248,t[31]&=127,t[31]|=64,t}function a5(t,e){const r=cd,i=at(e*e*e,r),n=at(i*i*e,r),s=n5(t*n).pow_p_5_8;let a=at(t*i*s,r);const c=at(e*a*a,r),d=a,u=at(a*cu,r),l=c===t,g=c===at(-t,r),w=c===at(-t*cu,r);return l&&(a=d),(g||w)&&(a=u),z8(a,r)&&(a=at(-a,r)),{isValid:l||g,value:a}}const o5=zp(cd,void 0,!0),c5={a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:o5,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:i5,Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:P8,randomBytes:Cp,adjustScalarBytes:s5,uvRatio:a5},Hp=e5(c5),f5="EdDSA",d5="JWT",Za=".",Mo="base64url",Kp="utf8",Vp="utf8",h5=":",u5="did",l5="key",du="base58btc",p5="z",b5="K36",g5=32;function fd(t){return globalThis.Buffer!=null?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t}function Wp(t=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?fd(globalThis.Buffer.allocUnsafe(t)):new Uint8Array(t)}function Gp(t,e){e||(e=t.reduce((n,s)=>n+s.length,0));const r=Wp(e);let i=0;for(const n of t)r.set(n,i),i+=n.length;return fd(r)}function v5(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),i=0;i<r.length;i++)r[i]=255;for(var n=0;n<t.length;n++){var s=t.charAt(n),a=s.charCodeAt(0);if(r[a]!==255)throw new TypeError(s+" is ambiguous");r[a]=n}var c=t.length,d=t.charAt(0),u=Math.log(c)/Math.log(256),l=Math.log(256)/Math.log(c);function g($){if($ instanceof Uint8Array||(ArrayBuffer.isView($)?$=new Uint8Array($.buffer,$.byteOffset,$.byteLength):Array.isArray($)&&($=Uint8Array.from($))),!($ instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if($.length===0)return"";for(var I=0,M=0,P=0,A=$.length;P!==A&&$[P]===0;)P++,I++;for(var R=(A-P)*l+1>>>0,C=new Uint8Array(R);P!==A;){for(var D=$[P],U=0,j=R-1;(D!==0||U<M)&&j!==-1;j--,U++)D+=256*C[j]>>>0,C[j]=D%c>>>0,D=D/c>>>0;if(D!==0)throw new Error("Non-zero carry");M=U,P++}for(var z=R-M;z!==R&&C[z]===0;)z++;for(var q=d.repeat(I);z<R;++z)q+=t.charAt(C[z]);return q}function w($){if(typeof $!="string")throw new TypeError("Expected String");if($.length===0)return new Uint8Array;var I=0;if($[I]!==" "){for(var M=0,P=0;$[I]===d;)M++,I++;for(var A=($.length-I)*u+1>>>0,R=new Uint8Array(A);$[I];){var C=r[$.charCodeAt(I)];if(C===255)return;for(var D=0,U=A-1;(C!==0||D<P)&&U!==-1;U--,D++)C+=c*R[U]>>>0,R[U]=C%256>>>0,C=C/256>>>0;if(C!==0)throw new Error("Non-zero carry");P=D,I++}if($[I]!==" "){for(var j=A-P;j!==A&&R[j]===0;)j++;for(var z=new Uint8Array(M+(A-j)),q=M;j!==A;)z[q++]=R[j++];return z}}}function E($){var I=w($);if(I)return I;throw new Error(`Non-${e} character`)}return{encode:g,decodeUnsafe:w,decode:E}}var y5=v5,m5=y5;const Jp=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")},w5=t=>new TextEncoder().encode(t),_5=t=>new TextDecoder().decode(t);let E5=class{constructor(e,r,i){this.name=e,this.prefix=r,this.baseEncode=i}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},S5=class{constructor(e,r,i){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=i}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return Yp(this,e)}},$5=class{constructor(e){this.decoders=e}or(e){return Yp(this,e)}decode(e){const r=e[0],i=this.decoders[r];if(i)return i.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}};const Yp=(t,e)=>new $5({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}});let x5=class{constructor(e,r,i,n){this.name=e,this.prefix=r,this.baseEncode=i,this.baseDecode=n,this.encoder=new E5(e,r,i),this.decoder=new S5(e,r,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}};const Ao=({name:t,prefix:e,encode:r,decode:i})=>new x5(t,e,r,i),Qs=({prefix:t,name:e,alphabet:r})=>{const{encode:i,decode:n}=m5(r,e);return Ao({prefix:t,name:e,encode:i,decode:s=>Jp(n(s))})},I5=(t,e,r,i)=>{const n={};for(let l=0;l<e.length;++l)n[e[l]]=l;let s=t.length;for(;t[s-1]==="=";)--s;const a=new Uint8Array(s*r/8|0);let c=0,d=0,u=0;for(let l=0;l<s;++l){const g=n[t[l]];if(g===void 0)throw new SyntaxError(`Non-${i} character`);d=d<<r|g,c+=r,c>=8&&(c-=8,a[u++]=255&d>>c)}if(c>=r||255&d<<8-c)throw new SyntaxError("Unexpected end of data");return a},M5=(t,e,r)=>{const i=e[e.length-1]==="=",n=(1<<r)-1;let s="",a=0,c=0;for(let d=0;d<t.length;++d)for(c=c<<8|t[d],a+=8;a>r;)a-=r,s+=e[n&c>>a];if(a&&(s+=e[n&c<<r-a]),i)for(;s.length*r&7;)s+="=";return s},xt=({name:t,prefix:e,bitsPerChar:r,alphabet:i})=>Ao({prefix:e,name:t,encode(n){return M5(n,i,r)},decode(n){return I5(n,i,r,t)}}),A5=Ao({prefix:"\0",name:"identity",encode:t=>_5(t),decode:t=>w5(t)});var P5=Object.freeze({__proto__:null,identity:A5});const O5=xt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var R5=Object.freeze({__proto__:null,base2:O5});const F5=xt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var N5=Object.freeze({__proto__:null,base8:F5});const C5=Qs({prefix:"9",name:"base10",alphabet:"0123456789"});var T5=Object.freeze({__proto__:null,base10:C5});const B5=xt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),q5=xt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var L5=Object.freeze({__proto__:null,base16:B5,base16upper:q5});const D5=xt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),U5=xt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),z5=xt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),j5=xt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),k5=xt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),H5=xt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),K5=xt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),V5=xt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),W5=xt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var G5=Object.freeze({__proto__:null,base32:D5,base32upper:U5,base32pad:z5,base32padupper:j5,base32hex:k5,base32hexupper:H5,base32hexpad:K5,base32hexpadupper:V5,base32z:W5});const J5=Qs({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Y5=Qs({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var Z5=Object.freeze({__proto__:null,base36:J5,base36upper:Y5});const X5=Qs({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Q5=Qs({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var e9=Object.freeze({__proto__:null,base58btc:X5,base58flickr:Q5});const t9=xt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),r9=xt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),i9=xt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),n9=xt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var s9=Object.freeze({__proto__:null,base64:t9,base64pad:r9,base64url:i9,base64urlpad:n9});const Zp=Array.from(""),a9=Zp.reduce((t,e,r)=>(t[r]=e,t),[]),o9=Zp.reduce((t,e,r)=>(t[e.codePointAt(0)]=r,t),[]);function c9(t){return t.reduce((e,r)=>(e+=a9[r],e),"")}function f9(t){const e=[];for(const r of t){const i=o9[r.codePointAt(0)];if(i===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(i)}return new Uint8Array(e)}const d9=Ao({prefix:"",name:"base256emoji",encode:c9,decode:f9});var h9=Object.freeze({__proto__:null,base256emoji:d9}),u9=Xp,hu=128,l9=-128,p9=Math.pow(2,31);function Xp(t,e,r){e=e||[],r=r||0;for(var i=r;t>=p9;)e[r++]=t&255|hu,t/=128;for(;t&l9;)e[r++]=t&255|hu,t>>>=7;return e[r]=t|0,Xp.bytes=r-i+1,e}var b9=mf,g9=128,uu=127;function mf(t,i){var r=0,i=i||0,n=0,s=i,a,c=t.length;do{if(s>=c)throw mf.bytes=0,new RangeError("Could not decode varint");a=t[s++],r+=n<28?(a&uu)<<n:(a&uu)*Math.pow(2,n),n+=7}while(a>=g9);return mf.bytes=s-i,r}var v9=Math.pow(2,7),y9=Math.pow(2,14),m9=Math.pow(2,21),w9=Math.pow(2,28),_9=Math.pow(2,35),E9=Math.pow(2,42),S9=Math.pow(2,49),$9=Math.pow(2,56),x9=Math.pow(2,63),I9=function(t){return t<v9?1:t<y9?2:t<m9?3:t<w9?4:t<_9?5:t<E9?6:t<S9?7:t<$9?8:t<x9?9:10},M9={encode:u9,decode:b9,encodingLength:I9},Qp=M9;const lu=(t,e,r=0)=>(Qp.encode(t,e,r),e),pu=t=>Qp.encodingLength(t),wf=(t,e)=>{const r=e.byteLength,i=pu(t),n=i+pu(r),s=new Uint8Array(n+r);return lu(t,s,0),lu(r,s,i),s.set(e,n),new A9(t,r,e,s)};let A9=class{constructor(e,r,i,n){this.code=e,this.size=r,this.digest=i,this.bytes=n}};const e1=({name:t,code:e,encode:r})=>new P9(t,e,r);let P9=class{constructor(e,r,i){this.name=e,this.code=r,this.encode=i}digest(e){if(e instanceof Uint8Array){const r=this.encode(e);return r instanceof Uint8Array?wf(this.code,r):r.then(i=>wf(this.code,i))}else throw Error("Unknown type, must be binary type")}};const t1=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),O9=e1({name:"sha2-256",code:18,encode:t1("SHA-256")}),R9=e1({name:"sha2-512",code:19,encode:t1("SHA-512")});var F9=Object.freeze({__proto__:null,sha256:O9,sha512:R9});const r1=0,N9="identity",i1=Jp,C9=t=>wf(r1,i1(t)),T9={code:r1,name:N9,encode:i1,digest:C9};var B9=Object.freeze({__proto__:null,identity:T9});new TextEncoder,new TextDecoder;const bu={...P5,...R5,...N5,...T5,...L5,...G5,...Z5,...e9,...s9,...h9};({...F9,...B9});function n1(t,e,r,i){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:i}}}const gu=n1("utf8","u",t=>"u"+new TextDecoder("utf8").decode(t),t=>new TextEncoder().encode(t.substring(1))),xc=n1("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);const e=Wp(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),s1={utf8:gu,"utf-8":gu,hex:bu.base16,latin1:xc,ascii:xc,binary:xc,...bu};function Po(t,e="utf8"){const r=s1[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t.buffer,t.byteOffset,t.byteLength).toString("utf8"):r.encoder.encode(t).substring(1)}function fs(t,e="utf8"){const r=s1[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?fd(globalThis.Buffer.from(t,"utf-8")):r.decoder.decode(`${r.prefix}${t}`)}function vu(t){return Vi(Po(fs(t,Mo),Kp))}function Xa(t){return Po(fs(Cr(t),Kp),Mo)}function a1(t){const e=fs(b5,du),r=p5+Po(Gp([e,t]),du);return[u5,l5,r].join(h5)}function q9(t){return Po(t,Mo)}function L9(t){return fs(t,Mo)}function D9(t){return fs([Xa(t.header),Xa(t.payload)].join(Za),Vp)}function U9(t){return[Xa(t.header),Xa(t.payload),q9(t.signature)].join(Za)}function _f(t){const e=t.split(Za),r=vu(e[0]),i=vu(e[1]),n=L9(e[2]),s=fs(e.slice(0,2).join(Za),Vp);return{header:r,payload:i,signature:n,data:s}}function yu(t=Cp(g5)){const e=Hp.getPublicKey(t);return{secretKey:Gp([t,e]),publicKey:e}}async function z9(t,e,r,i,n=G.fromMiliseconds(Date.now())){const s={alg:f5,typ:d5},a=a1(i.publicKey),c=n+r,d={iss:a,sub:t,aud:e,iat:n,exp:c},u=D9({header:s,payload:d}),l=Hp.sign(u,i.secretKey.slice(0,32));return U9({header:s,payload:d,signature:l})}function o1(t=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?globalThis.Buffer.allocUnsafe(t):new Uint8Array(t)}function Ic(t,e){e||(e=t.reduce((n,s)=>n+s.length,0));const r=o1(e);let i=0;for(const n of t)r.set(n,i),i+=n.length;return r}function c1(t,e,r,i){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:i}}}const mu=c1("utf8","u",t=>"u"+new TextDecoder("utf8").decode(t),t=>new TextEncoder().encode(t.substring(1))),Mc=c1("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);const e=o1(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),f1={utf8:mu,"utf-8":mu,hex:ja.base16,latin1:Mc,ascii:Mc,binary:Mc,...ja};function hr(t,e="utf8"){const r=f1[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t,"utf8"):r.decoder.decode(`${r.prefix}${t}`)}function Bt(t,e="utf8"){const r=f1[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t.buffer,t.byteOffset,t.byteLength).toString("utf8"):r.encoder.encode(t).substring(1)}var d1={};const j9="6.6.1",k9={version:j9};var nr={},dd={exports:{}};dd.exports;(function(t){(function(e,r){function i(S,o){if(!S)throw new Error(o||"Assertion failed")}function n(S,o){S.super_=o;var h=function(){};h.prototype=o.prototype,S.prototype=new h,S.prototype.constructor=S}function s(S,o,h){if(s.isBN(S))return S;this.negative=0,this.words=null,this.length=0,this.red=null,S!==null&&((o==="le"||o==="be")&&(h=o,o=10),this._init(S||0,o||10,h||"be"))}typeof e=="object"?e.exports=s:r.BN=s,s.BN=s,s.wordSize=26;var a;try{typeof window<"u"&&typeof window.Buffer<"u"?a=window.Buffer:a=S0.Buffer}catch{}s.isBN=function(o){return o instanceof s?!0:o!==null&&typeof o=="object"&&o.constructor.wordSize===s.wordSize&&Array.isArray(o.words)},s.max=function(o,h){return o.cmp(h)>0?o:h},s.min=function(o,h){return o.cmp(h)<0?o:h},s.prototype._init=function(o,h,y){if(typeof o=="number")return this._initNumber(o,h,y);if(typeof o=="object")return this._initArray(o,h,y);h==="hex"&&(h=16),i(h===(h|0)&&h>=2&&h<=36),o=o.toString().replace(/\s+/g,"");var p=0;o[0]==="-"&&(p++,this.negative=1),p<o.length&&(h===16?this._parseHex(o,p,y):(this._parseBase(o,h,p),y==="le"&&this._initArray(this.toArray(),h,y)))},s.prototype._initNumber=function(o,h,y){o<0&&(this.negative=1,o=-o),o<67108864?(this.words=[o&67108863],this.length=1):o<4503599627370496?(this.words=[o&67108863,o/67108864&67108863],this.length=2):(i(o<9007199254740992),this.words=[o&67108863,o/67108864&67108863,1],this.length=3),y==="le"&&this._initArray(this.toArray(),h,y)},s.prototype._initArray=function(o,h,y){if(i(typeof o.length=="number"),o.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(o.length/3),this.words=new Array(this.length);for(var p=0;p<this.length;p++)this.words[p]=0;var v,_,x=0;if(y==="be")for(p=o.length-1,v=0;p>=0;p-=3)_=o[p]|o[p-1]<<8|o[p-2]<<16,this.words[v]|=_<<x&67108863,this.words[v+1]=_>>>26-x&67108863,x+=24,x>=26&&(x-=26,v++);else if(y==="le")for(p=0,v=0;p<o.length;p+=3)_=o[p]|o[p+1]<<8|o[p+2]<<16,this.words[v]|=_<<x&67108863,this.words[v+1]=_>>>26-x&67108863,x+=24,x>=26&&(x-=26,v++);return this.strip()};function c(S,o){var h=S.charCodeAt(o);return h>=65&&h<=70?h-55:h>=97&&h<=102?h-87:h-48&15}function d(S,o,h){var y=c(S,h);return h-1>=o&&(y|=c(S,h-1)<<4),y}s.prototype._parseHex=function(o,h,y){this.length=Math.ceil((o.length-h)/6),this.words=new Array(this.length);for(var p=0;p<this.length;p++)this.words[p]=0;var v=0,_=0,x;if(y==="be")for(p=o.length-1;p>=h;p-=2)x=d(o,h,p)<<v,this.words[_]|=x&67108863,v>=18?(v-=18,_+=1,this.words[_]|=x>>>26):v+=8;else{var b=o.length-h;for(p=b%2===0?h+1:h;p<o.length;p+=2)x=d(o,h,p)<<v,this.words[_]|=x&67108863,v>=18?(v-=18,_+=1,this.words[_]|=x>>>26):v+=8}this.strip()};function u(S,o,h,y){for(var p=0,v=Math.min(S.length,h),_=o;_<v;_++){var x=S.charCodeAt(_)-48;p*=y,x>=49?p+=x-49+10:x>=17?p+=x-17+10:p+=x}return p}s.prototype._parseBase=function(o,h,y){this.words=[0],this.length=1;for(var p=0,v=1;v<=67108863;v*=h)p++;p--,v=v/h|0;for(var _=o.length-y,x=_%p,b=Math.min(_,_-x)+y,f=0,m=y;m<b;m+=p)f=u(o,m,m+p,h),this.imuln(v),this.words[0]+f<67108864?this.words[0]+=f:this._iaddn(f);if(x!==0){var F=1;for(f=u(o,m,o.length,h),m=0;m<x;m++)F*=h;this.imuln(F),this.words[0]+f<67108864?this.words[0]+=f:this._iaddn(f)}this.strip()},s.prototype.copy=function(o){o.words=new Array(this.length);for(var h=0;h<this.length;h++)o.words[h]=this.words[h];o.length=this.length,o.negative=this.negative,o.red=this.red},s.prototype.clone=function(){var o=new s(null);return this.copy(o),o},s.prototype._expand=function(o){for(;this.length<o;)this.words[this.length++]=0;return this},s.prototype.strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},s.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},s.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var l=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],g=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],w=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];s.prototype.toString=function(o,h){o=o||10,h=h|0||1;var y;if(o===16||o==="hex"){y="";for(var p=0,v=0,_=0;_<this.length;_++){var x=this.words[_],b=((x<<p|v)&16777215).toString(16);v=x>>>24-p&16777215,v!==0||_!==this.length-1?y=l[6-b.length]+b+y:y=b+y,p+=2,p>=26&&(p-=26,_--)}for(v!==0&&(y=v.toString(16)+y);y.length%h!==0;)y="0"+y;return this.negative!==0&&(y="-"+y),y}if(o===(o|0)&&o>=2&&o<=36){var f=g[o],m=w[o];y="";var F=this.clone();for(F.negative=0;!F.isZero();){var N=F.modn(m).toString(o);F=F.idivn(m),F.isZero()?y=N+y:y=l[f-N.length]+N+y}for(this.isZero()&&(y="0"+y);y.length%h!==0;)y="0"+y;return this.negative!==0&&(y="-"+y),y}i(!1,"Base should be between 2 and 36")},s.prototype.toNumber=function(){var o=this.words[0];return this.length===2?o+=this.words[1]*67108864:this.length===3&&this.words[2]===1?o+=4503599627370496+this.words[1]*67108864:this.length>2&&i(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-o:o},s.prototype.toJSON=function(){return this.toString(16)},s.prototype.toBuffer=function(o,h){return i(typeof a<"u"),this.toArrayLike(a,o,h)},s.prototype.toArray=function(o,h){return this.toArrayLike(Array,o,h)},s.prototype.toArrayLike=function(o,h,y){var p=this.byteLength(),v=y||Math.max(1,p);i(p<=v,"byte array longer than desired length"),i(v>0,"Requested array length <= 0"),this.strip();var _=h==="le",x=new o(v),b,f,m=this.clone();if(_){for(f=0;!m.isZero();f++)b=m.andln(255),m.iushrn(8),x[f]=b;for(;f<v;f++)x[f]=0}else{for(f=0;f<v-p;f++)x[f]=0;for(f=0;!m.isZero();f++)b=m.andln(255),m.iushrn(8),x[v-f-1]=b}return x},Math.clz32?s.prototype._countBits=function(o){return 32-Math.clz32(o)}:s.prototype._countBits=function(o){var h=o,y=0;return h>=4096&&(y+=13,h>>>=13),h>=64&&(y+=7,h>>>=7),h>=8&&(y+=4,h>>>=4),h>=2&&(y+=2,h>>>=2),y+h},s.prototype._zeroBits=function(o){if(o===0)return 26;var h=o,y=0;return h&8191||(y+=13,h>>>=13),h&127||(y+=7,h>>>=7),h&15||(y+=4,h>>>=4),h&3||(y+=2,h>>>=2),h&1||y++,y},s.prototype.bitLength=function(){var o=this.words[this.length-1],h=this._countBits(o);return(this.length-1)*26+h};function E(S){for(var o=new Array(S.bitLength()),h=0;h<o.length;h++){var y=h/26|0,p=h%26;o[h]=(S.words[y]&1<<p)>>>p}return o}s.prototype.zeroBits=function(){if(this.isZero())return 0;for(var o=0,h=0;h<this.length;h++){var y=this._zeroBits(this.words[h]);if(o+=y,y!==26)break}return o},s.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},s.prototype.toTwos=function(o){return this.negative!==0?this.abs().inotn(o).iaddn(1):this.clone()},s.prototype.fromTwos=function(o){return this.testn(o-1)?this.notn(o).iaddn(1).ineg():this.clone()},s.prototype.isNeg=function(){return this.negative!==0},s.prototype.neg=function(){return this.clone().ineg()},s.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},s.prototype.iuor=function(o){for(;this.length<o.length;)this.words[this.length++]=0;for(var h=0;h<o.length;h++)this.words[h]=this.words[h]|o.words[h];return this.strip()},s.prototype.ior=function(o){return i((this.negative|o.negative)===0),this.iuor(o)},s.prototype.or=function(o){return this.length>o.length?this.clone().ior(o):o.clone().ior(this)},s.prototype.uor=function(o){return this.length>o.length?this.clone().iuor(o):o.clone().iuor(this)},s.prototype.iuand=function(o){var h;this.length>o.length?h=o:h=this;for(var y=0;y<h.length;y++)this.words[y]=this.words[y]&o.words[y];return this.length=h.length,this.strip()},s.prototype.iand=function(o){return i((this.negative|o.negative)===0),this.iuand(o)},s.prototype.and=function(o){return this.length>o.length?this.clone().iand(o):o.clone().iand(this)},s.prototype.uand=function(o){return this.length>o.length?this.clone().iuand(o):o.clone().iuand(this)},s.prototype.iuxor=function(o){var h,y;this.length>o.length?(h=this,y=o):(h=o,y=this);for(var p=0;p<y.length;p++)this.words[p]=h.words[p]^y.words[p];if(this!==h)for(;p<h.length;p++)this.words[p]=h.words[p];return this.length=h.length,this.strip()},s.prototype.ixor=function(o){return i((this.negative|o.negative)===0),this.iuxor(o)},s.prototype.xor=function(o){return this.length>o.length?this.clone().ixor(o):o.clone().ixor(this)},s.prototype.uxor=function(o){return this.length>o.length?this.clone().iuxor(o):o.clone().iuxor(this)},s.prototype.inotn=function(o){i(typeof o=="number"&&o>=0);var h=Math.ceil(o/26)|0,y=o%26;this._expand(h),y>0&&h--;for(var p=0;p<h;p++)this.words[p]=~this.words[p]&67108863;return y>0&&(this.words[p]=~this.words[p]&67108863>>26-y),this.strip()},s.prototype.notn=function(o){return this.clone().inotn(o)},s.prototype.setn=function(o,h){i(typeof o=="number"&&o>=0);var y=o/26|0,p=o%26;return this._expand(y+1),h?this.words[y]=this.words[y]|1<<p:this.words[y]=this.words[y]&~(1<<p),this.strip()},s.prototype.iadd=function(o){var h;if(this.negative!==0&&o.negative===0)return this.negative=0,h=this.isub(o),this.negative^=1,this._normSign();if(this.negative===0&&o.negative!==0)return o.negative=0,h=this.isub(o),o.negative=1,h._normSign();var y,p;this.length>o.length?(y=this,p=o):(y=o,p=this);for(var v=0,_=0;_<p.length;_++)h=(y.words[_]|0)+(p.words[_]|0)+v,this.words[_]=h&67108863,v=h>>>26;for(;v!==0&&_<y.length;_++)h=(y.words[_]|0)+v,this.words[_]=h&67108863,v=h>>>26;if(this.length=y.length,v!==0)this.words[this.length]=v,this.length++;else if(y!==this)for(;_<y.length;_++)this.words[_]=y.words[_];return this},s.prototype.add=function(o){var h;return o.negative!==0&&this.negative===0?(o.negative=0,h=this.sub(o),o.negative^=1,h):o.negative===0&&this.negative!==0?(this.negative=0,h=o.sub(this),this.negative=1,h):this.length>o.length?this.clone().iadd(o):o.clone().iadd(this)},s.prototype.isub=function(o){if(o.negative!==0){o.negative=0;var h=this.iadd(o);return o.negative=1,h._normSign()}else if(this.negative!==0)return this.negative=0,this.iadd(o),this.negative=1,this._normSign();var y=this.cmp(o);if(y===0)return this.negative=0,this.length=1,this.words[0]=0,this;var p,v;y>0?(p=this,v=o):(p=o,v=this);for(var _=0,x=0;x<v.length;x++)h=(p.words[x]|0)-(v.words[x]|0)+_,_=h>>26,this.words[x]=h&67108863;for(;_!==0&&x<p.length;x++)h=(p.words[x]|0)+_,_=h>>26,this.words[x]=h&67108863;if(_===0&&x<p.length&&p!==this)for(;x<p.length;x++)this.words[x]=p.words[x];return this.length=Math.max(this.length,x),p!==this&&(this.negative=1),this.strip()},s.prototype.sub=function(o){return this.clone().isub(o)};function $(S,o,h){h.negative=o.negative^S.negative;var y=S.length+o.length|0;h.length=y,y=y-1|0;var p=S.words[0]|0,v=o.words[0]|0,_=p*v,x=_&67108863,b=_/67108864|0;h.words[0]=x;for(var f=1;f<y;f++){for(var m=b>>>26,F=b&67108863,N=Math.min(f,o.length-1),T=Math.max(0,f-S.length+1);T<=N;T++){var L=f-T|0;p=S.words[L]|0,v=o.words[T]|0,_=p*v+F,m+=_/67108864|0,F=_&67108863}h.words[f]=F|0,b=m|0}return b!==0?h.words[f]=b|0:h.length--,h.strip()}var I=function(o,h,y){var p=o.words,v=h.words,_=y.words,x=0,b,f,m,F=p[0]|0,N=F&8191,T=F>>>13,L=p[1]|0,k=L&8191,W=L>>>13,Z=p[2]|0,K=Z&8191,Y=Z>>>13,ke=p[3]|0,Q=ke&8191,te=ke>>>13,At=p[4]|0,he=At&8191,ue=At>>>13,wr=p[5]|0,le=wr&8191,se=wr>>>13,Vt=p[6]|0,re=Vt&8191,ae=Vt>>>13,Wt=p[7]|0,oe=Wt&8191,ce=Wt>>>13,Gt=p[8]|0,ie=Gt&8191,fe=Gt>>>13,sr=p[9]|0,ee=sr&8191,me=sr>>>13,Ai=v[0]|0,xe=Ai&8191,we=Ai>>>13,Br=v[1]|0,_e=Br&8191,Ee=Br>>>13,Yi=v[2]|0,de=Yi&8191,Se=Yi>>>13,Zi=v[3]|0,Ie=Zi&8191,be=Zi>>>13,_r=v[4]|0,ge=_r&8191,ve=_r>>>13,Gr=v[5]|0,pe=Gr&8191,Me=Gr>>>13,Xi=v[6]|0,Ae=Xi&8191,Pe=Xi>>>13,Qi=v[7]|0,$e=Qi&8191,ye=Qi>>>13,Jt=v[8]|0,Oe=Jt&8191,Re=Jt>>>13,en=v[9]|0,Fe=en&8191,Ne=en>>>13;y.negative=o.negative^h.negative,y.length=19,b=Math.imul(N,xe),f=Math.imul(N,we),f=f+Math.imul(T,xe)|0,m=Math.imul(T,we);var mt=(x+b|0)+((f&8191)<<13)|0;x=(m+(f>>>13)|0)+(mt>>>26)|0,mt&=67108863,b=Math.imul(k,xe),f=Math.imul(k,we),f=f+Math.imul(W,xe)|0,m=Math.imul(W,we),b=b+Math.imul(N,_e)|0,f=f+Math.imul(N,Ee)|0,f=f+Math.imul(T,_e)|0,m=m+Math.imul(T,Ee)|0;var Jr=(x+b|0)+((f&8191)<<13)|0;x=(m+(f>>>13)|0)+(Jr>>>26)|0,Jr&=67108863,b=Math.imul(K,xe),f=Math.imul(K,we),f=f+Math.imul(Y,xe)|0,m=Math.imul(Y,we),b=b+Math.imul(k,_e)|0,f=f+Math.imul(k,Ee)|0,f=f+Math.imul(W,_e)|0,m=m+Math.imul(W,Ee)|0,b=b+Math.imul(N,de)|0,f=f+Math.imul(N,Se)|0,f=f+Math.imul(T,de)|0,m=m+Math.imul(T,Se)|0;var Yr=(x+b|0)+((f&8191)<<13)|0;x=(m+(f>>>13)|0)+(Yr>>>26)|0,Yr&=67108863,b=Math.imul(Q,xe),f=Math.imul(Q,we),f=f+Math.imul(te,xe)|0,m=Math.imul(te,we),b=b+Math.imul(K,_e)|0,f=f+Math.imul(K,Ee)|0,f=f+Math.imul(Y,_e)|0,m=m+Math.imul(Y,Ee)|0,b=b+Math.imul(k,de)|0,f=f+Math.imul(k,Se)|0,f=f+Math.imul(W,de)|0,m=m+Math.imul(W,Se)|0,b=b+Math.imul(N,Ie)|0,f=f+Math.imul(N,be)|0,f=f+Math.imul(T,Ie)|0,m=m+Math.imul(T,be)|0;var Zr=(x+b|0)+((f&8191)<<13)|0;x=(m+(f>>>13)|0)+(Zr>>>26)|0,Zr&=67108863,b=Math.imul(he,xe),f=Math.imul(he,we),f=f+Math.imul(ue,xe)|0,m=Math.imul(ue,we),b=b+Math.imul(Q,_e)|0,f=f+Math.imul(Q,Ee)|0,f=f+Math.imul(te,_e)|0,m=m+Math.imul(te,Ee)|0,b=b+Math.imul(K,de)|0,f=f+Math.imul(K,Se)|0,f=f+Math.imul(Y,de)|0,m=m+Math.imul(Y,Se)|0,b=b+Math.imul(k,Ie)|0,f=f+Math.imul(k,be)|0,f=f+Math.imul(W,Ie)|0,m=m+Math.imul(W,be)|0,b=b+Math.imul(N,ge)|0,f=f+Math.imul(N,ve)|0,f=f+Math.imul(T,ge)|0,m=m+Math.imul(T,ve)|0;var Xr=(x+b|0)+((f&8191)<<13)|0;x=(m+(f>>>13)|0)+(Xr>>>26)|0,Xr&=67108863,b=Math.imul(le,xe),f=Math.imul(le,we),f=f+Math.imul(se,xe)|0,m=Math.imul(se,we),b=b+Math.imul(he,_e)|0,f=f+Math.imul(he,Ee)|0,f=f+Math.imul(ue,_e)|0,m=m+Math.imul(ue,Ee)|0,b=b+Math.imul(Q,de)|0,f=f+Math.imul(Q,Se)|0,f=f+Math.imul(te,de)|0,m=m+Math.imul(te,Se)|0,b=b+Math.imul(K,Ie)|0,f=f+Math.imul(K,be)|0,f=f+Math.imul(Y,Ie)|0,m=m+Math.imul(Y,be)|0,b=b+Math.imul(k,ge)|0,f=f+Math.imul(k,ve)|0,f=f+Math.imul(W,ge)|0,m=m+Math.imul(W,ve)|0,b=b+Math.imul(N,pe)|0,f=f+Math.imul(N,Me)|0,f=f+Math.imul(T,pe)|0,m=m+Math.imul(T,Me)|0;var Qr=(x+b|0)+((f&8191)<<13)|0;x=(m+(f>>>13)|0)+(Qr>>>26)|0,Qr&=67108863,b=Math.imul(re,xe),f=Math.imul(re,we),f=f+Math.imul(ae,xe)|0,m=Math.imul(ae,we),b=b+Math.imul(le,_e)|0,f=f+Math.imul(le,Ee)|0,f=f+Math.imul(se,_e)|0,m=m+Math.imul(se,Ee)|0,b=b+Math.imul(he,de)|0,f=f+Math.imul(he,Se)|0,f=f+Math.imul(ue,de)|0,m=m+Math.imul(ue,Se)|0,b=b+Math.imul(Q,Ie)|0,f=f+Math.imul(Q,be)|0,f=f+Math.imul(te,Ie)|0,m=m+Math.imul(te,be)|0,b=b+Math.imul(K,ge)|0,f=f+Math.imul(K,ve)|0,f=f+Math.imul(Y,ge)|0,m=m+Math.imul(Y,ve)|0,b=b+Math.imul(k,pe)|0,f=f+Math.imul(k,Me)|0,f=f+Math.imul(W,pe)|0,m=m+Math.imul(W,Me)|0,b=b+Math.imul(N,Ae)|0,f=f+Math.imul(N,Pe)|0,f=f+Math.imul(T,Ae)|0,m=m+Math.imul(T,Pe)|0;var Ct=(x+b|0)+((f&8191)<<13)|0;x=(m+(f>>>13)|0)+(Ct>>>26)|0,Ct&=67108863,b=Math.imul(oe,xe),f=Math.imul(oe,we),f=f+Math.imul(ce,xe)|0,m=Math.imul(ce,we),b=b+Math.imul(re,_e)|0,f=f+Math.imul(re,Ee)|0,f=f+Math.imul(ae,_e)|0,m=m+Math.imul(ae,Ee)|0,b=b+Math.imul(le,de)|0,f=f+Math.imul(le,Se)|0,f=f+Math.imul(se,de)|0,m=m+Math.imul(se,Se)|0,b=b+Math.imul(he,Ie)|0,f=f+Math.imul(he,be)|0,f=f+Math.imul(ue,Ie)|0,m=m+Math.imul(ue,be)|0,b=b+Math.imul(Q,ge)|0,f=f+Math.imul(Q,ve)|0,f=f+Math.imul(te,ge)|0,m=m+Math.imul(te,ve)|0,b=b+Math.imul(K,pe)|0,f=f+Math.imul(K,Me)|0,f=f+Math.imul(Y,pe)|0,m=m+Math.imul(Y,Me)|0,b=b+Math.imul(k,Ae)|0,f=f+Math.imul(k,Pe)|0,f=f+Math.imul(W,Ae)|0,m=m+Math.imul(W,Pe)|0,b=b+Math.imul(N,$e)|0,f=f+Math.imul(N,ye)|0,f=f+Math.imul(T,$e)|0,m=m+Math.imul(T,ye)|0;var ei=(x+b|0)+((f&8191)<<13)|0;x=(m+(f>>>13)|0)+(ei>>>26)|0,ei&=67108863,b=Math.imul(ie,xe),f=Math.imul(ie,we),f=f+Math.imul(fe,xe)|0,m=Math.imul(fe,we),b=b+Math.imul(oe,_e)|0,f=f+Math.imul(oe,Ee)|0,f=f+Math.imul(ce,_e)|0,m=m+Math.imul(ce,Ee)|0,b=b+Math.imul(re,de)|0,f=f+Math.imul(re,Se)|0,f=f+Math.imul(ae,de)|0,m=m+Math.imul(ae,Se)|0,b=b+Math.imul(le,Ie)|0,f=f+Math.imul(le,be)|0,f=f+Math.imul(se,Ie)|0,m=m+Math.imul(se,be)|0,b=b+Math.imul(he,ge)|0,f=f+Math.imul(he,ve)|0,f=f+Math.imul(ue,ge)|0,m=m+Math.imul(ue,ve)|0,b=b+Math.imul(Q,pe)|0,f=f+Math.imul(Q,Me)|0,f=f+Math.imul(te,pe)|0,m=m+Math.imul(te,Me)|0,b=b+Math.imul(K,Ae)|0,f=f+Math.imul(K,Pe)|0,f=f+Math.imul(Y,Ae)|0,m=m+Math.imul(Y,Pe)|0,b=b+Math.imul(k,$e)|0,f=f+Math.imul(k,ye)|0,f=f+Math.imul(W,$e)|0,m=m+Math.imul(W,ye)|0,b=b+Math.imul(N,Oe)|0,f=f+Math.imul(N,Re)|0,f=f+Math.imul(T,Oe)|0,m=m+Math.imul(T,Re)|0;var ti=(x+b|0)+((f&8191)<<13)|0;x=(m+(f>>>13)|0)+(ti>>>26)|0,ti&=67108863,b=Math.imul(ee,xe),f=Math.imul(ee,we),f=f+Math.imul(me,xe)|0,m=Math.imul(me,we),b=b+Math.imul(ie,_e)|0,f=f+Math.imul(ie,Ee)|0,f=f+Math.imul(fe,_e)|0,m=m+Math.imul(fe,Ee)|0,b=b+Math.imul(oe,de)|0,f=f+Math.imul(oe,Se)|0,f=f+Math.imul(ce,de)|0,m=m+Math.imul(ce,Se)|0,b=b+Math.imul(re,Ie)|0,f=f+Math.imul(re,be)|0,f=f+Math.imul(ae,Ie)|0,m=m+Math.imul(ae,be)|0,b=b+Math.imul(le,ge)|0,f=f+Math.imul(le,ve)|0,f=f+Math.imul(se,ge)|0,m=m+Math.imul(se,ve)|0,b=b+Math.imul(he,pe)|0,f=f+Math.imul(he,Me)|0,f=f+Math.imul(ue,pe)|0,m=m+Math.imul(ue,Me)|0,b=b+Math.imul(Q,Ae)|0,f=f+Math.imul(Q,Pe)|0,f=f+Math.imul(te,Ae)|0,m=m+Math.imul(te,Pe)|0,b=b+Math.imul(K,$e)|0,f=f+Math.imul(K,ye)|0,f=f+Math.imul(Y,$e)|0,m=m+Math.imul(Y,ye)|0,b=b+Math.imul(k,Oe)|0,f=f+Math.imul(k,Re)|0,f=f+Math.imul(W,Oe)|0,m=m+Math.imul(W,Re)|0,b=b+Math.imul(N,Fe)|0,f=f+Math.imul(N,Ne)|0,f=f+Math.imul(T,Fe)|0,m=m+Math.imul(T,Ne)|0;var ri=(x+b|0)+((f&8191)<<13)|0;x=(m+(f>>>13)|0)+(ri>>>26)|0,ri&=67108863,b=Math.imul(ee,_e),f=Math.imul(ee,Ee),f=f+Math.imul(me,_e)|0,m=Math.imul(me,Ee),b=b+Math.imul(ie,de)|0,f=f+Math.imul(ie,Se)|0,f=f+Math.imul(fe,de)|0,m=m+Math.imul(fe,Se)|0,b=b+Math.imul(oe,Ie)|0,f=f+Math.imul(oe,be)|0,f=f+Math.imul(ce,Ie)|0,m=m+Math.imul(ce,be)|0,b=b+Math.imul(re,ge)|0,f=f+Math.imul(re,ve)|0,f=f+Math.imul(ae,ge)|0,m=m+Math.imul(ae,ve)|0,b=b+Math.imul(le,pe)|0,f=f+Math.imul(le,Me)|0,f=f+Math.imul(se,pe)|0,m=m+Math.imul(se,Me)|0,b=b+Math.imul(he,Ae)|0,f=f+Math.imul(he,Pe)|0,f=f+Math.imul(ue,Ae)|0,m=m+Math.imul(ue,Pe)|0,b=b+Math.imul(Q,$e)|0,f=f+Math.imul(Q,ye)|0,f=f+Math.imul(te,$e)|0,m=m+Math.imul(te,ye)|0,b=b+Math.imul(K,Oe)|0,f=f+Math.imul(K,Re)|0,f=f+Math.imul(Y,Oe)|0,m=m+Math.imul(Y,Re)|0,b=b+Math.imul(k,Fe)|0,f=f+Math.imul(k,Ne)|0,f=f+Math.imul(W,Fe)|0,m=m+Math.imul(W,Ne)|0;var ii=(x+b|0)+((f&8191)<<13)|0;x=(m+(f>>>13)|0)+(ii>>>26)|0,ii&=67108863,b=Math.imul(ee,de),f=Math.imul(ee,Se),f=f+Math.imul(me,de)|0,m=Math.imul(me,Se),b=b+Math.imul(ie,Ie)|0,f=f+Math.imul(ie,be)|0,f=f+Math.imul(fe,Ie)|0,m=m+Math.imul(fe,be)|0,b=b+Math.imul(oe,ge)|0,f=f+Math.imul(oe,ve)|0,f=f+Math.imul(ce,ge)|0,m=m+Math.imul(ce,ve)|0,b=b+Math.imul(re,pe)|0,f=f+Math.imul(re,Me)|0,f=f+Math.imul(ae,pe)|0,m=m+Math.imul(ae,Me)|0,b=b+Math.imul(le,Ae)|0,f=f+Math.imul(le,Pe)|0,f=f+Math.imul(se,Ae)|0,m=m+Math.imul(se,Pe)|0,b=b+Math.imul(he,$e)|0,f=f+Math.imul(he,ye)|0,f=f+Math.imul(ue,$e)|0,m=m+Math.imul(ue,ye)|0,b=b+Math.imul(Q,Oe)|0,f=f+Math.imul(Q,Re)|0,f=f+Math.imul(te,Oe)|0,m=m+Math.imul(te,Re)|0,b=b+Math.imul(K,Fe)|0,f=f+Math.imul(K,Ne)|0,f=f+Math.imul(Y,Fe)|0,m=m+Math.imul(Y,Ne)|0;var ni=(x+b|0)+((f&8191)<<13)|0;x=(m+(f>>>13)|0)+(ni>>>26)|0,ni&=67108863,b=Math.imul(ee,Ie),f=Math.imul(ee,be),f=f+Math.imul(me,Ie)|0,m=Math.imul(me,be),b=b+Math.imul(ie,ge)|0,f=f+Math.imul(ie,ve)|0,f=f+Math.imul(fe,ge)|0,m=m+Math.imul(fe,ve)|0,b=b+Math.imul(oe,pe)|0,f=f+Math.imul(oe,Me)|0,f=f+Math.imul(ce,pe)|0,m=m+Math.imul(ce,Me)|0,b=b+Math.imul(re,Ae)|0,f=f+Math.imul(re,Pe)|0,f=f+Math.imul(ae,Ae)|0,m=m+Math.imul(ae,Pe)|0,b=b+Math.imul(le,$e)|0,f=f+Math.imul(le,ye)|0,f=f+Math.imul(se,$e)|0,m=m+Math.imul(se,ye)|0,b=b+Math.imul(he,Oe)|0,f=f+Math.imul(he,Re)|0,f=f+Math.imul(ue,Oe)|0,m=m+Math.imul(ue,Re)|0,b=b+Math.imul(Q,Fe)|0,f=f+Math.imul(Q,Ne)|0,f=f+Math.imul(te,Fe)|0,m=m+Math.imul(te,Ne)|0;var ar=(x+b|0)+((f&8191)<<13)|0;x=(m+(f>>>13)|0)+(ar>>>26)|0,ar&=67108863,b=Math.imul(ee,ge),f=Math.imul(ee,ve),f=f+Math.imul(me,ge)|0,m=Math.imul(me,ve),b=b+Math.imul(ie,pe)|0,f=f+Math.imul(ie,Me)|0,f=f+Math.imul(fe,pe)|0,m=m+Math.imul(fe,Me)|0,b=b+Math.imul(oe,Ae)|0,f=f+Math.imul(oe,Pe)|0,f=f+Math.imul(ce,Ae)|0,m=m+Math.imul(ce,Pe)|0,b=b+Math.imul(re,$e)|0,f=f+Math.imul(re,ye)|0,f=f+Math.imul(ae,$e)|0,m=m+Math.imul(ae,ye)|0,b=b+Math.imul(le,Oe)|0,f=f+Math.imul(le,Re)|0,f=f+Math.imul(se,Oe)|0,m=m+Math.imul(se,Re)|0,b=b+Math.imul(he,Fe)|0,f=f+Math.imul(he,Ne)|0,f=f+Math.imul(ue,Fe)|0,m=m+Math.imul(ue,Ne)|0;var si=(x+b|0)+((f&8191)<<13)|0;x=(m+(f>>>13)|0)+(si>>>26)|0,si&=67108863,b=Math.imul(ee,pe),f=Math.imul(ee,Me),f=f+Math.imul(me,pe)|0,m=Math.imul(me,Me),b=b+Math.imul(ie,Ae)|0,f=f+Math.imul(ie,Pe)|0,f=f+Math.imul(fe,Ae)|0,m=m+Math.imul(fe,Pe)|0,b=b+Math.imul(oe,$e)|0,f=f+Math.imul(oe,ye)|0,f=f+Math.imul(ce,$e)|0,m=m+Math.imul(ce,ye)|0,b=b+Math.imul(re,Oe)|0,f=f+Math.imul(re,Re)|0,f=f+Math.imul(ae,Oe)|0,m=m+Math.imul(ae,Re)|0,b=b+Math.imul(le,Fe)|0,f=f+Math.imul(le,Ne)|0,f=f+Math.imul(se,Fe)|0,m=m+Math.imul(se,Ne)|0;var ai=(x+b|0)+((f&8191)<<13)|0;x=(m+(f>>>13)|0)+(ai>>>26)|0,ai&=67108863,b=Math.imul(ee,Ae),f=Math.imul(ee,Pe),f=f+Math.imul(me,Ae)|0,m=Math.imul(me,Pe),b=b+Math.imul(ie,$e)|0,f=f+Math.imul(ie,ye)|0,f=f+Math.imul(fe,$e)|0,m=m+Math.imul(fe,ye)|0,b=b+Math.imul(oe,Oe)|0,f=f+Math.imul(oe,Re)|0,f=f+Math.imul(ce,Oe)|0,m=m+Math.imul(ce,Re)|0,b=b+Math.imul(re,Fe)|0,f=f+Math.imul(re,Ne)|0,f=f+Math.imul(ae,Fe)|0,m=m+Math.imul(ae,Ne)|0;var Pt=(x+b|0)+((f&8191)<<13)|0;x=(m+(f>>>13)|0)+(Pt>>>26)|0,Pt&=67108863,b=Math.imul(ee,$e),f=Math.imul(ee,ye),f=f+Math.imul(me,$e)|0,m=Math.imul(me,ye),b=b+Math.imul(ie,Oe)|0,f=f+Math.imul(ie,Re)|0,f=f+Math.imul(fe,Oe)|0,m=m+Math.imul(fe,Re)|0,b=b+Math.imul(oe,Fe)|0,f=f+Math.imul(oe,Ne)|0,f=f+Math.imul(ce,Fe)|0,m=m+Math.imul(ce,Ne)|0;var oi=(x+b|0)+((f&8191)<<13)|0;x=(m+(f>>>13)|0)+(oi>>>26)|0,oi&=67108863,b=Math.imul(ee,Oe),f=Math.imul(ee,Re),f=f+Math.imul(me,Oe)|0,m=Math.imul(me,Re),b=b+Math.imul(ie,Fe)|0,f=f+Math.imul(ie,Ne)|0,f=f+Math.imul(fe,Fe)|0,m=m+Math.imul(fe,Ne)|0;var ci=(x+b|0)+((f&8191)<<13)|0;x=(m+(f>>>13)|0)+(ci>>>26)|0,ci&=67108863,b=Math.imul(ee,Fe),f=Math.imul(ee,Ne),f=f+Math.imul(me,Fe)|0,m=Math.imul(me,Ne);var fi=(x+b|0)+((f&8191)<<13)|0;return x=(m+(f>>>13)|0)+(fi>>>26)|0,fi&=67108863,_[0]=mt,_[1]=Jr,_[2]=Yr,_[3]=Zr,_[4]=Xr,_[5]=Qr,_[6]=Ct,_[7]=ei,_[8]=ti,_[9]=ri,_[10]=ii,_[11]=ni,_[12]=ar,_[13]=si,_[14]=ai,_[15]=Pt,_[16]=oi,_[17]=ci,_[18]=fi,x!==0&&(_[19]=x,y.length++),y};Math.imul||(I=$);function M(S,o,h){h.negative=o.negative^S.negative,h.length=S.length+o.length;for(var y=0,p=0,v=0;v<h.length-1;v++){var _=p;p=0;for(var x=y&67108863,b=Math.min(v,o.length-1),f=Math.max(0,v-S.length+1);f<=b;f++){var m=v-f,F=S.words[m]|0,N=o.words[f]|0,T=F*N,L=T&67108863;_=_+(T/67108864|0)|0,L=L+x|0,x=L&67108863,_=_+(L>>>26)|0,p+=_>>>26,_&=67108863}h.words[v]=x,y=_,_=p}return y!==0?h.words[v]=y:h.length--,h.strip()}function P(S,o,h){var y=new A;return y.mulp(S,o,h)}s.prototype.mulTo=function(o,h){var y,p=this.length+o.length;return this.length===10&&o.length===10?y=I(this,o,h):p<63?y=$(this,o,h):p<1024?y=M(this,o,h):y=P(this,o,h),y};function A(S,o){this.x=S,this.y=o}A.prototype.makeRBT=function(o){for(var h=new Array(o),y=s.prototype._countBits(o)-1,p=0;p<o;p++)h[p]=this.revBin(p,y,o);return h},A.prototype.revBin=function(o,h,y){if(o===0||o===y-1)return o;for(var p=0,v=0;v<h;v++)p|=(o&1)<<h-v-1,o>>=1;return p},A.prototype.permute=function(o,h,y,p,v,_){for(var x=0;x<_;x++)p[x]=h[o[x]],v[x]=y[o[x]]},A.prototype.transform=function(o,h,y,p,v,_){this.permute(_,o,h,y,p,v);for(var x=1;x<v;x<<=1)for(var b=x<<1,f=Math.cos(2*Math.PI/b),m=Math.sin(2*Math.PI/b),F=0;F<v;F+=b)for(var N=f,T=m,L=0;L<x;L++){var k=y[F+L],W=p[F+L],Z=y[F+L+x],K=p[F+L+x],Y=N*Z-T*K;K=N*K+T*Z,Z=Y,y[F+L]=k+Z,p[F+L]=W+K,y[F+L+x]=k-Z,p[F+L+x]=W-K,L!==b&&(Y=f*N-m*T,T=f*T+m*N,N=Y)}},A.prototype.guessLen13b=function(o,h){var y=Math.max(h,o)|1,p=y&1,v=0;for(y=y/2|0;y;y=y>>>1)v++;return 1<<v+1+p},A.prototype.conjugate=function(o,h,y){if(!(y<=1))for(var p=0;p<y/2;p++){var v=o[p];o[p]=o[y-p-1],o[y-p-1]=v,v=h[p],h[p]=-h[y-p-1],h[y-p-1]=-v}},A.prototype.normalize13b=function(o,h){for(var y=0,p=0;p<h/2;p++){var v=Math.round(o[2*p+1]/h)*8192+Math.round(o[2*p]/h)+y;o[p]=v&67108863,v<67108864?y=0:y=v/67108864|0}return o},A.prototype.convert13b=function(o,h,y,p){for(var v=0,_=0;_<h;_++)v=v+(o[_]|0),y[2*_]=v&8191,v=v>>>13,y[2*_+1]=v&8191,v=v>>>13;for(_=2*h;_<p;++_)y[_]=0;i(v===0),i((v&-8192)===0)},A.prototype.stub=function(o){for(var h=new Array(o),y=0;y<o;y++)h[y]=0;return h},A.prototype.mulp=function(o,h,y){var p=2*this.guessLen13b(o.length,h.length),v=this.makeRBT(p),_=this.stub(p),x=new Array(p),b=new Array(p),f=new Array(p),m=new Array(p),F=new Array(p),N=new Array(p),T=y.words;T.length=p,this.convert13b(o.words,o.length,x,p),this.convert13b(h.words,h.length,m,p),this.transform(x,_,b,f,p,v),this.transform(m,_,F,N,p,v);for(var L=0;L<p;L++){var k=b[L]*F[L]-f[L]*N[L];f[L]=b[L]*N[L]+f[L]*F[L],b[L]=k}return this.conjugate(b,f,p),this.transform(b,f,T,_,p,v),this.conjugate(T,_,p),this.normalize13b(T,p),y.negative=o.negative^h.negative,y.length=o.length+h.length,y.strip()},s.prototype.mul=function(o){var h=new s(null);return h.words=new Array(this.length+o.length),this.mulTo(o,h)},s.prototype.mulf=function(o){var h=new s(null);return h.words=new Array(this.length+o.length),P(this,o,h)},s.prototype.imul=function(o){return this.clone().mulTo(o,this)},s.prototype.imuln=function(o){i(typeof o=="number"),i(o<67108864);for(var h=0,y=0;y<this.length;y++){var p=(this.words[y]|0)*o,v=(p&67108863)+(h&67108863);h>>=26,h+=p/67108864|0,h+=v>>>26,this.words[y]=v&67108863}return h!==0&&(this.words[y]=h,this.length++),this},s.prototype.muln=function(o){return this.clone().imuln(o)},s.prototype.sqr=function(){return this.mul(this)},s.prototype.isqr=function(){return this.imul(this.clone())},s.prototype.pow=function(o){var h=E(o);if(h.length===0)return new s(1);for(var y=this,p=0;p<h.length&&h[p]===0;p++,y=y.sqr());if(++p<h.length)for(var v=y.sqr();p<h.length;p++,v=v.sqr())h[p]!==0&&(y=y.mul(v));return y},s.prototype.iushln=function(o){i(typeof o=="number"&&o>=0);var h=o%26,y=(o-h)/26,p=67108863>>>26-h<<26-h,v;if(h!==0){var _=0;for(v=0;v<this.length;v++){var x=this.words[v]&p,b=(this.words[v]|0)-x<<h;this.words[v]=b|_,_=x>>>26-h}_&&(this.words[v]=_,this.length++)}if(y!==0){for(v=this.length-1;v>=0;v--)this.words[v+y]=this.words[v];for(v=0;v<y;v++)this.words[v]=0;this.length+=y}return this.strip()},s.prototype.ishln=function(o){return i(this.negative===0),this.iushln(o)},s.prototype.iushrn=function(o,h,y){i(typeof o=="number"&&o>=0);var p;h?p=(h-h%26)/26:p=0;var v=o%26,_=Math.min((o-v)/26,this.length),x=67108863^67108863>>>v<<v,b=y;if(p-=_,p=Math.max(0,p),b){for(var f=0;f<_;f++)b.words[f]=this.words[f];b.length=_}if(_!==0)if(this.length>_)for(this.length-=_,f=0;f<this.length;f++)this.words[f]=this.words[f+_];else this.words[0]=0,this.length=1;var m=0;for(f=this.length-1;f>=0&&(m!==0||f>=p);f--){var F=this.words[f]|0;this.words[f]=m<<26-v|F>>>v,m=F&x}return b&&m!==0&&(b.words[b.length++]=m),this.length===0&&(this.words[0]=0,this.length=1),this.strip()},s.prototype.ishrn=function(o,h,y){return i(this.negative===0),this.iushrn(o,h,y)},s.prototype.shln=function(o){return this.clone().ishln(o)},s.prototype.ushln=function(o){return this.clone().iushln(o)},s.prototype.shrn=function(o){return this.clone().ishrn(o)},s.prototype.ushrn=function(o){return this.clone().iushrn(o)},s.prototype.testn=function(o){i(typeof o=="number"&&o>=0);var h=o%26,y=(o-h)/26,p=1<<h;if(this.length<=y)return!1;var v=this.words[y];return!!(v&p)},s.prototype.imaskn=function(o){i(typeof o=="number"&&o>=0);var h=o%26,y=(o-h)/26;if(i(this.negative===0,"imaskn works only with positive numbers"),this.length<=y)return this;if(h!==0&&y++,this.length=Math.min(y,this.length),h!==0){var p=67108863^67108863>>>h<<h;this.words[this.length-1]&=p}return this.strip()},s.prototype.maskn=function(o){return this.clone().imaskn(o)},s.prototype.iaddn=function(o){return i(typeof o=="number"),i(o<67108864),o<0?this.isubn(-o):this.negative!==0?this.length===1&&(this.words[0]|0)<o?(this.words[0]=o-(this.words[0]|0),this.negative=0,this):(this.negative=0,this.isubn(o),this.negative=1,this):this._iaddn(o)},s.prototype._iaddn=function(o){this.words[0]+=o;for(var h=0;h<this.length&&this.words[h]>=67108864;h++)this.words[h]-=67108864,h===this.length-1?this.words[h+1]=1:this.words[h+1]++;return this.length=Math.max(this.length,h+1),this},s.prototype.isubn=function(o){if(i(typeof o=="number"),i(o<67108864),o<0)return this.iaddn(-o);if(this.negative!==0)return this.negative=0,this.iaddn(o),this.negative=1,this;if(this.words[0]-=o,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var h=0;h<this.length&&this.words[h]<0;h++)this.words[h]+=67108864,this.words[h+1]-=1;return this.strip()},s.prototype.addn=function(o){return this.clone().iaddn(o)},s.prototype.subn=function(o){return this.clone().isubn(o)},s.prototype.iabs=function(){return this.negative=0,this},s.prototype.abs=function(){return this.clone().iabs()},s.prototype._ishlnsubmul=function(o,h,y){var p=o.length+y,v;this._expand(p);var _,x=0;for(v=0;v<o.length;v++){_=(this.words[v+y]|0)+x;var b=(o.words[v]|0)*h;_-=b&67108863,x=(_>>26)-(b/67108864|0),this.words[v+y]=_&67108863}for(;v<this.length-y;v++)_=(this.words[v+y]|0)+x,x=_>>26,this.words[v+y]=_&67108863;if(x===0)return this.strip();for(i(x===-1),x=0,v=0;v<this.length;v++)_=-(this.words[v]|0)+x,x=_>>26,this.words[v]=_&67108863;return this.negative=1,this.strip()},s.prototype._wordDiv=function(o,h){var y=this.length-o.length,p=this.clone(),v=o,_=v.words[v.length-1]|0,x=this._countBits(_);y=26-x,y!==0&&(v=v.ushln(y),p.iushln(y),_=v.words[v.length-1]|0);var b=p.length-v.length,f;if(h!=="mod"){f=new s(null),f.length=b+1,f.words=new Array(f.length);for(var m=0;m<f.length;m++)f.words[m]=0}var F=p.clone()._ishlnsubmul(v,1,b);F.negative===0&&(p=F,f&&(f.words[b]=1));for(var N=b-1;N>=0;N--){var T=(p.words[v.length+N]|0)*67108864+(p.words[v.length+N-1]|0);for(T=Math.min(T/_|0,67108863),p._ishlnsubmul(v,T,N);p.negative!==0;)T--,p.negative=0,p._ishlnsubmul(v,1,N),p.isZero()||(p.negative^=1);f&&(f.words[N]=T)}return f&&f.strip(),p.strip(),h!=="div"&&y!==0&&p.iushrn(y),{div:f||null,mod:p}},s.prototype.divmod=function(o,h,y){if(i(!o.isZero()),this.isZero())return{div:new s(0),mod:new s(0)};var p,v,_;return this.negative!==0&&o.negative===0?(_=this.neg().divmod(o,h),h!=="mod"&&(p=_.div.neg()),h!=="div"&&(v=_.mod.neg(),y&&v.negative!==0&&v.iadd(o)),{div:p,mod:v}):this.negative===0&&o.negative!==0?(_=this.divmod(o.neg(),h),h!=="mod"&&(p=_.div.neg()),{div:p,mod:_.mod}):this.negative&o.negative?(_=this.neg().divmod(o.neg(),h),h!=="div"&&(v=_.mod.neg(),y&&v.negative!==0&&v.isub(o)),{div:_.div,mod:v}):o.length>this.length||this.cmp(o)<0?{div:new s(0),mod:this}:o.length===1?h==="div"?{div:this.divn(o.words[0]),mod:null}:h==="mod"?{div:null,mod:new s(this.modn(o.words[0]))}:{div:this.divn(o.words[0]),mod:new s(this.modn(o.words[0]))}:this._wordDiv(o,h)},s.prototype.div=function(o){return this.divmod(o,"div",!1).div},s.prototype.mod=function(o){return this.divmod(o,"mod",!1).mod},s.prototype.umod=function(o){return this.divmod(o,"mod",!0).mod},s.prototype.divRound=function(o){var h=this.divmod(o);if(h.mod.isZero())return h.div;var y=h.div.negative!==0?h.mod.isub(o):h.mod,p=o.ushrn(1),v=o.andln(1),_=y.cmp(p);return _<0||v===1&&_===0?h.div:h.div.negative!==0?h.div.isubn(1):h.div.iaddn(1)},s.prototype.modn=function(o){i(o<=67108863);for(var h=(1<<26)%o,y=0,p=this.length-1;p>=0;p--)y=(h*y+(this.words[p]|0))%o;return y},s.prototype.idivn=function(o){i(o<=67108863);for(var h=0,y=this.length-1;y>=0;y--){var p=(this.words[y]|0)+h*67108864;this.words[y]=p/o|0,h=p%o}return this.strip()},s.prototype.divn=function(o){return this.clone().idivn(o)},s.prototype.egcd=function(o){i(o.negative===0),i(!o.isZero());var h=this,y=o.clone();h.negative!==0?h=h.umod(o):h=h.clone();for(var p=new s(1),v=new s(0),_=new s(0),x=new s(1),b=0;h.isEven()&&y.isEven();)h.iushrn(1),y.iushrn(1),++b;for(var f=y.clone(),m=h.clone();!h.isZero();){for(var F=0,N=1;!(h.words[0]&N)&&F<26;++F,N<<=1);if(F>0)for(h.iushrn(F);F-- >0;)(p.isOdd()||v.isOdd())&&(p.iadd(f),v.isub(m)),p.iushrn(1),v.iushrn(1);for(var T=0,L=1;!(y.words[0]&L)&&T<26;++T,L<<=1);if(T>0)for(y.iushrn(T);T-- >0;)(_.isOdd()||x.isOdd())&&(_.iadd(f),x.isub(m)),_.iushrn(1),x.iushrn(1);h.cmp(y)>=0?(h.isub(y),p.isub(_),v.isub(x)):(y.isub(h),_.isub(p),x.isub(v))}return{a:_,b:x,gcd:y.iushln(b)}},s.prototype._invmp=function(o){i(o.negative===0),i(!o.isZero());var h=this,y=o.clone();h.negative!==0?h=h.umod(o):h=h.clone();for(var p=new s(1),v=new s(0),_=y.clone();h.cmpn(1)>0&&y.cmpn(1)>0;){for(var x=0,b=1;!(h.words[0]&b)&&x<26;++x,b<<=1);if(x>0)for(h.iushrn(x);x-- >0;)p.isOdd()&&p.iadd(_),p.iushrn(1);for(var f=0,m=1;!(y.words[0]&m)&&f<26;++f,m<<=1);if(f>0)for(y.iushrn(f);f-- >0;)v.isOdd()&&v.iadd(_),v.iushrn(1);h.cmp(y)>=0?(h.isub(y),p.isub(v)):(y.isub(h),v.isub(p))}var F;return h.cmpn(1)===0?F=p:F=v,F.cmpn(0)<0&&F.iadd(o),F},s.prototype.gcd=function(o){if(this.isZero())return o.abs();if(o.isZero())return this.abs();var h=this.clone(),y=o.clone();h.negative=0,y.negative=0;for(var p=0;h.isEven()&&y.isEven();p++)h.iushrn(1),y.iushrn(1);do{for(;h.isEven();)h.iushrn(1);for(;y.isEven();)y.iushrn(1);var v=h.cmp(y);if(v<0){var _=h;h=y,y=_}else if(v===0||y.cmpn(1)===0)break;h.isub(y)}while(!0);return y.iushln(p)},s.prototype.invm=function(o){return this.egcd(o).a.umod(o)},s.prototype.isEven=function(){return(this.words[0]&1)===0},s.prototype.isOdd=function(){return(this.words[0]&1)===1},s.prototype.andln=function(o){return this.words[0]&o},s.prototype.bincn=function(o){i(typeof o=="number");var h=o%26,y=(o-h)/26,p=1<<h;if(this.length<=y)return this._expand(y+1),this.words[y]|=p,this;for(var v=p,_=y;v!==0&&_<this.length;_++){var x=this.words[_]|0;x+=v,v=x>>>26,x&=67108863,this.words[_]=x}return v!==0&&(this.words[_]=v,this.length++),this},s.prototype.isZero=function(){return this.length===1&&this.words[0]===0},s.prototype.cmpn=function(o){var h=o<0;if(this.negative!==0&&!h)return-1;if(this.negative===0&&h)return 1;this.strip();var y;if(this.length>1)y=1;else{h&&(o=-o),i(o<=67108863,"Number is too big");var p=this.words[0]|0;y=p===o?0:p<o?-1:1}return this.negative!==0?-y|0:y},s.prototype.cmp=function(o){if(this.negative!==0&&o.negative===0)return-1;if(this.negative===0&&o.negative!==0)return 1;var h=this.ucmp(o);return this.negative!==0?-h|0:h},s.prototype.ucmp=function(o){if(this.length>o.length)return 1;if(this.length<o.length)return-1;for(var h=0,y=this.length-1;y>=0;y--){var p=this.words[y]|0,v=o.words[y]|0;if(p!==v){p<v?h=-1:p>v&&(h=1);break}}return h},s.prototype.gtn=function(o){return this.cmpn(o)===1},s.prototype.gt=function(o){return this.cmp(o)===1},s.prototype.gten=function(o){return this.cmpn(o)>=0},s.prototype.gte=function(o){return this.cmp(o)>=0},s.prototype.ltn=function(o){return this.cmpn(o)===-1},s.prototype.lt=function(o){return this.cmp(o)===-1},s.prototype.lten=function(o){return this.cmpn(o)<=0},s.prototype.lte=function(o){return this.cmp(o)<=0},s.prototype.eqn=function(o){return this.cmpn(o)===0},s.prototype.eq=function(o){return this.cmp(o)===0},s.red=function(o){return new q(o)},s.prototype.toRed=function(o){return i(!this.red,"Already a number in reduction context"),i(this.negative===0,"red works only with positives"),o.convertTo(this)._forceRed(o)},s.prototype.fromRed=function(){return i(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},s.prototype._forceRed=function(o){return this.red=o,this},s.prototype.forceRed=function(o){return i(!this.red,"Already a number in reduction context"),this._forceRed(o)},s.prototype.redAdd=function(o){return i(this.red,"redAdd works only with red numbers"),this.red.add(this,o)},s.prototype.redIAdd=function(o){return i(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,o)},s.prototype.redSub=function(o){return i(this.red,"redSub works only with red numbers"),this.red.sub(this,o)},s.prototype.redISub=function(o){return i(this.red,"redISub works only with red numbers"),this.red.isub(this,o)},s.prototype.redShl=function(o){return i(this.red,"redShl works only with red numbers"),this.red.shl(this,o)},s.prototype.redMul=function(o){return i(this.red,"redMul works only with red numbers"),this.red._verify2(this,o),this.red.mul(this,o)},s.prototype.redIMul=function(o){return i(this.red,"redMul works only with red numbers"),this.red._verify2(this,o),this.red.imul(this,o)},s.prototype.redSqr=function(){return i(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},s.prototype.redISqr=function(){return i(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},s.prototype.redSqrt=function(){return i(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},s.prototype.redInvm=function(){return i(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},s.prototype.redNeg=function(){return i(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},s.prototype.redPow=function(o){return i(this.red&&!o.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,o)};var R={k256:null,p224:null,p192:null,p25519:null};function C(S,o){this.name=S,this.p=new s(o,16),this.n=this.p.bitLength(),this.k=new s(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}C.prototype._tmp=function(){var o=new s(null);return o.words=new Array(Math.ceil(this.n/13)),o},C.prototype.ireduce=function(o){var h=o,y;do this.split(h,this.tmp),h=this.imulK(h),h=h.iadd(this.tmp),y=h.bitLength();while(y>this.n);var p=y<this.n?-1:h.ucmp(this.p);return p===0?(h.words[0]=0,h.length=1):p>0?h.isub(this.p):h.strip!==void 0?h.strip():h._strip(),h},C.prototype.split=function(o,h){o.iushrn(this.n,0,h)},C.prototype.imulK=function(o){return o.imul(this.k)};function D(){C.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}n(D,C),D.prototype.split=function(o,h){for(var y=4194303,p=Math.min(o.length,9),v=0;v<p;v++)h.words[v]=o.words[v];if(h.length=p,o.length<=9){o.words[0]=0,o.length=1;return}var _=o.words[9];for(h.words[h.length++]=_&y,v=10;v<o.length;v++){var x=o.words[v]|0;o.words[v-10]=(x&y)<<4|_>>>22,_=x}_>>>=22,o.words[v-10]=_,_===0&&o.length>10?o.length-=10:o.length-=9},D.prototype.imulK=function(o){o.words[o.length]=0,o.words[o.length+1]=0,o.length+=2;for(var h=0,y=0;y<o.length;y++){var p=o.words[y]|0;h+=p*977,o.words[y]=h&67108863,h=p*64+(h/67108864|0)}return o.words[o.length-1]===0&&(o.length--,o.words[o.length-1]===0&&o.length--),o};function U(){C.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}n(U,C);function j(){C.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}n(j,C);function z(){C.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}n(z,C),z.prototype.imulK=function(o){for(var h=0,y=0;y<o.length;y++){var p=(o.words[y]|0)*19+h,v=p&67108863;p>>>=26,o.words[y]=v,h=p}return h!==0&&(o.words[o.length++]=h),o},s._prime=function(o){if(R[o])return R[o];var h;if(o==="k256")h=new D;else if(o==="p224")h=new U;else if(o==="p192")h=new j;else if(o==="p25519")h=new z;else throw new Error("Unknown prime "+o);return R[o]=h,h};function q(S){if(typeof S=="string"){var o=s._prime(S);this.m=o.p,this.prime=o}else i(S.gtn(1),"modulus must be greater than 1"),this.m=S,this.prime=null}q.prototype._verify1=function(o){i(o.negative===0,"red works only with positives"),i(o.red,"red works only with red numbers")},q.prototype._verify2=function(o,h){i((o.negative|h.negative)===0,"red works only with positives"),i(o.red&&o.red===h.red,"red works only with red numbers")},q.prototype.imod=function(o){return this.prime?this.prime.ireduce(o)._forceRed(this):o.umod(this.m)._forceRed(this)},q.prototype.neg=function(o){return o.isZero()?o.clone():this.m.sub(o)._forceRed(this)},q.prototype.add=function(o,h){this._verify2(o,h);var y=o.add(h);return y.cmp(this.m)>=0&&y.isub(this.m),y._forceRed(this)},q.prototype.iadd=function(o,h){this._verify2(o,h);var y=o.iadd(h);return y.cmp(this.m)>=0&&y.isub(this.m),y},q.prototype.sub=function(o,h){this._verify2(o,h);var y=o.sub(h);return y.cmpn(0)<0&&y.iadd(this.m),y._forceRed(this)},q.prototype.isub=function(o,h){this._verify2(o,h);var y=o.isub(h);return y.cmpn(0)<0&&y.iadd(this.m),y},q.prototype.shl=function(o,h){return this._verify1(o),this.imod(o.ushln(h))},q.prototype.imul=function(o,h){return this._verify2(o,h),this.imod(o.imul(h))},q.prototype.mul=function(o,h){return this._verify2(o,h),this.imod(o.mul(h))},q.prototype.isqr=function(o){return this.imul(o,o.clone())},q.prototype.sqr=function(o){return this.mul(o,o)},q.prototype.sqrt=function(o){if(o.isZero())return o.clone();var h=this.m.andln(3);if(i(h%2===1),h===3){var y=this.m.add(new s(1)).iushrn(2);return this.pow(o,y)}for(var p=this.m.subn(1),v=0;!p.isZero()&&p.andln(1)===0;)v++,p.iushrn(1);i(!p.isZero());var _=new s(1).toRed(this),x=_.redNeg(),b=this.m.subn(1).iushrn(1),f=this.m.bitLength();for(f=new s(2*f*f).toRed(this);this.pow(f,b).cmp(x)!==0;)f.redIAdd(x);for(var m=this.pow(f,p),F=this.pow(o,p.addn(1).iushrn(1)),N=this.pow(o,p),T=v;N.cmp(_)!==0;){for(var L=N,k=0;L.cmp(_)!==0;k++)L=L.redSqr();i(k<T);var W=this.pow(m,new s(1).iushln(T-k-1));F=F.redMul(W),m=W.redSqr(),N=N.redMul(m),T=k}return F},q.prototype.invm=function(o){var h=o._invmp(this.m);return h.negative!==0?(h.negative=0,this.imod(h).redNeg()):this.imod(h)},q.prototype.pow=function(o,h){if(h.isZero())return new s(1).toRed(this);if(h.cmpn(1)===0)return o.clone();var y=4,p=new Array(1<<y);p[0]=new s(1).toRed(this),p[1]=o;for(var v=2;v<p.length;v++)p[v]=this.mul(p[v-1],o);var _=p[0],x=0,b=0,f=h.bitLength()%26;for(f===0&&(f=26),v=h.length-1;v>=0;v--){for(var m=h.words[v],F=f-1;F>=0;F--){var N=m>>F&1;if(_!==p[0]&&(_=this.sqr(_)),N===0&&x===0){b=0;continue}x<<=1,x|=N,b++,!(b!==y&&(v!==0||F!==0))&&(_=this.mul(_,p[x]),b=0,x=0)}f=26}return _},q.prototype.convertTo=function(o){var h=o.umod(this.m);return h===o?h.clone():h},q.prototype.convertFrom=function(o){var h=o.clone();return h.red=null,h},s.mont=function(o){return new V(o)};function V(S){q.call(this,S),this.shift=this.m.bitLength(),this.shift%26!==0&&(this.shift+=26-this.shift%26),this.r=new s(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}n(V,q),V.prototype.convertTo=function(o){return this.imod(o.ushln(this.shift))},V.prototype.convertFrom=function(o){var h=this.imod(o.mul(this.rinv));return h.red=null,h},V.prototype.imul=function(o,h){if(o.isZero()||h.isZero())return o.words[0]=0,o.length=1,o;var y=o.imul(h),p=y.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),v=y.isub(p).iushrn(this.shift),_=v;return v.cmp(this.m)>=0?_=v.isub(this.m):v.cmpn(0)<0&&(_=v.iadd(this.m)),_._forceRed(this)},V.prototype.mul=function(o,h){if(o.isZero()||h.isZero())return new s(0)._forceRed(this);var y=o.mul(h),p=y.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),v=y.isub(p).iushrn(this.shift),_=v;return v.cmp(this.m)>=0?_=v.isub(this.m):v.cmpn(0)<0&&(_=v.iadd(this.m)),_._forceRed(this)},V.prototype.invm=function(o){var h=this.imod(o._invmp(this.m).mul(this.r2));return h._forceRed(this)}})(t,Ue)})(dd);var Mi=dd.exports;(function(t){var e=t,r=Mi,i=$0,n=x0;e.assert=i,e.toArray=n.toArray,e.zero2=n.zero2,e.toHex=n.toHex,e.encode=n.encode;function s(l,g,w){var E=new Array(Math.max(l.bitLength(),w)+1),$;for($=0;$<E.length;$+=1)E[$]=0;var I=1<<g+1,M=l.clone();for($=0;$<E.length;$++){var P,A=M.andln(I-1);M.isOdd()?(A>(I>>1)-1?P=(I>>1)-A:P=A,M.isubn(P)):P=0,E[$]=P,M.iushrn(1)}return E}e.getNAF=s;function a(l,g){var w=[[],[]];l=l.clone(),g=g.clone();for(var E=0,$=0,I;l.cmpn(-E)>0||g.cmpn(-$)>0;){var M=l.andln(3)+E&3,P=g.andln(3)+$&3;M===3&&(M=-1),P===3&&(P=-1);var A;M&1?(I=l.andln(7)+E&7,(I===3||I===5)&&P===2?A=-M:A=M):A=0,w[0].push(A);var R;P&1?(I=g.andln(7)+$&7,(I===3||I===5)&&M===2?R=-P:R=P):R=0,w[1].push(R),2*E===A+1&&(E=1-E),2*$===R+1&&($=1-$),l.iushrn(1),g.iushrn(1)}return w}e.getJSF=a;function c(l,g,w){var E="_"+g;l.prototype[g]=function(){return this[E]!==void 0?this[E]:this[E]=w.call(this)}}e.cachedProperty=c;function d(l){return typeof l=="string"?e.toArray(l,"hex"):l}e.parseBytes=d;function u(l){return new r(l,"hex","le")}e.intFromLE=u})(nr);var hd={},on=Mi,ea=nr,Qa=ea.getNAF,H9=ea.getJSF,eo=ea.assert;function Gi(t,e){this.type=t,this.p=new on(e.p,16),this.red=e.prime?on.red(e.prime):on.mont(this.p),this.zero=new on(0).toRed(this.red),this.one=new on(1).toRed(this.red),this.two=new on(2).toRed(this.red),this.n=e.n&&new on(e.n,16),this.g=e.g&&this.pointFromJSON(e.g,e.gRed),this._wnafT1=new Array(4),this._wnafT2=new Array(4),this._wnafT3=new Array(4),this._wnafT4=new Array(4),this._bitLength=this.n?this.n.bitLength():0;var r=this.n&&this.p.div(this.n);!r||r.cmpn(100)>0?this.redN=null:(this._maxwellTrick=!0,this.redN=this.n.toRed(this.red))}var Oo=Gi;Gi.prototype.point=function(){throw new Error("Not implemented")};Gi.prototype.validate=function(){throw new Error("Not implemented")};Gi.prototype._fixedNafMul=function(e,r){eo(e.precomputed);var i=e._getDoubles(),n=Qa(r,1,this._bitLength),s=(1<<i.step+1)-(i.step%2===0?2:1);s/=3;var a=[],c,d;for(c=0;c<n.length;c+=i.step){d=0;for(var u=c+i.step-1;u>=c;u--)d=(d<<1)+n[u];a.push(d)}for(var l=this.jpoint(null,null,null),g=this.jpoint(null,null,null),w=s;w>0;w--){for(c=0;c<a.length;c++)d=a[c],d===w?g=g.mixedAdd(i.points[c]):d===-w&&(g=g.mixedAdd(i.points[c].neg()));l=l.add(g)}return l.toP()};Gi.prototype._wnafMul=function(e,r){var i=4,n=e._getNAFPoints(i);i=n.wnd;for(var s=n.points,a=Qa(r,i,this._bitLength),c=this.jpoint(null,null,null),d=a.length-1;d>=0;d--){for(var u=0;d>=0&&a[d]===0;d--)u++;if(d>=0&&u++,c=c.dblp(u),d<0)break;var l=a[d];eo(l!==0),e.type==="affine"?l>0?c=c.mixedAdd(s[l-1>>1]):c=c.mixedAdd(s[-l-1>>1].neg()):l>0?c=c.add(s[l-1>>1]):c=c.add(s[-l-1>>1].neg())}return e.type==="affine"?c.toP():c};Gi.prototype._wnafMulAdd=function(e,r,i,n,s){var a=this._wnafT1,c=this._wnafT2,d=this._wnafT3,u=0,l,g,w;for(l=0;l<n;l++){w=r[l];var E=w._getNAFPoints(e);a[l]=E.wnd,c[l]=E.points}for(l=n-1;l>=1;l-=2){var $=l-1,I=l;if(a[$]!==1||a[I]!==1){d[$]=Qa(i[$],a[$],this._bitLength),d[I]=Qa(i[I],a[I],this._bitLength),u=Math.max(d[$].length,u),u=Math.max(d[I].length,u);continue}var M=[r[$],null,null,r[I]];r[$].y.cmp(r[I].y)===0?(M[1]=r[$].add(r[I]),M[2]=r[$].toJ().mixedAdd(r[I].neg())):r[$].y.cmp(r[I].y.redNeg())===0?(M[1]=r[$].toJ().mixedAdd(r[I]),M[2]=r[$].add(r[I].neg())):(M[1]=r[$].toJ().mixedAdd(r[I]),M[2]=r[$].toJ().mixedAdd(r[I].neg()));var P=[-3,-1,-5,-7,0,7,5,1,3],A=H9(i[$],i[I]);for(u=Math.max(A[0].length,u),d[$]=new Array(u),d[I]=new Array(u),g=0;g<u;g++){var R=A[0][g]|0,C=A[1][g]|0;d[$][g]=P[(R+1)*3+(C+1)],d[I][g]=0,c[$]=M}}var D=this.jpoint(null,null,null),U=this._wnafT4;for(l=u;l>=0;l--){for(var j=0;l>=0;){var z=!0;for(g=0;g<n;g++)U[g]=d[g][l]|0,U[g]!==0&&(z=!1);if(!z)break;j++,l--}if(l>=0&&j++,D=D.dblp(j),l<0)break;for(g=0;g<n;g++){var q=U[g];q!==0&&(q>0?w=c[g][q-1>>1]:q<0&&(w=c[g][-q-1>>1].neg()),w.type==="affine"?D=D.mixedAdd(w):D=D.add(w))}}for(l=0;l<n;l++)c[l]=null;return s?D:D.toP()};function gr(t,e){this.curve=t,this.type=e,this.precomputed=null}Gi.BasePoint=gr;gr.prototype.eq=function(){throw new Error("Not implemented")};gr.prototype.validate=function(){return this.curve.validate(this)};Gi.prototype.decodePoint=function(e,r){e=ea.toArray(e,r);var i=this.p.byteLength();if((e[0]===4||e[0]===6||e[0]===7)&&e.length-1===2*i){e[0]===6?eo(e[e.length-1]%2===0):e[0]===7&&eo(e[e.length-1]%2===1);var n=this.point(e.slice(1,1+i),e.slice(1+i,1+2*i));return n}else if((e[0]===2||e[0]===3)&&e.length-1===i)return this.pointFromX(e.slice(1,1+i),e[0]===3);throw new Error("Unknown point format")};gr.prototype.encodeCompressed=function(e){return this.encode(e,!0)};gr.prototype._encode=function(e){var r=this.curve.p.byteLength(),i=this.getX().toArray("be",r);return e?[this.getY().isEven()?2:3].concat(i):[4].concat(i,this.getY().toArray("be",r))};gr.prototype.encode=function(e,r){return ea.encode(this._encode(r),e)};gr.prototype.precompute=function(e){if(this.precomputed)return this;var r={doubles:null,naf:null,beta:null};return r.naf=this._getNAFPoints(8),r.doubles=this._getDoubles(4,e),r.beta=this._getBeta(),this.precomputed=r,this};gr.prototype._hasDoubles=function(e){if(!this.precomputed)return!1;var r=this.precomputed.doubles;return r?r.points.length>=Math.ceil((e.bitLength()+1)/r.step):!1};gr.prototype._getDoubles=function(e,r){if(this.precomputed&&this.precomputed.doubles)return this.precomputed.doubles;for(var i=[this],n=this,s=0;s<r;s+=e){for(var a=0;a<e;a++)n=n.dbl();i.push(n)}return{step:e,points:i}};gr.prototype._getNAFPoints=function(e){if(this.precomputed&&this.precomputed.naf)return this.precomputed.naf;for(var r=[this],i=(1<<e)-1,n=i===1?null:this.dbl(),s=1;s<i;s++)r[s]=r[s-1].add(n);return{wnd:e,points:r}};gr.prototype._getBeta=function(){return null};gr.prototype.dblp=function(e){for(var r=this,i=0;i<e;i++)r=r.dbl();return r};var K9=nr,et=Mi,ud=is,ds=Oo,V9=K9.assert;function vr(t){ds.call(this,"short",t),this.a=new et(t.a,16).toRed(this.red),this.b=new et(t.b,16).toRed(this.red),this.tinv=this.two.redInvm(),this.zeroA=this.a.fromRed().cmpn(0)===0,this.threeA=this.a.fromRed().sub(this.p).cmpn(-3)===0,this.endo=this._getEndomorphism(t),this._endoWnafT1=new Array(4),this._endoWnafT2=new Array(4)}ud(vr,ds);var W9=vr;vr.prototype._getEndomorphism=function(e){if(!(!this.zeroA||!this.g||!this.n||this.p.modn(3)!==1)){var r,i;if(e.beta)r=new et(e.beta,16).toRed(this.red);else{var n=this._getEndoRoots(this.p);r=n[0].cmp(n[1])<0?n[0]:n[1],r=r.toRed(this.red)}if(e.lambda)i=new et(e.lambda,16);else{var s=this._getEndoRoots(this.n);this.g.mul(s[0]).x.cmp(this.g.x.redMul(r))===0?i=s[0]:(i=s[1],V9(this.g.mul(i).x.cmp(this.g.x.redMul(r))===0))}var a;return e.basis?a=e.basis.map(function(c){return{a:new et(c.a,16),b:new et(c.b,16)}}):a=this._getEndoBasis(i),{beta:r,lambda:i,basis:a}}};vr.prototype._getEndoRoots=function(e){var r=e===this.p?this.red:et.mont(e),i=new et(2).toRed(r).redInvm(),n=i.redNeg(),s=new et(3).toRed(r).redNeg().redSqrt().redMul(i),a=n.redAdd(s).fromRed(),c=n.redSub(s).fromRed();return[a,c]};vr.prototype._getEndoBasis=function(e){for(var r=this.n.ushrn(Math.floor(this.n.bitLength()/2)),i=e,n=this.n.clone(),s=new et(1),a=new et(0),c=new et(0),d=new et(1),u,l,g,w,E,$,I,M=0,P,A;i.cmpn(0)!==0;){var R=n.div(i);P=n.sub(R.mul(i)),A=c.sub(R.mul(s));var C=d.sub(R.mul(a));if(!g&&P.cmp(r)<0)u=I.neg(),l=s,g=P.neg(),w=A;else if(g&&++M===2)break;I=P,n=i,i=P,c=s,s=A,d=a,a=C}E=P.neg(),$=A;var D=g.sqr().add(w.sqr()),U=E.sqr().add($.sqr());return U.cmp(D)>=0&&(E=u,$=l),g.negative&&(g=g.neg(),w=w.neg()),E.negative&&(E=E.neg(),$=$.neg()),[{a:g,b:w},{a:E,b:$}]};vr.prototype._endoSplit=function(e){var r=this.endo.basis,i=r[0],n=r[1],s=n.b.mul(e).divRound(this.n),a=i.b.neg().mul(e).divRound(this.n),c=s.mul(i.a),d=a.mul(n.a),u=s.mul(i.b),l=a.mul(n.b),g=e.sub(c).sub(d),w=u.add(l).neg();return{k1:g,k2:w}};vr.prototype.pointFromX=function(e,r){e=new et(e,16),e.red||(e=e.toRed(this.red));var i=e.redSqr().redMul(e).redIAdd(e.redMul(this.a)).redIAdd(this.b),n=i.redSqrt();if(n.redSqr().redSub(i).cmp(this.zero)!==0)throw new Error("invalid point");var s=n.fromRed().isOdd();return(r&&!s||!r&&s)&&(n=n.redNeg()),this.point(e,n)};vr.prototype.validate=function(e){if(e.inf)return!0;var r=e.x,i=e.y,n=this.a.redMul(r),s=r.redSqr().redMul(r).redIAdd(n).redIAdd(this.b);return i.redSqr().redISub(s).cmpn(0)===0};vr.prototype._endoWnafMulAdd=function(e,r,i){for(var n=this._endoWnafT1,s=this._endoWnafT2,a=0;a<e.length;a++){var c=this._endoSplit(r[a]),d=e[a],u=d._getBeta();c.k1.negative&&(c.k1.ineg(),d=d.neg(!0)),c.k2.negative&&(c.k2.ineg(),u=u.neg(!0)),n[a*2]=d,n[a*2+1]=u,s[a*2]=c.k1,s[a*2+1]=c.k2}for(var l=this._wnafMulAdd(1,n,s,a*2,i),g=0;g<a*2;g++)n[g]=null,s[g]=null;return l};function yt(t,e,r,i){ds.BasePoint.call(this,t,"affine"),e===null&&r===null?(this.x=null,this.y=null,this.inf=!0):(this.x=new et(e,16),this.y=new et(r,16),i&&(this.x.forceRed(this.curve.red),this.y.forceRed(this.curve.red)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.inf=!1)}ud(yt,ds.BasePoint);vr.prototype.point=function(e,r,i){return new yt(this,e,r,i)};vr.prototype.pointFromJSON=function(e,r){return yt.fromJSON(this,e,r)};yt.prototype._getBeta=function(){if(this.curve.endo){var e=this.precomputed;if(e&&e.beta)return e.beta;var r=this.curve.point(this.x.redMul(this.curve.endo.beta),this.y);if(e){var i=this.curve,n=function(s){return i.point(s.x.redMul(i.endo.beta),s.y)};e.beta=r,r.precomputed={beta:null,naf:e.naf&&{wnd:e.naf.wnd,points:e.naf.points.map(n)},doubles:e.doubles&&{step:e.doubles.step,points:e.doubles.points.map(n)}}}return r}};yt.prototype.toJSON=function(){return this.precomputed?[this.x,this.y,this.precomputed&&{doubles:this.precomputed.doubles&&{step:this.precomputed.doubles.step,points:this.precomputed.doubles.points.slice(1)},naf:this.precomputed.naf&&{wnd:this.precomputed.naf.wnd,points:this.precomputed.naf.points.slice(1)}}]:[this.x,this.y]};yt.fromJSON=function(e,r,i){typeof r=="string"&&(r=JSON.parse(r));var n=e.point(r[0],r[1],i);if(!r[2])return n;function s(c){return e.point(c[0],c[1],i)}var a=r[2];return n.precomputed={beta:null,doubles:a.doubles&&{step:a.doubles.step,points:[n].concat(a.doubles.points.map(s))},naf:a.naf&&{wnd:a.naf.wnd,points:[n].concat(a.naf.points.map(s))}},n};yt.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+">"};yt.prototype.isInfinity=function(){return this.inf};yt.prototype.add=function(e){if(this.inf)return e;if(e.inf)return this;if(this.eq(e))return this.dbl();if(this.neg().eq(e))return this.curve.point(null,null);if(this.x.cmp(e.x)===0)return this.curve.point(null,null);var r=this.y.redSub(e.y);r.cmpn(0)!==0&&(r=r.redMul(this.x.redSub(e.x).redInvm()));var i=r.redSqr().redISub(this.x).redISub(e.x),n=r.redMul(this.x.redSub(i)).redISub(this.y);return this.curve.point(i,n)};yt.prototype.dbl=function(){if(this.inf)return this;var e=this.y.redAdd(this.y);if(e.cmpn(0)===0)return this.curve.point(null,null);var r=this.curve.a,i=this.x.redSqr(),n=e.redInvm(),s=i.redAdd(i).redIAdd(i).redIAdd(r).redMul(n),a=s.redSqr().redISub(this.x.redAdd(this.x)),c=s.redMul(this.x.redSub(a)).redISub(this.y);return this.curve.point(a,c)};yt.prototype.getX=function(){return this.x.fromRed()};yt.prototype.getY=function(){return this.y.fromRed()};yt.prototype.mul=function(e){return e=new et(e,16),this.isInfinity()?this:this._hasDoubles(e)?this.curve._fixedNafMul(this,e):this.curve.endo?this.curve._endoWnafMulAdd([this],[e]):this.curve._wnafMul(this,e)};yt.prototype.mulAdd=function(e,r,i){var n=[this,r],s=[e,i];return this.curve.endo?this.curve._endoWnafMulAdd(n,s):this.curve._wnafMulAdd(1,n,s,2)};yt.prototype.jmulAdd=function(e,r,i){var n=[this,r],s=[e,i];return this.curve.endo?this.curve._endoWnafMulAdd(n,s,!0):this.curve._wnafMulAdd(1,n,s,2,!0)};yt.prototype.eq=function(e){return this===e||this.inf===e.inf&&(this.inf||this.x.cmp(e.x)===0&&this.y.cmp(e.y)===0)};yt.prototype.neg=function(e){if(this.inf)return this;var r=this.curve.point(this.x,this.y.redNeg());if(e&&this.precomputed){var i=this.precomputed,n=function(s){return s.neg()};r.precomputed={naf:i.naf&&{wnd:i.naf.wnd,points:i.naf.points.map(n)},doubles:i.doubles&&{step:i.doubles.step,points:i.doubles.points.map(n)}}}return r};yt.prototype.toJ=function(){if(this.inf)return this.curve.jpoint(null,null,null);var e=this.curve.jpoint(this.x,this.y,this.curve.one);return e};function It(t,e,r,i){ds.BasePoint.call(this,t,"jacobian"),e===null&&r===null&&i===null?(this.x=this.curve.one,this.y=this.curve.one,this.z=new et(0)):(this.x=new et(e,16),this.y=new et(r,16),this.z=new et(i,16)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.zOne=this.z===this.curve.one}ud(It,ds.BasePoint);vr.prototype.jpoint=function(e,r,i){return new It(this,e,r,i)};It.prototype.toP=function(){if(this.isInfinity())return this.curve.point(null,null);var e=this.z.redInvm(),r=e.redSqr(),i=this.x.redMul(r),n=this.y.redMul(r).redMul(e);return this.curve.point(i,n)};It.prototype.neg=function(){return this.curve.jpoint(this.x,this.y.redNeg(),this.z)};It.prototype.add=function(e){if(this.isInfinity())return e;if(e.isInfinity())return this;var r=e.z.redSqr(),i=this.z.redSqr(),n=this.x.redMul(r),s=e.x.redMul(i),a=this.y.redMul(r.redMul(e.z)),c=e.y.redMul(i.redMul(this.z)),d=n.redSub(s),u=a.redSub(c);if(d.cmpn(0)===0)return u.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var l=d.redSqr(),g=l.redMul(d),w=n.redMul(l),E=u.redSqr().redIAdd(g).redISub(w).redISub(w),$=u.redMul(w.redISub(E)).redISub(a.redMul(g)),I=this.z.redMul(e.z).redMul(d);return this.curve.jpoint(E,$,I)};It.prototype.mixedAdd=function(e){if(this.isInfinity())return e.toJ();if(e.isInfinity())return this;var r=this.z.redSqr(),i=this.x,n=e.x.redMul(r),s=this.y,a=e.y.redMul(r).redMul(this.z),c=i.redSub(n),d=s.redSub(a);if(c.cmpn(0)===0)return d.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var u=c.redSqr(),l=u.redMul(c),g=i.redMul(u),w=d.redSqr().redIAdd(l).redISub(g).redISub(g),E=d.redMul(g.redISub(w)).redISub(s.redMul(l)),$=this.z.redMul(c);return this.curve.jpoint(w,E,$)};It.prototype.dblp=function(e){if(e===0)return this;if(this.isInfinity())return this;if(!e)return this.dbl();var r;if(this.curve.zeroA||this.curve.threeA){var i=this;for(r=0;r<e;r++)i=i.dbl();return i}var n=this.curve.a,s=this.curve.tinv,a=this.x,c=this.y,d=this.z,u=d.redSqr().redSqr(),l=c.redAdd(c);for(r=0;r<e;r++){var g=a.redSqr(),w=l.redSqr(),E=w.redSqr(),$=g.redAdd(g).redIAdd(g).redIAdd(n.redMul(u)),I=a.redMul(w),M=$.redSqr().redISub(I.redAdd(I)),P=I.redISub(M),A=$.redMul(P);A=A.redIAdd(A).redISub(E);var R=l.redMul(d);r+1<e&&(u=u.redMul(E)),a=M,d=R,l=A}return this.curve.jpoint(a,l.redMul(s),d)};It.prototype.dbl=function(){return this.isInfinity()?this:this.curve.zeroA?this._zeroDbl():this.curve.threeA?this._threeDbl():this._dbl()};It.prototype._zeroDbl=function(){var e,r,i;if(this.zOne){var n=this.x.redSqr(),s=this.y.redSqr(),a=s.redSqr(),c=this.x.redAdd(s).redSqr().redISub(n).redISub(a);c=c.redIAdd(c);var d=n.redAdd(n).redIAdd(n),u=d.redSqr().redISub(c).redISub(c),l=a.redIAdd(a);l=l.redIAdd(l),l=l.redIAdd(l),e=u,r=d.redMul(c.redISub(u)).redISub(l),i=this.y.redAdd(this.y)}else{var g=this.x.redSqr(),w=this.y.redSqr(),E=w.redSqr(),$=this.x.redAdd(w).redSqr().redISub(g).redISub(E);$=$.redIAdd($);var I=g.redAdd(g).redIAdd(g),M=I.redSqr(),P=E.redIAdd(E);P=P.redIAdd(P),P=P.redIAdd(P),e=M.redISub($).redISub($),r=I.redMul($.redISub(e)).redISub(P),i=this.y.redMul(this.z),i=i.redIAdd(i)}return this.curve.jpoint(e,r,i)};It.prototype._threeDbl=function(){var e,r,i;if(this.zOne){var n=this.x.redSqr(),s=this.y.redSqr(),a=s.redSqr(),c=this.x.redAdd(s).redSqr().redISub(n).redISub(a);c=c.redIAdd(c);var d=n.redAdd(n).redIAdd(n).redIAdd(this.curve.a),u=d.redSqr().redISub(c).redISub(c);e=u;var l=a.redIAdd(a);l=l.redIAdd(l),l=l.redIAdd(l),r=d.redMul(c.redISub(u)).redISub(l),i=this.y.redAdd(this.y)}else{var g=this.z.redSqr(),w=this.y.redSqr(),E=this.x.redMul(w),$=this.x.redSub(g).redMul(this.x.redAdd(g));$=$.redAdd($).redIAdd($);var I=E.redIAdd(E);I=I.redIAdd(I);var M=I.redAdd(I);e=$.redSqr().redISub(M),i=this.y.redAdd(this.z).redSqr().redISub(w).redISub(g);var P=w.redSqr();P=P.redIAdd(P),P=P.redIAdd(P),P=P.redIAdd(P),r=$.redMul(I.redISub(e)).redISub(P)}return this.curve.jpoint(e,r,i)};It.prototype._dbl=function(){var e=this.curve.a,r=this.x,i=this.y,n=this.z,s=n.redSqr().redSqr(),a=r.redSqr(),c=i.redSqr(),d=a.redAdd(a).redIAdd(a).redIAdd(e.redMul(s)),u=r.redAdd(r);u=u.redIAdd(u);var l=u.redMul(c),g=d.redSqr().redISub(l.redAdd(l)),w=l.redISub(g),E=c.redSqr();E=E.redIAdd(E),E=E.redIAdd(E),E=E.redIAdd(E);var $=d.redMul(w).redISub(E),I=i.redAdd(i).redMul(n);return this.curve.jpoint(g,$,I)};It.prototype.trpl=function(){if(!this.curve.zeroA)return this.dbl().add(this);var e=this.x.redSqr(),r=this.y.redSqr(),i=this.z.redSqr(),n=r.redSqr(),s=e.redAdd(e).redIAdd(e),a=s.redSqr(),c=this.x.redAdd(r).redSqr().redISub(e).redISub(n);c=c.redIAdd(c),c=c.redAdd(c).redIAdd(c),c=c.redISub(a);var d=c.redSqr(),u=n.redIAdd(n);u=u.redIAdd(u),u=u.redIAdd(u),u=u.redIAdd(u);var l=s.redIAdd(c).redSqr().redISub(a).redISub(d).redISub(u),g=r.redMul(l);g=g.redIAdd(g),g=g.redIAdd(g);var w=this.x.redMul(d).redISub(g);w=w.redIAdd(w),w=w.redIAdd(w);var E=this.y.redMul(l.redMul(u.redISub(l)).redISub(c.redMul(d)));E=E.redIAdd(E),E=E.redIAdd(E),E=E.redIAdd(E);var $=this.z.redAdd(c).redSqr().redISub(i).redISub(d);return this.curve.jpoint(w,E,$)};It.prototype.mul=function(e,r){return e=new et(e,r),this.curve._wnafMul(this,e)};It.prototype.eq=function(e){if(e.type==="affine")return this.eq(e.toJ());if(this===e)return!0;var r=this.z.redSqr(),i=e.z.redSqr();if(this.x.redMul(i).redISub(e.x.redMul(r)).cmpn(0)!==0)return!1;var n=r.redMul(this.z),s=i.redMul(e.z);return this.y.redMul(s).redISub(e.y.redMul(n)).cmpn(0)===0};It.prototype.eqXToP=function(e){var r=this.z.redSqr(),i=e.toRed(this.curve.red).redMul(r);if(this.x.cmp(i)===0)return!0;for(var n=e.clone(),s=this.curve.redN.redMul(r);;){if(n.iadd(this.curve.n),n.cmp(this.curve.p)>=0)return!1;if(i.redIAdd(s),this.x.cmp(i)===0)return!0}};It.prototype.inspect=function(){return this.isInfinity()?"<EC JPoint Infinity>":"<EC JPoint x: "+this.x.toString(16,2)+" y: "+this.y.toString(16,2)+" z: "+this.z.toString(16,2)+">"};It.prototype.isInfinity=function(){return this.z.cmpn(0)===0};var Wn=Mi,h1=is,Ro=Oo,G9=nr;function hs(t){Ro.call(this,"mont",t),this.a=new Wn(t.a,16).toRed(this.red),this.b=new Wn(t.b,16).toRed(this.red),this.i4=new Wn(4).toRed(this.red).redInvm(),this.two=new Wn(2).toRed(this.red),this.a24=this.i4.redMul(this.a.redAdd(this.two))}h1(hs,Ro);var J9=hs;hs.prototype.validate=function(e){var r=e.normalize().x,i=r.redSqr(),n=i.redMul(r).redAdd(i.redMul(this.a)).redAdd(r),s=n.redSqrt();return s.redSqr().cmp(n)===0};function gt(t,e,r){Ro.BasePoint.call(this,t,"projective"),e===null&&r===null?(this.x=this.curve.one,this.z=this.curve.zero):(this.x=new Wn(e,16),this.z=new Wn(r,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)))}h1(gt,Ro.BasePoint);hs.prototype.decodePoint=function(e,r){return this.point(G9.toArray(e,r),1)};hs.prototype.point=function(e,r){return new gt(this,e,r)};hs.prototype.pointFromJSON=function(e){return gt.fromJSON(this,e)};gt.prototype.precompute=function(){};gt.prototype._encode=function(){return this.getX().toArray("be",this.curve.p.byteLength())};gt.fromJSON=function(e,r){return new gt(e,r[0],r[1]||e.one)};gt.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"};gt.prototype.isInfinity=function(){return this.z.cmpn(0)===0};gt.prototype.dbl=function(){var e=this.x.redAdd(this.z),r=e.redSqr(),i=this.x.redSub(this.z),n=i.redSqr(),s=r.redSub(n),a=r.redMul(n),c=s.redMul(n.redAdd(this.curve.a24.redMul(s)));return this.curve.point(a,c)};gt.prototype.add=function(){throw new Error("Not supported on Montgomery curve")};gt.prototype.diffAdd=function(e,r){var i=this.x.redAdd(this.z),n=this.x.redSub(this.z),s=e.x.redAdd(e.z),a=e.x.redSub(e.z),c=a.redMul(i),d=s.redMul(n),u=r.z.redMul(c.redAdd(d).redSqr()),l=r.x.redMul(c.redISub(d).redSqr());return this.curve.point(u,l)};gt.prototype.mul=function(e){for(var r=e.clone(),i=this,n=this.curve.point(null,null),s=this,a=[];r.cmpn(0)!==0;r.iushrn(1))a.push(r.andln(1));for(var c=a.length-1;c>=0;c--)a[c]===0?(i=i.diffAdd(n,s),n=n.dbl()):(n=i.diffAdd(n,s),i=i.dbl());return n};gt.prototype.mulAdd=function(){throw new Error("Not supported on Montgomery curve")};gt.prototype.jumlAdd=function(){throw new Error("Not supported on Montgomery curve")};gt.prototype.eq=function(e){return this.getX().cmp(e.getX())===0};gt.prototype.normalize=function(){return this.x=this.x.redMul(this.z.redInvm()),this.z=this.curve.one,this};gt.prototype.getX=function(){return this.normalize(),this.x.fromRed()};var Y9=nr,$i=Mi,u1=is,Fo=Oo,Z9=Y9.assert;function Wr(t){this.twisted=(t.a|0)!==1,this.mOneA=this.twisted&&(t.a|0)===-1,this.extended=this.mOneA,Fo.call(this,"edwards",t),this.a=new $i(t.a,16).umod(this.red.m),this.a=this.a.toRed(this.red),this.c=new $i(t.c,16).toRed(this.red),this.c2=this.c.redSqr(),this.d=new $i(t.d,16).toRed(this.red),this.dd=this.d.redAdd(this.d),Z9(!this.twisted||this.c.fromRed().cmpn(1)===0),this.oneC=(t.c|0)===1}u1(Wr,Fo);var X9=Wr;Wr.prototype._mulA=function(e){return this.mOneA?e.redNeg():this.a.redMul(e)};Wr.prototype._mulC=function(e){return this.oneC?e:this.c.redMul(e)};Wr.prototype.jpoint=function(e,r,i,n){return this.point(e,r,i,n)};Wr.prototype.pointFromX=function(e,r){e=new $i(e,16),e.red||(e=e.toRed(this.red));var i=e.redSqr(),n=this.c2.redSub(this.a.redMul(i)),s=this.one.redSub(this.c2.redMul(this.d).redMul(i)),a=n.redMul(s.redInvm()),c=a.redSqrt();if(c.redSqr().redSub(a).cmp(this.zero)!==0)throw new Error("invalid point");var d=c.fromRed().isOdd();return(r&&!d||!r&&d)&&(c=c.redNeg()),this.point(e,c)};Wr.prototype.pointFromY=function(e,r){e=new $i(e,16),e.red||(e=e.toRed(this.red));var i=e.redSqr(),n=i.redSub(this.c2),s=i.redMul(this.d).redMul(this.c2).redSub(this.a),a=n.redMul(s.redInvm());if(a.cmp(this.zero)===0){if(r)throw new Error("invalid point");return this.point(this.zero,e)}var c=a.redSqrt();if(c.redSqr().redSub(a).cmp(this.zero)!==0)throw new Error("invalid point");return c.fromRed().isOdd()!==r&&(c=c.redNeg()),this.point(c,e)};Wr.prototype.validate=function(e){if(e.isInfinity())return!0;e.normalize();var r=e.x.redSqr(),i=e.y.redSqr(),n=r.redMul(this.a).redAdd(i),s=this.c2.redMul(this.one.redAdd(this.d.redMul(r).redMul(i)));return n.cmp(s)===0};function We(t,e,r,i,n){Fo.BasePoint.call(this,t,"projective"),e===null&&r===null&&i===null?(this.x=this.curve.zero,this.y=this.curve.one,this.z=this.curve.one,this.t=this.curve.zero,this.zOne=!0):(this.x=new $i(e,16),this.y=new $i(r,16),this.z=i?new $i(i,16):this.curve.one,this.t=n&&new $i(n,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.t&&!this.t.red&&(this.t=this.t.toRed(this.curve.red)),this.zOne=this.z===this.curve.one,this.curve.extended&&!this.t&&(this.t=this.x.redMul(this.y),this.zOne||(this.t=this.t.redMul(this.z.redInvm()))))}u1(We,Fo.BasePoint);Wr.prototype.pointFromJSON=function(e){return We.fromJSON(this,e)};Wr.prototype.point=function(e,r,i,n){return new We(this,e,r,i,n)};We.fromJSON=function(e,r){return new We(e,r[0],r[1],r[2])};We.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"};We.prototype.isInfinity=function(){return this.x.cmpn(0)===0&&(this.y.cmp(this.z)===0||this.zOne&&this.y.cmp(this.curve.c)===0)};We.prototype._extDbl=function(){var e=this.x.redSqr(),r=this.y.redSqr(),i=this.z.redSqr();i=i.redIAdd(i);var n=this.curve._mulA(e),s=this.x.redAdd(this.y).redSqr().redISub(e).redISub(r),a=n.redAdd(r),c=a.redSub(i),d=n.redSub(r),u=s.redMul(c),l=a.redMul(d),g=s.redMul(d),w=c.redMul(a);return this.curve.point(u,l,w,g)};We.prototype._projDbl=function(){var e=this.x.redAdd(this.y).redSqr(),r=this.x.redSqr(),i=this.y.redSqr(),n,s,a,c,d,u;if(this.curve.twisted){c=this.curve._mulA(r);var l=c.redAdd(i);this.zOne?(n=e.redSub(r).redSub(i).redMul(l.redSub(this.curve.two)),s=l.redMul(c.redSub(i)),a=l.redSqr().redSub(l).redSub(l)):(d=this.z.redSqr(),u=l.redSub(d).redISub(d),n=e.redSub(r).redISub(i).redMul(u),s=l.redMul(c.redSub(i)),a=l.redMul(u))}else c=r.redAdd(i),d=this.curve._mulC(this.z).redSqr(),u=c.redSub(d).redSub(d),n=this.curve._mulC(e.redISub(c)).redMul(u),s=this.curve._mulC(c).redMul(r.redISub(i)),a=c.redMul(u);return this.curve.point(n,s,a)};We.prototype.dbl=function(){return this.isInfinity()?this:this.curve.extended?this._extDbl():this._projDbl()};We.prototype._extAdd=function(e){var r=this.y.redSub(this.x).redMul(e.y.redSub(e.x)),i=this.y.redAdd(this.x).redMul(e.y.redAdd(e.x)),n=this.t.redMul(this.curve.dd).redMul(e.t),s=this.z.redMul(e.z.redAdd(e.z)),a=i.redSub(r),c=s.redSub(n),d=s.redAdd(n),u=i.redAdd(r),l=a.redMul(c),g=d.redMul(u),w=a.redMul(u),E=c.redMul(d);return this.curve.point(l,g,E,w)};We.prototype._projAdd=function(e){var r=this.z.redMul(e.z),i=r.redSqr(),n=this.x.redMul(e.x),s=this.y.redMul(e.y),a=this.curve.d.redMul(n).redMul(s),c=i.redSub(a),d=i.redAdd(a),u=this.x.redAdd(this.y).redMul(e.x.redAdd(e.y)).redISub(n).redISub(s),l=r.redMul(c).redMul(u),g,w;return this.curve.twisted?(g=r.redMul(d).redMul(s.redSub(this.curve._mulA(n))),w=c.redMul(d)):(g=r.redMul(d).redMul(s.redSub(n)),w=this.curve._mulC(c).redMul(d)),this.curve.point(l,g,w)};We.prototype.add=function(e){return this.isInfinity()?e:e.isInfinity()?this:this.curve.extended?this._extAdd(e):this._projAdd(e)};We.prototype.mul=function(e){return this._hasDoubles(e)?this.curve._fixedNafMul(this,e):this.curve._wnafMul(this,e)};We.prototype.mulAdd=function(e,r,i){return this.curve._wnafMulAdd(1,[this,r],[e,i],2,!1)};We.prototype.jmulAdd=function(e,r,i){return this.curve._wnafMulAdd(1,[this,r],[e,i],2,!0)};We.prototype.normalize=function(){if(this.zOne)return this;var e=this.z.redInvm();return this.x=this.x.redMul(e),this.y=this.y.redMul(e),this.t&&(this.t=this.t.redMul(e)),this.z=this.curve.one,this.zOne=!0,this};We.prototype.neg=function(){return this.curve.point(this.x.redNeg(),this.y,this.z,this.t&&this.t.redNeg())};We.prototype.getX=function(){return this.normalize(),this.x.fromRed()};We.prototype.getY=function(){return this.normalize(),this.y.fromRed()};We.prototype.eq=function(e){return this===e||this.getX().cmp(e.getX())===0&&this.getY().cmp(e.getY())===0};We.prototype.eqXToP=function(e){var r=e.toRed(this.curve.red).redMul(this.z);if(this.x.cmp(r)===0)return!0;for(var i=e.clone(),n=this.curve.redN.redMul(this.z);;){if(i.iadd(this.curve.n),i.cmp(this.curve.p)>=0)return!1;if(r.redIAdd(n),this.x.cmp(r)===0)return!0}};We.prototype.toP=We.prototype.normalize;We.prototype.mixedAdd=We.prototype.add;(function(t){var e=t;e.base=Oo,e.short=W9,e.mont=J9,e.edwards=X9})(hd);var No={},Ac,wu;function Q9(){return wu||(wu=1,Ac={doubles:{step:4,points:[["e60fce93b59e9ec53011aabc21c23e97b2a31369b87a5ae9c44ee89e2a6dec0a","f7e3507399e595929db99f34f57937101296891e44d23f0be1f32cce69616821"],["8282263212c609d9ea2a6e3e172de238d8c39cabd5ac1ca10646e23fd5f51508","11f8a8098557dfe45e8256e830b60ace62d613ac2f7b17bed31b6eaff6e26caf"],["175e159f728b865a72f99cc6c6fc846de0b93833fd2222ed73fce5b551e5b739","d3506e0d9e3c79eba4ef97a51ff71f5eacb5955add24345c6efa6ffee9fed695"],["363d90d447b00c9c99ceac05b6262ee053441c7e55552ffe526bad8f83ff4640","4e273adfc732221953b445397f3363145b9a89008199ecb62003c7f3bee9de9"],["8b4b5f165df3c2be8c6244b5b745638843e4a781a15bcd1b69f79a55dffdf80c","4aad0a6f68d308b4b3fbd7813ab0da04f9e336546162ee56b3eff0c65fd4fd36"],["723cbaa6e5db996d6bf771c00bd548c7b700dbffa6c0e77bcb6115925232fcda","96e867b5595cc498a921137488824d6e2660a0653779494801dc069d9eb39f5f"],["eebfa4d493bebf98ba5feec812c2d3b50947961237a919839a533eca0e7dd7fa","5d9a8ca3970ef0f269ee7edaf178089d9ae4cdc3a711f712ddfd4fdae1de8999"],["100f44da696e71672791d0a09b7bde459f1215a29b3c03bfefd7835b39a48db0","cdd9e13192a00b772ec8f3300c090666b7ff4a18ff5195ac0fbd5cd62bc65a09"],["e1031be262c7ed1b1dc9227a4a04c017a77f8d4464f3b3852c8acde6e534fd2d","9d7061928940405e6bb6a4176597535af292dd419e1ced79a44f18f29456a00d"],["feea6cae46d55b530ac2839f143bd7ec5cf8b266a41d6af52d5e688d9094696d","e57c6b6c97dce1bab06e4e12bf3ecd5c981c8957cc41442d3155debf18090088"],["da67a91d91049cdcb367be4be6ffca3cfeed657d808583de33fa978bc1ec6cb1","9bacaa35481642bc41f463f7ec9780e5dec7adc508f740a17e9ea8e27a68be1d"],["53904faa0b334cdda6e000935ef22151ec08d0f7bb11069f57545ccc1a37b7c0","5bc087d0bc80106d88c9eccac20d3c1c13999981e14434699dcb096b022771c8"],["8e7bcd0bd35983a7719cca7764ca906779b53a043a9b8bcaeff959f43ad86047","10b7770b2a3da4b3940310420ca9514579e88e2e47fd68b3ea10047e8460372a"],["385eed34c1cdff21e6d0818689b81bde71a7f4f18397e6690a841e1599c43862","283bebc3e8ea23f56701de19e9ebf4576b304eec2086dc8cc0458fe5542e5453"],["6f9d9b803ecf191637c73a4413dfa180fddf84a5947fbc9c606ed86c3fac3a7","7c80c68e603059ba69b8e2a30e45c4d47ea4dd2f5c281002d86890603a842160"],["3322d401243c4e2582a2147c104d6ecbf774d163db0f5e5313b7e0e742d0e6bd","56e70797e9664ef5bfb019bc4ddaf9b72805f63ea2873af624f3a2e96c28b2a0"],["85672c7d2de0b7da2bd1770d89665868741b3f9af7643397721d74d28134ab83","7c481b9b5b43b2eb6374049bfa62c2e5e77f17fcc5298f44c8e3094f790313a6"],["948bf809b1988a46b06c9f1919413b10f9226c60f668832ffd959af60c82a0a","53a562856dcb6646dc6b74c5d1c3418c6d4dff08c97cd2bed4cb7f88d8c8e589"],["6260ce7f461801c34f067ce0f02873a8f1b0e44dfc69752accecd819f38fd8e8","bc2da82b6fa5b571a7f09049776a1ef7ecd292238051c198c1a84e95b2b4ae17"],["e5037de0afc1d8d43d8348414bbf4103043ec8f575bfdc432953cc8d2037fa2d","4571534baa94d3b5f9f98d09fb990bddbd5f5b03ec481f10e0e5dc841d755bda"],["e06372b0f4a207adf5ea905e8f1771b4e7e8dbd1c6a6c5b725866a0ae4fce725","7a908974bce18cfe12a27bb2ad5a488cd7484a7787104870b27034f94eee31dd"],["213c7a715cd5d45358d0bbf9dc0ce02204b10bdde2a3f58540ad6908d0559754","4b6dad0b5ae462507013ad06245ba190bb4850f5f36a7eeddff2c27534b458f2"],["4e7c272a7af4b34e8dbb9352a5419a87e2838c70adc62cddf0cc3a3b08fbd53c","17749c766c9d0b18e16fd09f6def681b530b9614bff7dd33e0b3941817dcaae6"],["fea74e3dbe778b1b10f238ad61686aa5c76e3db2be43057632427e2840fb27b6","6e0568db9b0b13297cf674deccb6af93126b596b973f7b77701d3db7f23cb96f"],["76e64113f677cf0e10a2570d599968d31544e179b760432952c02a4417bdde39","c90ddf8dee4e95cf577066d70681f0d35e2a33d2b56d2032b4b1752d1901ac01"],["c738c56b03b2abe1e8281baa743f8f9a8f7cc643df26cbee3ab150242bcbb891","893fb578951ad2537f718f2eacbfbbbb82314eef7880cfe917e735d9699a84c3"],["d895626548b65b81e264c7637c972877d1d72e5f3a925014372e9f6588f6c14b","febfaa38f2bc7eae728ec60818c340eb03428d632bb067e179363ed75d7d991f"],["b8da94032a957518eb0f6433571e8761ceffc73693e84edd49150a564f676e03","2804dfa44805a1e4d7c99cc9762808b092cc584d95ff3b511488e4e74efdf6e7"],["e80fea14441fb33a7d8adab9475d7fab2019effb5156a792f1a11778e3c0df5d","eed1de7f638e00771e89768ca3ca94472d155e80af322ea9fcb4291b6ac9ec78"],["a301697bdfcd704313ba48e51d567543f2a182031efd6915ddc07bbcc4e16070","7370f91cfb67e4f5081809fa25d40f9b1735dbf7c0a11a130c0d1a041e177ea1"],["90ad85b389d6b936463f9d0512678de208cc330b11307fffab7ac63e3fb04ed4","e507a3620a38261affdcbd9427222b839aefabe1582894d991d4d48cb6ef150"],["8f68b9d2f63b5f339239c1ad981f162ee88c5678723ea3351b7b444c9ec4c0da","662a9f2dba063986de1d90c2b6be215dbbea2cfe95510bfdf23cbf79501fff82"],["e4f3fb0176af85d65ff99ff9198c36091f48e86503681e3e6686fd5053231e11","1e63633ad0ef4f1c1661a6d0ea02b7286cc7e74ec951d1c9822c38576feb73bc"],["8c00fa9b18ebf331eb961537a45a4266c7034f2f0d4e1d0716fb6eae20eae29e","efa47267fea521a1a9dc343a3736c974c2fadafa81e36c54e7d2a4c66702414b"],["e7a26ce69dd4829f3e10cec0a9e98ed3143d084f308b92c0997fddfc60cb3e41","2a758e300fa7984b471b006a1aafbb18d0a6b2c0420e83e20e8a9421cf2cfd51"],["b6459e0ee3662ec8d23540c223bcbdc571cbcb967d79424f3cf29eb3de6b80ef","67c876d06f3e06de1dadf16e5661db3c4b3ae6d48e35b2ff30bf0b61a71ba45"],["d68a80c8280bb840793234aa118f06231d6f1fc67e73c5a5deda0f5b496943e8","db8ba9fff4b586d00c4b1f9177b0e28b5b0e7b8f7845295a294c84266b133120"],["324aed7df65c804252dc0270907a30b09612aeb973449cea4095980fc28d3d5d","648a365774b61f2ff130c0c35aec1f4f19213b0c7e332843967224af96ab7c84"],["4df9c14919cde61f6d51dfdbe5fee5dceec4143ba8d1ca888e8bd373fd054c96","35ec51092d8728050974c23a1d85d4b5d506cdc288490192ebac06cad10d5d"],["9c3919a84a474870faed8a9c1cc66021523489054d7f0308cbfc99c8ac1f98cd","ddb84f0f4a4ddd57584f044bf260e641905326f76c64c8e6be7e5e03d4fc599d"],["6057170b1dd12fdf8de05f281d8e06bb91e1493a8b91d4cc5a21382120a959e5","9a1af0b26a6a4807add9a2daf71df262465152bc3ee24c65e899be932385a2a8"],["a576df8e23a08411421439a4518da31880cef0fba7d4df12b1a6973eecb94266","40a6bf20e76640b2c92b97afe58cd82c432e10a7f514d9f3ee8be11ae1b28ec8"],["7778a78c28dec3e30a05fe9629de8c38bb30d1f5cf9a3a208f763889be58ad71","34626d9ab5a5b22ff7098e12f2ff580087b38411ff24ac563b513fc1fd9f43ac"],["928955ee637a84463729fd30e7afd2ed5f96274e5ad7e5cb09eda9c06d903ac","c25621003d3f42a827b78a13093a95eeac3d26efa8a8d83fc5180e935bcd091f"],["85d0fef3ec6db109399064f3a0e3b2855645b4a907ad354527aae75163d82751","1f03648413a38c0be29d496e582cf5663e8751e96877331582c237a24eb1f962"],["ff2b0dce97eece97c1c9b6041798b85dfdfb6d8882da20308f5404824526087e","493d13fef524ba188af4c4dc54d07936c7b7ed6fb90e2ceb2c951e01f0c29907"],["827fbbe4b1e880ea9ed2b2e6301b212b57f1ee148cd6dd28780e5e2cf856e241","c60f9c923c727b0b71bef2c67d1d12687ff7a63186903166d605b68baec293ec"],["eaa649f21f51bdbae7be4ae34ce6e5217a58fdce7f47f9aa7f3b58fa2120e2b3","be3279ed5bbbb03ac69a80f89879aa5a01a6b965f13f7e59d47a5305ba5ad93d"],["e4a42d43c5cf169d9391df6decf42ee541b6d8f0c9a137401e23632dda34d24f","4d9f92e716d1c73526fc99ccfb8ad34ce886eedfa8d8e4f13a7f7131deba9414"],["1ec80fef360cbdd954160fadab352b6b92b53576a88fea4947173b9d4300bf19","aeefe93756b5340d2f3a4958a7abbf5e0146e77f6295a07b671cdc1cc107cefd"],["146a778c04670c2f91b00af4680dfa8bce3490717d58ba889ddb5928366642be","b318e0ec3354028add669827f9d4b2870aaa971d2f7e5ed1d0b297483d83efd0"],["fa50c0f61d22e5f07e3acebb1aa07b128d0012209a28b9776d76a8793180eef9","6b84c6922397eba9b72cd2872281a68a5e683293a57a213b38cd8d7d3f4f2811"],["da1d61d0ca721a11b1a5bf6b7d88e8421a288ab5d5bba5220e53d32b5f067ec2","8157f55a7c99306c79c0766161c91e2966a73899d279b48a655fba0f1ad836f1"],["a8e282ff0c9706907215ff98e8fd416615311de0446f1e062a73b0610d064e13","7f97355b8db81c09abfb7f3c5b2515888b679a3e50dd6bd6cef7c73111f4cc0c"],["174a53b9c9a285872d39e56e6913cab15d59b1fa512508c022f382de8319497c","ccc9dc37abfc9c1657b4155f2c47f9e6646b3a1d8cb9854383da13ac079afa73"],["959396981943785c3d3e57edf5018cdbe039e730e4918b3d884fdff09475b7ba","2e7e552888c331dd8ba0386a4b9cd6849c653f64c8709385e9b8abf87524f2fd"],["d2a63a50ae401e56d645a1153b109a8fcca0a43d561fba2dbb51340c9d82b151","e82d86fb6443fcb7565aee58b2948220a70f750af484ca52d4142174dcf89405"],["64587e2335471eb890ee7896d7cfdc866bacbdbd3839317b3436f9b45617e073","d99fcdd5bf6902e2ae96dd6447c299a185b90a39133aeab358299e5e9faf6589"],["8481bde0e4e4d885b3a546d3e549de042f0aa6cea250e7fd358d6c86dd45e458","38ee7b8cba5404dd84a25bf39cecb2ca900a79c42b262e556d64b1b59779057e"],["13464a57a78102aa62b6979ae817f4637ffcfed3c4b1ce30bcd6303f6caf666b","69be159004614580ef7e433453ccb0ca48f300a81d0942e13f495a907f6ecc27"],["bc4a9df5b713fe2e9aef430bcc1dc97a0cd9ccede2f28588cada3a0d2d83f366","d3a81ca6e785c06383937adf4b798caa6e8a9fbfa547b16d758d666581f33c1"],["8c28a97bf8298bc0d23d8c749452a32e694b65e30a9472a3954ab30fe5324caa","40a30463a3305193378fedf31f7cc0eb7ae784f0451cb9459e71dc73cbef9482"],["8ea9666139527a8c1dd94ce4f071fd23c8b350c5a4bb33748c4ba111faccae0","620efabbc8ee2782e24e7c0cfb95c5d735b783be9cf0f8e955af34a30e62b945"],["dd3625faef5ba06074669716bbd3788d89bdde815959968092f76cc4eb9a9787","7a188fa3520e30d461da2501045731ca941461982883395937f68d00c644a573"],["f710d79d9eb962297e4f6232b40e8f7feb2bc63814614d692c12de752408221e","ea98e67232d3b3295d3b535532115ccac8612c721851617526ae47a9c77bfc82"]]},naf:{wnd:7,points:[["f9308a019258c31049344f85f89d5229b531c845836f99b08601f113bce036f9","388f7b0f632de8140fe337e62a37f3566500a99934c2231b6cb9fd7584b8e672"],["2f8bde4d1a07209355b4a7250a5c5128e88b84bddc619ab7cba8d569b240efe4","d8ac222636e5e3d6d4dba9dda6c9c426f788271bab0d6840dca87d3aa6ac62d6"],["5cbdf0646e5db4eaa398f365f2ea7a0e3d419b7e0330e39ce92bddedcac4f9bc","6aebca40ba255960a3178d6d861a54dba813d0b813fde7b5a5082628087264da"],["acd484e2f0c7f65309ad178a9f559abde09796974c57e714c35f110dfc27ccbe","cc338921b0a7d9fd64380971763b61e9add888a4375f8e0f05cc262ac64f9c37"],["774ae7f858a9411e5ef4246b70c65aac5649980be5c17891bbec17895da008cb","d984a032eb6b5e190243dd56d7b7b365372db1e2dff9d6a8301d74c9c953c61b"],["f28773c2d975288bc7d1d205c3748651b075fbc6610e58cddeeddf8f19405aa8","ab0902e8d880a89758212eb65cdaf473a1a06da521fa91f29b5cb52db03ed81"],["d7924d4f7d43ea965a465ae3095ff41131e5946f3c85f79e44adbcf8e27e080e","581e2872a86c72a683842ec228cc6defea40af2bd896d3a5c504dc9ff6a26b58"],["defdea4cdb677750a420fee807eacf21eb9898ae79b9768766e4faa04a2d4a34","4211ab0694635168e997b0ead2a93daeced1f4a04a95c0f6cfb199f69e56eb77"],["2b4ea0a797a443d293ef5cff444f4979f06acfebd7e86d277475656138385b6c","85e89bc037945d93b343083b5a1c86131a01f60c50269763b570c854e5c09b7a"],["352bbf4a4cdd12564f93fa332ce333301d9ad40271f8107181340aef25be59d5","321eb4075348f534d59c18259dda3e1f4a1b3b2e71b1039c67bd3d8bcf81998c"],["2fa2104d6b38d11b0230010559879124e42ab8dfeff5ff29dc9cdadd4ecacc3f","2de1068295dd865b64569335bd5dd80181d70ecfc882648423ba76b532b7d67"],["9248279b09b4d68dab21a9b066edda83263c3d84e09572e269ca0cd7f5453714","73016f7bf234aade5d1aa71bdea2b1ff3fc0de2a887912ffe54a32ce97cb3402"],["daed4f2be3a8bf278e70132fb0beb7522f570e144bf615c07e996d443dee8729","a69dce4a7d6c98e8d4a1aca87ef8d7003f83c230f3afa726ab40e52290be1c55"],["c44d12c7065d812e8acf28d7cbb19f9011ecd9e9fdf281b0e6a3b5e87d22e7db","2119a460ce326cdc76c45926c982fdac0e106e861edf61c5a039063f0e0e6482"],["6a245bf6dc698504c89a20cfded60853152b695336c28063b61c65cbd269e6b4","e022cf42c2bd4a708b3f5126f16a24ad8b33ba48d0423b6efd5e6348100d8a82"],["1697ffa6fd9de627c077e3d2fe541084ce13300b0bec1146f95ae57f0d0bd6a5","b9c398f186806f5d27561506e4557433a2cf15009e498ae7adee9d63d01b2396"],["605bdb019981718b986d0f07e834cb0d9deb8360ffb7f61df982345ef27a7479","2972d2de4f8d20681a78d93ec96fe23c26bfae84fb14db43b01e1e9056b8c49"],["62d14dab4150bf497402fdc45a215e10dcb01c354959b10cfe31c7e9d87ff33d","80fc06bd8cc5b01098088a1950eed0db01aa132967ab472235f5642483b25eaf"],["80c60ad0040f27dade5b4b06c408e56b2c50e9f56b9b8b425e555c2f86308b6f","1c38303f1cc5c30f26e66bad7fe72f70a65eed4cbe7024eb1aa01f56430bd57a"],["7a9375ad6167ad54aa74c6348cc54d344cc5dc9487d847049d5eabb0fa03c8fb","d0e3fa9eca8726909559e0d79269046bdc59ea10c70ce2b02d499ec224dc7f7"],["d528ecd9b696b54c907a9ed045447a79bb408ec39b68df504bb51f459bc3ffc9","eecf41253136e5f99966f21881fd656ebc4345405c520dbc063465b521409933"],["49370a4b5f43412ea25f514e8ecdad05266115e4a7ecb1387231808f8b45963","758f3f41afd6ed428b3081b0512fd62a54c3f3afbb5b6764b653052a12949c9a"],["77f230936ee88cbbd73df930d64702ef881d811e0e1498e2f1c13eb1fc345d74","958ef42a7886b6400a08266e9ba1b37896c95330d97077cbbe8eb3c7671c60d6"],["f2dac991cc4ce4b9ea44887e5c7c0bce58c80074ab9d4dbaeb28531b7739f530","e0dedc9b3b2f8dad4da1f32dec2531df9eb5fbeb0598e4fd1a117dba703a3c37"],["463b3d9f662621fb1b4be8fbbe2520125a216cdfc9dae3debcba4850c690d45b","5ed430d78c296c3543114306dd8622d7c622e27c970a1de31cb377b01af7307e"],["f16f804244e46e2a09232d4aff3b59976b98fac14328a2d1a32496b49998f247","cedabd9b82203f7e13d206fcdf4e33d92a6c53c26e5cce26d6579962c4e31df6"],["caf754272dc84563b0352b7a14311af55d245315ace27c65369e15f7151d41d1","cb474660ef35f5f2a41b643fa5e460575f4fa9b7962232a5c32f908318a04476"],["2600ca4b282cb986f85d0f1709979d8b44a09c07cb86d7c124497bc86f082120","4119b88753c15bd6a693b03fcddbb45d5ac6be74ab5f0ef44b0be9475a7e4b40"],["7635ca72d7e8432c338ec53cd12220bc01c48685e24f7dc8c602a7746998e435","91b649609489d613d1d5e590f78e6d74ecfc061d57048bad9e76f302c5b9c61"],["754e3239f325570cdbbf4a87deee8a66b7f2b33479d468fbc1a50743bf56cc18","673fb86e5bda30fb3cd0ed304ea49a023ee33d0197a695d0c5d98093c536683"],["e3e6bd1071a1e96aff57859c82d570f0330800661d1c952f9fe2694691d9b9e8","59c9e0bba394e76f40c0aa58379a3cb6a5a2283993e90c4167002af4920e37f5"],["186b483d056a033826ae73d88f732985c4ccb1f32ba35f4b4cc47fdcf04aa6eb","3b952d32c67cf77e2e17446e204180ab21fb8090895138b4a4a797f86e80888b"],["df9d70a6b9876ce544c98561f4be4f725442e6d2b737d9c91a8321724ce0963f","55eb2dafd84d6ccd5f862b785dc39d4ab157222720ef9da217b8c45cf2ba2417"],["5edd5cc23c51e87a497ca815d5dce0f8ab52554f849ed8995de64c5f34ce7143","efae9c8dbc14130661e8cec030c89ad0c13c66c0d17a2905cdc706ab7399a868"],["290798c2b6476830da12fe02287e9e777aa3fba1c355b17a722d362f84614fba","e38da76dcd440621988d00bcf79af25d5b29c094db2a23146d003afd41943e7a"],["af3c423a95d9f5b3054754efa150ac39cd29552fe360257362dfdecef4053b45","f98a3fd831eb2b749a93b0e6f35cfb40c8cd5aa667a15581bc2feded498fd9c6"],["766dbb24d134e745cccaa28c99bf274906bb66b26dcf98df8d2fed50d884249a","744b1152eacbe5e38dcc887980da38b897584a65fa06cedd2c924f97cbac5996"],["59dbf46f8c94759ba21277c33784f41645f7b44f6c596a58ce92e666191abe3e","c534ad44175fbc300f4ea6ce648309a042ce739a7919798cd85e216c4a307f6e"],["f13ada95103c4537305e691e74e9a4a8dd647e711a95e73cb62dc6018cfd87b8","e13817b44ee14de663bf4bc808341f326949e21a6a75c2570778419bdaf5733d"],["7754b4fa0e8aced06d4167a2c59cca4cda1869c06ebadfb6488550015a88522c","30e93e864e669d82224b967c3020b8fa8d1e4e350b6cbcc537a48b57841163a2"],["948dcadf5990e048aa3874d46abef9d701858f95de8041d2a6828c99e2262519","e491a42537f6e597d5d28a3224b1bc25df9154efbd2ef1d2cbba2cae5347d57e"],["7962414450c76c1689c7b48f8202ec37fb224cf5ac0bfa1570328a8a3d7c77ab","100b610ec4ffb4760d5c1fc133ef6f6b12507a051f04ac5760afa5b29db83437"],["3514087834964b54b15b160644d915485a16977225b8847bb0dd085137ec47ca","ef0afbb2056205448e1652c48e8127fc6039e77c15c2378b7e7d15a0de293311"],["d3cc30ad6b483e4bc79ce2c9dd8bc54993e947eb8df787b442943d3f7b527eaf","8b378a22d827278d89c5e9be8f9508ae3c2ad46290358630afb34db04eede0a4"],["1624d84780732860ce1c78fcbfefe08b2b29823db913f6493975ba0ff4847610","68651cf9b6da903e0914448c6cd9d4ca896878f5282be4c8cc06e2a404078575"],["733ce80da955a8a26902c95633e62a985192474b5af207da6df7b4fd5fc61cd4","f5435a2bd2badf7d485a4d8b8db9fcce3e1ef8e0201e4578c54673bc1dc5ea1d"],["15d9441254945064cf1a1c33bbd3b49f8966c5092171e699ef258dfab81c045c","d56eb30b69463e7234f5137b73b84177434800bacebfc685fc37bbe9efe4070d"],["a1d0fcf2ec9de675b612136e5ce70d271c21417c9d2b8aaaac138599d0717940","edd77f50bcb5a3cab2e90737309667f2641462a54070f3d519212d39c197a629"],["e22fbe15c0af8ccc5780c0735f84dbe9a790badee8245c06c7ca37331cb36980","a855babad5cd60c88b430a69f53a1a7a38289154964799be43d06d77d31da06"],["311091dd9860e8e20ee13473c1155f5f69635e394704eaa74009452246cfa9b3","66db656f87d1f04fffd1f04788c06830871ec5a64feee685bd80f0b1286d8374"],["34c1fd04d301be89b31c0442d3e6ac24883928b45a9340781867d4232ec2dbdf","9414685e97b1b5954bd46f730174136d57f1ceeb487443dc5321857ba73abee"],["f219ea5d6b54701c1c14de5b557eb42a8d13f3abbcd08affcc2a5e6b049b8d63","4cb95957e83d40b0f73af4544cccf6b1f4b08d3c07b27fb8d8c2962a400766d1"],["d7b8740f74a8fbaab1f683db8f45de26543a5490bca627087236912469a0b448","fa77968128d9c92ee1010f337ad4717eff15db5ed3c049b3411e0315eaa4593b"],["32d31c222f8f6f0ef86f7c98d3a3335ead5bcd32abdd94289fe4d3091aa824bf","5f3032f5892156e39ccd3d7915b9e1da2e6dac9e6f26e961118d14b8462e1661"],["7461f371914ab32671045a155d9831ea8793d77cd59592c4340f86cbc18347b5","8ec0ba238b96bec0cbdddcae0aa442542eee1ff50c986ea6b39847b3cc092ff6"],["ee079adb1df1860074356a25aa38206a6d716b2c3e67453d287698bad7b2b2d6","8dc2412aafe3be5c4c5f37e0ecc5f9f6a446989af04c4e25ebaac479ec1c8c1e"],["16ec93e447ec83f0467b18302ee620f7e65de331874c9dc72bfd8616ba9da6b5","5e4631150e62fb40d0e8c2a7ca5804a39d58186a50e497139626778e25b0674d"],["eaa5f980c245f6f038978290afa70b6bd8855897f98b6aa485b96065d537bd99","f65f5d3e292c2e0819a528391c994624d784869d7e6ea67fb18041024edc07dc"],["78c9407544ac132692ee1910a02439958ae04877151342ea96c4b6b35a49f51","f3e0319169eb9b85d5404795539a5e68fa1fbd583c064d2462b675f194a3ddb4"],["494f4be219a1a77016dcd838431aea0001cdc8ae7a6fc688726578d9702857a5","42242a969283a5f339ba7f075e36ba2af925ce30d767ed6e55f4b031880d562c"],["a598a8030da6d86c6bc7f2f5144ea549d28211ea58faa70ebf4c1e665c1fe9b5","204b5d6f84822c307e4b4a7140737aec23fc63b65b35f86a10026dbd2d864e6b"],["c41916365abb2b5d09192f5f2dbeafec208f020f12570a184dbadc3e58595997","4f14351d0087efa49d245b328984989d5caf9450f34bfc0ed16e96b58fa9913"],["841d6063a586fa475a724604da03bc5b92a2e0d2e0a36acfe4c73a5514742881","73867f59c0659e81904f9a1c7543698e62562d6744c169ce7a36de01a8d6154"],["5e95bb399a6971d376026947f89bde2f282b33810928be4ded112ac4d70e20d5","39f23f366809085beebfc71181313775a99c9aed7d8ba38b161384c746012865"],["36e4641a53948fd476c39f8a99fd974e5ec07564b5315d8bf99471bca0ef2f66","d2424b1b1abe4eb8164227b085c9aa9456ea13493fd563e06fd51cf5694c78fc"],["336581ea7bfbbb290c191a2f507a41cf5643842170e914faeab27c2c579f726","ead12168595fe1be99252129b6e56b3391f7ab1410cd1e0ef3dcdcabd2fda224"],["8ab89816dadfd6b6a1f2634fcf00ec8403781025ed6890c4849742706bd43ede","6fdcef09f2f6d0a044e654aef624136f503d459c3e89845858a47a9129cdd24e"],["1e33f1a746c9c5778133344d9299fcaa20b0938e8acff2544bb40284b8c5fb94","60660257dd11b3aa9c8ed618d24edff2306d320f1d03010e33a7d2057f3b3b6"],["85b7c1dcb3cec1b7ee7f30ded79dd20a0ed1f4cc18cbcfcfa410361fd8f08f31","3d98a9cdd026dd43f39048f25a8847f4fcafad1895d7a633c6fed3c35e999511"],["29df9fbd8d9e46509275f4b125d6d45d7fbe9a3b878a7af872a2800661ac5f51","b4c4fe99c775a606e2d8862179139ffda61dc861c019e55cd2876eb2a27d84b"],["a0b1cae06b0a847a3fea6e671aaf8adfdfe58ca2f768105c8082b2e449fce252","ae434102edde0958ec4b19d917a6a28e6b72da1834aff0e650f049503a296cf2"],["4e8ceafb9b3e9a136dc7ff67e840295b499dfb3b2133e4ba113f2e4c0e121e5","cf2174118c8b6d7a4b48f6d534ce5c79422c086a63460502b827ce62a326683c"],["d24a44e047e19b6f5afb81c7ca2f69080a5076689a010919f42725c2b789a33b","6fb8d5591b466f8fc63db50f1c0f1c69013f996887b8244d2cdec417afea8fa3"],["ea01606a7a6c9cdd249fdfcfacb99584001edd28abbab77b5104e98e8e3b35d4","322af4908c7312b0cfbfe369f7a7b3cdb7d4494bc2823700cfd652188a3ea98d"],["af8addbf2b661c8a6c6328655eb96651252007d8c5ea31be4ad196de8ce2131f","6749e67c029b85f52a034eafd096836b2520818680e26ac8f3dfbcdb71749700"],["e3ae1974566ca06cc516d47e0fb165a674a3dabcfca15e722f0e3450f45889","2aeabe7e4531510116217f07bf4d07300de97e4874f81f533420a72eeb0bd6a4"],["591ee355313d99721cf6993ffed1e3e301993ff3ed258802075ea8ced397e246","b0ea558a113c30bea60fc4775460c7901ff0b053d25ca2bdeee98f1a4be5d196"],["11396d55fda54c49f19aa97318d8da61fa8584e47b084945077cf03255b52984","998c74a8cd45ac01289d5833a7beb4744ff536b01b257be4c5767bea93ea57a4"],["3c5d2a1ba39c5a1790000738c9e0c40b8dcdfd5468754b6405540157e017aa7a","b2284279995a34e2f9d4de7396fc18b80f9b8b9fdd270f6661f79ca4c81bd257"],["cc8704b8a60a0defa3a99a7299f2e9c3fbc395afb04ac078425ef8a1793cc030","bdd46039feed17881d1e0862db347f8cf395b74fc4bcdc4e940b74e3ac1f1b13"],["c533e4f7ea8555aacd9777ac5cad29b97dd4defccc53ee7ea204119b2889b197","6f0a256bc5efdf429a2fb6242f1a43a2d9b925bb4a4b3a26bb8e0f45eb596096"],["c14f8f2ccb27d6f109f6d08d03cc96a69ba8c34eec07bbcf566d48e33da6593","c359d6923bb398f7fd4473e16fe1c28475b740dd098075e6c0e8649113dc3a38"],["a6cbc3046bc6a450bac24789fa17115a4c9739ed75f8f21ce441f72e0b90e6ef","21ae7f4680e889bb130619e2c0f95a360ceb573c70603139862afd617fa9b9f"],["347d6d9a02c48927ebfb86c1359b1caf130a3c0267d11ce6344b39f99d43cc38","60ea7f61a353524d1c987f6ecec92f086d565ab687870cb12689ff1e31c74448"],["da6545d2181db8d983f7dcb375ef5866d47c67b1bf31c8cf855ef7437b72656a","49b96715ab6878a79e78f07ce5680c5d6673051b4935bd897fea824b77dc208a"],["c40747cc9d012cb1a13b8148309c6de7ec25d6945d657146b9d5994b8feb1111","5ca560753be2a12fc6de6caf2cb489565db936156b9514e1bb5e83037e0fa2d4"],["4e42c8ec82c99798ccf3a610be870e78338c7f713348bd34c8203ef4037f3502","7571d74ee5e0fb92a7a8b33a07783341a5492144cc54bcc40a94473693606437"],["3775ab7089bc6af823aba2e1af70b236d251cadb0c86743287522a1b3b0dedea","be52d107bcfa09d8bcb9736a828cfa7fac8db17bf7a76a2c42ad961409018cf7"],["cee31cbf7e34ec379d94fb814d3d775ad954595d1314ba8846959e3e82f74e26","8fd64a14c06b589c26b947ae2bcf6bfa0149ef0be14ed4d80f448a01c43b1c6d"],["b4f9eaea09b6917619f6ea6a4eb5464efddb58fd45b1ebefcdc1a01d08b47986","39e5c9925b5a54b07433a4f18c61726f8bb131c012ca542eb24a8ac07200682a"],["d4263dfc3d2df923a0179a48966d30ce84e2515afc3dccc1b77907792ebcc60e","62dfaf07a0f78feb30e30d6295853ce189e127760ad6cf7fae164e122a208d54"],["48457524820fa65a4f8d35eb6930857c0032acc0a4a2de422233eeda897612c4","25a748ab367979d98733c38a1fa1c2e7dc6cc07db2d60a9ae7a76aaa49bd0f77"],["dfeeef1881101f2cb11644f3a2afdfc2045e19919152923f367a1767c11cceda","ecfb7056cf1de042f9420bab396793c0c390bde74b4bbdff16a83ae09a9a7517"],["6d7ef6b17543f8373c573f44e1f389835d89bcbc6062ced36c82df83b8fae859","cd450ec335438986dfefa10c57fea9bcc521a0959b2d80bbf74b190dca712d10"],["e75605d59102a5a2684500d3b991f2e3f3c88b93225547035af25af66e04541f","f5c54754a8f71ee540b9b48728473e314f729ac5308b06938360990e2bfad125"],["eb98660f4c4dfaa06a2be453d5020bc99a0c2e60abe388457dd43fefb1ed620c","6cb9a8876d9cb8520609af3add26cd20a0a7cd8a9411131ce85f44100099223e"],["13e87b027d8514d35939f2e6892b19922154596941888336dc3563e3b8dba942","fef5a3c68059a6dec5d624114bf1e91aac2b9da568d6abeb2570d55646b8adf1"],["ee163026e9fd6fe017c38f06a5be6fc125424b371ce2708e7bf4491691e5764a","1acb250f255dd61c43d94ccc670d0f58f49ae3fa15b96623e5430da0ad6c62b2"],["b268f5ef9ad51e4d78de3a750c2dc89b1e626d43505867999932e5db33af3d80","5f310d4b3c99b9ebb19f77d41c1dee018cf0d34fd4191614003e945a1216e423"],["ff07f3118a9df035e9fad85eb6c7bfe42b02f01ca99ceea3bf7ffdba93c4750d","438136d603e858a3a5c440c38eccbaddc1d2942114e2eddd4740d098ced1f0d8"],["8d8b9855c7c052a34146fd20ffb658bea4b9f69e0d825ebec16e8c3ce2b526a1","cdb559eedc2d79f926baf44fb84ea4d44bcf50fee51d7ceb30e2e7f463036758"],["52db0b5384dfbf05bfa9d472d7ae26dfe4b851ceca91b1eba54263180da32b63","c3b997d050ee5d423ebaf66a6db9f57b3180c902875679de924b69d84a7b375"],["e62f9490d3d51da6395efd24e80919cc7d0f29c3f3fa48c6fff543becbd43352","6d89ad7ba4876b0b22c2ca280c682862f342c8591f1daf5170e07bfd9ccafa7d"],["7f30ea2476b399b4957509c88f77d0191afa2ff5cb7b14fd6d8e7d65aaab1193","ca5ef7d4b231c94c3b15389a5f6311e9daff7bb67b103e9880ef4bff637acaec"],["5098ff1e1d9f14fb46a210fada6c903fef0fb7b4a1dd1d9ac60a0361800b7a00","9731141d81fc8f8084d37c6e7542006b3ee1b40d60dfe5362a5b132fd17ddc0"],["32b78c7de9ee512a72895be6b9cbefa6e2f3c4ccce445c96b9f2c81e2778ad58","ee1849f513df71e32efc3896ee28260c73bb80547ae2275ba497237794c8753c"],["e2cb74fddc8e9fbcd076eef2a7c72b0ce37d50f08269dfc074b581550547a4f7","d3aa2ed71c9dd2247a62df062736eb0baddea9e36122d2be8641abcb005cc4a4"],["8438447566d4d7bedadc299496ab357426009a35f235cb141be0d99cd10ae3a8","c4e1020916980a4da5d01ac5e6ad330734ef0d7906631c4f2390426b2edd791f"],["4162d488b89402039b584c6fc6c308870587d9c46f660b878ab65c82c711d67e","67163e903236289f776f22c25fb8a3afc1732f2b84b4e95dbda47ae5a0852649"],["3fad3fa84caf0f34f0f89bfd2dcf54fc175d767aec3e50684f3ba4a4bf5f683d","cd1bc7cb6cc407bb2f0ca647c718a730cf71872e7d0d2a53fa20efcdfe61826"],["674f2600a3007a00568c1a7ce05d0816c1fb84bf1370798f1c69532faeb1a86b","299d21f9413f33b3edf43b257004580b70db57da0b182259e09eecc69e0d38a5"],["d32f4da54ade74abb81b815ad1fb3b263d82d6c692714bcff87d29bd5ee9f08f","f9429e738b8e53b968e99016c059707782e14f4535359d582fc416910b3eea87"],["30e4e670435385556e593657135845d36fbb6931f72b08cb1ed954f1e3ce3ff6","462f9bce619898638499350113bbc9b10a878d35da70740dc695a559eb88db7b"],["be2062003c51cc3004682904330e4dee7f3dcd10b01e580bf1971b04d4cad297","62188bc49d61e5428573d48a74e1c655b1c61090905682a0d5558ed72dccb9bc"],["93144423ace3451ed29e0fb9ac2af211cb6e84a601df5993c419859fff5df04a","7c10dfb164c3425f5c71a3f9d7992038f1065224f72bb9d1d902a6d13037b47c"],["b015f8044f5fcbdcf21ca26d6c34fb8197829205c7b7d2a7cb66418c157b112c","ab8c1e086d04e813744a655b2df8d5f83b3cdc6faa3088c1d3aea1454e3a1d5f"],["d5e9e1da649d97d89e4868117a465a3a4f8a18de57a140d36b3f2af341a21b52","4cb04437f391ed73111a13cc1d4dd0db1693465c2240480d8955e8592f27447a"],["d3ae41047dd7ca065dbf8ed77b992439983005cd72e16d6f996a5316d36966bb","bd1aeb21ad22ebb22a10f0303417c6d964f8cdd7df0aca614b10dc14d125ac46"],["463e2763d885f958fc66cdd22800f0a487197d0a82e377b49f80af87c897b065","bfefacdb0e5d0fd7df3a311a94de062b26b80c61fbc97508b79992671ef7ca7f"],["7985fdfd127c0567c6f53ec1bb63ec3158e597c40bfe747c83cddfc910641917","603c12daf3d9862ef2b25fe1de289aed24ed291e0ec6708703a5bd567f32ed03"],["74a1ad6b5f76e39db2dd249410eac7f99e74c59cb83d2d0ed5ff1543da7703e9","cc6157ef18c9c63cd6193d83631bbea0093e0968942e8c33d5737fd790e0db08"],["30682a50703375f602d416664ba19b7fc9bab42c72747463a71d0896b22f6da3","553e04f6b018b4fa6c8f39e7f311d3176290d0e0f19ca73f17714d9977a22ff8"],["9e2158f0d7c0d5f26c3791efefa79597654e7a2b2464f52b1ee6c1347769ef57","712fcdd1b9053f09003a3481fa7762e9ffd7c8ef35a38509e2fbf2629008373"],["176e26989a43c9cfeba4029c202538c28172e566e3c4fce7322857f3be327d66","ed8cc9d04b29eb877d270b4878dc43c19aefd31f4eee09ee7b47834c1fa4b1c3"],["75d46efea3771e6e68abb89a13ad747ecf1892393dfc4f1b7004788c50374da8","9852390a99507679fd0b86fd2b39a868d7efc22151346e1a3ca4726586a6bed8"],["809a20c67d64900ffb698c4c825f6d5f2310fb0451c869345b7319f645605721","9e994980d9917e22b76b061927fa04143d096ccc54963e6a5ebfa5f3f8e286c1"],["1b38903a43f7f114ed4500b4eac7083fdefece1cf29c63528d563446f972c180","4036edc931a60ae889353f77fd53de4a2708b26b6f5da72ad3394119daf408f9"]]}}),Ac}(function(t){var e=t,r=uo,i=hd,n=nr,s=n.assert;function a(u){u.type==="short"?this.curve=new i.short(u):u.type==="edwards"?this.curve=new i.edwards(u):this.curve=new i.mont(u),this.g=this.curve.g,this.n=this.curve.n,this.hash=u.hash,s(this.g.validate(),"Invalid curve"),s(this.g.mul(this.n).isInfinity(),"Invalid curve, G*N != O")}e.PresetCurve=a;function c(u,l){Object.defineProperty(e,u,{configurable:!0,enumerable:!0,get:function(){var g=new a(l);return Object.defineProperty(e,u,{configurable:!0,enumerable:!0,value:g}),g}})}c("p192",{type:"short",prime:"p192",p:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff",a:"ffffffff ffffffff ffffffff fffffffe ffffffff fffffffc",b:"64210519 e59c80e7 0fa7e9ab 72243049 feb8deec c146b9b1",n:"ffffffff ffffffff ffffffff 99def836 146bc9b1 b4d22831",hash:r.sha256,gRed:!1,g:["188da80e b03090f6 7cbf20eb 43a18800 f4ff0afd 82ff1012","07192b95 ffc8da78 631011ed 6b24cdd5 73f977a1 1e794811"]}),c("p224",{type:"short",prime:"p224",p:"ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001",a:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff fffffffe",b:"b4050a85 0c04b3ab f5413256 5044b0b7 d7bfd8ba 270b3943 2355ffb4",n:"ffffffff ffffffff ffffffff ffff16a2 e0b8f03e 13dd2945 5c5c2a3d",hash:r.sha256,gRed:!1,g:["b70e0cbd 6bb4bf7f 321390b9 4a03c1d3 56c21122 343280d6 115c1d21","bd376388 b5f723fb 4c22dfe6 cd4375a0 5a074764 44d58199 85007e34"]}),c("p256",{type:"short",prime:null,p:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff ffffffff",a:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff fffffffc",b:"5ac635d8 aa3a93e7 b3ebbd55 769886bc 651d06b0 cc53b0f6 3bce3c3e 27d2604b",n:"ffffffff 00000000 ffffffff ffffffff bce6faad a7179e84 f3b9cac2 fc632551",hash:r.sha256,gRed:!1,g:["6b17d1f2 e12c4247 f8bce6e5 63a440f2 77037d81 2deb33a0 f4a13945 d898c296","4fe342e2 fe1a7f9b 8ee7eb4a 7c0f9e16 2bce3357 6b315ece cbb64068 37bf51f5"]}),c("p384",{type:"short",prime:null,p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 ffffffff",a:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 fffffffc",b:"b3312fa7 e23ee7e4 988e056b e3f82d19 181d9c6e fe814112 0314088f 5013875a c656398d 8a2ed19d 2a85c8ed d3ec2aef",n:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff c7634d81 f4372ddf 581a0db2 48b0a77a ecec196a ccc52973",hash:r.sha384,gRed:!1,g:["aa87ca22 be8b0537 8eb1c71e f320ad74 6e1d3b62 8ba79b98 59f741e0 82542a38 5502f25d bf55296c 3a545e38 72760ab7","3617de4a 96262c6f 5d9e98bf 9292dc29 f8f41dbd 289a147c e9da3113 b5f0b8c0 0a60b1ce 1d7e819d 7a431d7c 90ea0e5f"]}),c("p521",{type:"short",prime:null,p:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff",a:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffc",b:"00000051 953eb961 8e1c9a1f 929a21a0 b68540ee a2da725b 99b315f3 b8b48991 8ef109e1 56193951 ec7e937b 1652c0bd 3bb1bf07 3573df88 3d2c34f1 ef451fd4 6b503f00",n:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffa 51868783 bf2f966b 7fcc0148 f709a5d0 3bb5c9b8 899c47ae bb6fb71e 91386409",hash:r.sha512,gRed:!1,g:["000000c6 858e06b7 0404e9cd 9e3ecb66 2395b442 9c648139 053fb521 f828af60 6b4d3dba a14b5e77 efe75928 fe1dc127 a2ffa8de 3348b3c1 856a429b f97e7e31 c2e5bd66","00000118 39296a78 9a3bc004 5c8a5fb4 2c7d1bd9 98f54449 579b4468 17afbd17 273e662c 97ee7299 5ef42640 c550b901 3fad0761 353c7086 a272c240 88be9476 9fd16650"]}),c("curve25519",{type:"mont",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"76d06",b:"1",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:r.sha256,gRed:!1,g:["9"]}),c("ed25519",{type:"edwards",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"-1",c:"1",d:"52036cee2b6ffe73 8cc740797779e898 00700a4d4141d8ab 75eb4dca135978a3",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:r.sha256,gRed:!1,g:["216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a","6666666666666666666666666666666666666666666666666666666666666658"]});var d;try{d=Q9()}catch{d=void 0}c("secp256k1",{type:"short",prime:"k256",p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f",a:"0",b:"7",n:"ffffffff ffffffff ffffffff fffffffe baaedce6 af48a03b bfd25e8c d0364141",h:"1",hash:r.sha256,beta:"7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee",lambda:"5363ad4cc05c30e0a5261c028812645a122e22ea20816678df02967c1b23bd72",basis:[{a:"3086d221a7d46bcde86c90e49284eb15",b:"-e4437ed6010e88286f547fa90abfe4c3"},{a:"114ca50f7a8e2f3f657c1108d9d44cfd8",b:"3086d221a7d46bcde86c90e49284eb15"}],gRed:!1,g:["79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798","483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8",d]})})(No);var e7=Mi,t7=nr,Ef=t7.assert;function Ft(t,e){this.ec=t,this.priv=null,this.pub=null,e.priv&&this._importPrivate(e.priv,e.privEnc),e.pub&&this._importPublic(e.pub,e.pubEnc)}var r7=Ft;Ft.fromPublic=function(e,r,i){return r instanceof Ft?r:new Ft(e,{pub:r,pubEnc:i})};Ft.fromPrivate=function(e,r,i){return r instanceof Ft?r:new Ft(e,{priv:r,privEnc:i})};Ft.prototype.validate=function(){var e=this.getPublic();return e.isInfinity()?{result:!1,reason:"Invalid public key"}:e.validate()?e.mul(this.ec.curve.n).isInfinity()?{result:!0,reason:null}:{result:!1,reason:"Public key * N != O"}:{result:!1,reason:"Public key is not a point"}};Ft.prototype.getPublic=function(e,r){return typeof e=="string"&&(r=e,e=null),this.pub||(this.pub=this.ec.g.mul(this.priv)),r?this.pub.encode(r,e):this.pub};Ft.prototype.getPrivate=function(e){return e==="hex"?this.priv.toString(16,2):this.priv};Ft.prototype._importPrivate=function(e,r){this.priv=new e7(e,r||16),this.priv=this.priv.umod(this.ec.curve.n)};Ft.prototype._importPublic=function(e,r){if(e.x||e.y){this.ec.curve.type==="mont"?Ef(e.x,"Need x coordinate"):(this.ec.curve.type==="short"||this.ec.curve.type==="edwards")&&Ef(e.x&&e.y,"Need both x and y coordinate"),this.pub=this.ec.curve.point(e.x,e.y);return}this.pub=this.ec.curve.decodePoint(e,r)};Ft.prototype.derive=function(e){return e.validate()||Ef(e.validate(),"public point not validated"),e.mul(this.priv).getX()};Ft.prototype.sign=function(e,r,i){return this.ec.sign(e,this,r,i)};Ft.prototype.verify=function(e,r,i){return this.ec.verify(e,r,this,void 0,i)};Ft.prototype.inspect=function(){return"<Key priv: "+(this.priv&&this.priv.toString(16,2))+" pub: "+(this.pub&&this.pub.inspect())+" >"};var to=Mi,ld=nr,i7=ld.assert;function Co(t,e){if(t instanceof Co)return t;this._importDER(t,e)||(i7(t.r&&t.s,"Signature without r or s"),this.r=new to(t.r,16),this.s=new to(t.s,16),t.recoveryParam===void 0?this.recoveryParam=null:this.recoveryParam=t.recoveryParam)}var n7=Co;function s7(){this.place=0}function Pc(t,e){var r=t[e.place++];if(!(r&128))return r;var i=r&15;if(i===0||i>4||t[e.place]===0)return!1;for(var n=0,s=0,a=e.place;s<i;s++,a++)n<<=8,n|=t[a],n>>>=0;return n<=127?!1:(e.place=a,n)}function _u(t){for(var e=0,r=t.length-1;!t[e]&&!(t[e+1]&128)&&e<r;)e++;return e===0?t:t.slice(e)}Co.prototype._importDER=function(e,r){e=ld.toArray(e,r);var i=new s7;if(e[i.place++]!==48)return!1;var n=Pc(e,i);if(n===!1||n+i.place!==e.length||e[i.place++]!==2)return!1;var s=Pc(e,i);if(s===!1||e[i.place]&128)return!1;var a=e.slice(i.place,s+i.place);if(i.place+=s,e[i.place++]!==2)return!1;var c=Pc(e,i);if(c===!1||e.length!==c+i.place||e[i.place]&128)return!1;var d=e.slice(i.place,c+i.place);if(a[0]===0)if(a[1]&128)a=a.slice(1);else return!1;if(d[0]===0)if(d[1]&128)d=d.slice(1);else return!1;return this.r=new to(a),this.s=new to(d),this.recoveryParam=null,!0};function Oc(t,e){if(e<128){t.push(e);return}var r=1+(Math.log(e)/Math.LN2>>>3);for(t.push(r|128);--r;)t.push(e>>>(r<<3)&255);t.push(e)}Co.prototype.toDER=function(e){var r=this.r.toArray(),i=this.s.toArray();for(r[0]&128&&(r=[0].concat(r)),i[0]&128&&(i=[0].concat(i)),r=_u(r),i=_u(i);!i[0]&&!(i[1]&128);)i=i.slice(1);var n=[2];Oc(n,r.length),n=n.concat(r),n.push(2),Oc(n,i.length);var s=n.concat(i),a=[48];return Oc(a,s.length),a=a.concat(s),ld.encode(a,e)};var Rr=Mi,l1=I0,a7=nr,Rc=No,o7=lo(),pn=a7.assert,pd=r7,To=n7;function lr(t){if(!(this instanceof lr))return new lr(t);typeof t=="string"&&(pn(Object.prototype.hasOwnProperty.call(Rc,t),"Unknown curve "+t),t=Rc[t]),t instanceof Rc.PresetCurve&&(t={curve:t}),this.curve=t.curve.curve,this.n=this.curve.n,this.nh=this.n.ushrn(1),this.g=this.curve.g,this.g=t.curve.g,this.g.precompute(t.curve.n.bitLength()+1),this.hash=t.hash||t.curve.hash}var c7=lr;lr.prototype.keyPair=function(e){return new pd(this,e)};lr.prototype.keyFromPrivate=function(e,r){return pd.fromPrivate(this,e,r)};lr.prototype.keyFromPublic=function(e,r){return pd.fromPublic(this,e,r)};lr.prototype.genKeyPair=function(e){e||(e={});for(var r=new l1({hash:this.hash,pers:e.pers,persEnc:e.persEnc||"utf8",entropy:e.entropy||o7(this.hash.hmacStrength),entropyEnc:e.entropy&&e.entropyEnc||"utf8",nonce:this.n.toArray()}),i=this.n.byteLength(),n=this.n.sub(new Rr(2));;){var s=new Rr(r.generate(i));if(!(s.cmp(n)>0))return s.iaddn(1),this.keyFromPrivate(s)}};lr.prototype._truncateToN=function(e,r,i){var n;if(Rr.isBN(e)||typeof e=="number")e=new Rr(e,16),n=e.byteLength();else if(typeof e=="object")n=e.length,e=new Rr(e,16);else{var s=e.toString();n=s.length+1>>>1,e=new Rr(s,16)}typeof i!="number"&&(i=n*8);var a=i-this.n.bitLength();return a>0&&(e=e.ushrn(a)),!r&&e.cmp(this.n)>=0?e.sub(this.n):e};lr.prototype.sign=function(e,r,i,n){if(typeof i=="object"&&(n=i,i=null),n||(n={}),typeof e!="string"&&typeof e!="number"&&!Rr.isBN(e)){pn(typeof e=="object"&&e&&typeof e.length=="number","Expected message to be an array-like, a hex string, or a BN instance"),pn(e.length>>>0===e.length);for(var s=0;s<e.length;s++)pn((e[s]&255)===e[s])}r=this.keyFromPrivate(r,i),e=this._truncateToN(e,!1,n.msgBitLength),pn(!e.isNeg(),"Can not sign a negative message");var a=this.n.byteLength(),c=r.getPrivate().toArray("be",a),d=e.toArray("be",a);pn(new Rr(d).eq(e),"Can not sign message");for(var u=new l1({hash:this.hash,entropy:c,nonce:d,pers:n.pers,persEnc:n.persEnc||"utf8"}),l=this.n.sub(new Rr(1)),g=0;;g++){var w=n.k?n.k(g):new Rr(u.generate(this.n.byteLength()));if(w=this._truncateToN(w,!0),!(w.cmpn(1)<=0||w.cmp(l)>=0)){var E=this.g.mul(w);if(!E.isInfinity()){var $=E.getX(),I=$.umod(this.n);if(I.cmpn(0)!==0){var M=w.invm(this.n).mul(I.mul(r.getPrivate()).iadd(e));if(M=M.umod(this.n),M.cmpn(0)!==0){var P=(E.getY().isOdd()?1:0)|($.cmp(I)!==0?2:0);return n.canonical&&M.cmp(this.nh)>0&&(M=this.n.sub(M),P^=1),new To({r:I,s:M,recoveryParam:P})}}}}}};lr.prototype.verify=function(e,r,i,n,s){s||(s={}),e=this._truncateToN(e,!1,s.msgBitLength),i=this.keyFromPublic(i,n),r=new To(r,"hex");var a=r.r,c=r.s;if(a.cmpn(1)<0||a.cmp(this.n)>=0||c.cmpn(1)<0||c.cmp(this.n)>=0)return!1;var d=c.invm(this.n),u=d.mul(e).umod(this.n),l=d.mul(a).umod(this.n),g;return this.curve._maxwellTrick?(g=this.g.jmulAdd(u,i.getPublic(),l),g.isInfinity()?!1:g.eqXToP(a)):(g=this.g.mulAdd(u,i.getPublic(),l),g.isInfinity()?!1:g.getX().umod(this.n).cmp(a)===0)};lr.prototype.recoverPubKey=function(t,e,r,i){pn((3&r)===r,"The recovery param is more than two bits"),e=new To(e,i);var n=this.n,s=new Rr(t),a=e.r,c=e.s,d=r&1,u=r>>1;if(a.cmp(this.curve.p.umod(this.curve.n))>=0&&u)throw new Error("Unable to find sencond key candinate");u?a=this.curve.pointFromX(a.add(this.curve.n),d):a=this.curve.pointFromX(a,d);var l=e.r.invm(n),g=n.sub(s).mul(l).umod(n),w=c.mul(l).umod(n);return this.g.mulAdd(g,a,w)};lr.prototype.getKeyRecoveryParam=function(t,e,r,i){if(e=new To(e,i),e.recoveryParam!==null)return e.recoveryParam;for(var n=0;n<4;n++){var s;try{s=this.recoverPubKey(t,e,n)}catch{continue}if(s.eq(r))return n}throw new Error("Unable to find valid recovery factor")};var ta=nr,p1=ta.assert,Eu=ta.parseBytes,us=ta.cachedProperty;function pt(t,e){this.eddsa=t,this._secret=Eu(e.secret),t.isPoint(e.pub)?this._pub=e.pub:this._pubBytes=Eu(e.pub)}pt.fromPublic=function(e,r){return r instanceof pt?r:new pt(e,{pub:r})};pt.fromSecret=function(e,r){return r instanceof pt?r:new pt(e,{secret:r})};pt.prototype.secret=function(){return this._secret};us(pt,"pubBytes",function(){return this.eddsa.encodePoint(this.pub())});us(pt,"pub",function(){return this._pubBytes?this.eddsa.decodePoint(this._pubBytes):this.eddsa.g.mul(this.priv())});us(pt,"privBytes",function(){var e=this.eddsa,r=this.hash(),i=e.encodingLength-1,n=r.slice(0,e.encodingLength);return n[0]&=248,n[i]&=127,n[i]|=64,n});us(pt,"priv",function(){return this.eddsa.decodeInt(this.privBytes())});us(pt,"hash",function(){return this.eddsa.hash().update(this.secret()).digest()});us(pt,"messagePrefix",function(){return this.hash().slice(this.eddsa.encodingLength)});pt.prototype.sign=function(e){return p1(this._secret,"KeyPair can only verify"),this.eddsa.sign(e,this)};pt.prototype.verify=function(e,r){return this.eddsa.verify(e,r,this)};pt.prototype.getSecret=function(e){return p1(this._secret,"KeyPair is public only"),ta.encode(this.secret(),e)};pt.prototype.getPublic=function(e){return ta.encode(this.pubBytes(),e)};var f7=pt,d7=Mi,Bo=nr,Su=Bo.assert,qo=Bo.cachedProperty,h7=Bo.parseBytes;function Sn(t,e){this.eddsa=t,typeof e!="object"&&(e=h7(e)),Array.isArray(e)&&(Su(e.length===t.encodingLength*2,"Signature has invalid size"),e={R:e.slice(0,t.encodingLength),S:e.slice(t.encodingLength)}),Su(e.R&&e.S,"Signature without R or S"),t.isPoint(e.R)&&(this._R=e.R),e.S instanceof d7&&(this._S=e.S),this._Rencoded=Array.isArray(e.R)?e.R:e.Rencoded,this._Sencoded=Array.isArray(e.S)?e.S:e.Sencoded}qo(Sn,"S",function(){return this.eddsa.decodeInt(this.Sencoded())});qo(Sn,"R",function(){return this.eddsa.decodePoint(this.Rencoded())});qo(Sn,"Rencoded",function(){return this.eddsa.encodePoint(this.R())});qo(Sn,"Sencoded",function(){return this.eddsa.encodeInt(this.S())});Sn.prototype.toBytes=function(){return this.Rencoded().concat(this.Sencoded())};Sn.prototype.toHex=function(){return Bo.encode(this.toBytes(),"hex").toUpperCase()};var u7=Sn,l7=uo,p7=No,Xn=nr,b7=Xn.assert,b1=Xn.parseBytes,g1=f7,$u=u7;function kt(t){if(b7(t==="ed25519","only tested with ed25519 so far"),!(this instanceof kt))return new kt(t);t=p7[t].curve,this.curve=t,this.g=t.g,this.g.precompute(t.n.bitLength()+1),this.pointClass=t.point().constructor,this.encodingLength=Math.ceil(t.n.bitLength()/8),this.hash=l7.sha512}var g7=kt;kt.prototype.sign=function(e,r){e=b1(e);var i=this.keyFromSecret(r),n=this.hashInt(i.messagePrefix(),e),s=this.g.mul(n),a=this.encodePoint(s),c=this.hashInt(a,i.pubBytes(),e).mul(i.priv()),d=n.add(c).umod(this.curve.n);return this.makeSignature({R:s,S:d,Rencoded:a})};kt.prototype.verify=function(e,r,i){if(e=b1(e),r=this.makeSignature(r),r.S().gte(r.eddsa.curve.n)||r.S().isNeg())return!1;var n=this.keyFromPublic(i),s=this.hashInt(r.Rencoded(),n.pubBytes(),e),a=this.g.mul(r.S()),c=r.R().add(n.pub().mul(s));return c.eq(a)};kt.prototype.hashInt=function(){for(var e=this.hash(),r=0;r<arguments.length;r++)e.update(arguments[r]);return Xn.intFromLE(e.digest()).umod(this.curve.n)};kt.prototype.keyFromPublic=function(e){return g1.fromPublic(this,e)};kt.prototype.keyFromSecret=function(e){return g1.fromSecret(this,e)};kt.prototype.makeSignature=function(e){return e instanceof $u?e:new $u(this,e)};kt.prototype.encodePoint=function(e){var r=e.getY().toArray("le",this.encodingLength);return r[this.encodingLength-1]|=e.getX().isOdd()?128:0,r};kt.prototype.decodePoint=function(e){e=Xn.parseBytes(e);var r=e.length-1,i=e.slice(0,r).concat(e[r]&-129),n=(e[r]&128)!==0,s=Xn.intFromLE(i);return this.curve.pointFromY(s,n)};kt.prototype.encodeInt=function(e){return e.toArray("le",this.encodingLength)};kt.prototype.decodeInt=function(e){return Xn.intFromLE(e)};kt.prototype.isPoint=function(e){return e instanceof this.pointClass};(function(t){var e=t;e.version=k9.version,e.utils=nr,e.rand=lo(),e.curve=hd,e.curves=No,e.ec=c7,e.eddsa=g7})(d1);const v7={waku:{publish:"waku_publish",batchPublish:"waku_batchPublish",subscribe:"waku_subscribe",batchSubscribe:"waku_batchSubscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe",batchUnsubscribe:"waku_batchUnsubscribe",batchFetchMessages:"waku_batchFetchMessages"},irn:{publish:"irn_publish",batchPublish:"irn_batchPublish",subscribe:"irn_subscribe",batchSubscribe:"irn_batchSubscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe",batchUnsubscribe:"irn_batchUnsubscribe",batchFetchMessages:"irn_batchFetchMessages"},iridium:{publish:"iridium_publish",batchPublish:"iridium_batchPublish",subscribe:"iridium_subscribe",batchSubscribe:"iridium_batchSubscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe",batchUnsubscribe:"iridium_batchUnsubscribe",batchFetchMessages:"iridium_batchFetchMessages"}};var y7={};const m7=":";function Jn(t){const[e,r]=t.split(m7);return{namespace:e,reference:r}}function v1(t,e){return t.includes(":")?[t]:e.chains||[]}const w7="ReactNative",tr={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},_7="js";function ro(){return typeof Fr<"u"&&typeof Fr.versions<"u"&&typeof Fr.versions.node<"u"}function Ji(){return!Vs()&&!!Uf()&&navigator.product===w7}function E7(){return Ji()&&typeof ne<"u"&&typeof(ne==null?void 0:ne.Platform)<"u"&&(ne==null?void 0:ne.Platform.OS)==="android"}function S7(){return Ji()&&typeof ne<"u"&&typeof(ne==null?void 0:ne.Platform)<"u"&&(ne==null?void 0:ne.Platform.OS)==="ios"}function ra(){return!ro()&&!!Uf()&&!!Vs()}function ia(){return Ji()?tr.reactNative:ro()?tr.node:ra()?tr.browser:tr.unknown}function xu(){var t;try{return Ji()&&typeof ne<"u"&&typeof(ne==null?void 0:ne.Application)<"u"?(t=ne.Application)==null?void 0:t.applicationId:void 0}catch{return}}function $7(t,e){const r=new URLSearchParams(t);for(const i of Object.keys(e).sort())if(e.hasOwnProperty(i)){const n=e[i];n!==void 0&&r.set(i,n)}return r.toString()}function y1(){return D0()||{name:"",description:"",url:"",icons:[""]}}function x7(){if(ia()===tr.reactNative&&typeof ne<"u"&&typeof(ne==null?void 0:ne.Platform)<"u"){const{OS:r,Version:i}=ne.Platform;return[r,i].join("-")}const t=wg();if(t===null)return"unknown";const e=t.os?t.os.replace(" ","").toLowerCase():"unknown";return t.type==="browser"?[e,t.name,t.version].join("-"):[e,t.version].join("-")}function I7(){var t;const e=ia();return e===tr.browser?[e,((t=L0())==null?void 0:t.host)||"unknown"].join(":"):e}function m1(t,e,r){const i=x7(),n=I7();return[[t,e].join("-"),[_7,r].join("-"),i,n].join("/")}function M7({protocol:t,version:e,relayUrl:r,sdkVersion:i,auth:n,projectId:s,useOnCloseEvent:a,bundleId:c,packageName:d}){const u=r.split("?"),l=m1(t,e,i),g={auth:n,ua:l,projectId:s,useOnCloseEvent:a,packageName:d||void 0,bundleId:c||void 0},w=$7(u[1]||"",g);return u[0]+"?"+w}function gn(t,e){return t.filter(r=>e.includes(r)).length===t.length}function w1(t){return Object.fromEntries(t.entries())}function _1(t){return new Map(Object.entries(t))}function dn(t=G.FIVE_MINUTES,e){const r=G.toMiliseconds(t||G.FIVE_MINUTES);let i,n,s,a;return{resolve:c=>{s&&i&&(clearTimeout(s),i(c),a=Promise.resolve(c))},reject:c=>{s&&n&&(clearTimeout(s),n(c))},done:()=>new Promise((c,d)=>{if(a)return c(a);s=setTimeout(()=>{const u=new Error(e);a=Promise.reject(u),d(u)},r),i=c,n=d})}}function zi(t,e,r){return new Promise(async(i,n)=>{const s=setTimeout(()=>n(new Error(r)),e);try{const a=await t;i(a)}catch(a){n(a)}clearTimeout(s)})}function E1(t,e){if(typeof e=="string"&&e.startsWith(`${t}:`))return e;if(t.toLowerCase()==="topic"){if(typeof e!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${e}`}else if(t.toLowerCase()==="id"){if(typeof e!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${e}`}throw new Error(`Unknown expirer target type: ${t}`)}function A7(t){return E1("topic",t)}function P7(t){return E1("id",t)}function S1(t){const[e,r]=t.split(":"),i={id:void 0,topic:void 0};if(e==="topic"&&typeof r=="string")i.topic=r;else if(e==="id"&&Number.isInteger(Number(r)))i.id=Number(r);else throw new Error(`Invalid target, expected id:number or topic:string, got ${e}:${r}`);return i}function nt(t,e){return G.fromMiliseconds(Date.now()+G.toMiliseconds(t))}function Di(t){return Date.now()>=G.toMiliseconds(t)}function qe(t,e){return`${t}${e?`:${e}`:""}`}function La(t=[],e=[]){return[...new Set([...t,...e])]}async function O7({id:t,topic:e,wcDeepLink:r}){var i;try{if(!r)return;const n=typeof r=="string"?JSON.parse(r):r,s=n==null?void 0:n.href;if(typeof s!="string")return;const a=R7(s,t,e),c=ia();if(c===tr.browser){if(!((i=Vs())!=null&&i.hasFocus())){console.warn("Document does not have focus, skipping deeplink.");return}F7(a)}else c===tr.reactNative&&typeof(ne==null?void 0:ne.Linking)<"u"&&await ne.Linking.openURL(a)}catch(n){console.error(n)}}function R7(t,e,r){const i=`requestId=${e}&sessionTopic=${r}`;t.endsWith("/")&&(t=t.slice(0,-1));let n=`${t}`;if(t.startsWith("https://t.me")){const s=t.includes("?")?"&startapp=":"?startapp=";n=`${n}${s}${B7(i,!0)}`}else n=`${n}/wc?${i}`;return n}function F7(t){let e="_self";T7()?e="_top":(C7()||t.startsWith("https://")||t.startsWith("http://"))&&(e="_blank"),window.open(t,e,"noreferrer noopener")}async function N7(t,e){let r="";try{if(ra()&&(r=localStorage.getItem(e),r))return r;r=await t.getItem(e)}catch(i){console.error(i)}return r}function Iu(t,e){if(!t.includes(e))return null;const r=t.split(/([&,?,=])/),i=r.indexOf(e);return r[i+2]}function Mu(){return typeof crypto<"u"&&crypto!=null&&crypto.randomUUID?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/gu,t=>{const e=Math.random()*16|0;return(t==="x"?e:e&3|8).toString(16)})}function bd(){return typeof Fr<"u"&&y7.IS_VITEST==="true"}function C7(){return typeof window<"u"&&(!!window.TelegramWebviewProxy||!!window.Telegram||!!window.TelegramWebviewProxyProto)}function T7(){try{return window.self!==window.top}catch{return!1}}function B7(t,e=!1){const r=Nr.from(t).toString("base64");return e?r.replace(/[=]/g,""):r}function $1(t){return Nr.from(t,"base64").toString("utf-8")}function q7(t){return new Promise(e=>setTimeout(e,t))}function Ds(t){if(!Number.isSafeInteger(t)||t<0)throw new Error("positive integer expected, got "+t)}function L7(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function Lo(t,...e){if(!L7(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error("Uint8Array expected of length "+e+", got length="+t.length)}function gd(t){if(typeof t!="function"||typeof t.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");Ds(t.outputLen),Ds(t.blockLen)}function Qn(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function x1(t,e){Lo(t);const r=e.outputLen;if(t.length<r)throw new Error("digestInto() expects output buffer of length at least "+r)}const Ia=BigInt(2**32-1),Au=BigInt(32);function D7(t,e=!1){return e?{h:Number(t&Ia),l:Number(t>>Au&Ia)}:{h:Number(t>>Au&Ia)|0,l:Number(t&Ia)|0}}function U7(t,e=!1){let r=new Uint32Array(t.length),i=new Uint32Array(t.length);for(let n=0;n<t.length;n++){const{h:s,l:a}=D7(t[n],e);[r[n],i[n]]=[s,a]}return[r,i]}const z7=(t,e,r)=>t<<r|e>>>32-r,j7=(t,e,r)=>e<<r|t>>>32-r,k7=(t,e,r)=>e<<r-32|t>>>64-r,H7=(t,e,r)=>t<<r-32|e>>>64-r,Tn=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;function K7(t){return new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4))}function Fc(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function Ur(t,e){return t<<32-e|t>>>e}const Pu=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function V7(t){return t<<24&4278190080|t<<8&16711680|t>>>8&65280|t>>>24&255}function Ou(t){for(let e=0;e<t.length;e++)t[e]=V7(t[e])}function W7(t){if(typeof t!="string")throw new Error("utf8ToBytes expected string, got "+typeof t);return new Uint8Array(new TextEncoder().encode(t))}function es(t){return typeof t=="string"&&(t=W7(t)),Lo(t),t}let vd=class{clone(){return this._cloneInto()}};function I1(t){const e=i=>t().update(es(i)).digest(),r=t();return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=()=>t(),e}function na(t=32){if(Tn&&typeof Tn.getRandomValues=="function")return Tn.getRandomValues(new Uint8Array(t));if(Tn&&typeof Tn.randomBytes=="function")return Tn.randomBytes(t);throw new Error("crypto.getRandomValues must be defined")}const M1=[],A1=[],P1=[],G7=BigInt(0),Es=BigInt(1),J7=BigInt(2),Y7=BigInt(7),Z7=BigInt(256),X7=BigInt(113);for(let t=0,e=Es,r=1,i=0;t<24;t++){[r,i]=[i,(2*r+3*i)%5],M1.push(2*(5*i+r)),A1.push((t+1)*(t+2)/2%64);let n=G7;for(let s=0;s<7;s++)e=(e<<Es^(e>>Y7)*X7)%Z7,e&J7&&(n^=Es<<(Es<<BigInt(s))-Es);P1.push(n)}const[Q7,ew]=U7(P1,!0),Ru=(t,e,r)=>r>32?k7(t,e,r):z7(t,e,r),Fu=(t,e,r)=>r>32?H7(t,e,r):j7(t,e,r);function tw(t,e=24){const r=new Uint32Array(10);for(let i=24-e;i<24;i++){for(let a=0;a<10;a++)r[a]=t[a]^t[a+10]^t[a+20]^t[a+30]^t[a+40];for(let a=0;a<10;a+=2){const c=(a+8)%10,d=(a+2)%10,u=r[d],l=r[d+1],g=Ru(u,l,1)^r[c],w=Fu(u,l,1)^r[c+1];for(let E=0;E<50;E+=10)t[a+E]^=g,t[a+E+1]^=w}let n=t[2],s=t[3];for(let a=0;a<24;a++){const c=A1[a],d=Ru(n,s,c),u=Fu(n,s,c),l=M1[a];n=t[l],s=t[l+1],t[l]=d,t[l+1]=u}for(let a=0;a<50;a+=10){for(let c=0;c<10;c++)r[c]=t[a+c];for(let c=0;c<10;c++)t[a+c]^=~r[(c+2)%10]&r[(c+4)%10]}t[0]^=Q7[i],t[1]^=ew[i]}r.fill(0)}let rw=class O1 extends vd{constructor(e,r,i,n=!1,s=24){if(super(),this.blockLen=e,this.suffix=r,this.outputLen=i,this.enableXOF=n,this.rounds=s,this.pos=0,this.posOut=0,this.finished=!1,this.destroyed=!1,Ds(i),0>=this.blockLen||this.blockLen>=200)throw new Error("Sha3 supports only keccak-f1600 function");this.state=new Uint8Array(200),this.state32=K7(this.state)}keccak(){Pu||Ou(this.state32),tw(this.state32,this.rounds),Pu||Ou(this.state32),this.posOut=0,this.pos=0}update(e){Qn(this);const{blockLen:r,state:i}=this;e=es(e);const n=e.length;for(let s=0;s<n;){const a=Math.min(r-this.pos,n-s);for(let c=0;c<a;c++)i[this.pos++]^=e[s++];this.pos===r&&this.keccak()}return this}finish(){if(this.finished)return;this.finished=!0;const{state:e,suffix:r,pos:i,blockLen:n}=this;e[i]^=r,r&128&&i===n-1&&this.keccak(),e[n-1]^=128,this.keccak()}writeInto(e){Qn(this,!1),Lo(e),this.finish();const r=this.state,{blockLen:i}=this;for(let n=0,s=e.length;n<s;){this.posOut>=i&&this.keccak();const a=Math.min(i-this.posOut,s-n);e.set(r.subarray(this.posOut,this.posOut+a),n),this.posOut+=a,n+=a}return e}xofInto(e){if(!this.enableXOF)throw new Error("XOF is not possible for this instance");return this.writeInto(e)}xof(e){return Ds(e),this.xofInto(new Uint8Array(e))}digestInto(e){if(x1(e,this),this.finished)throw new Error("digest() was already called");return this.writeInto(e),this.destroy(),e}digest(){return this.digestInto(new Uint8Array(this.outputLen))}destroy(){this.destroyed=!0,this.state.fill(0)}_cloneInto(e){const{blockLen:r,suffix:i,outputLen:n,rounds:s,enableXOF:a}=this;return e||(e=new O1(r,i,n,a,s)),e.state32.set(this.state32),e.pos=this.pos,e.posOut=this.posOut,e.finished=this.finished,e.rounds=s,e.suffix=i,e.outputLen=n,e.enableXOF=a,e.destroyed=this.destroyed,e}};const iw=(t,e,r)=>I1(()=>new rw(e,t,r)),nw=iw(1,136,256/8),sw="https://rpc.walletconnect.org/v1";function R1(t){const e=`Ethereum Signed Message:
${t.length}`,r=new TextEncoder().encode(e+t);return"0x"+Nr.from(nw(r)).toString("hex")}async function aw(t,e,r,i,n,s){switch(r.t){case"eip191":return ow(t,e,r.s);case"eip1271":return await cw(t,e,r.s,i,n,s);default:throw new Error(`verifySignature failed: Attempted to verify CacaoSignature with unknown type: ${r.t}`)}}function ow(t,e,r){return p2(R1(e),r).toLowerCase()===t.toLowerCase()}async function cw(t,e,r,i,n,s){const a=Jn(i);if(!a.namespace||!a.reference)throw new Error(`isValidEip1271Signature failed: chainId must be in CAIP-2 format, received: ${i}`);try{const c="0x1626ba7e",d="0000000000000000000000000000000000000000000000000000000000000040",u="0000000000000000000000000000000000000000000000000000000000000041",l=r.substring(2),g=R1(e).substring(2),w=c+g+d+u+l,E=await fetch(`${s||sw}/?chainId=${i}&projectId=${n}`,{method:"POST",body:JSON.stringify({id:fw(),jsonrpc:"2.0",method:"eth_call",params:[{to:t,data:w},"latest"]})}),{result:$}=await E.json();return $?$.slice(0,c.length).toLowerCase()===c.toLowerCase():!1}catch(c){return console.error("isValidEip1271Signature: ",c),!1}}function fw(){return Date.now()+Math.floor(Math.random()*1e3)}var dw=Object.defineProperty,hw=Object.defineProperties,uw=Object.getOwnPropertyDescriptors,Nu=Object.getOwnPropertySymbols,lw=Object.prototype.hasOwnProperty,pw=Object.prototype.propertyIsEnumerable,Cu=(t,e,r)=>e in t?dw(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,bw=(t,e)=>{for(var r in e||(e={}))lw.call(e,r)&&Cu(t,r,e[r]);if(Nu)for(var r of Nu(e))pw.call(e,r)&&Cu(t,r,e[r]);return t},gw=(t,e)=>hw(t,uw(e));const vw="did:pkh:",yd=t=>t==null?void 0:t.split(":"),yw=t=>{const e=t&&yd(t);if(e)return t.includes(vw)?e[3]:e[1]},Sf=t=>{const e=t&&yd(t);if(e)return e[2]+":"+e[3]},io=t=>{const e=t&&yd(t);if(e)return e.pop()};async function Tu(t){const{cacao:e,projectId:r}=t,{s:i,p:n}=e,s=F1(n,n.iss),a=io(n.iss);return await aw(a,s,i,Sf(n.iss),r)}const F1=(t,e)=>{const r=`${t.domain} wants you to sign in with your Ethereum account:`,i=io(e);if(!t.aud&&!t.uri)throw new Error("Either `aud` or `uri` is required to construct the message");let n=t.statement||void 0;const s=`URI: ${t.aud||t.uri}`,a=`Version: ${t.version}`,c=`Chain ID: ${yw(e)}`,d=`Nonce: ${t.nonce}`,u=`Issued At: ${t.iat}`,l=t.exp?`Expiration Time: ${t.exp}`:void 0,g=t.nbf?`Not Before: ${t.nbf}`:void 0,w=t.requestId?`Request ID: ${t.requestId}`:void 0,E=t.resources?`Resources:${t.resources.map(I=>`
- ${I}`).join("")}`:void 0,$=Da(t.resources);if($){const I=Us($);n=Mw(n,I)}return[r,i,"",n,"",s,a,c,d,u,l,g,w,E].filter(I=>I!=null).join(`
`)};function mw(t){return Nr.from(JSON.stringify(t)).toString("base64")}function ww(t){return JSON.parse(Nr.from(t,"base64").toString("utf-8"))}function vn(t){if(!t)throw new Error("No recap provided, value is undefined");if(!t.att)throw new Error("No `att` property found");const e=Object.keys(t.att);if(!(e!=null&&e.length))throw new Error("No resources found in `att` property");e.forEach(r=>{const i=t.att[r];if(Array.isArray(i))throw new Error(`Resource must be an object: ${r}`);if(typeof i!="object")throw new Error(`Resource must be an object: ${r}`);if(!Object.keys(i).length)throw new Error(`Resource object is empty: ${r}`);Object.keys(i).forEach(n=>{const s=i[n];if(!Array.isArray(s))throw new Error(`Ability limits ${n} must be an array of objects, found: ${s}`);if(!s.length)throw new Error(`Value of ${n} is empty array, must be an array with objects`);s.forEach(a=>{if(typeof a!="object")throw new Error(`Ability limits (${n}) must be an array of objects, found: ${a}`)})})})}function _w(t,e,r,i={}){return r==null||r.sort((n,s)=>n.localeCompare(s)),{att:{[t]:Ew(e,r,i)}}}function Ew(t,e,r={}){e=e==null?void 0:e.sort((n,s)=>n.localeCompare(s));const i=e.map(n=>({[`${t}/${n}`]:[r]}));return Object.assign({},...i)}function N1(t){return vn(t),`urn:recap:${mw(t).replace(/=/g,"")}`}function Us(t){const e=ww(t.replace("urn:recap:",""));return vn(e),e}function Sw(t,e,r){const i=_w(t,e,r);return N1(i)}function $w(t){return t&&t.includes("urn:recap:")}function xw(t,e){const r=Us(t),i=Us(e),n=Iw(r,i);return N1(n)}function Iw(t,e){vn(t),vn(e);const r=Object.keys(t.att).concat(Object.keys(e.att)).sort((n,s)=>n.localeCompare(s)),i={att:{}};return r.forEach(n=>{var s,a;Object.keys(((s=t.att)==null?void 0:s[n])||{}).concat(Object.keys(((a=e.att)==null?void 0:a[n])||{})).sort((c,d)=>c.localeCompare(d)).forEach(c=>{var d,u;i.att[n]=gw(bw({},i.att[n]),{[c]:((d=t.att[n])==null?void 0:d[c])||((u=e.att[n])==null?void 0:u[c])})})}),i}function Mw(t="",e){vn(e);const r="I further authorize the stated URI to perform the following actions on my behalf: ";if(t.includes(r))return t;const i=[];let n=0;Object.keys(e.att).forEach(c=>{const d=Object.keys(e.att[c]).map(g=>({ability:g.split("/")[0],action:g.split("/")[1]}));d.sort((g,w)=>g.action.localeCompare(w.action));const u={};d.forEach(g=>{u[g.ability]||(u[g.ability]=[]),u[g.ability].push(g.action)});const l=Object.keys(u).map(g=>(n++,`(${n}) '${g}': '${u[g].join("', '")}' for '${c}'.`));i.push(l.join(", ").replace(".,","."))});const s=i.join(" "),a=`${r}${s}`;return`${t?t+" ":""}${a}`}function Bu(t){var e;const r=Us(t);vn(r);const i=(e=r.att)==null?void 0:e.eip155;return i?Object.keys(i).map(n=>n.split("/")[1]):[]}function qu(t){const e=Us(t);vn(e);const r=[];return Object.values(e.att).forEach(i=>{Object.values(i).forEach(n=>{var s;(s=n==null?void 0:n[0])!=null&&s.chains&&r.push(n[0].chains)})}),[...new Set(r.flat())]}function Da(t){if(!t)return;const e=t==null?void 0:t[t.length-1];return $w(e)?e:void 0}function Nc(t){if(!Number.isSafeInteger(t)||t<0)throw new Error("positive integer expected, got "+t)}function C1(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function er(t,...e){if(!C1(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error("Uint8Array expected of length "+e+", got length="+t.length)}function Lu(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function Aw(t,e){er(t);const r=e.outputLen;if(t.length<r)throw new Error("digestInto() expects output buffer of length at least "+r)}function Du(t){if(typeof t!="boolean")throw new Error(`boolean expected, not ${t}`)}const Ki=t=>new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4)),Pw=t=>new DataView(t.buffer,t.byteOffset,t.byteLength),Ow=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!Ow)throw new Error("Non little-endian hardware is not supported");function Rw(t){if(typeof t!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(t))}function $f(t){if(typeof t=="string")t=Rw(t);else if(C1(t))t=xf(t);else throw new Error("Uint8Array expected, got "+typeof t);return t}function Fw(t,e){if(e==null||typeof e!="object")throw new Error("options must be defined");return Object.assign(t,e)}function Nw(t,e){if(t.length!==e.length)return!1;let r=0;for(let i=0;i<t.length;i++)r|=t[i]^e[i];return r===0}const Cw=(t,e)=>{function r(i,...n){if(er(i),t.nonceLength!==void 0){const u=n[0];if(!u)throw new Error("nonce / iv required");t.varSizeNonce?er(u):er(u,t.nonceLength)}const s=t.tagLength;s&&n[1]!==void 0&&er(n[1]);const a=e(i,...n),c=(u,l)=>{if(l!==void 0){if(u!==2)throw new Error("cipher output not supported");er(l)}};let d=!1;return{encrypt(u,l){if(d)throw new Error("cannot encrypt() twice with same key + nonce");return d=!0,er(u),c(a.encrypt.length,l),a.encrypt(u,l)},decrypt(u,l){if(er(u),s&&u.length<s)throw new Error("invalid ciphertext length: smaller than tagLength="+s);return c(a.decrypt.length,l),a.decrypt(u,l)}}}return Object.assign(r,t),r};function Uu(t,e,r=!0){if(e===void 0)return new Uint8Array(t);if(e.length!==t)throw new Error("invalid output length, expected "+t+", got: "+e.length);if(r&&!Tw(e))throw new Error("invalid output, must be aligned");return e}function zu(t,e,r,i){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,r,i);const n=BigInt(32),s=BigInt(4294967295),a=Number(r>>n&s),c=Number(r&s);t.setUint32(e+4,a,i),t.setUint32(e+0,c,i)}function Tw(t){return t.byteOffset%4===0}function xf(t){return Uint8Array.from(t)}function ts(...t){for(let e=0;e<t.length;e++)t[e].fill(0)}const T1=t=>Uint8Array.from(t.split("").map(e=>e.charCodeAt(0))),Bw=T1("expand 16-byte k"),qw=T1("expand 32-byte k"),Lw=Ki(Bw),Dw=Ki(qw);function De(t,e){return t<<e|t>>>32-e}function If(t){return t.byteOffset%4===0}const Ma=64,Uw=16,B1=2**32-1,ju=new Uint32Array;function zw(t,e,r,i,n,s,a,c){const d=n.length,u=new Uint8Array(Ma),l=Ki(u),g=If(n)&&If(s),w=g?Ki(n):ju,E=g?Ki(s):ju;for(let $=0;$<d;a++){if(t(e,r,i,l,a,c),a>=B1)throw new Error("arx: counter overflow");const I=Math.min(Ma,d-$);if(g&&I===Ma){const M=$/4;if($%4!==0)throw new Error("arx: invalid block position");for(let P=0,A;P<Uw;P++)A=M+P,E[A]=w[A]^l[P];$+=Ma;continue}for(let M=0,P;M<I;M++)P=$+M,s[P]=n[P]^u[M];$+=I}}function jw(t,e){const{allowShortKeys:r,extendNonceFn:i,counterLength:n,counterRight:s,rounds:a}=Fw({allowShortKeys:!1,counterLength:8,counterRight:!1,rounds:20},e);if(typeof t!="function")throw new Error("core must be a function");return Nc(n),Nc(a),Du(s),Du(r),(c,d,u,l,g=0)=>{er(c),er(d),er(u);const w=u.length;if(l===void 0&&(l=new Uint8Array(w)),er(l),Nc(g),g<0||g>=B1)throw new Error("arx: counter overflow");if(l.length<w)throw new Error(`arx: output (${l.length}) is shorter than data (${w})`);const E=[];let $=c.length,I,M;if($===32)E.push(I=xf(c)),M=Dw;else if($===16&&r)I=new Uint8Array(32),I.set(c),I.set(c,16),M=Lw,E.push(I);else throw new Error(`arx: invalid 32-byte key, got length=${$}`);If(d)||E.push(d=xf(d));const P=Ki(I);if(i){if(d.length!==24)throw new Error("arx: extended nonce must be 24 bytes");i(M,P,Ki(d.subarray(0,16)),P),d=d.subarray(16)}const A=16-n;if(A!==d.length)throw new Error(`arx: nonce must be ${A} or 16 bytes`);if(A!==12){const C=new Uint8Array(12);C.set(d,s?0:12-d.length),d=C,E.push(d)}const R=Ki(d);return zw(t,M,P,R,u,l,g,a),ts(...E),l}}const Et=(t,e)=>t[e++]&255|(t[e++]&255)<<8;let kw=class{constructor(e){this.blockLen=16,this.outputLen=16,this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.pos=0,this.finished=!1,e=$f(e),er(e,32);const r=Et(e,0),i=Et(e,2),n=Et(e,4),s=Et(e,6),a=Et(e,8),c=Et(e,10),d=Et(e,12),u=Et(e,14);this.r[0]=r&8191,this.r[1]=(r>>>13|i<<3)&8191,this.r[2]=(i>>>10|n<<6)&7939,this.r[3]=(n>>>7|s<<9)&8191,this.r[4]=(s>>>4|a<<12)&255,this.r[5]=a>>>1&8190,this.r[6]=(a>>>14|c<<2)&8191,this.r[7]=(c>>>11|d<<5)&8065,this.r[8]=(d>>>8|u<<8)&8191,this.r[9]=u>>>5&127;for(let l=0;l<8;l++)this.pad[l]=Et(e,16+2*l)}process(e,r,i=!1){const n=i?0:2048,{h:s,r:a}=this,c=a[0],d=a[1],u=a[2],l=a[3],g=a[4],w=a[5],E=a[6],$=a[7],I=a[8],M=a[9],P=Et(e,r+0),A=Et(e,r+2),R=Et(e,r+4),C=Et(e,r+6),D=Et(e,r+8),U=Et(e,r+10),j=Et(e,r+12),z=Et(e,r+14);let q=s[0]+(P&8191),V=s[1]+((P>>>13|A<<3)&8191),S=s[2]+((A>>>10|R<<6)&8191),o=s[3]+((R>>>7|C<<9)&8191),h=s[4]+((C>>>4|D<<12)&8191),y=s[5]+(D>>>1&8191),p=s[6]+((D>>>14|U<<2)&8191),v=s[7]+((U>>>11|j<<5)&8191),_=s[8]+((j>>>8|z<<8)&8191),x=s[9]+(z>>>5|n),b=0,f=b+q*c+V*(5*M)+S*(5*I)+o*(5*$)+h*(5*E);b=f>>>13,f&=8191,f+=y*(5*w)+p*(5*g)+v*(5*l)+_*(5*u)+x*(5*d),b+=f>>>13,f&=8191;let m=b+q*d+V*c+S*(5*M)+o*(5*I)+h*(5*$);b=m>>>13,m&=8191,m+=y*(5*E)+p*(5*w)+v*(5*g)+_*(5*l)+x*(5*u),b+=m>>>13,m&=8191;let F=b+q*u+V*d+S*c+o*(5*M)+h*(5*I);b=F>>>13,F&=8191,F+=y*(5*$)+p*(5*E)+v*(5*w)+_*(5*g)+x*(5*l),b+=F>>>13,F&=8191;let N=b+q*l+V*u+S*d+o*c+h*(5*M);b=N>>>13,N&=8191,N+=y*(5*I)+p*(5*$)+v*(5*E)+_*(5*w)+x*(5*g),b+=N>>>13,N&=8191;let T=b+q*g+V*l+S*u+o*d+h*c;b=T>>>13,T&=8191,T+=y*(5*M)+p*(5*I)+v*(5*$)+_*(5*E)+x*(5*w),b+=T>>>13,T&=8191;let L=b+q*w+V*g+S*l+o*u+h*d;b=L>>>13,L&=8191,L+=y*c+p*(5*M)+v*(5*I)+_*(5*$)+x*(5*E),b+=L>>>13,L&=8191;let k=b+q*E+V*w+S*g+o*l+h*u;b=k>>>13,k&=8191,k+=y*d+p*c+v*(5*M)+_*(5*I)+x*(5*$),b+=k>>>13,k&=8191;let W=b+q*$+V*E+S*w+o*g+h*l;b=W>>>13,W&=8191,W+=y*u+p*d+v*c+_*(5*M)+x*(5*I),b+=W>>>13,W&=8191;let Z=b+q*I+V*$+S*E+o*w+h*g;b=Z>>>13,Z&=8191,Z+=y*l+p*u+v*d+_*c+x*(5*M),b+=Z>>>13,Z&=8191;let K=b+q*M+V*I+S*$+o*E+h*w;b=K>>>13,K&=8191,K+=y*g+p*l+v*u+_*d+x*c,b+=K>>>13,K&=8191,b=(b<<2)+b|0,b=b+f|0,f=b&8191,b=b>>>13,m+=b,s[0]=f,s[1]=m,s[2]=F,s[3]=N,s[4]=T,s[5]=L,s[6]=k,s[7]=W,s[8]=Z,s[9]=K}finalize(){const{h:e,pad:r}=this,i=new Uint16Array(10);let n=e[1]>>>13;e[1]&=8191;for(let c=2;c<10;c++)e[c]+=n,n=e[c]>>>13,e[c]&=8191;e[0]+=n*5,n=e[0]>>>13,e[0]&=8191,e[1]+=n,n=e[1]>>>13,e[1]&=8191,e[2]+=n,i[0]=e[0]+5,n=i[0]>>>13,i[0]&=8191;for(let c=1;c<10;c++)i[c]=e[c]+n,n=i[c]>>>13,i[c]&=8191;i[9]-=8192;let s=(n^1)-1;for(let c=0;c<10;c++)i[c]&=s;s=~s;for(let c=0;c<10;c++)e[c]=e[c]&s|i[c];e[0]=(e[0]|e[1]<<13)&65535,e[1]=(e[1]>>>3|e[2]<<10)&65535,e[2]=(e[2]>>>6|e[3]<<7)&65535,e[3]=(e[3]>>>9|e[4]<<4)&65535,e[4]=(e[4]>>>12|e[5]<<1|e[6]<<14)&65535,e[5]=(e[6]>>>2|e[7]<<11)&65535,e[6]=(e[7]>>>5|e[8]<<8)&65535,e[7]=(e[8]>>>8|e[9]<<5)&65535;let a=e[0]+r[0];e[0]=a&65535;for(let c=1;c<8;c++)a=(e[c]+r[c]|0)+(a>>>16)|0,e[c]=a&65535;ts(i)}update(e){Lu(this);const{buffer:r,blockLen:i}=this;e=$f(e);const n=e.length;for(let s=0;s<n;){const a=Math.min(i-this.pos,n-s);if(a===i){for(;i<=n-s;s+=i)this.process(e,s);continue}r.set(e.subarray(s,s+a),this.pos),this.pos+=a,s+=a,this.pos===i&&(this.process(r,0,!1),this.pos=0)}return this}destroy(){ts(this.h,this.r,this.buffer,this.pad)}digestInto(e){Lu(this),Aw(e,this),this.finished=!0;const{buffer:r,h:i}=this;let{pos:n}=this;if(n){for(r[n++]=1;n<16;n++)r[n]=0;this.process(r,0,!0)}this.finalize();let s=0;for(let a=0;a<8;a++)e[s++]=i[a]>>>0,e[s++]=i[a]>>>8;return e}digest(){const{buffer:e,outputLen:r}=this;this.digestInto(e);const i=e.slice(0,r);return this.destroy(),i}};function Hw(t){const e=(i,n)=>t(n).update($f(i)).digest(),r=t(new Uint8Array(32));return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=i=>t(i),e}const Kw=Hw(t=>new kw(t));function Vw(t,e,r,i,n,s=20){let a=t[0],c=t[1],d=t[2],u=t[3],l=e[0],g=e[1],w=e[2],E=e[3],$=e[4],I=e[5],M=e[6],P=e[7],A=n,R=r[0],C=r[1],D=r[2],U=a,j=c,z=d,q=u,V=l,S=g,o=w,h=E,y=$,p=I,v=M,_=P,x=A,b=R,f=C,m=D;for(let N=0;N<s;N+=2)U=U+V|0,x=De(x^U,16),y=y+x|0,V=De(V^y,12),U=U+V|0,x=De(x^U,8),y=y+x|0,V=De(V^y,7),j=j+S|0,b=De(b^j,16),p=p+b|0,S=De(S^p,12),j=j+S|0,b=De(b^j,8),p=p+b|0,S=De(S^p,7),z=z+o|0,f=De(f^z,16),v=v+f|0,o=De(o^v,12),z=z+o|0,f=De(f^z,8),v=v+f|0,o=De(o^v,7),q=q+h|0,m=De(m^q,16),_=_+m|0,h=De(h^_,12),q=q+h|0,m=De(m^q,8),_=_+m|0,h=De(h^_,7),U=U+S|0,m=De(m^U,16),v=v+m|0,S=De(S^v,12),U=U+S|0,m=De(m^U,8),v=v+m|0,S=De(S^v,7),j=j+o|0,x=De(x^j,16),_=_+x|0,o=De(o^_,12),j=j+o|0,x=De(x^j,8),_=_+x|0,o=De(o^_,7),z=z+h|0,b=De(b^z,16),y=y+b|0,h=De(h^y,12),z=z+h|0,b=De(b^z,8),y=y+b|0,h=De(h^y,7),q=q+V|0,f=De(f^q,16),p=p+f|0,V=De(V^p,12),q=q+V|0,f=De(f^q,8),p=p+f|0,V=De(V^p,7);let F=0;i[F++]=a+U|0,i[F++]=c+j|0,i[F++]=d+z|0,i[F++]=u+q|0,i[F++]=l+V|0,i[F++]=g+S|0,i[F++]=w+o|0,i[F++]=E+h|0,i[F++]=$+y|0,i[F++]=I+p|0,i[F++]=M+v|0,i[F++]=P+_|0,i[F++]=A+x|0,i[F++]=R+b|0,i[F++]=C+f|0,i[F++]=D+m|0}const Ww=jw(Vw,{counterRight:!1,counterLength:4,allowShortKeys:!1}),Gw=new Uint8Array(16),ku=(t,e)=>{t.update(e);const r=e.length%16;r&&t.update(Gw.subarray(r))},Jw=new Uint8Array(32);function Hu(t,e,r,i,n){const s=t(e,r,Jw),a=Kw.create(s);n&&ku(a,n),ku(a,i);const c=new Uint8Array(16),d=Pw(c);zu(d,0,BigInt(n?n.length:0),!0),zu(d,8,BigInt(i.length),!0),a.update(c);const u=a.digest();return ts(s,c),u}const Yw=t=>(e,r,i)=>({encrypt(n,s){const a=n.length;s=Uu(a+16,s,!1),s.set(n);const c=s.subarray(0,-16);t(e,r,c,c,1);const d=Hu(t,e,r,c,i);return s.set(d,a),ts(d),s},decrypt(n,s){s=Uu(n.length-16,s,!1);const a=n.subarray(0,-16),c=n.subarray(-16),d=Hu(t,e,r,a,i);if(!Nw(c,d))throw new Error("invalid tag");return s.set(n.subarray(0,-16)),t(e,r,s,s,1),ts(d),s}}),q1=Cw({blockSize:64,nonceLength:12,tagLength:16},Yw(Ww));let L1=class extends vd{constructor(e,r){super(),this.finished=!1,this.destroyed=!1,gd(e);const i=es(r);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const n=this.blockLen,s=new Uint8Array(n);s.set(i.length>n?e.create().update(i).digest():i);for(let a=0;a<s.length;a++)s[a]^=54;this.iHash.update(s),this.oHash=e.create();for(let a=0;a<s.length;a++)s[a]^=106;this.oHash.update(s),s.fill(0)}update(e){return Qn(this),this.iHash.update(e),this}digestInto(e){Qn(this),Lo(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){const e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));const{oHash:r,iHash:i,finished:n,destroyed:s,blockLen:a,outputLen:c}=this;return e=e,e.finished=n,e.destroyed=s,e.blockLen=a,e.outputLen=c,e.oHash=r._cloneInto(e.oHash),e.iHash=i._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}};const md=(t,e,r)=>new L1(t,e).update(r).digest();md.create=(t,e)=>new L1(t,e);function Zw(t,e,r){return gd(t),r===void 0&&(r=new Uint8Array(t.outputLen)),md(t,es(r),es(e))}const Cc=new Uint8Array([0]),Ku=new Uint8Array;function Xw(t,e,r,i=32){if(gd(t),Ds(i),i>255*t.outputLen)throw new Error("Length should be <= 255*HashLen");const n=Math.ceil(i/t.outputLen);r===void 0&&(r=Ku);const s=new Uint8Array(n*t.outputLen),a=md.create(t,e),c=a._cloneInto(),d=new Uint8Array(a.outputLen);for(let u=0;u<n;u++)Cc[0]=u+1,c.update(u===0?Ku:d).update(r).update(Cc).digestInto(d),s.set(d,t.outputLen*u),a._cloneInto(c);return a.destroy(),c.destroy(),d.fill(0),Cc.fill(0),s.slice(0,i)}const Qw=(t,e,r,i,n)=>Xw(t,Zw(t,e,r),i,n);function e_(t,e,r,i){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,r,i);const n=BigInt(32),s=BigInt(4294967295),a=Number(r>>n&s),c=Number(r&s),d=i?4:0,u=i?0:4;t.setUint32(e+d,a,i),t.setUint32(e+u,c,i)}function t_(t,e,r){return t&e^~t&r}function r_(t,e,r){return t&e^t&r^e&r}let i_=class extends vd{constructor(e,r,i,n){super(),this.blockLen=e,this.outputLen=r,this.padOffset=i,this.isLE=n,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=Fc(this.buffer)}update(e){Qn(this);const{view:r,buffer:i,blockLen:n}=this;e=es(e);const s=e.length;for(let a=0;a<s;){const c=Math.min(n-this.pos,s-a);if(c===n){const d=Fc(e);for(;n<=s-a;a+=n)this.process(d,a);continue}i.set(e.subarray(a,a+c),this.pos),this.pos+=c,a+=c,this.pos===n&&(this.process(r,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){Qn(this),x1(e,this),this.finished=!0;const{buffer:r,view:i,blockLen:n,isLE:s}=this;let{pos:a}=this;r[a++]=128,this.buffer.subarray(a).fill(0),this.padOffset>n-a&&(this.process(i,0),a=0);for(let g=a;g<n;g++)r[g]=0;e_(i,n-8,BigInt(this.length*8),s),this.process(i,0);const c=Fc(e),d=this.outputLen;if(d%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const u=d/4,l=this.get();if(u>l.length)throw new Error("_sha2: outputLen bigger than state");for(let g=0;g<u;g++)c.setUint32(4*g,l[g],s)}digest(){const{buffer:e,outputLen:r}=this;this.digestInto(e);const i=e.slice(0,r);return this.destroy(),i}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());const{blockLen:r,buffer:i,length:n,finished:s,destroyed:a,pos:c}=this;return e.length=n,e.pos=c,e.finished=s,e.destroyed=a,n%r&&e.buffer.set(i),e}};const n_=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),qi=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Li=new Uint32Array(64);let s_=class extends i_{constructor(){super(64,32,8,!1),this.A=qi[0]|0,this.B=qi[1]|0,this.C=qi[2]|0,this.D=qi[3]|0,this.E=qi[4]|0,this.F=qi[5]|0,this.G=qi[6]|0,this.H=qi[7]|0}get(){const{A:e,B:r,C:i,D:n,E:s,F:a,G:c,H:d}=this;return[e,r,i,n,s,a,c,d]}set(e,r,i,n,s,a,c,d){this.A=e|0,this.B=r|0,this.C=i|0,this.D=n|0,this.E=s|0,this.F=a|0,this.G=c|0,this.H=d|0}process(e,r){for(let g=0;g<16;g++,r+=4)Li[g]=e.getUint32(r,!1);for(let g=16;g<64;g++){const w=Li[g-15],E=Li[g-2],$=Ur(w,7)^Ur(w,18)^w>>>3,I=Ur(E,17)^Ur(E,19)^E>>>10;Li[g]=I+Li[g-7]+$+Li[g-16]|0}let{A:i,B:n,C:s,D:a,E:c,F:d,G:u,H:l}=this;for(let g=0;g<64;g++){const w=Ur(c,6)^Ur(c,11)^Ur(c,25),E=l+w+t_(c,d,u)+n_[g]+Li[g]|0,$=(Ur(i,2)^Ur(i,13)^Ur(i,22))+r_(i,n,s)|0;l=u,u=d,d=c,c=a+E|0,a=s,s=n,n=i,i=E+$|0}i=i+this.A|0,n=n+this.B|0,s=s+this.C|0,a=a+this.D|0,c=c+this.E|0,d=d+this.F|0,u=u+this.G|0,l=l+this.H|0,this.set(i,n,s,a,c,d,u,l)}roundClean(){Li.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}};const Do=I1(()=>new s_);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const D1=BigInt(0);function wd(t){return t instanceof Uint8Array||ArrayBuffer.isView(t)&&t.constructor.name==="Uint8Array"}function U1(t){if(!wd(t))throw new Error("Uint8Array expected")}const a_=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function o_(t){U1(t);let e="";for(let r=0;r<t.length;r++)e+=a_[t[r]];return e}function c_(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);return t===""?D1:BigInt("0x"+t)}const yi={_0:48,_9:57,A:65,F:70,a:97,f:102};function Vu(t){if(t>=yi._0&&t<=yi._9)return t-yi._0;if(t>=yi.A&&t<=yi.F)return t-(yi.A-10);if(t>=yi.a&&t<=yi.f)return t-(yi.a-10)}function z1(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);const e=t.length,r=e/2;if(e%2)throw new Error("hex string expected, got unpadded hex of length "+e);const i=new Uint8Array(r);for(let n=0,s=0;n<r;n++,s+=2){const a=Vu(t.charCodeAt(s)),c=Vu(t.charCodeAt(s+1));if(a===void 0||c===void 0){const d=t[s]+t[s+1];throw new Error('hex string expected, got non-hex character "'+d+'" at index '+s)}i[n]=a*16+c}return i}function Wu(t){return U1(t),c_(o_(Uint8Array.from(t).reverse()))}function f_(t,e){return z1(t.toString(16).padStart(e*2,"0"))}function d_(t,e){return f_(t,e).reverse()}function Gu(t,e,r){let i;if(typeof e=="string")try{i=z1(e)}catch(s){throw new Error(t+" must be hex string or Uint8Array, cause: "+s)}else if(wd(e))i=Uint8Array.from(e);else throw new Error(t+" must be hex string or Uint8Array");const n=i.length;if(typeof r=="number"&&n!==r)throw new Error(t+" of length "+r+" expected, got "+n);return i}const Tc=t=>typeof t=="bigint"&&D1<=t;function h_(t,e,r){return Tc(t)&&Tc(e)&&Tc(r)&&e<=t&&t<r}function Ju(t,e,r,i){if(!h_(e,r,i))throw new Error("expected valid "+t+": "+r+" <= n < "+i+", got "+e)}const u_={bigint:t=>typeof t=="bigint",function:t=>typeof t=="function",boolean:t=>typeof t=="boolean",string:t=>typeof t=="string",stringOrUint8Array:t=>typeof t=="string"||wd(t),isSafeInteger:t=>Number.isSafeInteger(t),array:t=>Array.isArray(t),field:(t,e)=>e.Fp.isValid(t),hash:t=>typeof t=="function"&&Number.isSafeInteger(t.outputLen)};function l_(t,e,r={}){const i=(n,s,a)=>{const c=u_[s];if(typeof c!="function")throw new Error("invalid validator function");const d=t[n];if(!(a&&d===void 0)&&!c(d,t))throw new Error("param "+String(n)+" is invalid. Expected "+s+", got "+d)};for(const[n,s]of Object.entries(e))i(n,s,!1);for(const[n,s]of Object.entries(r))i(n,s,!0);return t}const Gn=BigInt(0),Aa=BigInt(1);function j1(t,e){const r=t%e;return r>=Gn?r:e+r}function p_(t,e,r){if(e<Gn)throw new Error("invalid exponent, negatives unsupported");if(r<=Gn)throw new Error("invalid modulus");if(r===Aa)return Gn;let i=Aa;for(;e>Gn;)e&Aa&&(i=i*t%r),t=t*t%r,e>>=Aa;return i}function Pr(t,e,r){let i=t;for(;e-- >Gn;)i*=i,i%=r;return i}BigInt(0),BigInt(1),BigInt(0),BigInt(1),BigInt(2),BigInt(8);const Bn=BigInt(0),Bc=BigInt(1);function b_(t){return l_(t,{a:"bigint"},{montgomeryBits:"isSafeInteger",nByteLength:"isSafeInteger",adjustScalarBytes:"function",domain:"function",powPminus2:"function",Gu:"bigint"}),Object.freeze({...t})}function g_(t){const e=b_(t),{P:r}=e,i=A=>j1(A,r),n=e.montgomeryBits,s=Math.ceil(n/8),a=e.nByteLength,c=e.adjustScalarBytes||(A=>A),d=e.powPminus2||(A=>p_(A,r-BigInt(2),r));function u(A,R,C){const D=i(A*(R-C));return R=i(R-D),C=i(C+D),[R,C]}const l=(e.a-BigInt(2))/BigInt(4);function g(A,R){Ju("u",A,Bn,r),Ju("scalar",R,Bn,r);const C=R,D=A;let U=Bc,j=Bn,z=A,q=Bc,V=Bn,S;for(let h=BigInt(n-1);h>=Bn;h--){const y=C>>h&Bc;V^=y,S=u(V,U,z),U=S[0],z=S[1],S=u(V,j,q),j=S[0],q=S[1],V=y;const p=U+j,v=i(p*p),_=U-j,x=i(_*_),b=v-x,f=z+q,m=z-q,F=i(m*p),N=i(f*_),T=F+N,L=F-N;z=i(T*T),q=i(D*i(L*L)),U=i(v*x),j=i(b*(v+i(l*b)))}S=u(V,U,z),U=S[0],z=S[1],S=u(V,j,q),j=S[0],q=S[1];const o=d(j);return i(U*o)}function w(A){return d_(i(A),s)}function E(A){const R=Gu("u coordinate",A,s);return a===32&&(R[31]&=127),Wu(R)}function $(A){const R=Gu("scalar",A),C=R.length;if(C!==s&&C!==a){let D=""+s+" or "+a;throw new Error("invalid scalar, expected "+D+" bytes, got "+C)}return Wu(c(R))}function I(A,R){const C=E(R),D=$(A),U=g(C,D);if(U===Bn)throw new Error("invalid private or public key received");return w(U)}const M=w(e.Gu);function P(A){return I(A,M)}return{scalarMult:I,scalarMultBase:P,getSharedSecret:(A,R)=>I(A,R),getPublicKey:A=>P(A),utils:{randomPrivateKey:()=>e.randomBytes(e.nByteLength)},GuBytes:M}}const Mf=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949");BigInt(0);const v_=BigInt(1),Yu=BigInt(2),y_=BigInt(3),m_=BigInt(5);BigInt(8);function w_(t){const e=BigInt(10),r=BigInt(20),i=BigInt(40),n=BigInt(80),s=Mf,a=t*t%s*t%s,c=Pr(a,Yu,s)*a%s,d=Pr(c,v_,s)*t%s,u=Pr(d,m_,s)*d%s,l=Pr(u,e,s)*u%s,g=Pr(l,r,s)*l%s,w=Pr(g,i,s)*g%s,E=Pr(w,n,s)*w%s,$=Pr(E,n,s)*w%s,I=Pr($,e,s)*u%s;return{pow_p_5_8:Pr(I,Yu,s)*t%s,b2:a}}function __(t){return t[0]&=248,t[31]&=127,t[31]|=64,t}const Af=g_({P:Mf,a:BigInt(486662),montgomeryBits:255,nByteLength:32,Gu:BigInt(9),powPminus2:t=>{const e=Mf,{pow_p_5_8:r,b2:i}=w_(t);return j1(Pr(r,y_,e)*i,e)},adjustScalarBytes:__,randomBytes:na}),k1="base10",Nt="base16",ji="base64pad",Ss="base64url",sa="utf8",H1=0,xi=1,aa=2,E_=0,Zu=1,Ns=12,_d=32;function S_(){const t=Af.utils.randomPrivateKey(),e=Af.getPublicKey(t);return{privateKey:Bt(t,Nt),publicKey:Bt(e,Nt)}}function Pf(){const t=na(_d);return Bt(t,Nt)}function $_(t,e){const r=Af.getSharedSecret(hr(t,Nt),hr(e,Nt)),i=Qw(Do,r,void 0,void 0,_d);return Bt(i,Nt)}function Ua(t){const e=Do(hr(t,Nt));return Bt(e,Nt)}function _i(t){const e=Do(hr(t,sa));return Bt(e,Nt)}function K1(t){return hr(`${t}`,k1)}function yn(t){return Number(Bt(t,k1))}function x_(t){const e=K1(typeof t.type<"u"?t.type:H1);if(yn(e)===xi&&typeof t.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const r=typeof t.senderPublicKey<"u"?hr(t.senderPublicKey,Nt):void 0,i=typeof t.iv<"u"?hr(t.iv,Nt):na(Ns),n=hr(t.symKey,Nt),s=q1(n,i).encrypt(hr(t.message,sa));return V1({type:e,sealed:s,iv:i,senderPublicKey:r,encoding:t.encoding})}function I_(t){const e=hr(t.symKey,Nt),{sealed:r,iv:i}=zs(t),n=q1(e,i).decrypt(r);if(n===null)throw new Error("Failed to decrypt");return Bt(n,sa)}function M_(t,e){const r=K1(aa),i=na(Ns),n=hr(t,sa);return V1({type:r,sealed:n,iv:i,encoding:e})}function A_(t,e){const{sealed:r}=zs({encoded:t,encoding:e});return Bt(r,sa)}function V1(t){const{encoding:e=ji}=t;if(yn(t.type)===aa)return Bt(Ic([t.type,t.sealed]),e);if(yn(t.type)===xi){if(typeof t.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return Bt(Ic([t.type,t.senderPublicKey,t.iv,t.sealed]),e)}return Bt(Ic([t.type,t.iv,t.sealed]),e)}function zs(t){const{encoded:e,encoding:r=ji}=t,i=hr(e,r),n=i.slice(E_,Zu),s=Zu;if(yn(n)===xi){const u=s+_d,l=u+Ns,g=i.slice(s,u),w=i.slice(u,l),E=i.slice(l);return{type:n,sealed:E,iv:w,senderPublicKey:g}}if(yn(n)===aa){const u=i.slice(s),l=na(Ns);return{type:n,sealed:u,iv:l}}const a=s+Ns,c=i.slice(s,a),d=i.slice(a);return{type:n,sealed:d,iv:c}}function P_(t,e){const r=zs({encoded:t,encoding:e==null?void 0:e.encoding});return W1({type:yn(r.type),senderPublicKey:typeof r.senderPublicKey<"u"?Bt(r.senderPublicKey,Nt):void 0,receiverPublicKey:e==null?void 0:e.receiverPublicKey})}function W1(t){const e=(t==null?void 0:t.type)||H1;if(e===xi){if(typeof(t==null?void 0:t.senderPublicKey)>"u")throw new Error("missing sender public key");if(typeof(t==null?void 0:t.receiverPublicKey)>"u")throw new Error("missing receiver public key")}return{type:e,senderPublicKey:t==null?void 0:t.senderPublicKey,receiverPublicKey:t==null?void 0:t.receiverPublicKey}}function Xu(t){return t.type===xi&&typeof t.senderPublicKey=="string"&&typeof t.receiverPublicKey=="string"}function Qu(t){return t.type===aa}function O_(t){return new d1.ec("p256").keyFromPublic({x:Nr.from(t.x,"base64").toString("hex"),y:Nr.from(t.y,"base64").toString("hex")},"hex")}function R_(t){let e=t.replace(/-/g,"+").replace(/_/g,"/");const r=e.length%4;return r>0&&(e+="=".repeat(4-r)),e}function F_(t){return Nr.from(R_(t),"base64")}function N_(t,e){const[r,i,n]=t.split("."),s=F_(n);if(s.length!==64)throw new Error("Invalid signature length");const a=s.slice(0,32).toString("hex"),c=s.slice(32,64).toString("hex"),d=`${r}.${i}`,u=Do(d),l=O_(e),g=Bt(u,Nt);if(!l.verify(g,{r:a,s:c}))throw new Error("Invalid signature");return _f(t).payload}const C_="irn";function no(t){return(t==null?void 0:t.relay)||{protocol:C_}}function Os(t){const e=v7[t];if(typeof e>"u")throw new Error(`Relay Protocol not supported: ${t}`);return e}function T_(t,e="-"){const r={},i="relay"+e;return Object.keys(t).forEach(n=>{if(n.startsWith(i)){const s=n.replace(i,""),a=t[n];r[s]=a}}),r}function el(t){if(!t.includes("wc:")){const u=$1(t);u!=null&&u.includes("wc:")&&(t=u)}t=t.includes("wc://")?t.replace("wc://",""):t,t=t.includes("wc:")?t.replace("wc:",""):t;const e=t.indexOf(":"),r=t.indexOf("?")!==-1?t.indexOf("?"):void 0,i=t.substring(0,e),n=t.substring(e+1,r).split("@"),s=typeof r<"u"?t.substring(r):"",a=new URLSearchParams(s),c={};a.forEach((u,l)=>{c[l]=u});const d=typeof c.methods=="string"?c.methods.split(","):void 0;return{protocol:i,topic:B_(n[0]),version:parseInt(n[1],10),symKey:c.symKey,relay:T_(c),methods:d,expiryTimestamp:c.expiryTimestamp?parseInt(c.expiryTimestamp,10):void 0}}function B_(t){return t.startsWith("//")?t.substring(2):t}function q_(t,e="-"){const r="relay",i={};return Object.keys(t).forEach(n=>{const s=r+e+n;t[n]&&(i[s]=t[n])}),i}function tl(t){const e=new URLSearchParams,r=q_(t.relay);Object.keys(r).sort().forEach(n=>{e.set(n,r[n])}),e.set("symKey",t.symKey),t.expiryTimestamp&&e.set("expiryTimestamp",t.expiryTimestamp.toString()),t.methods&&e.set("methods",t.methods.join(","));const i=e.toString();return`${t.protocol}:${t.topic}@${t.version}?${i}`}function Pa(t,e,r){return`${t}?wc_ev=${r}&topic=${e}`}function ls(t){const e=[];return t.forEach(r=>{const[i,n]=r.split(":");e.push(`${i}:${n}`)}),e}function L_(t){const e=[];return Object.values(t).forEach(r=>{e.push(...ls(r.accounts))}),e}function D_(t,e){const r=[];return Object.values(t).forEach(i=>{ls(i.accounts).includes(e)&&r.push(...i.methods)}),r}function U_(t,e){const r=[];return Object.values(t).forEach(i=>{ls(i.accounts).includes(e)&&r.push(...i.events)}),r}function Ed(t){return t.includes(":")}function Rs(t){return Ed(t)?t.split(":")[0]:t}function z_(t){const e={};return t==null||t.forEach(r=>{const[i,n]=r.split(":");e[i]||(e[i]={accounts:[],chains:[],events:[]}),e[i].accounts.push(r),e[i].chains.push(`${i}:${n}`)}),e}function rl(t,e){e=e.map(i=>i.replace("did:pkh:",""));const r=z_(e);for(const[i,n]of Object.entries(r))n.methods?n.methods=La(n.methods,t):n.methods=t,n.events=["chainChanged","accountsChanged"];return r}const j_={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},k_={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function J(t,e){const{message:r,code:i}=k_[t];return{message:e?`${r} ${e}`:r,code:i}}function je(t,e){const{message:r,code:i}=j_[t];return{message:e?`${r} ${e}`:r,code:i}}function rs(t,e){return!!Array.isArray(t)}function js(t){return Object.getPrototypeOf(t)===Object.prototype&&Object.keys(t).length}function Tt(t){return typeof t>"u"}function tt(t,e){return e&&Tt(t)?!0:typeof t=="string"&&!!t.trim().length}function Sd(t,e){return e&&Tt(t)?!0:typeof t=="number"&&!isNaN(t)}function H_(t,e){const{requiredNamespaces:r}=e,i=Object.keys(t.namespaces),n=Object.keys(r);let s=!0;return gn(n,i)?(i.forEach(a=>{const{accounts:c,methods:d,events:u}=t.namespaces[a],l=ls(c),g=r[a];(!gn(v1(a,g),l)||!gn(g.methods,d)||!gn(g.events,u))&&(s=!1)}),s):!1}function so(t){return tt(t,!1)&&t.includes(":")?t.split(":").length===2:!1}function K_(t){if(tt(t,!1)&&t.includes(":")){const e=t.split(":");if(e.length===3){const r=e[0]+":"+e[1];return!!e[2]&&so(r)}}return!1}function V_(t){function e(r){try{return typeof new URL(r)<"u"}catch{return!1}}try{if(tt(t,!1)){if(e(t))return!0;const r=$1(t);return e(r)}}catch{}return!1}function W_(t){var e;return(e=t==null?void 0:t.proposer)==null?void 0:e.publicKey}function G_(t){return t==null?void 0:t.topic}function J_(t,e){let r=null;return tt(t==null?void 0:t.publicKey,!1)||(r=J("MISSING_OR_INVALID",`${e} controller public key should be a string`)),r}function il(t){let e=!0;return rs(t)?t.length&&(e=t.every(r=>tt(r,!1))):e=!1,e}function Y_(t,e,r){let i=null;return rs(e)&&e.length?e.forEach(n=>{i||so(n)||(i=je("UNSUPPORTED_CHAINS",`${r}, chain ${n} should be a string and conform to "namespace:chainId" format`))}):so(t)||(i=je("UNSUPPORTED_CHAINS",`${r}, chains must be defined as "namespace:chainId" e.g. "eip155:1": {...} in the namespace key OR as an array of CAIP-2 chainIds e.g. eip155: { chains: ["eip155:1", "eip155:5"] }`)),i}function Z_(t,e,r){let i=null;return Object.entries(t).forEach(([n,s])=>{if(i)return;const a=Y_(n,v1(n,s),`${e} ${r}`);a&&(i=a)}),i}function X_(t,e){let r=null;return rs(t)?t.forEach(i=>{r||K_(i)||(r=je("UNSUPPORTED_ACCOUNTS",`${e}, account ${i} should be a string and conform to "namespace:chainId:address" format`))}):r=je("UNSUPPORTED_ACCOUNTS",`${e}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),r}function Q_(t,e){let r=null;return Object.values(t).forEach(i=>{if(r)return;const n=X_(i==null?void 0:i.accounts,`${e} namespace`);n&&(r=n)}),r}function eE(t,e){let r=null;return il(t==null?void 0:t.methods)?il(t==null?void 0:t.events)||(r=je("UNSUPPORTED_EVENTS",`${e}, events should be an array of strings or empty array for no events`)):r=je("UNSUPPORTED_METHODS",`${e}, methods should be an array of strings or empty array for no methods`),r}function G1(t,e){let r=null;return Object.values(t).forEach(i=>{if(r)return;const n=eE(i,`${e}, namespace`);n&&(r=n)}),r}function tE(t,e,r){let i=null;if(t&&js(t)){const n=G1(t,e);n&&(i=n);const s=Z_(t,e,r);s&&(i=s)}else i=J("MISSING_OR_INVALID",`${e}, ${r} should be an object with data`);return i}function qc(t,e){let r=null;if(t&&js(t)){const i=G1(t,e);i&&(r=i);const n=Q_(t,e);n&&(r=n)}else r=J("MISSING_OR_INVALID",`${e}, namespaces should be an object with data`);return r}function J1(t){return tt(t.protocol,!0)}function rE(t,e){let r=!1;return t?t&&rs(t)&&t.length&&t.forEach(i=>{r=J1(i)}):r=!0,r}function iE(t){return typeof t=="number"}function zt(t){return typeof t<"u"&&typeof t!==null}function nE(t){return!(!t||typeof t!="object"||!t.code||!Sd(t.code,!1)||!t.message||!tt(t.message,!1))}function sE(t){return!(Tt(t)||!tt(t.method,!1))}function aE(t){return!(Tt(t)||Tt(t.result)&&Tt(t.error)||!Sd(t.id,!1)||!tt(t.jsonrpc,!1))}function oE(t){return!(Tt(t)||!tt(t.name,!1))}function nl(t,e){return!(!so(e)||!L_(t).includes(e))}function cE(t,e,r){return tt(r,!1)?D_(t,e).includes(r):!1}function fE(t,e,r){return tt(r,!1)?U_(t,e).includes(r):!1}function sl(t,e,r){let i=null;const n=dE(t),s=hE(e),a=Object.keys(n),c=Object.keys(s),d=al(Object.keys(t)),u=al(Object.keys(e)),l=d.filter(g=>!u.includes(g));return l.length&&(i=J("NON_CONFORMING_NAMESPACES",`${r} namespaces keys don't satisfy requiredNamespaces.
      Required: ${l.toString()}
      Received: ${Object.keys(e).toString()}`)),gn(a,c)||(i=J("NON_CONFORMING_NAMESPACES",`${r} namespaces chains don't satisfy required namespaces.
      Required: ${a.toString()}
      Approved: ${c.toString()}`)),Object.keys(e).forEach(g=>{if(!g.includes(":")||i)return;const w=ls(e[g].accounts);w.includes(g)||(i=J("NON_CONFORMING_NAMESPACES",`${r} namespaces accounts don't satisfy namespace accounts for ${g}
        Required: ${g}
        Approved: ${w.toString()}`))}),a.forEach(g=>{i||(gn(n[g].methods,s[g].methods)?gn(n[g].events,s[g].events)||(i=J("NON_CONFORMING_NAMESPACES",`${r} namespaces events don't satisfy namespace events for ${g}`)):i=J("NON_CONFORMING_NAMESPACES",`${r} namespaces methods don't satisfy namespace methods for ${g}`))}),i}function dE(t){const e={};return Object.keys(t).forEach(r=>{var i;r.includes(":")?e[r]=t[r]:(i=t[r].chains)==null||i.forEach(n=>{e[n]={methods:t[r].methods,events:t[r].events}})}),e}function al(t){return[...new Set(t.map(e=>e.includes(":")?e.split(":")[0]:e))]}function hE(t){const e={};return Object.keys(t).forEach(r=>{if(r.includes(":"))e[r]=t[r];else{const i=ls(t[r].accounts);i==null||i.forEach(n=>{e[n]={accounts:t[r].accounts.filter(s=>s.includes(`${n}:`)),methods:t[r].methods,events:t[r].events}})}}),e}function uE(t,e){return Sd(t,!1)&&t<=e.max&&t>=e.min}function ol(){const t=ia();return new Promise(e=>{switch(t){case tr.browser:e(lE());break;case tr.reactNative:e(pE());break;case tr.node:e(bE());break;default:e(!0)}})}function lE(){return ra()&&(navigator==null?void 0:navigator.onLine)}async function pE(){if(Ji()&&typeof ne<"u"&&ne!=null&&ne.NetInfo){const t=await(ne==null?void 0:ne.NetInfo.fetch());return t==null?void 0:t.isConnected}return!0}function bE(){return!0}function gE(t){switch(ia()){case tr.browser:vE(t);break;case tr.reactNative:yE(t);break}}function vE(t){!Ji()&&ra()&&(window.addEventListener("online",()=>t(!0)),window.addEventListener("offline",()=>t(!1)))}function yE(t){var e;Ji()&&typeof ne<"u"&&ne!=null&&ne.NetInfo&&((e=ne)==null||e.NetInfo.addEventListener(r=>t(r==null?void 0:r.isConnected)))}const Lc={};let $s=class{static get(e){return Lc[e]}static set(e,r){Lc[e]=r}static delete(e){delete Lc[e]}};class yr extends N0{constructor(e){super(e),this.events=new Ht.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(e),this.connection.connected&&this.registerEventListeners()}async connect(e=this.connection){await this.open(e)}async disconnect(){await this.close()}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async request(e,r){return this.requestStrict(Ei(e.method,e.params||[],e.id||Ui().toString()),r)}async requestStrict(e,r){return new Promise(async(i,n)=>{if(!this.connection.connected)try{await this.open()}catch(s){n(s)}this.events.on(`${e.id}`,s=>{Xt(s)?n(s.error):i(s.result)});try{await this.connection.send(e,r)}catch(s){n(s)}})}setConnection(e=this.connection){return e}onPayload(e){this.events.emit("payload",e),Ks(e)?this.events.emit(`${e.id}`,e):this.events.emit("message",{type:e.method,data:e.params})}onClose(e){e&&e.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${e.code} ${e.reason?`(${e.reason})`:""}`)),this.events.emit("disconnect")}async open(e=this.connection){this.connection===e&&this.connection.connected||(this.connection.connected&&this.close(),typeof e=="string"&&(await this.connection.open(e),e=this.connection),this.connection=this.setConnection(e),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",e=>this.onPayload(e)),this.connection.on("close",e=>this.onClose(e)),this.connection.on("error",e=>this.events.emit("error",e)),this.connection.on("register_error",e=>this.onClose()),this.hasRegisteredEventListeners=!0)}}const mE=()=>typeof WebSocket<"u"?WebSocket:typeof ne<"u"&&typeof ne.WebSocket<"u"?ne.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:typeof self<"u"&&typeof self.WebSocket<"u"?self.WebSocket:require("ws"),wE=()=>typeof WebSocket<"u"||typeof ne<"u"&&typeof ne.WebSocket<"u"||typeof window<"u"&&typeof window.WebSocket<"u"||typeof self<"u"&&typeof self.WebSocket<"u",cl=t=>t.split("?")[0],fl=10,_E=mE();let EE=class{constructor(e){if(this.url=e,this.events=new Ht.EventEmitter,this.registering=!1,!jd(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);this.url=e}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async open(e=this.url){await this.register(e)}async close(){return new Promise((e,r)=>{if(typeof this.socket>"u"){r(new Error("Connection already closed"));return}this.socket.onclose=i=>{this.onClose(i),e()},this.socket.close()})}async send(e){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(Cr(e))}catch(r){this.onError(e.id,r)}}register(e=this.url){if(!jd(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((i,n)=>{this.events.once("register_error",s=>{this.resetMaxListeners(),n(s)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return n(new Error("WebSocket connection is missing or invalid"));i(this.socket)})})}return this.url=e,this.registering=!0,new Promise((r,i)=>{const n=R0.isReactNative()?void 0:{rejectUnauthorized:!Q2(e)},s=new _E(e,[],n);wE()?s.onerror=a=>{const c=a;i(this.emitError(c.error))}:s.on("error",a=>{i(this.emitError(a))}),s.onopen=()=>{this.onOpen(s),r(s)}})}onOpen(e){e.onmessage=r=>this.onPayload(r),e.onclose=r=>this.onClose(r),this.socket=e,this.registering=!1,this.events.emit("open")}onClose(e){this.socket=void 0,this.registering=!1,this.events.emit("close",e)}onPayload(e){if(typeof e.data>"u")return;const r=typeof e.data=="string"?Vi(e.data):e.data;this.events.emit("payload",r)}onError(e,r){const i=this.parseError(r),n=i.message||i.toString(),s=Hs(e,n);this.events.emit("payload",s)}parseError(e,r=this.url){return Lf(e,cl(r),"WS")}resetMaxListeners(){this.events.getMaxListeners()>fl&&this.events.setMaxListeners(fl)}emitError(e){const r=this.parseError(new Error((e==null?void 0:e.message)||`WebSocket connection failed for host: ${cl(this.url)}`));return this.events.emit("register_error",r),r}};var ao={exports:{}};ao.exports;(function(t,e){var r=200,i="__lodash_hash_undefined__",n=1,s=2,a=9007199254740991,c="[object Arguments]",d="[object Array]",u="[object AsyncFunction]",l="[object Boolean]",g="[object Date]",w="[object Error]",E="[object Function]",$="[object GeneratorFunction]",I="[object Map]",M="[object Number]",P="[object Null]",A="[object Object]",R="[object Promise]",C="[object Proxy]",D="[object RegExp]",U="[object Set]",j="[object String]",z="[object Symbol]",q="[object Undefined]",V="[object WeakMap]",S="[object ArrayBuffer]",o="[object DataView]",h="[object Float32Array]",y="[object Float64Array]",p="[object Int8Array]",v="[object Int16Array]",_="[object Int32Array]",x="[object Uint8Array]",b="[object Uint8ClampedArray]",f="[object Uint16Array]",m="[object Uint32Array]",F=/[\\^$.*+?()[\]{}|]/g,N=/^\[object .+?Constructor\]$/,T=/^(?:0|[1-9]\d*)$/,L={};L[h]=L[y]=L[p]=L[v]=L[_]=L[x]=L[b]=L[f]=L[m]=!0,L[c]=L[d]=L[S]=L[l]=L[o]=L[g]=L[w]=L[E]=L[I]=L[M]=L[A]=L[D]=L[U]=L[j]=L[V]=!1;var k=typeof Ue=="object"&&Ue&&Ue.Object===Object&&Ue,W=typeof self=="object"&&self&&self.Object===Object&&self,Z=k||W||Function("return this")(),K=e&&!e.nodeType&&e,Y=K&&!0&&t&&!t.nodeType&&t,ke=Y&&Y.exports===K,Q=ke&&k.process,te=function(){try{return Q&&Q.binding&&Q.binding("util")}catch{}}(),At=te&&te.isTypedArray;function he(O,B){for(var H=-1,X=O==null?0:O.length,Ge=0,Ce=[];++H<X;){var Ze=O[H];B(Ze,H,O)&&(Ce[Ge++]=Ze)}return Ce}function ue(O,B){for(var H=-1,X=B.length,Ge=O.length;++H<X;)O[Ge+H]=B[H];return O}function wr(O,B){for(var H=-1,X=O==null?0:O.length;++H<X;)if(B(O[H],H,O))return!0;return!1}function le(O,B){for(var H=-1,X=Array(O);++H<O;)X[H]=B(H);return X}function se(O){return function(B){return O(B)}}function Vt(O,B){return O.has(B)}function re(O,B){return O==null?void 0:O[B]}function ae(O){var B=-1,H=Array(O.size);return O.forEach(function(X,Ge){H[++B]=[Ge,X]}),H}function Wt(O,B){return function(H){return O(B(H))}}function oe(O){var B=-1,H=Array(O.size);return O.forEach(function(X){H[++B]=X}),H}var ce=Array.prototype,Gt=Function.prototype,ie=Object.prototype,fe=Z["__core-js_shared__"],sr=Gt.toString,ee=ie.hasOwnProperty,me=function(){var O=/[^.]+$/.exec(fe&&fe.keys&&fe.keys.IE_PROTO||"");return O?"Symbol(src)_1."+O:""}(),Ai=ie.toString,xe=RegExp("^"+sr.call(ee).replace(F,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),we=ke?Z.Buffer:void 0,Br=Z.Symbol,_e=Z.Uint8Array,Ee=ie.propertyIsEnumerable,Yi=ce.splice,de=Br?Br.toStringTag:void 0,Se=Object.getOwnPropertySymbols,Zi=we?we.isBuffer:void 0,Ie=Wt(Object.keys,Object),be=Mn(Z,"DataView"),_r=Mn(Z,"Map"),ge=Mn(Z,"Promise"),ve=Mn(Z,"Set"),Gr=Mn(Z,"WeakMap"),pe=Mn(Object,"create"),Me=tn(be),Xi=tn(_r),Ae=tn(ge),Pe=tn(ve),Qi=tn(Gr),$e=Br?Br.prototype:void 0,ye=$e?$e.valueOf:void 0;function Jt(O){var B=-1,H=O==null?0:O.length;for(this.clear();++B<H;){var X=O[B];this.set(X[0],X[1])}}function Oe(){this.__data__=pe?pe(null):{},this.size=0}function Re(O){var B=this.has(O)&&delete this.__data__[O];return this.size-=B?1:0,B}function en(O){var B=this.__data__;if(pe){var H=B[O];return H===i?void 0:H}return ee.call(B,O)?B[O]:void 0}function Fe(O){var B=this.__data__;return pe?B[O]!==void 0:ee.call(B,O)}function Ne(O,B){var H=this.__data__;return this.size+=this.has(O)?0:1,H[O]=pe&&B===void 0?i:B,this}Jt.prototype.clear=Oe,Jt.prototype.delete=Re,Jt.prototype.get=en,Jt.prototype.has=Fe,Jt.prototype.set=Ne;function mt(O){var B=-1,H=O==null?0:O.length;for(this.clear();++B<H;){var X=O[B];this.set(X[0],X[1])}}function Jr(){this.__data__=[],this.size=0}function Yr(O){var B=this.__data__,H=fa(B,O);if(H<0)return!1;var X=B.length-1;return H==X?B.pop():Yi.call(B,H,1),--this.size,!0}function Zr(O){var B=this.__data__,H=fa(B,O);return H<0?void 0:B[H][1]}function Xr(O){return fa(this.__data__,O)>-1}function Qr(O,B){var H=this.__data__,X=fa(H,O);return X<0?(++this.size,H.push([O,B])):H[X][1]=B,this}mt.prototype.clear=Jr,mt.prototype.delete=Yr,mt.prototype.get=Zr,mt.prototype.has=Xr,mt.prototype.set=Qr;function Ct(O){var B=-1,H=O==null?0:O.length;for(this.clear();++B<H;){var X=O[B];this.set(X[0],X[1])}}function ei(){this.size=0,this.__data__={hash:new Jt,map:new(_r||mt),string:new Jt}}function ti(O){var B=da(this,O).delete(O);return this.size-=B?1:0,B}function ri(O){return da(this,O).get(O)}function ii(O){return da(this,O).has(O)}function ni(O,B){var H=da(this,O),X=H.size;return H.set(O,B),this.size+=H.size==X?0:1,this}Ct.prototype.clear=ei,Ct.prototype.delete=ti,Ct.prototype.get=ri,Ct.prototype.has=ii,Ct.prototype.set=ni;function ar(O){var B=-1,H=O==null?0:O.length;for(this.__data__=new Ct;++B<H;)this.add(O[B])}function si(O){return this.__data__.set(O,i),this}function ai(O){return this.__data__.has(O)}ar.prototype.add=ar.prototype.push=si,ar.prototype.has=ai;function Pt(O){var B=this.__data__=new mt(O);this.size=B.size}function oi(){this.__data__=new mt,this.size=0}function ci(O){var B=this.__data__,H=B.delete(O);return this.size=B.size,H}function fi(O){return this.__data__.get(O)}function jb(O){return this.__data__.has(O)}function kb(O,B){var H=this.__data__;if(H instanceof mt){var X=H.__data__;if(!_r||X.length<r-1)return X.push([O,B]),this.size=++H.size,this;H=this.__data__=new Ct(X)}return H.set(O,B),this.size=H.size,this}Pt.prototype.clear=oi,Pt.prototype.delete=ci,Pt.prototype.get=fi,Pt.prototype.has=jb,Pt.prototype.set=kb;function Hb(O,B){var H=ha(O),X=!H&&s2(O),Ge=!H&&!X&&Jo(O),Ce=!H&&!X&&!Ge&&qd(O),Ze=H||X||Ge||Ce,ot=Ze?le(O.length,String):[],wt=ot.length;for(var Ye in O)ee.call(O,Ye)&&!(Ze&&(Ye=="length"||Ge&&(Ye=="offset"||Ye=="parent")||Ce&&(Ye=="buffer"||Ye=="byteLength"||Ye=="byteOffset")||e2(Ye,wt)))&&ot.push(Ye);return ot}function fa(O,B){for(var H=O.length;H--;)if(Nd(O[H][0],B))return H;return-1}function Kb(O,B,H){var X=B(O);return ha(O)?X:ue(X,H(O))}function bs(O){return O==null?O===void 0?q:P:de&&de in Object(O)?Xb(O):n2(O)}function Pd(O){return gs(O)&&bs(O)==c}function Od(O,B,H,X,Ge){return O===B?!0:O==null||B==null||!gs(O)&&!gs(B)?O!==O&&B!==B:Vb(O,B,H,X,Od,Ge)}function Vb(O,B,H,X,Ge,Ce){var Ze=ha(O),ot=ha(B),wt=Ze?d:Pi(O),Ye=ot?d:Pi(B);wt=wt==c?A:wt,Ye=Ye==c?A:Ye;var Yt=wt==A,Er=Ye==A,Ot=wt==Ye;if(Ot&&Jo(O)){if(!Jo(B))return!1;Ze=!0,Yt=!1}if(Ot&&!Yt)return Ce||(Ce=new Pt),Ze||qd(O)?Rd(O,B,H,X,Ge,Ce):Yb(O,B,wt,H,X,Ge,Ce);if(!(H&n)){var or=Yt&&ee.call(O,"__wrapped__"),cr=Er&&ee.call(B,"__wrapped__");if(or||cr){var Oi=or?O.value():O,di=cr?B.value():B;return Ce||(Ce=new Pt),Ge(Oi,di,H,X,Ce)}}return Ot?(Ce||(Ce=new Pt),Zb(O,B,H,X,Ge,Ce)):!1}function Wb(O){if(!Bd(O)||r2(O))return!1;var B=Cd(O)?xe:N;return B.test(tn(O))}function Gb(O){return gs(O)&&Td(O.length)&&!!L[bs(O)]}function Jb(O){if(!i2(O))return Ie(O);var B=[];for(var H in Object(O))ee.call(O,H)&&H!="constructor"&&B.push(H);return B}function Rd(O,B,H,X,Ge,Ce){var Ze=H&n,ot=O.length,wt=B.length;if(ot!=wt&&!(Ze&&wt>ot))return!1;var Ye=Ce.get(O);if(Ye&&Ce.get(B))return Ye==B;var Yt=-1,Er=!0,Ot=H&s?new ar:void 0;for(Ce.set(O,B),Ce.set(B,O);++Yt<ot;){var or=O[Yt],cr=B[Yt];if(X)var Oi=Ze?X(cr,or,Yt,B,O,Ce):X(or,cr,Yt,O,B,Ce);if(Oi!==void 0){if(Oi)continue;Er=!1;break}if(Ot){if(!wr(B,function(di,rn){if(!Vt(Ot,rn)&&(or===di||Ge(or,di,H,X,Ce)))return Ot.push(rn)})){Er=!1;break}}else if(!(or===cr||Ge(or,cr,H,X,Ce))){Er=!1;break}}return Ce.delete(O),Ce.delete(B),Er}function Yb(O,B,H,X,Ge,Ce,Ze){switch(H){case o:if(O.byteLength!=B.byteLength||O.byteOffset!=B.byteOffset)return!1;O=O.buffer,B=B.buffer;case S:return!(O.byteLength!=B.byteLength||!Ce(new _e(O),new _e(B)));case l:case g:case M:return Nd(+O,+B);case w:return O.name==B.name&&O.message==B.message;case D:case j:return O==B+"";case I:var ot=ae;case U:var wt=X&n;if(ot||(ot=oe),O.size!=B.size&&!wt)return!1;var Ye=Ze.get(O);if(Ye)return Ye==B;X|=s,Ze.set(O,B);var Yt=Rd(ot(O),ot(B),X,Ge,Ce,Ze);return Ze.delete(O),Yt;case z:if(ye)return ye.call(O)==ye.call(B)}return!1}function Zb(O,B,H,X,Ge,Ce){var Ze=H&n,ot=Fd(O),wt=ot.length,Ye=Fd(B),Yt=Ye.length;if(wt!=Yt&&!Ze)return!1;for(var Er=wt;Er--;){var Ot=ot[Er];if(!(Ze?Ot in B:ee.call(B,Ot)))return!1}var or=Ce.get(O);if(or&&Ce.get(B))return or==B;var cr=!0;Ce.set(O,B),Ce.set(B,O);for(var Oi=Ze;++Er<wt;){Ot=ot[Er];var di=O[Ot],rn=B[Ot];if(X)var Ld=Ze?X(rn,di,Ot,B,O,Ce):X(di,rn,Ot,O,B,Ce);if(!(Ld===void 0?di===rn||Ge(di,rn,H,X,Ce):Ld)){cr=!1;break}Oi||(Oi=Ot=="constructor")}if(cr&&!Oi){var ua=O.constructor,la=B.constructor;ua!=la&&"constructor"in O&&"constructor"in B&&!(typeof ua=="function"&&ua instanceof ua&&typeof la=="function"&&la instanceof la)&&(cr=!1)}return Ce.delete(O),Ce.delete(B),cr}function Fd(O){return Kb(O,c2,Qb)}function da(O,B){var H=O.__data__;return t2(B)?H[typeof B=="string"?"string":"hash"]:H.map}function Mn(O,B){var H=re(O,B);return Wb(H)?H:void 0}function Xb(O){var B=ee.call(O,de),H=O[de];try{O[de]=void 0;var X=!0}catch{}var Ge=Ai.call(O);return X&&(B?O[de]=H:delete O[de]),Ge}var Qb=Se?function(O){return O==null?[]:(O=Object(O),he(Se(O),function(B){return Ee.call(O,B)}))}:f2,Pi=bs;(be&&Pi(new be(new ArrayBuffer(1)))!=o||_r&&Pi(new _r)!=I||ge&&Pi(ge.resolve())!=R||ve&&Pi(new ve)!=U||Gr&&Pi(new Gr)!=V)&&(Pi=function(O){var B=bs(O),H=B==A?O.constructor:void 0,X=H?tn(H):"";if(X)switch(X){case Me:return o;case Xi:return I;case Ae:return R;case Pe:return U;case Qi:return V}return B});function e2(O,B){return B=B??a,!!B&&(typeof O=="number"||T.test(O))&&O>-1&&O%1==0&&O<B}function t2(O){var B=typeof O;return B=="string"||B=="number"||B=="symbol"||B=="boolean"?O!=="__proto__":O===null}function r2(O){return!!me&&me in O}function i2(O){var B=O&&O.constructor,H=typeof B=="function"&&B.prototype||ie;return O===H}function n2(O){return Ai.call(O)}function tn(O){if(O!=null){try{return sr.call(O)}catch{}try{return O+""}catch{}}return""}function Nd(O,B){return O===B||O!==O&&B!==B}var s2=Pd(function(){return arguments}())?Pd:function(O){return gs(O)&&ee.call(O,"callee")&&!Ee.call(O,"callee")},ha=Array.isArray;function a2(O){return O!=null&&Td(O.length)&&!Cd(O)}var Jo=Zi||d2;function o2(O,B){return Od(O,B)}function Cd(O){if(!Bd(O))return!1;var B=bs(O);return B==E||B==$||B==u||B==C}function Td(O){return typeof O=="number"&&O>-1&&O%1==0&&O<=a}function Bd(O){var B=typeof O;return O!=null&&(B=="object"||B=="function")}function gs(O){return O!=null&&typeof O=="object"}var qd=At?se(At):Gb;function c2(O){return a2(O)?Hb(O):Jb(O)}function f2(){return[]}function d2(){return!1}t.exports=o2})(ao,ao.exports);var SE=ao.exports;const $E=M0(SE),Y1="wc",Z1=2,Of="core",Kr=`${Y1}@2:${Of}:`,xE={logger:"error"},IE={database:":memory:"},ME="crypto",dl="client_ed25519_seed",AE=G.ONE_DAY,PE="keychain",OE="0.3",RE="messages",FE="0.3",hl=G.SIX_HOURS,NE="publisher",X1="irn",CE="error",Q1="wss://relay.walletconnect.org",TE="relayer",dt={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},BE="_subscription",fr={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},qE=.1,Rf="2.18.0",He={link_mode:"link_mode",relay:"relay"},LE="0.3",DE="WALLETCONNECT_CLIENT_ID",ul="WALLETCONNECT_LINK_MODE_APPS",Zt={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},UE="subscription",zE="0.3",jE=G.FIVE_SECONDS*1e3,kE="pairing",HE="0.3",xs={wc_pairingDelete:{req:{ttl:G.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:G.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:G.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:G.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:G.ONE_DAY,prompt:!1,tag:0},res:{ttl:G.ONE_DAY,prompt:!1,tag:0}}},bn={create:"pairing_create",expire:"pairing_expire",delete:"pairing_delete",ping:"pairing_ping"},xr={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},KE="history",VE="0.3",WE="expirer",dr={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},GE="0.3",JE="verify-api",YE="https://verify.walletconnect.com",eb="https://verify.walletconnect.org",Cs=eb,ZE=`${Cs}/v3`,XE=[YE,eb],QE="echo",eS="https://echo.walletconnect.com",jr={pairing_started:"pairing_started",pairing_uri_validation_success:"pairing_uri_validation_success",pairing_uri_not_expired:"pairing_uri_not_expired",store_new_pairing:"store_new_pairing",subscribing_pairing_topic:"subscribing_pairing_topic",subscribe_pairing_topic_success:"subscribe_pairing_topic_success",existing_pairing:"existing_pairing",pairing_not_expired:"pairing_not_expired",emit_inactive_pairing:"emit_inactive_pairing",emit_session_proposal:"emit_session_proposal",subscribing_to_pairing_topic:"subscribing_to_pairing_topic"},mi={no_wss_connection:"no_wss_connection",no_internet_connection:"no_internet_connection",malformed_pairing_uri:"malformed_pairing_uri",active_pairing_already_exists:"active_pairing_already_exists",subscribe_pairing_topic_failure:"subscribe_pairing_topic_failure",pairing_expired:"pairing_expired",proposal_expired:"proposal_expired",proposal_listener_not_found:"proposal_listener_not_found"},Ir={session_approve_started:"session_approve_started",proposal_not_expired:"proposal_not_expired",session_namespaces_validation_success:"session_namespaces_validation_success",create_session_topic:"create_session_topic",subscribing_session_topic:"subscribing_session_topic",subscribe_session_topic_success:"subscribe_session_topic_success",publishing_session_approve:"publishing_session_approve",session_approve_publish_success:"session_approve_publish_success",store_session:"store_session",publishing_session_settle:"publishing_session_settle",session_settle_publish_success:"session_settle_publish_success"},cn={no_internet_connection:"no_internet_connection",no_wss_connection:"no_wss_connection",proposal_expired:"proposal_expired",subscribe_session_topic_failure:"subscribe_session_topic_failure",session_approve_publish_failure:"session_approve_publish_failure",session_settle_publish_failure:"session_settle_publish_failure",session_approve_namespace_validation_failure:"session_approve_namespace_validation_failure",proposal_not_found:"proposal_not_found"},fn={authenticated_session_approve_started:"authenticated_session_approve_started",create_authenticated_session_topic:"create_authenticated_session_topic",cacaos_verified:"cacaos_verified",store_authenticated_session:"store_authenticated_session",subscribing_authenticated_session_topic:"subscribing_authenticated_session_topic",subscribe_authenticated_session_topic_success:"subscribe_authenticated_session_topic_success",publishing_authenticated_session_approve:"publishing_authenticated_session_approve"},Is={no_internet_connection:"no_internet_connection",invalid_cacao:"invalid_cacao",subscribe_authenticated_session_topic_failure:"subscribe_authenticated_session_topic_failure",authenticated_session_approve_publish_failure:"authenticated_session_approve_publish_failure",authenticated_session_pending_request_not_found:"authenticated_session_pending_request_not_found"},tS=.1,rS="event-client",iS=86400,nS="https://pulse.walletconnect.org/batch";function sS(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),i=0;i<r.length;i++)r[i]=255;for(var n=0;n<t.length;n++){var s=t.charAt(n),a=s.charCodeAt(0);if(r[a]!==255)throw new TypeError(s+" is ambiguous");r[a]=n}var c=t.length,d=t.charAt(0),u=Math.log(c)/Math.log(256),l=Math.log(256)/Math.log(c);function g($){if($ instanceof Uint8Array||(ArrayBuffer.isView($)?$=new Uint8Array($.buffer,$.byteOffset,$.byteLength):Array.isArray($)&&($=Uint8Array.from($))),!($ instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if($.length===0)return"";for(var I=0,M=0,P=0,A=$.length;P!==A&&$[P]===0;)P++,I++;for(var R=(A-P)*l+1>>>0,C=new Uint8Array(R);P!==A;){for(var D=$[P],U=0,j=R-1;(D!==0||U<M)&&j!==-1;j--,U++)D+=256*C[j]>>>0,C[j]=D%c>>>0,D=D/c>>>0;if(D!==0)throw new Error("Non-zero carry");M=U,P++}for(var z=R-M;z!==R&&C[z]===0;)z++;for(var q=d.repeat(I);z<R;++z)q+=t.charAt(C[z]);return q}function w($){if(typeof $!="string")throw new TypeError("Expected String");if($.length===0)return new Uint8Array;var I=0;if($[I]!==" "){for(var M=0,P=0;$[I]===d;)M++,I++;for(var A=($.length-I)*u+1>>>0,R=new Uint8Array(A);$[I];){var C=r[$.charCodeAt(I)];if(C===255)return;for(var D=0,U=A-1;(C!==0||D<P)&&U!==-1;U--,D++)C+=c*R[U]>>>0,R[U]=C%256>>>0,C=C/256>>>0;if(C!==0)throw new Error("Non-zero carry");P=D,I++}if($[I]!==" "){for(var j=A-P;j!==A&&R[j]===0;)j++;for(var z=new Uint8Array(M+(A-j)),q=M;j!==A;)z[q++]=R[j++];return z}}}function E($){var I=w($);if(I)return I;throw new Error(`Non-${e} character`)}return{encode:g,decodeUnsafe:w,decode:E}}var aS=sS,oS=aS;const tb=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")},cS=t=>new TextEncoder().encode(t),fS=t=>new TextDecoder().decode(t);let dS=class{constructor(e,r,i){this.name=e,this.prefix=r,this.baseEncode=i}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},hS=class{constructor(e,r,i){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=i}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return rb(this,e)}},uS=class{constructor(e){this.decoders=e}or(e){return rb(this,e)}decode(e){const r=e[0],i=this.decoders[r];if(i)return i.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}};const rb=(t,e)=>new uS({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}});let lS=class{constructor(e,r,i,n){this.name=e,this.prefix=r,this.baseEncode=i,this.baseDecode=n,this.encoder=new dS(e,r,i),this.decoder=new hS(e,r,n)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}};const Uo=({name:t,prefix:e,encode:r,decode:i})=>new lS(t,e,r,i),oa=({prefix:t,name:e,alphabet:r})=>{const{encode:i,decode:n}=oS(r,e);return Uo({prefix:t,name:e,encode:i,decode:s=>tb(n(s))})},pS=(t,e,r,i)=>{const n={};for(let l=0;l<e.length;++l)n[e[l]]=l;let s=t.length;for(;t[s-1]==="=";)--s;const a=new Uint8Array(s*r/8|0);let c=0,d=0,u=0;for(let l=0;l<s;++l){const g=n[t[l]];if(g===void 0)throw new SyntaxError(`Non-${i} character`);d=d<<r|g,c+=r,c>=8&&(c-=8,a[u++]=255&d>>c)}if(c>=r||255&d<<8-c)throw new SyntaxError("Unexpected end of data");return a},bS=(t,e,r)=>{const i=e[e.length-1]==="=",n=(1<<r)-1;let s="",a=0,c=0;for(let d=0;d<t.length;++d)for(c=c<<8|t[d],a+=8;a>r;)a-=r,s+=e[n&c>>a];if(a&&(s+=e[n&c<<r-a]),i)for(;s.length*r&7;)s+="=";return s},Mt=({name:t,prefix:e,bitsPerChar:r,alphabet:i})=>Uo({prefix:e,name:t,encode(n){return bS(n,i,r)},decode(n){return pS(n,i,r,t)}}),gS=Uo({prefix:"\0",name:"identity",encode:t=>fS(t),decode:t=>cS(t)});var vS=Object.freeze({__proto__:null,identity:gS});const yS=Mt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var mS=Object.freeze({__proto__:null,base2:yS});const wS=Mt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var _S=Object.freeze({__proto__:null,base8:wS});const ES=oa({prefix:"9",name:"base10",alphabet:"0123456789"});var SS=Object.freeze({__proto__:null,base10:ES});const $S=Mt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),xS=Mt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var IS=Object.freeze({__proto__:null,base16:$S,base16upper:xS});const MS=Mt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),AS=Mt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),PS=Mt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),OS=Mt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),RS=Mt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),FS=Mt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),NS=Mt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),CS=Mt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),TS=Mt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var BS=Object.freeze({__proto__:null,base32:MS,base32upper:AS,base32pad:PS,base32padupper:OS,base32hex:RS,base32hexupper:FS,base32hexpad:NS,base32hexpadupper:CS,base32z:TS});const qS=oa({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),LS=oa({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var DS=Object.freeze({__proto__:null,base36:qS,base36upper:LS});const US=oa({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),zS=oa({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var jS=Object.freeze({__proto__:null,base58btc:US,base58flickr:zS});const kS=Mt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),HS=Mt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),KS=Mt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),VS=Mt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var WS=Object.freeze({__proto__:null,base64:kS,base64pad:HS,base64url:KS,base64urlpad:VS});const ib=Array.from(""),GS=ib.reduce((t,e,r)=>(t[r]=e,t),[]),JS=ib.reduce((t,e,r)=>(t[e.codePointAt(0)]=r,t),[]);function YS(t){return t.reduce((e,r)=>(e+=GS[r],e),"")}function ZS(t){const e=[];for(const r of t){const i=JS[r.codePointAt(0)];if(i===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(i)}return new Uint8Array(e)}const XS=Uo({prefix:"",name:"base256emoji",encode:YS,decode:ZS});var QS=Object.freeze({__proto__:null,base256emoji:XS}),e$=nb,ll=128,t$=-128,r$=Math.pow(2,31);function nb(t,e,r){e=e||[],r=r||0;for(var i=r;t>=r$;)e[r++]=t&255|ll,t/=128;for(;t&t$;)e[r++]=t&255|ll,t>>>=7;return e[r]=t|0,nb.bytes=r-i+1,e}var i$=Ff,n$=128,pl=127;function Ff(t,i){var r=0,i=i||0,n=0,s=i,a,c=t.length;do{if(s>=c)throw Ff.bytes=0,new RangeError("Could not decode varint");a=t[s++],r+=n<28?(a&pl)<<n:(a&pl)*Math.pow(2,n),n+=7}while(a>=n$);return Ff.bytes=s-i,r}var s$=Math.pow(2,7),a$=Math.pow(2,14),o$=Math.pow(2,21),c$=Math.pow(2,28),f$=Math.pow(2,35),d$=Math.pow(2,42),h$=Math.pow(2,49),u$=Math.pow(2,56),l$=Math.pow(2,63),p$=function(t){return t<s$?1:t<a$?2:t<o$?3:t<c$?4:t<f$?5:t<d$?6:t<h$?7:t<u$?8:t<l$?9:10},b$={encode:e$,decode:i$,encodingLength:p$},sb=b$;const bl=(t,e,r=0)=>(sb.encode(t,e,r),e),gl=t=>sb.encodingLength(t),Nf=(t,e)=>{const r=e.byteLength,i=gl(t),n=i+gl(r),s=new Uint8Array(n+r);return bl(t,s,0),bl(r,s,i),s.set(e,n),new g$(t,r,e,s)};let g$=class{constructor(e,r,i,n){this.code=e,this.size=r,this.digest=i,this.bytes=n}};const ab=({name:t,code:e,encode:r})=>new v$(t,e,r);let v$=class{constructor(e,r,i){this.name=e,this.code=r,this.encode=i}digest(e){if(e instanceof Uint8Array){const r=this.encode(e);return r instanceof Uint8Array?Nf(this.code,r):r.then(i=>Nf(this.code,i))}else throw Error("Unknown type, must be binary type")}};const ob=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),y$=ab({name:"sha2-256",code:18,encode:ob("SHA-256")}),m$=ab({name:"sha2-512",code:19,encode:ob("SHA-512")});var w$=Object.freeze({__proto__:null,sha256:y$,sha512:m$});const cb=0,_$="identity",fb=tb,E$=t=>Nf(cb,fb(t)),S$={code:cb,name:_$,encode:fb,digest:E$};var $$=Object.freeze({__proto__:null,identity:S$});new TextEncoder,new TextDecoder;const vl={...vS,...mS,..._S,...SS,...IS,...BS,...DS,...jS,...WS,...QS};({...w$,...$$});function x$(t=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?globalThis.Buffer.allocUnsafe(t):new Uint8Array(t)}function db(t,e,r,i){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:i}}}const yl=db("utf8","u",t=>"u"+new TextDecoder("utf8").decode(t),t=>new TextEncoder().encode(t.substring(1))),Dc=db("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);const e=x$(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),I$={utf8:yl,"utf-8":yl,hex:vl.base16,latin1:Dc,ascii:Dc,binary:Dc,...vl};function M$(t,e="utf8"){const r=I$[e];if(!r)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(t,"utf8"):r.decoder.decode(`${r.prefix}${t}`)}let A$=class{constructor(e,r){this.core=e,this.logger=r,this.keychain=new Map,this.name=PE,this.version=OE,this.initialized=!1,this.storagePrefix=Kr,this.init=async()=>{if(!this.initialized){const i=await this.getKeyChain();typeof i<"u"&&(this.keychain=i),this.initialized=!0}},this.has=i=>(this.isInitialized(),this.keychain.has(i)),this.set=async(i,n)=>{this.isInitialized(),this.keychain.set(i,n),await this.persist()},this.get=i=>{this.isInitialized();const n=this.keychain.get(i);if(typeof n>"u"){const{message:s}=J("NO_MATCHING_KEY",`${this.name}: ${i}`);throw new Error(s)}return n},this.del=async i=>{this.isInitialized(),this.keychain.delete(i),await this.persist()},this.core=e,this.logger=qt(r,this.name)}get context(){return Kt(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setKeyChain(e){await this.core.storage.setItem(this.storageKey,w1(e))}async getKeyChain(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?_1(e):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:e}=J("NOT_INITIALIZED",this.name);throw new Error(e)}}},P$=class{constructor(e,r,i){this.core=e,this.logger=r,this.name=ME,this.randomSessionIdentifier=Pf(),this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=n=>(this.isInitialized(),this.keychain.has(n)),this.getClientId=async()=>{this.isInitialized();const n=await this.getClientSeed(),s=yu(n);return a1(s.publicKey)},this.generateKeyPair=()=>{this.isInitialized();const n=S_();return this.setPrivateKey(n.publicKey,n.privateKey)},this.signJWT=async n=>{this.isInitialized();const s=await this.getClientSeed(),a=yu(s),c=this.randomSessionIdentifier;return await z9(c,n,AE,a)},this.generateSharedKey=(n,s,a)=>{this.isInitialized();const c=this.getPrivateKey(n),d=$_(c,s);return this.setSymKey(d,a)},this.setSymKey=async(n,s)=>{this.isInitialized();const a=s||Ua(n);return await this.keychain.set(a,n),a},this.deleteKeyPair=async n=>{this.isInitialized(),await this.keychain.del(n)},this.deleteSymKey=async n=>{this.isInitialized(),await this.keychain.del(n)},this.encode=async(n,s,a)=>{this.isInitialized();const c=W1(a),d=Cr(s);if(Qu(c))return M_(d,a==null?void 0:a.encoding);if(Xu(c)){const w=c.senderPublicKey,E=c.receiverPublicKey;n=await this.generateSharedKey(w,E)}const u=this.getSymKey(n),{type:l,senderPublicKey:g}=c;return x_({type:l,symKey:u,message:d,senderPublicKey:g,encoding:a==null?void 0:a.encoding})},this.decode=async(n,s,a)=>{this.isInitialized();const c=P_(s,a);if(Qu(c)){const d=A_(s,a==null?void 0:a.encoding);return Vi(d)}if(Xu(c)){const d=c.receiverPublicKey,u=c.senderPublicKey;n=await this.generateSharedKey(d,u)}try{const d=this.getSymKey(n),u=I_({symKey:d,encoded:s,encoding:a==null?void 0:a.encoding});return Vi(u)}catch(d){this.logger.error(`Failed to decode message from topic: '${n}', clientId: '${await this.getClientId()}'`),this.logger.error(d)}},this.getPayloadType=(n,s=ji)=>{const a=zs({encoded:n,encoding:s});return yn(a.type)},this.getPayloadSenderPublicKey=(n,s=ji)=>{const a=zs({encoded:n,encoding:s});return a.senderPublicKey?Bt(a.senderPublicKey,Nt):void 0},this.core=e,this.logger=qt(r,this.name),this.keychain=i||new A$(this.core,this.logger)}get context(){return Kt(this.logger)}async setPrivateKey(e,r){return await this.keychain.set(e,r),e}getPrivateKey(e){return this.keychain.get(e)}async getClientSeed(){let e="";try{e=this.keychain.get(dl)}catch{e=Pf(),await this.keychain.set(dl,e)}return M$(e,"base16")}getSymKey(e){return this.keychain.get(e)}isInitialized(){if(!this.initialized){const{message:e}=J("NOT_INITIALIZED",this.name);throw new Error(e)}}},O$=class extends zm{constructor(e,r){super(e,r),this.logger=e,this.core=r,this.messages=new Map,this.name=RE,this.version=FE,this.initialized=!1,this.storagePrefix=Kr,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const i=await this.getRelayerMessages();typeof i<"u"&&(this.messages=i),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(i){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(i)}finally{this.initialized=!0}}},this.set=async(i,n)=>{this.isInitialized();const s=_i(n);let a=this.messages.get(i);return typeof a>"u"&&(a={}),typeof a[s]<"u"||(a[s]=n,this.messages.set(i,a),await this.persist()),s},this.get=i=>{this.isInitialized();let n=this.messages.get(i);return typeof n>"u"&&(n={}),n},this.has=(i,n)=>{this.isInitialized();const s=this.get(i),a=_i(n);return typeof s[a]<"u"},this.del=async i=>{this.isInitialized(),this.messages.delete(i),await this.persist()},this.logger=qt(e,this.name),this.core=r}get context(){return Kt(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setRelayerMessages(e){await this.core.storage.setItem(this.storageKey,w1(e))}async getRelayerMessages(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?_1(e):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:e}=J("NOT_INITIALIZED",this.name);throw new Error(e)}}};var R$=Object.defineProperty,F$=Object.defineProperties,N$=Object.getOwnPropertyDescriptors,ml=Object.getOwnPropertySymbols,C$=Object.prototype.hasOwnProperty,T$=Object.prototype.propertyIsEnumerable,wl=(t,e,r)=>e in t?R$(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,_l=(t,e)=>{for(var r in e||(e={}))C$.call(e,r)&&wl(t,r,e[r]);if(ml)for(var r of ml(e))T$.call(e,r)&&wl(t,r,e[r]);return t},El=(t,e)=>F$(t,N$(e));let B$=class extends jm{constructor(e,r){super(e,r),this.relayer=e,this.logger=r,this.events=new Ht.EventEmitter,this.name=NE,this.queue=new Map,this.publishTimeout=G.toMiliseconds(G.ONE_MINUTE),this.initialPublishTimeout=G.toMiliseconds(G.ONE_SECOND*15),this.needsTransportRestart=!1,this.publish=async(i,n,s)=>{var a;this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:i,message:n,opts:s}});const c=(s==null?void 0:s.ttl)||hl,d=no(s),u=(s==null?void 0:s.prompt)||!1,l=(s==null?void 0:s.tag)||0,g=(s==null?void 0:s.id)||Ui().toString(),w={topic:i,message:n,opts:{ttl:c,relay:d,prompt:u,tag:l,id:g,attestation:s==null?void 0:s.attestation}},E=`Failed to publish payload, please try again. id:${g} tag:${l}`;try{const $=new Promise(async I=>{const M=({id:A})=>{w.opts.id===A&&(this.removeRequestFromQueue(A),this.relayer.events.removeListener(dt.publish,M),I(w))};this.relayer.events.on(dt.publish,M);const P=zi(new Promise((A,R)=>{this.rpcPublish({topic:i,message:n,ttl:c,prompt:u,tag:l,id:g,attestation:s==null?void 0:s.attestation}).then(A).catch(C=>{this.logger.warn(C,C==null?void 0:C.message),R(C)})}),this.initialPublishTimeout,`Failed initial publish, retrying.... id:${g} tag:${l}`);try{await P,this.events.removeListener(dt.publish,M)}catch(A){this.queue.set(g,El(_l({},w),{attempt:1})),this.logger.warn(A,A==null?void 0:A.message)}});this.logger.trace({type:"method",method:"publish",params:{id:g,topic:i,message:n,opts:s}}),await zi($,this.publishTimeout,E)}catch($){if(this.logger.debug("Failed to Publish Payload"),this.logger.error($),(a=s==null?void 0:s.internal)!=null&&a.throwOnFailedPublish)throw $}finally{this.queue.delete(g)}},this.on=(i,n)=>{this.events.on(i,n)},this.once=(i,n)=>{this.events.once(i,n)},this.off=(i,n)=>{this.events.off(i,n)},this.removeListener=(i,n)=>{this.events.removeListener(i,n)},this.relayer=e,this.logger=qt(r,this.name),this.registerEventListeners()}get context(){return Kt(this.logger)}async rpcPublish(e){var r,i,n,s;const{topic:a,message:c,ttl:d=hl,prompt:u,tag:l,id:g,attestation:w}=e,E={method:Os(no().protocol).publish,params:{topic:a,message:c,ttl:d,prompt:u,tag:l,attestation:w},id:g};Tt((r=E.params)==null?void 0:r.prompt)&&((i=E.params)==null||delete i.prompt),Tt((n=E.params)==null?void 0:n.tag)&&((s=E.params)==null||delete s.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:E});const $=await this.relayer.request(E);return this.relayer.events.emit(dt.publish,e),this.logger.debug("Successfully Published Payload"),$}removeRequestFromQueue(e){this.queue.delete(e)}checkQueue(){this.queue.forEach(async(e,r)=>{const i=e.attempt+1;this.queue.set(r,El(_l({},e),{attempt:i}));const{topic:n,message:s,opts:a,attestation:c}=e;this.logger.warn({},`Publisher: queue->publishing: ${e.opts.id}, tag: ${e.opts.tag}, attempt: ${i}`),await this.rpcPublish({topic:n,message:s,ttl:a.ttl,prompt:a.prompt,tag:a.tag,id:a.id,attestation:c}),this.logger.warn({},`Publisher: queue->published: ${e.opts.id}`)})}registerEventListeners(){this.relayer.core.heartbeat.on(cs.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(dt.connection_stalled);return}this.checkQueue()}),this.relayer.on(dt.message_ack,e=>{this.removeRequestFromQueue(e.id.toString())})}},q$=class{constructor(){this.map=new Map,this.set=(e,r)=>{const i=this.get(e);this.exists(e,r)||this.map.set(e,[...i,r])},this.get=e=>this.map.get(e)||[],this.exists=(e,r)=>this.get(e).includes(r),this.delete=(e,r)=>{if(typeof r>"u"){this.map.delete(e);return}if(!this.map.has(e))return;const i=this.get(e);if(!this.exists(e,r))return;const n=i.filter(s=>s!==r);if(!n.length){this.map.delete(e);return}this.map.set(e,n)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}};var L$=Object.defineProperty,D$=Object.defineProperties,U$=Object.getOwnPropertyDescriptors,Sl=Object.getOwnPropertySymbols,z$=Object.prototype.hasOwnProperty,j$=Object.prototype.propertyIsEnumerable,$l=(t,e,r)=>e in t?L$(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Ms=(t,e)=>{for(var r in e||(e={}))z$.call(e,r)&&$l(t,r,e[r]);if(Sl)for(var r of Sl(e))j$.call(e,r)&&$l(t,r,e[r]);return t},Uc=(t,e)=>D$(t,U$(e));let k$=class extends Km{constructor(e,r){super(e,r),this.relayer=e,this.logger=r,this.subscriptions=new Map,this.topicMap=new q$,this.events=new Ht.EventEmitter,this.name=UE,this.version=zE,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pollingInterval=20,this.storagePrefix=Kr,this.subscribeTimeout=G.toMiliseconds(G.ONE_MINUTE),this.initialSubscribeTimeout=G.toMiliseconds(G.ONE_SECOND*15),this.batchSubscribeTopicsLimit=500,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),this.registerEventListeners(),this.clientId=await this.relayer.core.crypto.getClientId(),await this.restore()),this.initialized=!0},this.subscribe=async(i,n)=>{this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:i,opts:n}});try{const s=no(n),a={topic:i,relay:s,transportType:n==null?void 0:n.transportType};this.pending.set(i,a);const c=await this.rpcSubscribe(i,s,n);return typeof c=="string"&&(this.onSubscribe(c,a),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:i,opts:n}})),c}catch(s){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(s),s}},this.unsubscribe=async(i,n)=>{await this.restartToComplete(),this.isInitialized(),typeof(n==null?void 0:n.id)<"u"?await this.unsubscribeById(i,n.id,n):await this.unsubscribeByTopic(i,n)},this.isSubscribed=async i=>{if(this.topics.includes(i))return!0;const n=`${this.pendingSubscriptionWatchLabel}_${i}`;return await new Promise((s,a)=>{const c=new G.Watch;c.start(n);const d=setInterval(()=>{(!this.pending.has(i)&&this.topics.includes(i)||this.cached.some(u=>u.topic===i))&&(clearInterval(d),c.stop(n),s(!0)),c.elapsed(n)>=jE&&(clearInterval(d),c.stop(n),a(new Error("Subscription resolution timeout")))},this.pollingInterval)}).catch(()=>!1)},this.on=(i,n)=>{this.events.on(i,n)},this.once=(i,n)=>{this.events.once(i,n)},this.off=(i,n)=>{this.events.off(i,n)},this.removeListener=(i,n)=>{this.events.removeListener(i,n)},this.start=async()=>{await this.onConnect()},this.stop=async()=>{await this.onDisconnect()},this.restart=async()=>{await this.restore(),await this.onRestart()},this.checkPending=async()=>{if(this.pending.size===0&&(!this.initialized||!this.relayer.connected))return;const i=[];this.pending.forEach(n=>{i.push(n)}),await this.batchSubscribe(i)},this.registerEventListeners=()=>{this.relayer.core.heartbeat.on(cs.pulse,async()=>{await this.checkPending()}),this.events.on(Zt.created,async i=>{const n=Zt.created;this.logger.info(`Emitting ${n}`),this.logger.debug({type:"event",event:n,data:i}),await this.persist()}),this.events.on(Zt.deleted,async i=>{const n=Zt.deleted;this.logger.info(`Emitting ${n}`),this.logger.debug({type:"event",event:n,data:i}),await this.persist()})},this.relayer=e,this.logger=qt(r,this.name),this.clientId=""}get context(){return Kt(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.relayer.core.customStoragePrefix+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(e,r){let i=!1;try{i=this.getSubscription(e).topic===r}catch{}return i}reset(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(e,r){const i=this.topicMap.get(e);await Promise.all(i.map(async n=>await this.unsubscribeById(e,n,r)))}async unsubscribeById(e,r,i){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:r,opts:i}});try{const n=no(i);await this.rpcUnsubscribe(e,r,n);const s=je("USER_DISCONNECTED",`${this.name}, ${e}`);await this.onUnsubscribe(e,r,s),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:r,opts:i}})}catch(n){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(n),n}}async rpcSubscribe(e,r,i){var n;(i==null?void 0:i.transportType)===He.relay&&await this.restartToComplete();const s={method:Os(r.protocol).subscribe,params:{topic:e}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s});const a=(n=i==null?void 0:i.internal)==null?void 0:n.throwOnFailedPublish;try{const c=this.getSubscriptionId(e);if((i==null?void 0:i.transportType)===He.link_mode)return setTimeout(()=>{(this.relayer.connected||this.relayer.connecting)&&this.relayer.request(s).catch(l=>this.logger.warn(l))},G.toMiliseconds(G.ONE_SECOND)),c;const d=new Promise(async l=>{const g=w=>{w.topic===e&&(this.events.removeListener(Zt.created,g),l(w.id))};this.events.on(Zt.created,g);try{const w=await zi(new Promise((E,$)=>{this.relayer.request(s).catch(I=>{this.logger.warn(I,I==null?void 0:I.message),$(I)}).then(E)}),this.initialSubscribeTimeout,`Subscribing to ${e} failed, please try again`);this.events.removeListener(Zt.created,g),l(w)}catch{}}),u=await zi(d,this.subscribeTimeout,`Subscribing to ${e} failed, please try again`);if(!u&&a)throw new Error(`Subscribing to ${e} failed, please try again`);return u?c:null}catch(c){if(this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(dt.connection_stalled),a)throw c}return null}async rpcBatchSubscribe(e){if(!e.length)return;const r=e[0].relay,i={method:Os(r.protocol).batchSubscribe,params:{topics:e.map(n=>n.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:i});try{await await zi(new Promise(n=>{this.relayer.request(i).catch(s=>this.logger.warn(s)).then(n)}),this.subscribeTimeout,"rpcBatchSubscribe failed, please try again")}catch{this.relayer.events.emit(dt.connection_stalled)}}async rpcBatchFetchMessages(e){if(!e.length)return;const r=e[0].relay,i={method:Os(r.protocol).batchFetchMessages,params:{topics:e.map(s=>s.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:i});let n;try{n=await await zi(new Promise((s,a)=>{this.relayer.request(i).catch(c=>{this.logger.warn(c),a(c)}).then(s)}),this.subscribeTimeout,"rpcBatchFetchMessages failed, please try again")}catch{this.relayer.events.emit(dt.connection_stalled)}return n}rpcUnsubscribe(e,r,i){const n={method:Os(i.protocol).unsubscribe,params:{topic:e,id:r}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n}),this.relayer.request(n)}onSubscribe(e,r){this.setSubscription(e,Uc(Ms({},r),{id:e})),this.pending.delete(r.topic)}onBatchSubscribe(e){e.length&&e.forEach(r=>{this.setSubscription(r.id,Ms({},r)),this.pending.delete(r.topic)})}async onUnsubscribe(e,r,i){this.events.removeAllListeners(r),this.hasSubscription(r,e)&&this.deleteSubscription(r,i),await this.relayer.messages.del(e)}async setRelayerSubscriptions(e){await this.relayer.core.storage.setItem(this.storageKey,e)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(e,r){this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:e,subscription:r}),this.addSubscription(e,r)}addSubscription(e,r){this.subscriptions.set(e,Ms({},r)),this.topicMap.set(r.topic,e),this.events.emit(Zt.created,r)}getSubscription(e){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:e});const r=this.subscriptions.get(e);if(!r){const{message:i}=J("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(i)}return r}deleteSubscription(e,r){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:e,reason:r});const i=this.getSubscription(e);this.subscriptions.delete(e),this.topicMap.delete(i.topic,e),this.events.emit(Zt.deleted,Uc(Ms({},i),{reason:r}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(Zt.sync)}async onRestart(){if(this.cached.length){const e=[...this.cached],r=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let i=0;i<r;i++){const n=e.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(n)}}this.events.emit(Zt.resubscribed)}async restore(){try{const e=await this.getRelayerSubscriptions();if(typeof e>"u"||!e.length)return;if(this.subscriptions.size){const{message:r}=J("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(e){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(e)}}async batchSubscribe(e){e.length&&(await this.rpcBatchSubscribe(e),this.onBatchSubscribe(e.map(r=>Uc(Ms({},r),{id:this.getSubscriptionId(r.topic)}))))}async batchFetchMessages(e){if(!e.length)return;this.logger.trace(`Fetching batch messages for ${e.length} subscriptions`);const r=await this.rpcBatchFetchMessages(e);r&&r.messages&&(await q7(G.toMiliseconds(G.ONE_SECOND)),await this.relayer.handleBatchMessageEvents(r.messages))}async onConnect(){await this.restart(),this.reset()}onDisconnect(){this.onDisable()}isInitialized(){if(!this.initialized){const{message:e}=J("NOT_INITIALIZED",this.name);throw new Error(e)}}async restartToComplete(){!this.relayer.connected&&!this.relayer.connecting&&await this.relayer.transportOpen()}getSubscriptionId(e){return _i(e+this.clientId)}};var H$=Object.defineProperty,xl=Object.getOwnPropertySymbols,K$=Object.prototype.hasOwnProperty,V$=Object.prototype.propertyIsEnumerable,Il=(t,e,r)=>e in t?H$(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Ml=(t,e)=>{for(var r in e||(e={}))K$.call(e,r)&&Il(t,r,e[r]);if(xl)for(var r of xl(e))V$.call(e,r)&&Il(t,r,e[r]);return t};let W$=class extends km{constructor(e){super(e),this.protocol="wc",this.version=2,this.events=new Ht.EventEmitter,this.name=TE,this.transportExplicitlyClosed=!1,this.initialized=!1,this.connectionAttemptInProgress=!1,this.hasExperiencedNetworkDisruption=!1,this.heartBeatTimeout=G.toMiliseconds(G.THIRTY_SECONDS+G.FIVE_SECONDS),this.requestsInFlight=[],this.connectTimeout=G.toMiliseconds(G.ONE_SECOND*15),this.request=async r=>{var i,n;this.logger.debug("Publishing Request Payload");const s=r.id||Ui().toString();await this.toEstablishConnection();try{this.logger.trace({id:s,method:r.method,topic:(i=r.params)==null?void 0:i.topic},"relayer.request - publishing...");const a=`${s}:${((n=r.params)==null?void 0:n.tag)||""}`;this.requestsInFlight.push(a);const c=await this.provider.request(r);return this.requestsInFlight=this.requestsInFlight.filter(d=>d!==a),c}catch(a){throw this.logger.debug(`Failed to Publish Request: ${s}`),a}},this.resetPingTimeout=()=>{if(ro())try{clearTimeout(this.pingTimeout),this.pingTimeout=setTimeout(()=>{var r,i,n;this.logger.debug({},"pingTimeout: Connection stalled, terminating..."),(n=(i=(r=this.provider)==null?void 0:r.connection)==null?void 0:i.socket)==null||n.terminate()},this.heartBeatTimeout)}catch(r){this.logger.warn(r,r==null?void 0:r.message)}},this.onPayloadHandler=r=>{this.onProviderPayload(r),this.resetPingTimeout()},this.onConnectHandler=()=>{this.logger.warn({},"Relayer connected "),this.startPingTimeout(),this.events.emit(dt.connect)},this.onDisconnectHandler=()=>{this.logger.warn({},"Relayer disconnected "),this.requestsInFlight=[],this.onProviderDisconnect()},this.onProviderErrorHandler=r=>{this.logger.fatal(r,`Fatal socket error: ${r==null?void 0:r.message}`),this.events.emit(dt.error,r),this.logger.fatal("Fatal socket error received, closing transport"),this.transportClose()},this.registerProviderListeners=()=>{this.provider.on(fr.payload,this.onPayloadHandler),this.provider.on(fr.connect,this.onConnectHandler),this.provider.on(fr.disconnect,this.onDisconnectHandler),this.provider.on(fr.error,this.onProviderErrorHandler)},this.core=e.core,this.logger=typeof e.logger<"u"&&typeof e.logger!="string"?qt(e.logger,this.name):Zs(Io({level:e.logger||CE})),this.messages=new O$(this.logger,e.core),this.subscriber=new k$(this,this.logger),this.publisher=new B$(this,this.logger),this.relayUrl=(e==null?void 0:e.relayUrl)||Q1,this.projectId=e.projectId,E7()?this.packageName=xu():S7()&&(this.bundleId=xu()),this.provider={}}async init(){if(this.logger.trace("Initialized"),this.registerEventListeners(),await Promise.all([this.messages.init(),this.subscriber.init()]),this.initialized=!0,this.subscriber.cached.length>0)try{await this.transportOpen()}catch(e){this.logger.warn(e,e==null?void 0:e.message)}}get context(){return Kt(this.logger)}get connected(){var e,r,i;return((i=(r=(e=this.provider)==null?void 0:e.connection)==null?void 0:r.socket)==null?void 0:i.readyState)===1}get connecting(){var e,r,i;return((i=(r=(e=this.provider)==null?void 0:e.connection)==null?void 0:r.socket)==null?void 0:i.readyState)===0}async publish(e,r,i){this.isInitialized(),await this.publisher.publish(e,r,i),await this.recordMessageEvent({topic:e,message:r,publishedAt:Date.now(),transportType:He.relay})}async subscribe(e,r){var i,n,s;this.isInitialized(),(!(r!=null&&r.transportType)||(r==null?void 0:r.transportType)==="relay")&&await this.toEstablishConnection();const a=typeof((i=r==null?void 0:r.internal)==null?void 0:i.throwOnFailedPublish)>"u"?!0:(n=r==null?void 0:r.internal)==null?void 0:n.throwOnFailedPublish;let c=((s=this.subscriber.topicMap.get(e))==null?void 0:s[0])||"",d;const u=l=>{l.topic===e&&(this.subscriber.off(Zt.created,u),d())};return await Promise.all([new Promise(l=>{d=l,this.subscriber.on(Zt.created,u)}),new Promise(async(l,g)=>{c=await this.subscriber.subscribe(e,Ml({internal:{throwOnFailedPublish:a}},r)).catch(w=>{a&&g(w)})||c,l()})]),c}async unsubscribe(e,r){this.isInitialized(),await this.subscriber.unsubscribe(e,r)}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async transportDisconnect(){this.provider.disconnect&&(this.hasExperiencedNetworkDisruption||this.connected)?await zi(this.provider.disconnect(),2e3,"provider.disconnect()").catch(()=>this.onProviderDisconnect()):this.onProviderDisconnect()}async transportClose(){this.transportExplicitlyClosed=!0,await this.transportDisconnect()}async transportOpen(e){if(this.connectPromise?(this.logger.debug({},"Waiting for existing connection attempt to resolve..."),await this.connectPromise,this.logger.debug({},"Existing connection attempt resolved")):(this.connectPromise=new Promise(async(r,i)=>{await this.connect(e).then(r).catch(i).finally(()=>{this.connectPromise=void 0})}),await this.connectPromise),!this.connected)throw new Error(`Couldn't establish socket connection to the relay server: ${this.relayUrl}`)}async restartTransport(e){this.logger.debug({},"Restarting transport..."),!this.connectionAttemptInProgress&&(this.relayUrl=e||this.relayUrl,await this.confirmOnlineStateOrThrow(),await this.transportClose(),await this.transportOpen())}async confirmOnlineStateOrThrow(){if(!await ol())throw new Error("No internet connection detected. Please restart your network and try again.")}async handleBatchMessageEvents(e){if((e==null?void 0:e.length)===0){this.logger.trace("Batch message events is empty. Ignoring...");return}const r=e.sort((i,n)=>i.publishedAt-n.publishedAt);this.logger.debug(`Batch of ${r.length} message events sorted`);for(const i of r)try{await this.onMessageEvent(i)}catch(n){this.logger.warn(n,"Error while processing batch message event: "+(n==null?void 0:n.message))}this.logger.trace(`Batch of ${r.length} message events processed`)}async onLinkMessageEvent(e,r){const{topic:i}=e;if(!r.sessionExists){const n=nt(G.FIVE_MINUTES),s={topic:i,expiry:n,relay:{protocol:"irn"},active:!1};await this.core.pairing.pairings.set(i,s)}this.events.emit(dt.message,e),await this.recordMessageEvent(e)}async connect(e){await this.confirmOnlineStateOrThrow(),e&&e!==this.relayUrl&&(this.relayUrl=e,await this.transportDisconnect()),this.connectionAttemptInProgress=!0,this.transportExplicitlyClosed=!1;let r=1;for(;r<6;){try{this.logger.debug({},`Connecting to ${this.relayUrl}, attempt: ${r}...`),await this.createProvider(),await new Promise(async(i,n)=>{const s=()=>{n(new Error("Connection interrupted while trying to subscribe"))};this.provider.once(fr.disconnect,s),await zi(new Promise((a,c)=>{this.provider.connect().then(a).catch(c)}),this.connectTimeout,`Socket stalled when trying to connect to ${this.relayUrl}`).catch(a=>{n(a)}).finally(()=>{this.provider.off(fr.disconnect,s),clearTimeout(this.reconnectTimeout),this.reconnectTimeout=void 0}),await new Promise(async(a,c)=>{const d=()=>{c(new Error("Connection interrupted while trying to subscribe"))};this.provider.once(fr.disconnect,d),await this.subscriber.start().then(a).catch(c).finally(()=>{this.provider.off(fr.disconnect,d)})}),this.hasExperiencedNetworkDisruption=!1,i()})}catch(i){await this.subscriber.stop();const n=i;this.logger.warn({},n.message),this.hasExperiencedNetworkDisruption=!0}finally{this.connectionAttemptInProgress=!1}if(this.connected){this.logger.debug({},`Connected to ${this.relayUrl} successfully on attempt: ${r}`);break}await new Promise(i=>setTimeout(i,G.toMiliseconds(r*1))),r++}}startPingTimeout(){var e,r,i,n,s;if(ro())try{(r=(e=this.provider)==null?void 0:e.connection)!=null&&r.socket&&((s=(n=(i=this.provider)==null?void 0:i.connection)==null?void 0:n.socket)==null||s.on("ping",()=>{this.resetPingTimeout()})),this.resetPingTimeout()}catch(a){this.logger.warn(a,a==null?void 0:a.message)}}async createProvider(){this.provider.connection&&this.unregisterProviderListeners();const e=await this.core.crypto.signJWT(this.relayUrl);this.provider=new yr(new EE(M7({sdkVersion:Rf,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:e,useOnCloseEvent:!0,bundleId:this.bundleId,packageName:this.packageName}))),this.registerProviderListeners()}async recordMessageEvent(e){const{topic:r,message:i}=e;await this.messages.set(r,i)}async shouldIgnoreMessageEvent(e){const{topic:r,message:i}=e;if(!i||i.length===0)return this.logger.warn(`Ignoring invalid/empty message: ${i}`),!0;if(!await this.subscriber.isSubscribed(r))return this.logger.warn(`Ignoring message for non-subscribed topic ${r}`),!0;const n=this.messages.has(r,i);return n&&this.logger.warn(`Ignoring duplicate message: ${i}`),n}async onProviderPayload(e){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:e}),Df(e)){if(!e.method.endsWith(BE))return;const r=e.params,{topic:i,message:n,publishedAt:s,attestation:a}=r.data,c={topic:i,message:n,publishedAt:s,transportType:He.relay,attestation:a};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(Ml({type:"event",event:r.id},c)),this.events.emit(r.id,c),await this.acknowledgePayload(e),await this.onMessageEvent(c)}else Ks(e)&&this.events.emit(dt.message_ack,e)}async onMessageEvent(e){await this.shouldIgnoreMessageEvent(e)||(this.events.emit(dt.message,e),await this.recordMessageEvent(e))}async acknowledgePayload(e){const r=po(e.id,!0);await this.provider.connection.send(r)}unregisterProviderListeners(){this.provider.off(fr.payload,this.onPayloadHandler),this.provider.off(fr.connect,this.onConnectHandler),this.provider.off(fr.disconnect,this.onDisconnectHandler),this.provider.off(fr.error,this.onProviderErrorHandler),clearTimeout(this.pingTimeout)}async registerEventListeners(){let e=await ol();gE(async r=>{e!==r&&(e=r,r?await this.transportOpen().catch(i=>this.logger.error(i,i==null?void 0:i.message)):(this.hasExperiencedNetworkDisruption=!0,await this.transportDisconnect(),this.transportExplicitlyClosed=!1))})}async onProviderDisconnect(){await this.subscriber.stop(),clearTimeout(this.pingTimeout),this.events.emit(dt.disconnect),this.connectionAttemptInProgress=!1,!this.transportExplicitlyClosed&&(this.reconnectTimeout||this.connectPromise||(this.reconnectTimeout=setTimeout(async()=>{clearTimeout(this.reconnectTimeout),await this.transportOpen().catch(e=>this.logger.error(e,e==null?void 0:e.message))},G.toMiliseconds(qE))))}isInitialized(){if(!this.initialized){const{message:e}=J("NOT_INITIALIZED",this.name);throw new Error(e)}}async toEstablishConnection(){await this.confirmOnlineStateOrThrow(),!this.connected&&await this.transportOpen()}};var G$=Object.defineProperty,Al=Object.getOwnPropertySymbols,J$=Object.prototype.hasOwnProperty,Y$=Object.prototype.propertyIsEnumerable,Pl=(t,e,r)=>e in t?G$(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Ol=(t,e)=>{for(var r in e||(e={}))J$.call(e,r)&&Pl(t,r,e[r]);if(Al)for(var r of Al(e))Y$.call(e,r)&&Pl(t,r,e[r]);return t};let $n=class extends Hm{constructor(e,r,i,n=Kr,s=void 0){super(e,r,i,n),this.core=e,this.logger=r,this.name=i,this.map=new Map,this.version=LE,this.cached=[],this.initialized=!1,this.storagePrefix=Kr,this.recentlyDeleted=[],this.recentlyDeletedLimit=200,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(a=>{this.getKey&&a!==null&&!Tt(a)?this.map.set(this.getKey(a),a):W_(a)?this.map.set(a.id,a):G_(a)&&this.map.set(a.topic,a)}),this.cached=[],this.initialized=!0)},this.set=async(a,c)=>{this.isInitialized(),this.map.has(a)?await this.update(a,c):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:a,value:c}),this.map.set(a,c),await this.persist())},this.get=a=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:a}),this.getData(a)),this.getAll=a=>(this.isInitialized(),a?this.values.filter(c=>Object.keys(a).every(d=>$E(c[d],a[d]))):this.values),this.update=async(a,c)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:a,update:c});const d=Ol(Ol({},this.getData(a)),c);this.map.set(a,d),await this.persist()},this.delete=async(a,c)=>{this.isInitialized(),this.map.has(a)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:a,reason:c}),this.map.delete(a),this.addToRecentlyDeleted(a),await this.persist())},this.logger=qt(r,this.name),this.storagePrefix=n,this.getKey=s}get context(){return Kt(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}addToRecentlyDeleted(e){this.recentlyDeleted.push(e),this.recentlyDeleted.length>=this.recentlyDeletedLimit&&this.recentlyDeleted.splice(0,this.recentlyDeletedLimit/2)}async setDataStore(e){await this.core.storage.setItem(this.storageKey,e)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(e){const r=this.map.get(e);if(!r){if(this.recentlyDeleted.includes(e)){const{message:n}=J("MISSING_OR_INVALID",`Record was recently deleted - ${this.name}: ${e}`);throw this.logger.error(n),new Error(n)}const{message:i}=J("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(i),new Error(i)}return r}async persist(){await this.setDataStore(this.values)}async restore(){try{const e=await this.getDataStore();if(typeof e>"u"||!e.length)return;if(this.map.size){const{message:r}=J("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(e){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(e)}}isInitialized(){if(!this.initialized){const{message:e}=J("NOT_INITIALIZED",this.name);throw new Error(e)}}},Z$=class{constructor(e,r){this.core=e,this.logger=r,this.name=kE,this.version=HE,this.events=new Bf,this.initialized=!1,this.storagePrefix=Kr,this.ignoredPayloadTypes=[xi],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:i})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...i])]},this.create=async i=>{this.isInitialized();const n=Pf(),s=await this.core.crypto.setSymKey(n),a=nt(G.FIVE_MINUTES),c={protocol:X1},d={topic:s,expiry:a,relay:c,active:!1,methods:i==null?void 0:i.methods},u=tl({protocol:this.core.protocol,version:this.core.version,topic:s,symKey:n,relay:c,expiryTimestamp:a,methods:i==null?void 0:i.methods});return this.events.emit(bn.create,d),this.core.expirer.set(s,a),await this.pairings.set(s,d),await this.core.relayer.subscribe(s,{transportType:i==null?void 0:i.transportType}),{topic:s,uri:u}},this.pair=async i=>{this.isInitialized();const n=this.core.eventClient.createEvent({properties:{topic:i==null?void 0:i.uri,trace:[jr.pairing_started]}});this.isValidPair(i,n);const{topic:s,symKey:a,relay:c,expiryTimestamp:d,methods:u}=el(i.uri);n.props.properties.topic=s,n.addTrace(jr.pairing_uri_validation_success),n.addTrace(jr.pairing_uri_not_expired);let l;if(this.pairings.keys.includes(s)){if(l=this.pairings.get(s),n.addTrace(jr.existing_pairing),l.active)throw n.setError(mi.active_pairing_already_exists),new Error(`Pairing already exists: ${s}. Please try again with a new connection URI.`);n.addTrace(jr.pairing_not_expired)}const g=d||nt(G.FIVE_MINUTES),w={topic:s,relay:c,expiry:g,active:!1,methods:u};this.core.expirer.set(s,g),await this.pairings.set(s,w),n.addTrace(jr.store_new_pairing),i.activatePairing&&await this.activate({topic:s}),this.events.emit(bn.create,w),n.addTrace(jr.emit_inactive_pairing),this.core.crypto.keychain.has(s)||await this.core.crypto.setSymKey(a,s),n.addTrace(jr.subscribing_pairing_topic);try{await this.core.relayer.confirmOnlineStateOrThrow()}catch{n.setError(mi.no_internet_connection)}try{await this.core.relayer.subscribe(s,{relay:c})}catch(E){throw n.setError(mi.subscribe_pairing_topic_failure),E}return n.addTrace(jr.subscribe_pairing_topic_success),w},this.activate=async({topic:i})=>{this.isInitialized();const n=nt(G.FIVE_MINUTES);this.core.expirer.set(i,n),await this.pairings.update(i,{active:!0,expiry:n})},this.ping=async i=>{this.isInitialized(),await this.isValidPing(i),this.logger.warn("ping() is deprecated and will be removed in the next major release.");const{topic:n}=i;if(this.pairings.keys.includes(n)){const s=await this.sendRequest(n,"wc_pairingPing",{}),{done:a,resolve:c,reject:d}=dn();this.events.once(qe("pairing_ping",s),({error:u})=>{u?d(u):c()}),await a()}},this.updateExpiry=async({topic:i,expiry:n})=>{this.isInitialized(),await this.pairings.update(i,{expiry:n})},this.updateMetadata=async({topic:i,metadata:n})=>{this.isInitialized(),await this.pairings.update(i,{peerMetadata:n})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async i=>{this.isInitialized(),await this.isValidDisconnect(i);const{topic:n}=i;this.pairings.keys.includes(n)&&(await this.sendRequest(n,"wc_pairingDelete",je("USER_DISCONNECTED")),await this.deletePairing(n))},this.formatUriFromPairing=i=>{this.isInitialized();const{topic:n,relay:s,expiry:a,methods:c}=i,d=this.core.crypto.keychain.get(n);return tl({protocol:this.core.protocol,version:this.core.version,topic:n,symKey:d,relay:s,expiryTimestamp:a,methods:c})},this.sendRequest=async(i,n,s)=>{const a=Ei(n,s),c=await this.core.crypto.encode(i,a),d=xs[n].req;return this.core.history.set(i,a),this.core.relayer.publish(i,c,d),a.id},this.sendResult=async(i,n,s)=>{const a=po(i,s),c=await this.core.crypto.encode(n,a),d=await this.core.history.get(n,i),u=xs[d.request.method].res;await this.core.relayer.publish(n,c,u),await this.core.history.resolve(a)},this.sendError=async(i,n,s)=>{const a=Hs(i,s),c=await this.core.crypto.encode(n,a),d=await this.core.history.get(n,i),u=xs[d.request.method]?xs[d.request.method].res:xs.unregistered_method.res;await this.core.relayer.publish(n,c,u),await this.core.history.resolve(a)},this.deletePairing=async(i,n)=>{await this.core.relayer.unsubscribe(i),await Promise.all([this.pairings.delete(i,je("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(i),n?Promise.resolve():this.core.expirer.del(i)])},this.cleanup=async()=>{const i=this.pairings.getAll().filter(n=>Di(n.expiry));await Promise.all(i.map(n=>this.deletePairing(n.topic)))},this.onRelayEventRequest=i=>{const{topic:n,payload:s}=i;switch(s.method){case"wc_pairingPing":return this.onPairingPingRequest(n,s);case"wc_pairingDelete":return this.onPairingDeleteRequest(n,s);default:return this.onUnknownRpcMethodRequest(n,s)}},this.onRelayEventResponse=async i=>{const{topic:n,payload:s}=i,a=(await this.core.history.get(n,s.id)).request.method;switch(a){case"wc_pairingPing":return this.onPairingPingResponse(n,s);default:return this.onUnknownRpcMethodResponse(a)}},this.onPairingPingRequest=async(i,n)=>{const{id:s}=n;try{this.isValidPing({topic:i}),await this.sendResult(s,i,!0),this.events.emit(bn.ping,{id:s,topic:i})}catch(a){await this.sendError(s,i,a),this.logger.error(a)}},this.onPairingPingResponse=(i,n)=>{const{id:s}=n;setTimeout(()=>{kr(n)?this.events.emit(qe("pairing_ping",s),{}):Xt(n)&&this.events.emit(qe("pairing_ping",s),{error:n.error})},500)},this.onPairingDeleteRequest=async(i,n)=>{const{id:s}=n;try{this.isValidDisconnect({topic:i}),await this.deletePairing(i),this.events.emit(bn.delete,{id:s,topic:i})}catch(a){await this.sendError(s,i,a),this.logger.error(a)}},this.onUnknownRpcMethodRequest=async(i,n)=>{const{id:s,method:a}=n;try{if(this.registeredMethods.includes(a))return;const c=je("WC_METHOD_UNSUPPORTED",a);await this.sendError(s,i,c),this.logger.error(c)}catch(c){await this.sendError(s,i,c),this.logger.error(c)}},this.onUnknownRpcMethodResponse=i=>{this.registeredMethods.includes(i)||this.logger.error(je("WC_METHOD_UNSUPPORTED",i))},this.isValidPair=(i,n)=>{var s;if(!zt(i)){const{message:c}=J("MISSING_OR_INVALID",`pair() params: ${i}`);throw n.setError(mi.malformed_pairing_uri),new Error(c)}if(!V_(i.uri)){const{message:c}=J("MISSING_OR_INVALID",`pair() uri: ${i.uri}`);throw n.setError(mi.malformed_pairing_uri),new Error(c)}const a=el(i==null?void 0:i.uri);if(!((s=a==null?void 0:a.relay)!=null&&s.protocol)){const{message:c}=J("MISSING_OR_INVALID","pair() uri#relay-protocol");throw n.setError(mi.malformed_pairing_uri),new Error(c)}if(!(a!=null&&a.symKey)){const{message:c}=J("MISSING_OR_INVALID","pair() uri#symKey");throw n.setError(mi.malformed_pairing_uri),new Error(c)}if(a!=null&&a.expiryTimestamp&&G.toMiliseconds(a==null?void 0:a.expiryTimestamp)<Date.now()){n.setError(mi.pairing_expired);const{message:c}=J("EXPIRED","pair() URI has expired. Please try again with a new connection URI.");throw new Error(c)}},this.isValidPing=async i=>{if(!zt(i)){const{message:s}=J("MISSING_OR_INVALID",`ping() params: ${i}`);throw new Error(s)}const{topic:n}=i;await this.isValidPairingTopic(n)},this.isValidDisconnect=async i=>{if(!zt(i)){const{message:s}=J("MISSING_OR_INVALID",`disconnect() params: ${i}`);throw new Error(s)}const{topic:n}=i;await this.isValidPairingTopic(n)},this.isValidPairingTopic=async i=>{if(!tt(i,!1)){const{message:n}=J("MISSING_OR_INVALID",`pairing topic should be a string: ${i}`);throw new Error(n)}if(!this.pairings.keys.includes(i)){const{message:n}=J("NO_MATCHING_KEY",`pairing topic doesn't exist: ${i}`);throw new Error(n)}if(Di(this.pairings.get(i).expiry)){await this.deletePairing(i);const{message:n}=J("EXPIRED",`pairing topic: ${i}`);throw new Error(n)}},this.core=e,this.logger=qt(r,this.name),this.pairings=new $n(this.core,this.logger,this.name,this.storagePrefix)}get context(){return Kt(this.logger)}isInitialized(){if(!this.initialized){const{message:e}=J("NOT_INITIALIZED",this.name);throw new Error(e)}}registerRelayerEvents(){this.core.relayer.on(dt.message,async e=>{const{topic:r,message:i,transportType:n}=e;if(!this.pairings.keys.includes(r)||n===He.link_mode||this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(i)))return;const s=await this.core.crypto.decode(r,i);try{Df(s)?(this.core.history.set(r,s),this.onRelayEventRequest({topic:r,payload:s})):Ks(s)&&(await this.core.history.resolve(s),await this.onRelayEventResponse({topic:r,payload:s}),this.core.history.delete(r,s.id))}catch(a){this.logger.error(a)}})}registerExpirerEvents(){this.core.expirer.on(dr.expired,async e=>{const{topic:r}=S1(e.target);r&&this.pairings.keys.includes(r)&&(await this.deletePairing(r,!0),this.events.emit(bn.expire,{topic:r}))})}},X$=class extends Um{constructor(e,r){super(e,r),this.core=e,this.logger=r,this.records=new Map,this.events=new Ht.EventEmitter,this.name=KE,this.version=VE,this.cached=[],this.initialized=!1,this.storagePrefix=Kr,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(i=>this.records.set(i.id,i)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(i,n,s)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:i,request:n,chainId:s}),this.records.has(n.id))return;const a={id:n.id,topic:i,request:{method:n.method,params:n.params||null},chainId:s,expiry:nt(G.THIRTY_DAYS)};this.records.set(a.id,a),this.persist(),this.events.emit(xr.created,a)},this.resolve=async i=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:i}),!this.records.has(i.id))return;const n=await this.getRecord(i.id);typeof n.response>"u"&&(n.response=Xt(i)?{error:i.error}:{result:i.result},this.records.set(n.id,n),this.persist(),this.events.emit(xr.updated,n))},this.get=async(i,n)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:i,id:n}),await this.getRecord(n)),this.delete=(i,n)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:n}),this.values.forEach(s=>{if(s.topic===i){if(typeof n<"u"&&s.id!==n)return;this.records.delete(s.id),this.events.emit(xr.deleted,s)}}),this.persist()},this.exists=async(i,n)=>(this.isInitialized(),this.records.has(n)?(await this.getRecord(n)).topic===i:!1),this.on=(i,n)=>{this.events.on(i,n)},this.once=(i,n)=>{this.events.once(i,n)},this.off=(i,n)=>{this.events.off(i,n)},this.removeListener=(i,n)=>{this.events.removeListener(i,n)},this.logger=qt(r,this.name)}get context(){return Kt(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const e=[];return this.values.forEach(r=>{if(typeof r.response<"u")return;const i={topic:r.topic,request:Ei(r.request.method,r.request.params,r.id),chainId:r.chainId};return e.push(i)}),e}async setJsonRpcRecords(e){await this.core.storage.setItem(this.storageKey,e)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(e){this.isInitialized();const r=this.records.get(e);if(!r){const{message:i}=J("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(i)}return r}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(xr.sync)}async restore(){try{const e=await this.getJsonRpcRecords();if(typeof e>"u"||!e.length)return;if(this.records.size){const{message:r}=J("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(e){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(e)}}registerEventListeners(){this.events.on(xr.created,e=>{const r=xr.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:e})}),this.events.on(xr.updated,e=>{const r=xr.updated;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:e})}),this.events.on(xr.deleted,e=>{const r=xr.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:e})}),this.core.heartbeat.on(cs.pulse,()=>{this.cleanup()})}cleanup(){try{this.isInitialized();let e=!1;this.records.forEach(r=>{G.toMiliseconds(r.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${r.id}`),this.records.delete(r.id),this.events.emit(xr.deleted,r,!1),e=!0)}),e&&this.persist()}catch(e){this.logger.warn(e)}}isInitialized(){if(!this.initialized){const{message:e}=J("NOT_INITIALIZED",this.name);throw new Error(e)}}},Q$=class extends Vm{constructor(e,r){super(e,r),this.core=e,this.logger=r,this.expirations=new Map,this.events=new Ht.EventEmitter,this.name=WE,this.version=GE,this.cached=[],this.initialized=!1,this.storagePrefix=Kr,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(i=>this.expirations.set(i.target,i)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=i=>{try{const n=this.formatTarget(i);return typeof this.getExpiration(n)<"u"}catch{return!1}},this.set=(i,n)=>{this.isInitialized();const s=this.formatTarget(i),a={target:s,expiry:n};this.expirations.set(s,a),this.checkExpiry(s,a),this.events.emit(dr.created,{target:s,expiration:a})},this.get=i=>{this.isInitialized();const n=this.formatTarget(i);return this.getExpiration(n)},this.del=i=>{if(this.isInitialized(),this.has(i)){const n=this.formatTarget(i),s=this.getExpiration(n);this.expirations.delete(n),this.events.emit(dr.deleted,{target:n,expiration:s})}},this.on=(i,n)=>{this.events.on(i,n)},this.once=(i,n)=>{this.events.once(i,n)},this.off=(i,n)=>{this.events.off(i,n)},this.removeListener=(i,n)=>{this.events.removeListener(i,n)},this.logger=qt(r,this.name)}get context(){return Kt(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(e){if(typeof e=="string")return A7(e);if(typeof e=="number")return P7(e);const{message:r}=J("UNKNOWN_TYPE",`Target type: ${typeof e}`);throw new Error(r)}async setExpirations(e){await this.core.storage.setItem(this.storageKey,e)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(dr.sync)}async restore(){try{const e=await this.getExpirations();if(typeof e>"u"||!e.length)return;if(this.expirations.size){const{message:r}=J("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=e,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(e){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(e)}}getExpiration(e){const r=this.expirations.get(e);if(!r){const{message:i}=J("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.warn(i),new Error(i)}return r}checkExpiry(e,r){const{expiry:i}=r;G.toMiliseconds(i)-Date.now()<=0&&this.expire(e,r)}expire(e,r){this.expirations.delete(e),this.events.emit(dr.expired,{target:e,expiration:r})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((e,r)=>this.checkExpiry(r,e))}registerEventListeners(){this.core.heartbeat.on(cs.pulse,()=>this.checkExpirations()),this.events.on(dr.created,e=>{const r=dr.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),this.persist()}),this.events.on(dr.expired,e=>{const r=dr.expired;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),this.persist()}),this.events.on(dr.deleted,e=>{const r=dr.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:e}),this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=J("NOT_INITIALIZED",this.name);throw new Error(e)}}},ex=class extends Wm{constructor(e,r,i){super(e,r,i),this.core=e,this.logger=r,this.store=i,this.name=JE,this.verifyUrlV3=ZE,this.storagePrefix=Kr,this.version=Z1,this.init=async()=>{var n;this.isDevEnv||(this.publicKey=await this.store.getItem(this.storeKey),this.publicKey&&G.toMiliseconds((n=this.publicKey)==null?void 0:n.expiresAt)<Date.now()&&(this.logger.debug("verify v2 public key expired"),await this.removePublicKey()))},this.register=async n=>{if(!ra()||this.isDevEnv)return;const s=window.location.origin,{id:a,decryptedId:c}=n,d=`${this.verifyUrlV3}/attestation?projectId=${this.core.projectId}&origin=${s}&id=${a}&decryptedId=${c}`;try{const u=Vs(),l=this.startAbortTimer(G.ONE_SECOND*5),g=await new Promise((w,E)=>{const $=()=>{window.removeEventListener("message",M),u.body.removeChild(I),E("attestation aborted")};this.abortController.signal.addEventListener("abort",$);const I=u.createElement("iframe");I.src=d,I.style.display="none",I.addEventListener("error",$,{signal:this.abortController.signal});const M=P=>{if(P.data&&typeof P.data=="string")try{const A=JSON.parse(P.data);if(A.type==="verify_attestation"){if(_f(A.attestation).payload.id!==a)return;clearInterval(l),u.body.removeChild(I),this.abortController.signal.removeEventListener("abort",$),window.removeEventListener("message",M),w(A.attestation===null?"":A.attestation)}}catch(A){this.logger.warn(A)}};u.body.appendChild(I),window.addEventListener("message",M,{signal:this.abortController.signal})});return this.logger.debug("jwt attestation",g),g}catch(u){this.logger.warn(u)}return""},this.resolve=async n=>{if(this.isDevEnv)return"";const{attestationId:s,hash:a,encryptedId:c}=n;if(s===""){this.logger.debug("resolve: attestationId is empty, skipping");return}if(s){if(_f(s).payload.id!==c)return;const u=await this.isValidJwtAttestation(s);if(u){if(!u.isVerified){this.logger.warn("resolve: jwt attestation: origin url not verified");return}return u}}if(!a)return;const d=this.getVerifyUrl(n==null?void 0:n.verifyUrl);return this.fetchAttestation(a,d)},this.fetchAttestation=async(n,s)=>{this.logger.debug(`resolving attestation: ${n} from url: ${s}`);const a=this.startAbortTimer(G.ONE_SECOND*5),c=await fetch(`${s}/attestation/${n}?v2Supported=true`,{signal:this.abortController.signal});return clearTimeout(a),c.status===200?await c.json():void 0},this.getVerifyUrl=n=>{let s=n||Cs;return XE.includes(s)||(this.logger.info(`verify url: ${s}, not included in trusted list, assigning default: ${Cs}`),s=Cs),s},this.fetchPublicKey=async()=>{try{this.logger.debug(`fetching public key from: ${this.verifyUrlV3}`);const n=this.startAbortTimer(G.FIVE_SECONDS),s=await fetch(`${this.verifyUrlV3}/public-key`,{signal:this.abortController.signal});return clearTimeout(n),await s.json()}catch(n){this.logger.warn(n)}},this.persistPublicKey=async n=>{this.logger.debug("persisting public key to local storage",n),await this.store.setItem(this.storeKey,n),this.publicKey=n},this.removePublicKey=async()=>{this.logger.debug("removing verify v2 public key from storage"),await this.store.removeItem(this.storeKey),this.publicKey=void 0},this.isValidJwtAttestation=async n=>{const s=await this.getPublicKey();try{if(s)return this.validateAttestation(n,s)}catch(c){this.logger.error(c),this.logger.warn("error validating attestation")}const a=await this.fetchAndPersistPublicKey();try{if(a)return this.validateAttestation(n,a)}catch(c){this.logger.error(c),this.logger.warn("error validating attestation")}},this.getPublicKey=async()=>this.publicKey?this.publicKey:await this.fetchAndPersistPublicKey(),this.fetchAndPersistPublicKey=async()=>{if(this.fetchPromise)return await this.fetchPromise,this.publicKey;this.fetchPromise=new Promise(async s=>{const a=await this.fetchPublicKey();a&&(await this.persistPublicKey(a),s(a))});const n=await this.fetchPromise;return this.fetchPromise=void 0,n},this.validateAttestation=(n,s)=>{const a=N_(n,s.publicKey),c={hasExpired:G.toMiliseconds(a.exp)<Date.now(),payload:a};if(c.hasExpired)throw this.logger.warn("resolve: jwt attestation expired"),new Error("JWT attestation expired");return{origin:c.payload.origin,isScam:c.payload.isScam,isVerified:c.payload.isVerified}},this.logger=qt(r,this.name),this.abortController=new AbortController,this.isDevEnv=bd(),this.init()}get storeKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//verify:public:key"}get context(){return Kt(this.logger)}startAbortTimer(e){return this.abortController=new AbortController,setTimeout(()=>this.abortController.abort(),G.toMiliseconds(e))}},tx=class extends Gm{constructor(e,r){super(e,r),this.projectId=e,this.logger=r,this.context=QE,this.registerDeviceToken=async i=>{const{clientId:n,token:s,notificationType:a,enableEncrypted:c=!1}=i,d=`${eS}/${this.projectId}/clients`;await fetch(d,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({client_id:n,type:a,token:s,always_raw:c})})},this.logger=qt(r,this.context)}};var rx=Object.defineProperty,Rl=Object.getOwnPropertySymbols,ix=Object.prototype.hasOwnProperty,nx=Object.prototype.propertyIsEnumerable,Fl=(t,e,r)=>e in t?rx(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,As=(t,e)=>{for(var r in e||(e={}))ix.call(e,r)&&Fl(t,r,e[r]);if(Rl)for(var r of Rl(e))nx.call(e,r)&&Fl(t,r,e[r]);return t};let sx=class extends Jm{constructor(e,r,i=!0){super(e,r,i),this.core=e,this.logger=r,this.context=rS,this.storagePrefix=Kr,this.storageVersion=tS,this.events=new Map,this.shouldPersist=!1,this.init=async()=>{if(!bd())try{const n={eventId:Mu(),timestamp:Date.now(),domain:this.getAppDomain(),props:{event:"INIT",type:"",properties:{client_id:await this.core.crypto.getClientId(),user_agent:m1(this.core.relayer.protocol,this.core.relayer.version,Rf)}}};await this.sendEvent([n])}catch(n){this.logger.warn(n)}},this.createEvent=n=>{const{event:s="ERROR",type:a="",properties:{topic:c,trace:d}}=n,u=Mu(),l=this.core.projectId||"",g=Date.now(),w=As({eventId:u,timestamp:g,props:{event:s,type:a,properties:{topic:c,trace:d}},bundleId:l,domain:this.getAppDomain()},this.setMethods(u));return this.telemetryEnabled&&(this.events.set(u,w),this.shouldPersist=!0),w},this.getEvent=n=>{const{eventId:s,topic:a}=n;if(s)return this.events.get(s);const c=Array.from(this.events.values()).find(d=>d.props.properties.topic===a);if(c)return As(As({},c),this.setMethods(c.eventId))},this.deleteEvent=n=>{const{eventId:s}=n;this.events.delete(s),this.shouldPersist=!0},this.setEventListeners=()=>{this.core.heartbeat.on(cs.pulse,async()=>{this.shouldPersist&&await this.persist(),this.events.forEach(n=>{G.fromMiliseconds(Date.now())-G.fromMiliseconds(n.timestamp)>iS&&(this.events.delete(n.eventId),this.shouldPersist=!0)})})},this.setMethods=n=>({addTrace:s=>this.addTrace(n,s),setError:s=>this.setError(n,s)}),this.addTrace=(n,s)=>{const a=this.events.get(n);a&&(a.props.properties.trace.push(s),this.events.set(n,a),this.shouldPersist=!0)},this.setError=(n,s)=>{const a=this.events.get(n);a&&(a.props.type=s,a.timestamp=Date.now(),this.events.set(n,a),this.shouldPersist=!0)},this.persist=async()=>{await this.core.storage.setItem(this.storageKey,Array.from(this.events.values())),this.shouldPersist=!1},this.restore=async()=>{try{const n=await this.core.storage.getItem(this.storageKey)||[];if(!n.length)return;n.forEach(s=>{this.events.set(s.eventId,As(As({},s),this.setMethods(s.eventId)))})}catch(n){this.logger.warn(n)}},this.submit=async()=>{if(!this.telemetryEnabled||this.events.size===0)return;const n=[];for(const[s,a]of this.events)a.props.type&&n.push(a);if(n.length!==0)try{if((await this.sendEvent(n)).ok)for(const s of n)this.events.delete(s.eventId),this.shouldPersist=!0}catch(s){this.logger.warn(s)}},this.sendEvent=async n=>{const s=this.getAppDomain()?"":"&sp=desktop";return await fetch(`${nS}?projectId=${this.core.projectId}&st=events_sdk&sv=js-${Rf}${s}`,{method:"POST",body:JSON.stringify(n)})},this.getAppDomain=()=>y1().url,this.logger=qt(r,this.context),this.telemetryEnabled=i,i?this.restore().then(async()=>{await this.submit(),this.setEventListeners()}):this.persist()}get storageKey(){return this.storagePrefix+this.storageVersion+this.core.customStoragePrefix+"//"+this.context}};var ax=Object.defineProperty,Nl=Object.getOwnPropertySymbols,ox=Object.prototype.hasOwnProperty,cx=Object.prototype.propertyIsEnumerable,Cl=(t,e,r)=>e in t?ax(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Tl=(t,e)=>{for(var r in e||(e={}))ox.call(e,r)&&Cl(t,r,e[r]);if(Nl)for(var r of Nl(e))cx.call(e,r)&&Cl(t,r,e[r]);return t};let fx=class hb extends Dm{constructor(e){var r;super(e),this.protocol=Y1,this.version=Z1,this.name=Of,this.events=new Ht.EventEmitter,this.initialized=!1,this.on=(a,c)=>this.events.on(a,c),this.once=(a,c)=>this.events.once(a,c),this.off=(a,c)=>this.events.off(a,c),this.removeListener=(a,c)=>this.events.removeListener(a,c),this.dispatchEnvelope=({topic:a,message:c,sessionExists:d})=>{if(!a||!c)return;const u={topic:a,message:c,publishedAt:Date.now(),transportType:He.link_mode};this.relayer.onLinkMessageEvent(u,{sessionExists:d})},this.projectId=e==null?void 0:e.projectId,this.relayUrl=(e==null?void 0:e.relayUrl)||Q1,this.customStoragePrefix=e!=null&&e.customStoragePrefix?`:${e.customStoragePrefix}`:"";const i=Io({level:typeof(e==null?void 0:e.logger)=="string"&&e.logger?e.logger:xE.logger,name:Of}),{logger:n,chunkLoggerController:s}=Lm({opts:i,maxSizeInBytes:e==null?void 0:e.maxLogBlobSizeInBytes,loggerOverride:e==null?void 0:e.logger});this.logChunkController=s,(r=this.logChunkController)!=null&&r.downloadLogsBlobInBrowser&&(window.downloadLogsBlobInBrowser=async()=>{var a,c;(a=this.logChunkController)!=null&&a.downloadLogsBlobInBrowser&&((c=this.logChunkController)==null||c.downloadLogsBlobInBrowser({clientId:await this.crypto.getClientId()}))}),this.logger=qt(n,this.name),this.heartbeat=new Cy,this.crypto=new P$(this,this.logger,e==null?void 0:e.keychain),this.history=new X$(this,this.logger),this.expirer=new Q$(this,this.logger),this.storage=e!=null&&e.storage?e.storage:new dm(Tl(Tl({},IE),e==null?void 0:e.storageOptions)),this.relayer=new W$({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new Z$(this,this.logger),this.verify=new ex(this,this.logger,this.storage),this.echoClient=new tx(this.projectId||"",this.logger),this.linkModeSupportedApps=[],this.eventClient=new sx(this,this.logger,e==null?void 0:e.telemetryEnabled)}static async init(e){const r=new hb(e);await r.initialize();const i=await r.crypto.getClientId();return await r.storage.setItem(DE,i),r}get context(){return Kt(this.logger)}async start(){this.initialized||await this.initialize()}async getLogsBlob(){var e;return(e=this.logChunkController)==null?void 0:e.logsToBlob({clientId:await this.crypto.getClientId()})}async addLinkModeSupportedApp(e){this.linkModeSupportedApps.includes(e)||(this.linkModeSupportedApps.push(e),await this.storage.setItem(ul,this.linkModeSupportedApps))}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.linkModeSupportedApps=await this.storage.getItem(ul)||[],this.initialized=!0,this.logger.info("Core Initialization Success")}catch(e){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,e),this.logger.error(e.message),e}}};const dx=fx,ub="wc",lb=2,pb="client",$d=`${ub}@${lb}:${pb}:`,zc={name:pb,logger:"error"},Bl="WALLETCONNECT_DEEPLINK_CHOICE",hx="proposal",bb="Proposal expired",ux="session",qn=G.SEVEN_DAYS,lx="engine",ct={wc_sessionPropose:{req:{ttl:G.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:G.FIVE_MINUTES,prompt:!1,tag:1101},reject:{ttl:G.FIVE_MINUTES,prompt:!1,tag:1120},autoReject:{ttl:G.FIVE_MINUTES,prompt:!1,tag:1121}},wc_sessionSettle:{req:{ttl:G.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:G.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:G.ONE_DAY,prompt:!1,tag:1104},res:{ttl:G.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:G.ONE_DAY,prompt:!1,tag:1106},res:{ttl:G.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:G.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:G.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:G.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:G.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:G.ONE_DAY,prompt:!1,tag:1112},res:{ttl:G.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:G.ONE_DAY,prompt:!1,tag:1114},res:{ttl:G.ONE_DAY,prompt:!1,tag:1115}},wc_sessionAuthenticate:{req:{ttl:G.ONE_HOUR,prompt:!0,tag:1116},res:{ttl:G.ONE_HOUR,prompt:!1,tag:1117},reject:{ttl:G.FIVE_MINUTES,prompt:!1,tag:1118},autoReject:{ttl:G.FIVE_MINUTES,prompt:!1,tag:1119}}},jc={min:G.FIVE_MINUTES,max:G.SEVEN_DAYS},zr={idle:"IDLE",active:"ACTIVE"},px="request",bx=["wc_sessionPropose","wc_sessionRequest","wc_authRequest","wc_sessionAuthenticate"],gx="wc",vx="auth",yx="authKeys",mx="pairingTopics",wx="requests",zo=`${gx}@${1.5}:${vx}:`,za=`${zo}:PUB_KEY`;var _x=Object.defineProperty,Ex=Object.defineProperties,Sx=Object.getOwnPropertyDescriptors,ql=Object.getOwnPropertySymbols,$x=Object.prototype.hasOwnProperty,xx=Object.prototype.propertyIsEnumerable,Ll=(t,e,r)=>e in t?_x(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Xe=(t,e)=>{for(var r in e||(e={}))$x.call(e,r)&&Ll(t,r,e[r]);if(ql)for(var r of ql(e))xx.call(e,r)&&Ll(t,r,e[r]);return t},Mr=(t,e)=>Ex(t,Sx(e));let Ix=class extends Zm{constructor(e){super(e),this.name=lx,this.events=new Bf,this.initialized=!1,this.requestQueue={state:zr.idle,queue:[]},this.sessionRequestQueue={state:zr.idle,queue:[]},this.requestQueueDelay=G.ONE_SECOND,this.expectedPairingMethodMap=new Map,this.recentlyDeletedMap=new Map,this.recentlyDeletedLimit=200,this.relayMessageCache=[],this.init=async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.registerPairingEvents(),await this.registerLinkModeListeners(),this.client.core.pairing.register({methods:Object.keys(ct)}),this.initialized=!0,setTimeout(()=>{this.sessionRequestQueue.queue=this.getPendingSessionRequests(),this.processSessionRequestQueue()},G.toMiliseconds(this.requestQueueDelay)))},this.connect=async r=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();const i=Mr(Xe({},r),{requiredNamespaces:r.requiredNamespaces||{},optionalNamespaces:r.optionalNamespaces||{}});await this.isValidConnect(i);const{pairingTopic:n,requiredNamespaces:s,optionalNamespaces:a,sessionProperties:c,relays:d}=i;let u=n,l,g=!1;try{if(u){const C=this.client.core.pairing.pairings.get(u);this.client.logger.warn("connect() with existing pairing topic is deprecated and will be removed in the next major release."),g=C.active}}catch(C){throw this.client.logger.error(`connect() -> pairing.get(${u}) failed`),C}if(!u||!g){const{topic:C,uri:D}=await this.client.core.pairing.create();u=C,l=D}if(!u){const{message:C}=J("NO_MATCHING_KEY",`connect() pairing topic: ${u}`);throw new Error(C)}const w=await this.client.core.crypto.generateKeyPair(),E=ct.wc_sessionPropose.req.ttl||G.FIVE_MINUTES,$=nt(E),I=Xe({requiredNamespaces:s,optionalNamespaces:a,relays:d??[{protocol:X1}],proposer:{publicKey:w,metadata:this.client.metadata},expiryTimestamp:$,pairingTopic:u},c&&{sessionProperties:c}),{reject:M,resolve:P,done:A}=dn(E,bb);this.events.once(qe("session_connect"),async({error:C,session:D})=>{if(C)M(C);else if(D){D.self.publicKey=w;const U=Mr(Xe({},D),{pairingTopic:I.pairingTopic,requiredNamespaces:I.requiredNamespaces,optionalNamespaces:I.optionalNamespaces,transportType:He.relay});await this.client.session.set(D.topic,U),await this.setExpiry(D.topic,D.expiry),u&&await this.client.core.pairing.updateMetadata({topic:u,metadata:D.peer.metadata}),this.cleanupDuplicatePairings(U),P(U)}});const R=await this.sendRequest({topic:u,method:"wc_sessionPropose",params:I,throwOnFailedPublish:!0});return await this.setProposal(R,Xe({id:R},I)),{uri:l,approval:A}},this.pair=async r=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{return await this.client.core.pairing.pair(r)}catch(i){throw this.client.logger.error("pair() failed"),i}},this.approve=async r=>{var i,n,s;const a=this.client.core.eventClient.createEvent({properties:{topic:(i=r==null?void 0:r.id)==null?void 0:i.toString(),trace:[Ir.session_approve_started]}});try{this.isInitialized(),await this.confirmOnlineStateOrThrow()}catch(z){throw a.setError(cn.no_internet_connection),z}try{await this.isValidProposalId(r==null?void 0:r.id)}catch(z){throw this.client.logger.error(`approve() -> proposal.get(${r==null?void 0:r.id}) failed`),a.setError(cn.proposal_not_found),z}try{await this.isValidApprove(r)}catch(z){throw this.client.logger.error("approve() -> isValidApprove() failed"),a.setError(cn.session_approve_namespace_validation_failure),z}const{id:c,relayProtocol:d,namespaces:u,sessionProperties:l,sessionConfig:g}=r,w=this.client.proposal.get(c);this.client.core.eventClient.deleteEvent({eventId:a.eventId});const{pairingTopic:E,proposer:$,requiredNamespaces:I,optionalNamespaces:M}=w;let P=(n=this.client.core.eventClient)==null?void 0:n.getEvent({topic:E});P||(P=(s=this.client.core.eventClient)==null?void 0:s.createEvent({type:Ir.session_approve_started,properties:{topic:E,trace:[Ir.session_approve_started,Ir.session_namespaces_validation_success]}}));const A=await this.client.core.crypto.generateKeyPair(),R=$.publicKey,C=await this.client.core.crypto.generateSharedKey(A,R),D=Xe(Xe({relay:{protocol:d??"irn"},namespaces:u,controller:{publicKey:A,metadata:this.client.metadata},expiry:nt(qn)},l&&{sessionProperties:l}),g&&{sessionConfig:g}),U=He.relay;P.addTrace(Ir.subscribing_session_topic);try{await this.client.core.relayer.subscribe(C,{transportType:U})}catch(z){throw P.setError(cn.subscribe_session_topic_failure),z}P.addTrace(Ir.subscribe_session_topic_success);const j=Mr(Xe({},D),{topic:C,requiredNamespaces:I,optionalNamespaces:M,pairingTopic:E,acknowledged:!1,self:D.controller,peer:{publicKey:$.publicKey,metadata:$.metadata},controller:A,transportType:He.relay});await this.client.session.set(C,j),P.addTrace(Ir.store_session);try{P.addTrace(Ir.publishing_session_settle),await this.sendRequest({topic:C,method:"wc_sessionSettle",params:D,throwOnFailedPublish:!0}).catch(z=>{throw P==null||P.setError(cn.session_settle_publish_failure),z}),P.addTrace(Ir.session_settle_publish_success),P.addTrace(Ir.publishing_session_approve),await this.sendResult({id:c,topic:E,result:{relay:{protocol:d??"irn"},responderPublicKey:A},throwOnFailedPublish:!0}).catch(z=>{throw P==null||P.setError(cn.session_approve_publish_failure),z}),P.addTrace(Ir.session_approve_publish_success)}catch(z){throw this.client.logger.error(z),this.client.session.delete(C,je("USER_DISCONNECTED")),await this.client.core.relayer.unsubscribe(C),z}return this.client.core.eventClient.deleteEvent({eventId:P.eventId}),await this.client.core.pairing.updateMetadata({topic:E,metadata:$.metadata}),await this.client.proposal.delete(c,je("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:E}),await this.setExpiry(C,nt(qn)),{topic:C,acknowledged:()=>Promise.resolve(this.client.session.get(C))}},this.reject=async r=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidReject(r)}catch(a){throw this.client.logger.error("reject() -> isValidReject() failed"),a}const{id:i,reason:n}=r;let s;try{s=this.client.proposal.get(i).pairingTopic}catch(a){throw this.client.logger.error(`reject() -> proposal.get(${i}) failed`),a}s&&(await this.sendError({id:i,topic:s,error:n,rpcOpts:ct.wc_sessionPropose.reject}),await this.client.proposal.delete(i,je("USER_DISCONNECTED")))},this.update=async r=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidUpdate(r)}catch(g){throw this.client.logger.error("update() -> isValidUpdate() failed"),g}const{topic:i,namespaces:n}=r,{done:s,resolve:a,reject:c}=dn(),d=wi(),u=Ui().toString(),l=this.client.session.get(i).namespaces;return this.events.once(qe("session_update",d),({error:g})=>{g?c(g):a()}),await this.client.session.update(i,{namespaces:n}),await this.sendRequest({topic:i,method:"wc_sessionUpdate",params:{namespaces:n},throwOnFailedPublish:!0,clientRpcId:d,relayRpcId:u}).catch(g=>{this.client.logger.error(g),this.client.session.update(i,{namespaces:l}),c(g)}),{acknowledged:s}},this.extend=async r=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidExtend(r)}catch(d){throw this.client.logger.error("extend() -> isValidExtend() failed"),d}const{topic:i}=r,n=wi(),{done:s,resolve:a,reject:c}=dn();return this.events.once(qe("session_extend",n),({error:d})=>{d?c(d):a()}),await this.setExpiry(i,nt(qn)),this.sendRequest({topic:i,method:"wc_sessionExtend",params:{},clientRpcId:n,throwOnFailedPublish:!0}).catch(d=>{c(d)}),{acknowledged:s}},this.request=async r=>{this.isInitialized();try{await this.isValidRequest(r)}catch($){throw this.client.logger.error("request() -> isValidRequest() failed"),$}const{chainId:i,request:n,topic:s,expiry:a=ct.wc_sessionRequest.req.ttl}=r,c=this.client.session.get(s);(c==null?void 0:c.transportType)===He.relay&&await this.confirmOnlineStateOrThrow();const d=wi(),u=Ui().toString(),{done:l,resolve:g,reject:w}=dn(a,"Request expired. Please try again.");this.events.once(qe("session_request",d),({error:$,result:I})=>{$?w($):g(I)});const E=this.getAppLinkIfEnabled(c.peer.metadata,c.transportType);return E?(await this.sendRequest({clientRpcId:d,relayRpcId:u,topic:s,method:"wc_sessionRequest",params:{request:Mr(Xe({},n),{expiryTimestamp:nt(a)}),chainId:i},expiry:a,throwOnFailedPublish:!0,appLink:E}).catch($=>w($)),this.client.events.emit("session_request_sent",{topic:s,request:n,chainId:i,id:d}),await l()):await Promise.all([new Promise(async $=>{await this.sendRequest({clientRpcId:d,relayRpcId:u,topic:s,method:"wc_sessionRequest",params:{request:Mr(Xe({},n),{expiryTimestamp:nt(a)}),chainId:i},expiry:a,throwOnFailedPublish:!0}).catch(I=>w(I)),this.client.events.emit("session_request_sent",{topic:s,request:n,chainId:i,id:d}),$()}),new Promise(async $=>{var I;if(!((I=c.sessionConfig)!=null&&I.disableDeepLink)){const M=await N7(this.client.core.storage,Bl);await O7({id:d,topic:s,wcDeepLink:M})}$()}),l()]).then($=>$[2])},this.respond=async r=>{this.isInitialized(),await this.isValidRespond(r);const{topic:i,response:n}=r,{id:s}=n,a=this.client.session.get(i);a.transportType===He.relay&&await this.confirmOnlineStateOrThrow();const c=this.getAppLinkIfEnabled(a.peer.metadata,a.transportType);kr(n)?await this.sendResult({id:s,topic:i,result:n.result,throwOnFailedPublish:!0,appLink:c}):Xt(n)&&await this.sendError({id:s,topic:i,error:n.error,appLink:c}),this.cleanupAfterResponse(r)},this.ping=async r=>{this.isInitialized(),await this.confirmOnlineStateOrThrow();try{await this.isValidPing(r)}catch(n){throw this.client.logger.error("ping() -> isValidPing() failed"),n}const{topic:i}=r;if(this.client.session.keys.includes(i)){const n=wi(),s=Ui().toString(),{done:a,resolve:c,reject:d}=dn();this.events.once(qe("session_ping",n),({error:u})=>{u?d(u):c()}),await Promise.all([this.sendRequest({topic:i,method:"wc_sessionPing",params:{},throwOnFailedPublish:!0,clientRpcId:n,relayRpcId:s}),a()])}else this.client.core.pairing.pairings.keys.includes(i)&&(this.client.logger.warn("ping() on pairing topic is deprecated and will be removed in the next major release."),await this.client.core.pairing.ping({topic:i}))},this.emit=async r=>{this.isInitialized(),await this.confirmOnlineStateOrThrow(),await this.isValidEmit(r);const{topic:i,event:n,chainId:s}=r,a=Ui().toString(),c=wi();await this.sendRequest({topic:i,method:"wc_sessionEvent",params:{event:n,chainId:s},throwOnFailedPublish:!0,relayRpcId:a,clientRpcId:c})},this.disconnect=async r=>{this.isInitialized(),await this.confirmOnlineStateOrThrow(),await this.isValidDisconnect(r);const{topic:i}=r;if(this.client.session.keys.includes(i))await this.sendRequest({topic:i,method:"wc_sessionDelete",params:je("USER_DISCONNECTED"),throwOnFailedPublish:!0}),await this.deleteSession({topic:i,emitEvent:!1});else if(this.client.core.pairing.pairings.keys.includes(i))await this.client.core.pairing.disconnect({topic:i});else{const{message:n}=J("MISMATCHED_TOPIC",`Session or pairing topic not found: ${i}`);throw new Error(n)}},this.find=r=>(this.isInitialized(),this.client.session.getAll().filter(i=>H_(i,r))),this.getPendingSessionRequests=()=>this.client.pendingRequest.getAll(),this.authenticate=async(r,i)=>{var n;this.isInitialized(),this.isValidAuthenticate(r);const s=i&&this.client.core.linkModeSupportedApps.includes(i)&&((n=this.client.metadata.redirect)==null?void 0:n.linkMode),a=s?He.link_mode:He.relay;a===He.relay&&await this.confirmOnlineStateOrThrow();const{chains:c,statement:d="",uri:u,domain:l,nonce:g,type:w,exp:E,nbf:$,methods:I=[],expiry:M}=r,P=[...r.resources||[]],{topic:A,uri:R}=await this.client.core.pairing.create({methods:["wc_sessionAuthenticate"],transportType:a});this.client.logger.info({message:"Generated new pairing",pairing:{topic:A,uri:R}});const C=await this.client.core.crypto.generateKeyPair(),D=Ua(C);if(await Promise.all([this.client.auth.authKeys.set(za,{responseTopic:D,publicKey:C}),this.client.auth.pairingTopics.set(D,{topic:D,pairingTopic:A})]),await this.client.core.relayer.subscribe(D,{transportType:a}),this.client.logger.info(`sending request to new pairing topic: ${A}`),I.length>0){const{namespace:x}=Jn(c[0]);let b=Sw(x,"request",I);Da(P)&&(b=xw(b,P.pop())),P.push(b)}const U=M&&M>ct.wc_sessionAuthenticate.req.ttl?M:ct.wc_sessionAuthenticate.req.ttl,j={authPayload:{type:w??"caip122",chains:c,statement:d,aud:u,domain:l,version:"1",nonce:g,iat:new Date().toISOString(),exp:E,nbf:$,resources:P},requester:{publicKey:C,metadata:this.client.metadata},expiryTimestamp:nt(U)},z={eip155:{chains:c,methods:[...new Set(["personal_sign",...I])],events:["chainChanged","accountsChanged"]}},q={requiredNamespaces:{},optionalNamespaces:z,relays:[{protocol:"irn"}],pairingTopic:A,proposer:{publicKey:C,metadata:this.client.metadata},expiryTimestamp:nt(ct.wc_sessionPropose.req.ttl)},{done:V,resolve:S,reject:o}=dn(U,"Request expired"),h=async({error:x,session:b})=>{if(this.events.off(qe("session_request",p),y),x)o(x);else if(b){b.self.publicKey=C,await this.client.session.set(b.topic,b),await this.setExpiry(b.topic,b.expiry),A&&await this.client.core.pairing.updateMetadata({topic:A,metadata:b.peer.metadata});const f=this.client.session.get(b.topic);await this.deleteProposal(v),S({session:f})}},y=async x=>{var b,f,m;if(await this.deletePendingAuthRequest(p,{message:"fulfilled",code:0}),x.error){const Z=je("WC_METHOD_UNSUPPORTED","wc_sessionAuthenticate");return x.error.code===Z.code?void 0:(this.events.off(qe("session_connect"),h),o(x.error.message))}await this.deleteProposal(v),this.events.off(qe("session_connect"),h);const{cacaos:F,responder:N}=x.result,T=[],L=[];for(const Z of F){await Tu({cacao:Z,projectId:this.client.core.projectId})||(this.client.logger.error(Z,"Signature verification failed"),o(je("SESSION_SETTLEMENT_FAILED","Signature verification failed")));const{p:K}=Z,Y=Da(K.resources),ke=[Sf(K.iss)],Q=io(K.iss);if(Y){const te=Bu(Y),At=qu(Y);T.push(...te),ke.push(...At)}for(const te of ke)L.push(`${te}:${Q}`)}const k=await this.client.core.crypto.generateSharedKey(C,N.publicKey);let W;T.length>0&&(W={topic:k,acknowledged:!0,self:{publicKey:C,metadata:this.client.metadata},peer:N,controller:N.publicKey,expiry:nt(qn),requiredNamespaces:{},optionalNamespaces:{},relay:{protocol:"irn"},pairingTopic:A,namespaces:rl([...new Set(T)],[...new Set(L)]),transportType:a},await this.client.core.relayer.subscribe(k,{transportType:a}),await this.client.session.set(k,W),A&&await this.client.core.pairing.updateMetadata({topic:A,metadata:N.metadata}),W=this.client.session.get(k)),(b=this.client.metadata.redirect)!=null&&b.linkMode&&(f=N.metadata.redirect)!=null&&f.linkMode&&(m=N.metadata.redirect)!=null&&m.universal&&i&&(this.client.core.addLinkModeSupportedApp(N.metadata.redirect.universal),this.client.session.update(k,{transportType:He.link_mode})),S({auths:F,session:W})},p=wi(),v=wi();this.events.once(qe("session_connect"),h),this.events.once(qe("session_request",p),y);let _;try{if(s){const x=Ei("wc_sessionAuthenticate",j,p);this.client.core.history.set(A,x);const b=await this.client.core.crypto.encode("",x,{type:aa,encoding:Ss});_=Pa(i,A,b)}else await Promise.all([this.sendRequest({topic:A,method:"wc_sessionAuthenticate",params:j,expiry:r.expiry,throwOnFailedPublish:!0,clientRpcId:p}),this.sendRequest({topic:A,method:"wc_sessionPropose",params:q,expiry:ct.wc_sessionPropose.req.ttl,throwOnFailedPublish:!0,clientRpcId:v})])}catch(x){throw this.events.off(qe("session_connect"),h),this.events.off(qe("session_request",p),y),x}return await this.setProposal(v,Xe({id:v},q)),await this.setAuthRequest(p,{request:Mr(Xe({},j),{verifyContext:{}}),pairingTopic:A,transportType:a}),{uri:_??R,response:V}},this.approveSessionAuthenticate=async r=>{const{id:i,auths:n}=r,s=this.client.core.eventClient.createEvent({properties:{topic:i.toString(),trace:[fn.authenticated_session_approve_started]}});try{this.isInitialized()}catch(M){throw s.setError(Is.no_internet_connection),M}const a=this.getPendingAuthRequest(i);if(!a)throw s.setError(Is.authenticated_session_pending_request_not_found),new Error(`Could not find pending auth request with id ${i}`);const c=a.transportType||He.relay;c===He.relay&&await this.confirmOnlineStateOrThrow();const d=a.requester.publicKey,u=await this.client.core.crypto.generateKeyPair(),l=Ua(d),g={type:xi,receiverPublicKey:d,senderPublicKey:u},w=[],E=[];for(const M of n){if(!await Tu({cacao:M,projectId:this.client.core.projectId})){s.setError(Is.invalid_cacao);const D=je("SESSION_SETTLEMENT_FAILED","Signature verification failed");throw await this.sendError({id:i,topic:l,error:D,encodeOpts:g}),new Error(D.message)}s.addTrace(fn.cacaos_verified);const{p:P}=M,A=Da(P.resources),R=[Sf(P.iss)],C=io(P.iss);if(A){const D=Bu(A),U=qu(A);w.push(...D),R.push(...U)}for(const D of R)E.push(`${D}:${C}`)}const $=await this.client.core.crypto.generateSharedKey(u,d);s.addTrace(fn.create_authenticated_session_topic);let I;if((w==null?void 0:w.length)>0){I={topic:$,acknowledged:!0,self:{publicKey:u,metadata:this.client.metadata},peer:{publicKey:d,metadata:a.requester.metadata},controller:d,expiry:nt(qn),authentication:n,requiredNamespaces:{},optionalNamespaces:{},relay:{protocol:"irn"},pairingTopic:a.pairingTopic,namespaces:rl([...new Set(w)],[...new Set(E)]),transportType:c},s.addTrace(fn.subscribing_authenticated_session_topic);try{await this.client.core.relayer.subscribe($,{transportType:c})}catch(M){throw s.setError(Is.subscribe_authenticated_session_topic_failure),M}s.addTrace(fn.subscribe_authenticated_session_topic_success),await this.client.session.set($,I),s.addTrace(fn.store_authenticated_session),await this.client.core.pairing.updateMetadata({topic:a.pairingTopic,metadata:a.requester.metadata})}s.addTrace(fn.publishing_authenticated_session_approve);try{await this.sendResult({topic:l,id:i,result:{cacaos:n,responder:{publicKey:u,metadata:this.client.metadata}},encodeOpts:g,throwOnFailedPublish:!0,appLink:this.getAppLinkIfEnabled(a.requester.metadata,c)})}catch(M){throw s.setError(Is.authenticated_session_approve_publish_failure),M}return await this.client.auth.requests.delete(i,{message:"fulfilled",code:0}),await this.client.core.pairing.activate({topic:a.pairingTopic}),this.client.core.eventClient.deleteEvent({eventId:s.eventId}),{session:I}},this.rejectSessionAuthenticate=async r=>{this.isInitialized();const{id:i,reason:n}=r,s=this.getPendingAuthRequest(i);if(!s)throw new Error(`Could not find pending auth request with id ${i}`);s.transportType===He.relay&&await this.confirmOnlineStateOrThrow();const a=s.requester.publicKey,c=await this.client.core.crypto.generateKeyPair(),d=Ua(a),u={type:xi,receiverPublicKey:a,senderPublicKey:c};await this.sendError({id:i,topic:d,error:n,encodeOpts:u,rpcOpts:ct.wc_sessionAuthenticate.reject,appLink:this.getAppLinkIfEnabled(s.requester.metadata,s.transportType)}),await this.client.auth.requests.delete(i,{message:"rejected",code:0}),await this.client.proposal.delete(i,je("USER_DISCONNECTED"))},this.formatAuthMessage=r=>{this.isInitialized();const{request:i,iss:n}=r;return F1(i,n)},this.processRelayMessageCache=()=>{setTimeout(async()=>{if(this.relayMessageCache.length!==0)for(;this.relayMessageCache.length>0;)try{const r=this.relayMessageCache.shift();r&&await this.onRelayMessage(r)}catch(r){this.client.logger.error(r)}},50)},this.cleanupDuplicatePairings=async r=>{if(r.pairingTopic)try{const i=this.client.core.pairing.pairings.get(r.pairingTopic),n=this.client.core.pairing.pairings.getAll().filter(s=>{var a,c;return((a=s.peerMetadata)==null?void 0:a.url)&&((c=s.peerMetadata)==null?void 0:c.url)===r.peer.metadata.url&&s.topic&&s.topic!==i.topic});if(n.length===0)return;this.client.logger.info(`Cleaning up ${n.length} duplicate pairing(s)`),await Promise.all(n.map(s=>this.client.core.pairing.disconnect({topic:s.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(i){this.client.logger.error(i)}},this.deleteSession=async r=>{var i;const{topic:n,expirerHasDeleted:s=!1,emitEvent:a=!0,id:c=0}=r,{self:d}=this.client.session.get(n);await this.client.core.relayer.unsubscribe(n),await this.client.session.delete(n,je("USER_DISCONNECTED")),this.addToRecentlyDeleted(n,"session"),this.client.core.crypto.keychain.has(d.publicKey)&&await this.client.core.crypto.deleteKeyPair(d.publicKey),this.client.core.crypto.keychain.has(n)&&await this.client.core.crypto.deleteSymKey(n),s||this.client.core.expirer.del(n),this.client.core.storage.removeItem(Bl).catch(u=>this.client.logger.warn(u)),this.getPendingSessionRequests().forEach(u=>{u.topic===n&&this.deletePendingSessionRequest(u.id,je("USER_DISCONNECTED"))}),n===((i=this.sessionRequestQueue.queue[0])==null?void 0:i.topic)&&(this.sessionRequestQueue.state=zr.idle),a&&this.client.events.emit("session_delete",{id:c,topic:n})},this.deleteProposal=async(r,i)=>{if(i)try{const n=this.client.proposal.get(r),s=this.client.core.eventClient.getEvent({topic:n.pairingTopic});s==null||s.setError(cn.proposal_expired)}catch{}await Promise.all([this.client.proposal.delete(r,je("USER_DISCONNECTED")),i?Promise.resolve():this.client.core.expirer.del(r)]),this.addToRecentlyDeleted(r,"proposal")},this.deletePendingSessionRequest=async(r,i,n=!1)=>{await Promise.all([this.client.pendingRequest.delete(r,i),n?Promise.resolve():this.client.core.expirer.del(r)]),this.addToRecentlyDeleted(r,"request"),this.sessionRequestQueue.queue=this.sessionRequestQueue.queue.filter(s=>s.id!==r),n&&(this.sessionRequestQueue.state=zr.idle,this.client.events.emit("session_request_expire",{id:r}))},this.deletePendingAuthRequest=async(r,i,n=!1)=>{await Promise.all([this.client.auth.requests.delete(r,i),n?Promise.resolve():this.client.core.expirer.del(r)])},this.setExpiry=async(r,i)=>{this.client.session.keys.includes(r)&&(this.client.core.expirer.set(r,i),await this.client.session.update(r,{expiry:i}))},this.setProposal=async(r,i)=>{this.client.core.expirer.set(r,nt(ct.wc_sessionPropose.req.ttl)),await this.client.proposal.set(r,i)},this.setAuthRequest=async(r,i)=>{const{request:n,pairingTopic:s,transportType:a=He.relay}=i;this.client.core.expirer.set(r,n.expiryTimestamp),await this.client.auth.requests.set(r,{authPayload:n.authPayload,requester:n.requester,expiryTimestamp:n.expiryTimestamp,id:r,pairingTopic:s,verifyContext:n.verifyContext,transportType:a})},this.setPendingSessionRequest=async r=>{const{id:i,topic:n,params:s,verifyContext:a}=r,c=s.request.expiryTimestamp||nt(ct.wc_sessionRequest.req.ttl);this.client.core.expirer.set(i,c),await this.client.pendingRequest.set(i,{id:i,topic:n,params:s,verifyContext:a})},this.sendRequest=async r=>{const{topic:i,method:n,params:s,expiry:a,relayRpcId:c,clientRpcId:d,throwOnFailedPublish:u,appLink:l}=r,g=Ei(n,s,d);let w;const E=!!l;try{const M=E?Ss:ji;w=await this.client.core.crypto.encode(i,g,{encoding:M})}catch(M){throw await this.cleanup(),this.client.logger.error(`sendRequest() -> core.crypto.encode() for topic ${i} failed`),M}let $;if(bx.includes(n)){const M=_i(JSON.stringify(g)),P=_i(w);$=await this.client.core.verify.register({id:P,decryptedId:M})}const I=ct[n].req;if(I.attestation=$,a&&(I.ttl=a),c&&(I.id=c),this.client.core.history.set(i,g),E){const M=Pa(l,i,w);await ne.Linking.openURL(M,this.client.name)}else{const M=ct[n].req;a&&(M.ttl=a),c&&(M.id=c),u?(M.internal=Mr(Xe({},M.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(i,w,M)):this.client.core.relayer.publish(i,w,M).catch(P=>this.client.logger.error(P))}return g.id},this.sendResult=async r=>{const{id:i,topic:n,result:s,throwOnFailedPublish:a,encodeOpts:c,appLink:d}=r,u=po(i,s);let l;const g=d&&typeof(ne==null?void 0:ne.Linking)<"u";try{const E=g?Ss:ji;l=await this.client.core.crypto.encode(n,u,Mr(Xe({},c||{}),{encoding:E}))}catch(E){throw await this.cleanup(),this.client.logger.error(`sendResult() -> core.crypto.encode() for topic ${n} failed`),E}let w;try{w=await this.client.core.history.get(n,i)}catch(E){throw this.client.logger.error(`sendResult() -> history.get(${n}, ${i}) failed`),E}if(g){const E=Pa(d,n,l);await ne.Linking.openURL(E,this.client.name)}else{const E=ct[w.request.method].res;a?(E.internal=Mr(Xe({},E.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(n,l,E)):this.client.core.relayer.publish(n,l,E).catch($=>this.client.logger.error($))}await this.client.core.history.resolve(u)},this.sendError=async r=>{const{id:i,topic:n,error:s,encodeOpts:a,rpcOpts:c,appLink:d}=r,u=Hs(i,s);let l;const g=d&&typeof(ne==null?void 0:ne.Linking)<"u";try{const E=g?Ss:ji;l=await this.client.core.crypto.encode(n,u,Mr(Xe({},a||{}),{encoding:E}))}catch(E){throw await this.cleanup(),this.client.logger.error(`sendError() -> core.crypto.encode() for topic ${n} failed`),E}let w;try{w=await this.client.core.history.get(n,i)}catch(E){throw this.client.logger.error(`sendError() -> history.get(${n}, ${i}) failed`),E}if(g){const E=Pa(d,n,l);await ne.Linking.openURL(E,this.client.name)}else{const E=c||ct[w.request.method].res;this.client.core.relayer.publish(n,l,E)}await this.client.core.history.resolve(u)},this.cleanup=async()=>{const r=[],i=[];this.client.session.getAll().forEach(n=>{let s=!1;Di(n.expiry)&&(s=!0),this.client.core.crypto.keychain.has(n.topic)||(s=!0),s&&r.push(n.topic)}),this.client.proposal.getAll().forEach(n=>{Di(n.expiryTimestamp)&&i.push(n.id)}),await Promise.all([...r.map(n=>this.deleteSession({topic:n})),...i.map(n=>this.deleteProposal(n))])},this.onRelayEventRequest=async r=>{this.requestQueue.queue.push(r),await this.processRequestsQueue()},this.processRequestsQueue=async()=>{if(this.requestQueue.state===zr.active){this.client.logger.info("Request queue already active, skipping...");return}for(this.client.logger.info(`Request queue starting with ${this.requestQueue.queue.length} requests`);this.requestQueue.queue.length>0;){this.requestQueue.state=zr.active;const r=this.requestQueue.queue.shift();if(r)try{await this.processRequest(r)}catch(i){this.client.logger.warn(i)}}this.requestQueue.state=zr.idle},this.processRequest=async r=>{const{topic:i,payload:n,attestation:s,transportType:a,encryptedId:c}=r,d=n.method;if(!this.shouldIgnorePairingRequest({topic:i,requestMethod:d}))switch(d){case"wc_sessionPropose":return await this.onSessionProposeRequest({topic:i,payload:n,attestation:s,encryptedId:c});case"wc_sessionSettle":return await this.onSessionSettleRequest(i,n);case"wc_sessionUpdate":return await this.onSessionUpdateRequest(i,n);case"wc_sessionExtend":return await this.onSessionExtendRequest(i,n);case"wc_sessionPing":return await this.onSessionPingRequest(i,n);case"wc_sessionDelete":return await this.onSessionDeleteRequest(i,n);case"wc_sessionRequest":return await this.onSessionRequest({topic:i,payload:n,attestation:s,encryptedId:c,transportType:a});case"wc_sessionEvent":return await this.onSessionEventRequest(i,n);case"wc_sessionAuthenticate":return await this.onSessionAuthenticateRequest({topic:i,payload:n,attestation:s,encryptedId:c,transportType:a});default:return this.client.logger.info(`Unsupported request method ${d}`)}},this.onRelayEventResponse=async r=>{const{topic:i,payload:n,transportType:s}=r,a=(await this.client.core.history.get(i,n.id)).request.method;switch(a){case"wc_sessionPropose":return this.onSessionProposeResponse(i,n,s);case"wc_sessionSettle":return this.onSessionSettleResponse(i,n);case"wc_sessionUpdate":return this.onSessionUpdateResponse(i,n);case"wc_sessionExtend":return this.onSessionExtendResponse(i,n);case"wc_sessionPing":return this.onSessionPingResponse(i,n);case"wc_sessionRequest":return this.onSessionRequestResponse(i,n);case"wc_sessionAuthenticate":return this.onSessionAuthenticateResponse(i,n);default:return this.client.logger.info(`Unsupported response method ${a}`)}},this.onRelayEventUnknownPayload=r=>{const{topic:i}=r,{message:n}=J("MISSING_OR_INVALID",`Decoded payload on topic ${i} is not identifiable as a JSON-RPC request or a response.`);throw new Error(n)},this.shouldIgnorePairingRequest=r=>{const{topic:i,requestMethod:n}=r,s=this.expectedPairingMethodMap.get(i);return!s||s.includes(n)?!1:!!(s.includes("wc_sessionAuthenticate")&&this.client.events.listenerCount("session_authenticate")>0)},this.onSessionProposeRequest=async r=>{const{topic:i,payload:n,attestation:s,encryptedId:a}=r,{params:c,id:d}=n;try{const u=this.client.core.eventClient.getEvent({topic:i});this.client.events.listenerCount("session_proposal")===0&&(console.warn("No listener for session_proposal event"),u==null||u.setError(mi.proposal_listener_not_found)),this.isValidConnect(Xe({},n.params));const l=c.expiryTimestamp||nt(ct.wc_sessionPropose.req.ttl),g=Xe({id:d,pairingTopic:i,expiryTimestamp:l},c);await this.setProposal(d,g);const w=await this.getVerifyContext({attestationId:s,hash:_i(JSON.stringify(n)),encryptedId:a,metadata:g.proposer.metadata});u==null||u.addTrace(jr.emit_session_proposal),this.client.events.emit("session_proposal",{id:d,params:g,verifyContext:w})}catch(u){await this.sendError({id:d,topic:i,error:u,rpcOpts:ct.wc_sessionPropose.autoReject}),this.client.logger.error(u)}},this.onSessionProposeResponse=async(r,i,n)=>{const{id:s}=i;if(kr(i)){const{result:a}=i;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:a});const c=this.client.proposal.get(s);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:c});const d=c.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:d});const u=a.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:u});const l=await this.client.core.crypto.generateSharedKey(d,u);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:l});const g=await this.client.core.relayer.subscribe(l,{transportType:n});this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:g}),await this.client.core.pairing.activate({topic:r})}else if(Xt(i)){await this.client.proposal.delete(s,je("USER_DISCONNECTED"));const a=qe("session_connect");if(this.events.listenerCount(a)===0)throw new Error(`emitting ${a} without any listeners, 954`);this.events.emit(qe("session_connect"),{error:i.error})}},this.onSessionSettleRequest=async(r,i)=>{const{id:n,params:s}=i;try{this.isValidSessionSettleRequest(s);const{relay:a,controller:c,expiry:d,namespaces:u,sessionProperties:l,sessionConfig:g}=i.params,w=Mr(Xe(Xe({topic:r,relay:a,expiry:d,namespaces:u,acknowledged:!0,pairingTopic:"",requiredNamespaces:{},optionalNamespaces:{},controller:c.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:c.publicKey,metadata:c.metadata}},l&&{sessionProperties:l}),g&&{sessionConfig:g}),{transportType:He.relay}),E=qe("session_connect");if(this.events.listenerCount(E)===0)throw new Error(`emitting ${E} without any listeners 997`);this.events.emit(qe("session_connect"),{session:w}),await this.sendResult({id:i.id,topic:r,result:!0,throwOnFailedPublish:!0})}catch(a){await this.sendError({id:n,topic:r,error:a}),this.client.logger.error(a)}},this.onSessionSettleResponse=async(r,i)=>{const{id:n}=i;kr(i)?(await this.client.session.update(r,{acknowledged:!0}),this.events.emit(qe("session_approve",n),{})):Xt(i)&&(await this.client.session.delete(r,je("USER_DISCONNECTED")),this.events.emit(qe("session_approve",n),{error:i.error}))},this.onSessionUpdateRequest=async(r,i)=>{const{params:n,id:s}=i;try{const a=`${r}_session_update`,c=$s.get(a);if(c&&this.isRequestOutOfSync(c,s)){this.client.logger.warn(`Discarding out of sync request - ${s}`),this.sendError({id:s,topic:r,error:je("INVALID_UPDATE_REQUEST")});return}this.isValidUpdate(Xe({topic:r},n));try{$s.set(a,s),await this.client.session.update(r,{namespaces:n.namespaces}),await this.sendResult({id:s,topic:r,result:!0,throwOnFailedPublish:!0})}catch(d){throw $s.delete(a),d}this.client.events.emit("session_update",{id:s,topic:r,params:n})}catch(a){await this.sendError({id:s,topic:r,error:a}),this.client.logger.error(a)}},this.isRequestOutOfSync=(r,i)=>i.toString().slice(0,-3)<r.toString().slice(0,-3),this.onSessionUpdateResponse=(r,i)=>{const{id:n}=i,s=qe("session_update",n);if(this.events.listenerCount(s)===0)throw new Error(`emitting ${s} without any listeners`);kr(i)?this.events.emit(qe("session_update",n),{}):Xt(i)&&this.events.emit(qe("session_update",n),{error:i.error})},this.onSessionExtendRequest=async(r,i)=>{const{id:n}=i;try{this.isValidExtend({topic:r}),await this.setExpiry(r,nt(qn)),await this.sendResult({id:n,topic:r,result:!0,throwOnFailedPublish:!0}),this.client.events.emit("session_extend",{id:n,topic:r})}catch(s){await this.sendError({id:n,topic:r,error:s}),this.client.logger.error(s)}},this.onSessionExtendResponse=(r,i)=>{const{id:n}=i,s=qe("session_extend",n);if(this.events.listenerCount(s)===0)throw new Error(`emitting ${s} without any listeners`);kr(i)?this.events.emit(qe("session_extend",n),{}):Xt(i)&&this.events.emit(qe("session_extend",n),{error:i.error})},this.onSessionPingRequest=async(r,i)=>{const{id:n}=i;try{this.isValidPing({topic:r}),await this.sendResult({id:n,topic:r,result:!0,throwOnFailedPublish:!0}),this.client.events.emit("session_ping",{id:n,topic:r})}catch(s){await this.sendError({id:n,topic:r,error:s}),this.client.logger.error(s)}},this.onSessionPingResponse=(r,i)=>{const{id:n}=i,s=qe("session_ping",n);if(this.events.listenerCount(s)===0)throw new Error(`emitting ${s} without any listeners`);setTimeout(()=>{kr(i)?this.events.emit(qe("session_ping",n),{}):Xt(i)&&this.events.emit(qe("session_ping",n),{error:i.error})},500)},this.onSessionDeleteRequest=async(r,i)=>{const{id:n}=i;try{this.isValidDisconnect({topic:r,reason:i.params}),Promise.all([new Promise(s=>{this.client.core.relayer.once(dt.publish,async()=>{s(await this.deleteSession({topic:r,id:n}))})}),this.sendResult({id:n,topic:r,result:!0,throwOnFailedPublish:!0}),this.cleanupPendingSentRequestsForTopic({topic:r,error:je("USER_DISCONNECTED")})]).catch(s=>this.client.logger.error(s))}catch(s){this.client.logger.error(s)}},this.onSessionRequest=async r=>{var i,n,s;const{topic:a,payload:c,attestation:d,encryptedId:u,transportType:l}=r,{id:g,params:w}=c;try{await this.isValidRequest(Xe({topic:a},w));const E=this.client.session.get(a),$=await this.getVerifyContext({attestationId:d,hash:_i(JSON.stringify(Ei("wc_sessionRequest",w,g))),encryptedId:u,metadata:E.peer.metadata,transportType:l}),I={id:g,topic:a,params:w,verifyContext:$};await this.setPendingSessionRequest(I),l===He.link_mode&&(i=E.peer.metadata.redirect)!=null&&i.universal&&this.client.core.addLinkModeSupportedApp((n=E.peer.metadata.redirect)==null?void 0:n.universal),(s=this.client.signConfig)!=null&&s.disableRequestQueue?this.emitSessionRequest(I):(this.addSessionRequestToSessionRequestQueue(I),this.processSessionRequestQueue())}catch(E){await this.sendError({id:g,topic:a,error:E}),this.client.logger.error(E)}},this.onSessionRequestResponse=(r,i)=>{const{id:n}=i,s=qe("session_request",n);if(this.events.listenerCount(s)===0)throw new Error(`emitting ${s} without any listeners`);kr(i)?this.events.emit(qe("session_request",n),{result:i.result}):Xt(i)&&this.events.emit(qe("session_request",n),{error:i.error})},this.onSessionEventRequest=async(r,i)=>{const{id:n,params:s}=i;try{const a=`${r}_session_event_${s.event.name}`,c=$s.get(a);if(c&&this.isRequestOutOfSync(c,n)){this.client.logger.info(`Discarding out of sync request - ${n}`);return}this.isValidEmit(Xe({topic:r},s)),this.client.events.emit("session_event",{id:n,topic:r,params:s}),$s.set(a,n)}catch(a){await this.sendError({id:n,topic:r,error:a}),this.client.logger.error(a)}},this.onSessionAuthenticateResponse=(r,i)=>{const{id:n}=i;this.client.logger.trace({type:"method",method:"onSessionAuthenticateResponse",topic:r,payload:i}),kr(i)?this.events.emit(qe("session_request",n),{result:i.result}):Xt(i)&&this.events.emit(qe("session_request",n),{error:i.error})},this.onSessionAuthenticateRequest=async r=>{var i;const{topic:n,payload:s,attestation:a,encryptedId:c,transportType:d}=r;try{const{requester:u,authPayload:l,expiryTimestamp:g}=s.params,w=await this.getVerifyContext({attestationId:a,hash:_i(JSON.stringify(s)),encryptedId:c,metadata:u.metadata,transportType:d}),E={requester:u,pairingTopic:n,id:s.id,authPayload:l,verifyContext:w,expiryTimestamp:g};await this.setAuthRequest(s.id,{request:E,pairingTopic:n,transportType:d}),d===He.link_mode&&(i=u.metadata.redirect)!=null&&i.universal&&this.client.core.addLinkModeSupportedApp(u.metadata.redirect.universal),this.client.events.emit("session_authenticate",{topic:n,params:s.params,id:s.id,verifyContext:w})}catch(u){this.client.logger.error(u);const l=s.params.requester.publicKey,g=await this.client.core.crypto.generateKeyPair(),w=this.getAppLinkIfEnabled(s.params.requester.metadata,d),E={type:xi,receiverPublicKey:l,senderPublicKey:g};await this.sendError({id:s.id,topic:n,error:u,encodeOpts:E,rpcOpts:ct.wc_sessionAuthenticate.autoReject,appLink:w})}},this.addSessionRequestToSessionRequestQueue=r=>{this.sessionRequestQueue.queue.push(r)},this.cleanupAfterResponse=r=>{this.deletePendingSessionRequest(r.response.id,{message:"fulfilled",code:0}),setTimeout(()=>{this.sessionRequestQueue.state=zr.idle,this.processSessionRequestQueue()},G.toMiliseconds(this.requestQueueDelay))},this.cleanupPendingSentRequestsForTopic=({topic:r,error:i})=>{const n=this.client.core.history.pending;n.length>0&&n.filter(s=>s.topic===r&&s.request.method==="wc_sessionRequest").forEach(s=>{const a=s.request.id,c=qe("session_request",a);if(this.events.listenerCount(c)===0)throw new Error(`emitting ${c} without any listeners`);this.events.emit(qe("session_request",s.request.id),{error:i})})},this.processSessionRequestQueue=()=>{if(this.sessionRequestQueue.state===zr.active){this.client.logger.info("session request queue is already active.");return}const r=this.sessionRequestQueue.queue[0];if(!r){this.client.logger.info("session request queue is empty.");return}try{this.sessionRequestQueue.state=zr.active,this.emitSessionRequest(r)}catch(i){this.client.logger.error(i)}},this.emitSessionRequest=r=>{this.client.events.emit("session_request",r)},this.onPairingCreated=r=>{if(r.methods&&this.expectedPairingMethodMap.set(r.topic,r.methods),r.active)return;const i=this.client.proposal.getAll().find(n=>n.pairingTopic===r.topic);i&&this.onSessionProposeRequest({topic:r.topic,payload:Ei("wc_sessionPropose",{requiredNamespaces:i.requiredNamespaces,optionalNamespaces:i.optionalNamespaces,relays:i.relays,proposer:i.proposer,sessionProperties:i.sessionProperties},i.id)})},this.isValidConnect=async r=>{if(!zt(r)){const{message:d}=J("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(r)}`);throw new Error(d)}const{pairingTopic:i,requiredNamespaces:n,optionalNamespaces:s,sessionProperties:a,relays:c}=r;if(Tt(i)||await this.isValidPairingTopic(i),!rE(c)){const{message:d}=J("MISSING_OR_INVALID",`connect() relays: ${c}`);throw new Error(d)}!Tt(n)&&js(n)!==0&&this.validateNamespaces(n,"requiredNamespaces"),!Tt(s)&&js(s)!==0&&this.validateNamespaces(s,"optionalNamespaces"),Tt(a)||this.validateSessionProps(a,"sessionProperties")},this.validateNamespaces=(r,i)=>{const n=tE(r,"connect()",i);if(n)throw new Error(n.message)},this.isValidApprove=async r=>{if(!zt(r))throw new Error(J("MISSING_OR_INVALID",`approve() params: ${r}`).message);const{id:i,namespaces:n,relayProtocol:s,sessionProperties:a}=r;this.checkRecentlyDeleted(i),await this.isValidProposalId(i);const c=this.client.proposal.get(i),d=qc(n,"approve()");if(d)throw new Error(d.message);const u=sl(c.requiredNamespaces,n,"approve()");if(u)throw new Error(u.message);if(!tt(s,!0)){const{message:l}=J("MISSING_OR_INVALID",`approve() relayProtocol: ${s}`);throw new Error(l)}Tt(a)||this.validateSessionProps(a,"sessionProperties")},this.isValidReject=async r=>{if(!zt(r)){const{message:s}=J("MISSING_OR_INVALID",`reject() params: ${r}`);throw new Error(s)}const{id:i,reason:n}=r;if(this.checkRecentlyDeleted(i),await this.isValidProposalId(i),!nE(n)){const{message:s}=J("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(n)}`);throw new Error(s)}},this.isValidSessionSettleRequest=r=>{if(!zt(r)){const{message:u}=J("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${r}`);throw new Error(u)}const{relay:i,controller:n,namespaces:s,expiry:a}=r;if(!J1(i)){const{message:u}=J("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(u)}const c=J_(n,"onSessionSettleRequest()");if(c)throw new Error(c.message);const d=qc(s,"onSessionSettleRequest()");if(d)throw new Error(d.message);if(Di(a)){const{message:u}=J("EXPIRED","onSessionSettleRequest()");throw new Error(u)}},this.isValidUpdate=async r=>{if(!zt(r)){const{message:d}=J("MISSING_OR_INVALID",`update() params: ${r}`);throw new Error(d)}const{topic:i,namespaces:n}=r;this.checkRecentlyDeleted(i),await this.isValidSessionTopic(i);const s=this.client.session.get(i),a=qc(n,"update()");if(a)throw new Error(a.message);const c=sl(s.requiredNamespaces,n,"update()");if(c)throw new Error(c.message)},this.isValidExtend=async r=>{if(!zt(r)){const{message:n}=J("MISSING_OR_INVALID",`extend() params: ${r}`);throw new Error(n)}const{topic:i}=r;this.checkRecentlyDeleted(i),await this.isValidSessionTopic(i)},this.isValidRequest=async r=>{if(!zt(r)){const{message:d}=J("MISSING_OR_INVALID",`request() params: ${r}`);throw new Error(d)}const{topic:i,request:n,chainId:s,expiry:a}=r;this.checkRecentlyDeleted(i),await this.isValidSessionTopic(i);const{namespaces:c}=this.client.session.get(i);if(!nl(c,s)){const{message:d}=J("MISSING_OR_INVALID",`request() chainId: ${s}`);throw new Error(d)}if(!sE(n)){const{message:d}=J("MISSING_OR_INVALID",`request() ${JSON.stringify(n)}`);throw new Error(d)}if(!cE(c,s,n.method)){const{message:d}=J("MISSING_OR_INVALID",`request() method: ${n.method}`);throw new Error(d)}if(a&&!uE(a,jc)){const{message:d}=J("MISSING_OR_INVALID",`request() expiry: ${a}. Expiry must be a number (in seconds) between ${jc.min} and ${jc.max}`);throw new Error(d)}},this.isValidRespond=async r=>{var i;if(!zt(r)){const{message:a}=J("MISSING_OR_INVALID",`respond() params: ${r}`);throw new Error(a)}const{topic:n,response:s}=r;try{await this.isValidSessionTopic(n)}catch(a){throw(i=r==null?void 0:r.response)!=null&&i.id&&this.cleanupAfterResponse(r),a}if(!aE(s)){const{message:a}=J("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(s)}`);throw new Error(a)}},this.isValidPing=async r=>{if(!zt(r)){const{message:n}=J("MISSING_OR_INVALID",`ping() params: ${r}`);throw new Error(n)}const{topic:i}=r;await this.isValidSessionOrPairingTopic(i)},this.isValidEmit=async r=>{if(!zt(r)){const{message:c}=J("MISSING_OR_INVALID",`emit() params: ${r}`);throw new Error(c)}const{topic:i,event:n,chainId:s}=r;await this.isValidSessionTopic(i);const{namespaces:a}=this.client.session.get(i);if(!nl(a,s)){const{message:c}=J("MISSING_OR_INVALID",`emit() chainId: ${s}`);throw new Error(c)}if(!oE(n)){const{message:c}=J("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(n)}`);throw new Error(c)}if(!fE(a,s,n.name)){const{message:c}=J("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(n)}`);throw new Error(c)}},this.isValidDisconnect=async r=>{if(!zt(r)){const{message:n}=J("MISSING_OR_INVALID",`disconnect() params: ${r}`);throw new Error(n)}const{topic:i}=r;await this.isValidSessionOrPairingTopic(i)},this.isValidAuthenticate=r=>{const{chains:i,uri:n,domain:s,nonce:a}=r;if(!Array.isArray(i)||i.length===0)throw new Error("chains is required and must be a non-empty array");if(!tt(n,!1))throw new Error("uri is required parameter");if(!tt(s,!1))throw new Error("domain is required parameter");if(!tt(a,!1))throw new Error("nonce is required parameter");if([...new Set(i.map(d=>Jn(d).namespace))].length>1)throw new Error("Multi-namespace requests are not supported. Please request single namespace only.");const{namespace:c}=Jn(i[0]);if(c!=="eip155")throw new Error("Only eip155 namespace is supported for authenticated sessions. Please use .connect() for non-eip155 chains.")},this.getVerifyContext=async r=>{const{attestationId:i,hash:n,encryptedId:s,metadata:a,transportType:c}=r,d={verified:{verifyUrl:a.verifyUrl||Cs,validation:"UNKNOWN",origin:a.url||""}};try{if(c===He.link_mode){const l=this.getAppLinkIfEnabled(a,c);return d.verified.validation=l&&new URL(l).origin===new URL(a.url).origin?"VALID":"INVALID",d}const u=await this.client.core.verify.resolve({attestationId:i,hash:n,encryptedId:s,verifyUrl:a.verifyUrl});u&&(d.verified.origin=u.origin,d.verified.isScam=u.isScam,d.verified.validation=u.origin===new URL(a.url).origin?"VALID":"INVALID")}catch(u){this.client.logger.warn(u)}return this.client.logger.debug(`Verify context: ${JSON.stringify(d)}`),d},this.validateSessionProps=(r,i)=>{Object.values(r).forEach(n=>{if(!tt(n,!1)){const{message:s}=J("MISSING_OR_INVALID",`${i} must be in Record<string, string> format. Received: ${JSON.stringify(n)}`);throw new Error(s)}})},this.getPendingAuthRequest=r=>{const i=this.client.auth.requests.get(r);return typeof i=="object"?i:void 0},this.addToRecentlyDeleted=(r,i)=>{if(this.recentlyDeletedMap.set(r,i),this.recentlyDeletedMap.size>=this.recentlyDeletedLimit){let n=0;const s=this.recentlyDeletedLimit/2;for(const a of this.recentlyDeletedMap.keys()){if(n++>=s)break;this.recentlyDeletedMap.delete(a)}}},this.checkRecentlyDeleted=r=>{const i=this.recentlyDeletedMap.get(r);if(i){const{message:n}=J("MISSING_OR_INVALID",`Record was recently deleted - ${i}: ${r}`);throw new Error(n)}},this.isLinkModeEnabled=(r,i)=>{var n,s,a,c,d,u,l,g,w;return!r||i!==He.link_mode?!1:((s=(n=this.client.metadata)==null?void 0:n.redirect)==null?void 0:s.linkMode)===!0&&((c=(a=this.client.metadata)==null?void 0:a.redirect)==null?void 0:c.universal)!==void 0&&((u=(d=this.client.metadata)==null?void 0:d.redirect)==null?void 0:u.universal)!==""&&((l=r==null?void 0:r.redirect)==null?void 0:l.universal)!==void 0&&((g=r==null?void 0:r.redirect)==null?void 0:g.universal)!==""&&((w=r==null?void 0:r.redirect)==null?void 0:w.linkMode)===!0&&this.client.core.linkModeSupportedApps.includes(r.redirect.universal)&&typeof(ne==null?void 0:ne.Linking)<"u"},this.getAppLinkIfEnabled=(r,i)=>{var n;return this.isLinkModeEnabled(r,i)?(n=r==null?void 0:r.redirect)==null?void 0:n.universal:void 0},this.handleLinkModeMessage=({url:r})=>{if(!r||!r.includes("wc_ev")||!r.includes("topic"))return;const i=Iu(r,"topic")||"",n=decodeURIComponent(Iu(r,"wc_ev")||""),s=this.client.session.keys.includes(i);s&&this.client.session.update(i,{transportType:He.link_mode}),this.client.core.dispatchEnvelope({topic:i,message:n,sessionExists:s})},this.registerLinkModeListeners=async()=>{var r;if(bd()||Ji()&&(r=this.client.metadata.redirect)!=null&&r.linkMode){const i=ne==null?void 0:ne.Linking;if(typeof i<"u"){i.addEventListener("url",this.handleLinkModeMessage,this.client.name);const n=await i.getInitialURL();n&&setTimeout(()=>{this.handleLinkModeMessage({url:n})},50)}}}}isInitialized(){if(!this.initialized){const{message:e}=J("NOT_INITIALIZED",this.name);throw new Error(e)}}async confirmOnlineStateOrThrow(){await this.client.core.relayer.confirmOnlineStateOrThrow()}registerRelayerEvents(){this.client.core.relayer.on(dt.message,e=>{!this.initialized||this.relayMessageCache.length>0?this.relayMessageCache.push(e):this.onRelayMessage(e)})}async onRelayMessage(e){const{topic:r,message:i,attestation:n,transportType:s}=e,{publicKey:a}=this.client.auth.authKeys.keys.includes(za)?this.client.auth.authKeys.get(za):{publicKey:void 0},c=await this.client.core.crypto.decode(r,i,{receiverPublicKey:a,encoding:s===He.link_mode?Ss:ji});try{Df(c)?(this.client.core.history.set(r,c),this.onRelayEventRequest({topic:r,payload:c,attestation:n,transportType:s,encryptedId:_i(i)})):Ks(c)?(await this.client.core.history.resolve(c),await this.onRelayEventResponse({topic:r,payload:c,transportType:s}),this.client.core.history.delete(r,c.id)):this.onRelayEventUnknownPayload({topic:r,payload:c,transportType:s})}catch(d){this.client.logger.error(d)}}registerExpirerEvents(){this.client.core.expirer.on(dr.expired,async e=>{const{topic:r,id:i}=S1(e.target);if(i&&this.client.pendingRequest.keys.includes(i))return await this.deletePendingSessionRequest(i,J("EXPIRED"),!0);if(i&&this.client.auth.requests.keys.includes(i))return await this.deletePendingAuthRequest(i,J("EXPIRED"),!0);r?this.client.session.keys.includes(r)&&(await this.deleteSession({topic:r,expirerHasDeleted:!0}),this.client.events.emit("session_expire",{topic:r})):i&&(await this.deleteProposal(i,!0),this.client.events.emit("proposal_expire",{id:i}))})}registerPairingEvents(){this.client.core.pairing.events.on(bn.create,e=>this.onPairingCreated(e)),this.client.core.pairing.events.on(bn.delete,e=>{this.addToRecentlyDeleted(e.topic,"pairing")})}isValidPairingTopic(e){if(!tt(e,!1)){const{message:r}=J("MISSING_OR_INVALID",`pairing topic should be a string: ${e}`);throw new Error(r)}if(!this.client.core.pairing.pairings.keys.includes(e)){const{message:r}=J("NO_MATCHING_KEY",`pairing topic doesn't exist: ${e}`);throw new Error(r)}if(Di(this.client.core.pairing.pairings.get(e).expiry)){const{message:r}=J("EXPIRED",`pairing topic: ${e}`);throw new Error(r)}}async isValidSessionTopic(e){if(!tt(e,!1)){const{message:r}=J("MISSING_OR_INVALID",`session topic should be a string: ${e}`);throw new Error(r)}if(this.checkRecentlyDeleted(e),!this.client.session.keys.includes(e)){const{message:r}=J("NO_MATCHING_KEY",`session topic doesn't exist: ${e}`);throw new Error(r)}if(Di(this.client.session.get(e).expiry)){await this.deleteSession({topic:e});const{message:r}=J("EXPIRED",`session topic: ${e}`);throw new Error(r)}if(!this.client.core.crypto.keychain.has(e)){const{message:r}=J("MISSING_OR_INVALID",`session topic does not exist in keychain: ${e}`);throw await this.deleteSession({topic:e}),new Error(r)}}async isValidSessionOrPairingTopic(e){if(this.checkRecentlyDeleted(e),this.client.session.keys.includes(e))await this.isValidSessionTopic(e);else if(this.client.core.pairing.pairings.keys.includes(e))this.isValidPairingTopic(e);else if(tt(e,!1)){const{message:r}=J("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${e}`);throw new Error(r)}else{const{message:r}=J("MISSING_OR_INVALID",`session or pairing topic should be a string: ${e}`);throw new Error(r)}}async isValidProposalId(e){if(!iE(e)){const{message:r}=J("MISSING_OR_INVALID",`proposal id should be a number: ${e}`);throw new Error(r)}if(!this.client.proposal.keys.includes(e)){const{message:r}=J("NO_MATCHING_KEY",`proposal id doesn't exist: ${e}`);throw new Error(r)}if(Di(this.client.proposal.get(e).expiryTimestamp)){await this.deleteProposal(e);const{message:r}=J("EXPIRED",`proposal id: ${e}`);throw new Error(r)}}},Mx=class extends $n{constructor(e,r){super(e,r,hx,$d),this.core=e,this.logger=r}},Ax=class extends $n{constructor(e,r){super(e,r,ux,$d),this.core=e,this.logger=r}},Px=class extends $n{constructor(e,r){super(e,r,px,$d,i=>i.id),this.core=e,this.logger=r}},Ox=class extends $n{constructor(e,r){super(e,r,yx,zo,()=>za),this.core=e,this.logger=r}},Rx=class extends $n{constructor(e,r){super(e,r,mx,zo),this.core=e,this.logger=r}},Fx=class extends $n{constructor(e,r){super(e,r,wx,zo,i=>i.id),this.core=e,this.logger=r}},Nx=class{constructor(e,r){this.core=e,this.logger=r,this.authKeys=new Ox(this.core,this.logger),this.pairingTopics=new Rx(this.core,this.logger),this.requests=new Fx(this.core,this.logger)}async init(){await this.authKeys.init(),await this.pairingTopics.init(),await this.requests.init()}},Cx=class gb extends Ym{constructor(e){super(e),this.protocol=ub,this.version=lb,this.name=zc.name,this.events=new Ht.EventEmitter,this.on=(i,n)=>this.events.on(i,n),this.once=(i,n)=>this.events.once(i,n),this.off=(i,n)=>this.events.off(i,n),this.removeListener=(i,n)=>this.events.removeListener(i,n),this.removeAllListeners=i=>this.events.removeAllListeners(i),this.connect=async i=>{try{return await this.engine.connect(i)}catch(n){throw this.logger.error(n.message),n}},this.pair=async i=>{try{return await this.engine.pair(i)}catch(n){throw this.logger.error(n.message),n}},this.approve=async i=>{try{return await this.engine.approve(i)}catch(n){throw this.logger.error(n.message),n}},this.reject=async i=>{try{return await this.engine.reject(i)}catch(n){throw this.logger.error(n.message),n}},this.update=async i=>{try{return await this.engine.update(i)}catch(n){throw this.logger.error(n.message),n}},this.extend=async i=>{try{return await this.engine.extend(i)}catch(n){throw this.logger.error(n.message),n}},this.request=async i=>{try{return await this.engine.request(i)}catch(n){throw this.logger.error(n.message),n}},this.respond=async i=>{try{return await this.engine.respond(i)}catch(n){throw this.logger.error(n.message),n}},this.ping=async i=>{try{return await this.engine.ping(i)}catch(n){throw this.logger.error(n.message),n}},this.emit=async i=>{try{return await this.engine.emit(i)}catch(n){throw this.logger.error(n.message),n}},this.disconnect=async i=>{try{return await this.engine.disconnect(i)}catch(n){throw this.logger.error(n.message),n}},this.find=i=>{try{return this.engine.find(i)}catch(n){throw this.logger.error(n.message),n}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(i){throw this.logger.error(i.message),i}},this.authenticate=async(i,n)=>{try{return await this.engine.authenticate(i,n)}catch(s){throw this.logger.error(s.message),s}},this.formatAuthMessage=i=>{try{return this.engine.formatAuthMessage(i)}catch(n){throw this.logger.error(n.message),n}},this.approveSessionAuthenticate=async i=>{try{return await this.engine.approveSessionAuthenticate(i)}catch(n){throw this.logger.error(n.message),n}},this.rejectSessionAuthenticate=async i=>{try{return await this.engine.rejectSessionAuthenticate(i)}catch(n){throw this.logger.error(n.message),n}},this.name=(e==null?void 0:e.name)||zc.name,this.metadata=(e==null?void 0:e.metadata)||y1(),this.signConfig=e==null?void 0:e.signConfig;const r=typeof(e==null?void 0:e.logger)<"u"&&typeof(e==null?void 0:e.logger)!="string"?e.logger:Zs(Io({level:(e==null?void 0:e.logger)||zc.logger}));this.core=(e==null?void 0:e.core)||new dx(e),this.logger=qt(r,this.name),this.session=new Ax(this.core,this.logger),this.proposal=new Mx(this.core,this.logger),this.pendingRequest=new Px(this.core,this.logger),this.engine=new Ix(this),this.auth=new Nx(this.core,this.logger)}static async init(e){const r=new gb(e);return await r.initialize(),r}get context(){return Kt(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.auth.init(),await this.engine.init(),this.logger.info("SignClient Initialization Success"),setTimeout(()=>{this.engine.processRelayMessageCache()},G.toMiliseconds(G.ONE_SECOND))}catch(e){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(e.message),e}}};var Tx=Object.defineProperty,Bx=Object.defineProperties,qx=Object.getOwnPropertyDescriptors,Dl=Object.getOwnPropertySymbols,Lx=Object.prototype.hasOwnProperty,Dx=Object.prototype.propertyIsEnumerable,Ul=(t,e,r)=>e in t?Tx(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,zl=(t,e)=>{for(var r in e||(e={}))Lx.call(e,r)&&Ul(t,r,e[r]);if(Dl)for(var r of Dl(e))Dx.call(e,r)&&Ul(t,r,e[r]);return t},jl=(t,e)=>Bx(t,qx(e));const Ux={Accept:"application/json","Content-Type":"application/json"},zx="POST",kl={headers:Ux,method:zx},Hl=10;let Tr=class{constructor(e,r=!1){if(this.url=e,this.disableProviderPing=r,this.events=new Ht.EventEmitter,this.isAvailable=!1,this.registering=!1,!Ha(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);this.url=e,this.disableProviderPing=r}get connected(){return this.isAvailable}get connecting(){return this.registering}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}off(e,r){this.events.off(e,r)}removeListener(e,r){this.events.removeListener(e,r)}async open(e=this.url){await this.register(e)}async close(){if(!this.isAvailable)throw new Error("Connection already closed");this.onClose()}async send(e){this.isAvailable||await this.register();try{const r=Cr(e),i=await(await ka(this.url,jl(zl({},kl),{body:r}))).json();this.onPayload({data:i})}catch(r){this.onError(e.id,r)}}async register(e=this.url){if(!Ha(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((i,n)=>{this.events.once("register_error",s=>{this.resetMaxListeners(),n(s)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.isAvailable>"u")return n(new Error("HTTP connection is missing or invalid"));i()})})}this.url=e,this.registering=!0;try{if(!this.disableProviderPing){const r=Cr({id:1,jsonrpc:"2.0",method:"test",params:[]});await ka(e,jl(zl({},kl),{body:r}))}this.onOpen()}catch(r){const i=this.parseError(r);throw this.events.emit("register_error",i),this.onClose(),i}}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(e){if(typeof e.data>"u")return;const r=typeof e.data=="string"?Vi(e.data):e.data;this.events.emit("payload",r)}onError(e,r){const i=this.parseError(r),n=i.message||i.toString(),s=Hs(e,n);this.events.emit("payload",s)}parseError(e,r=this.url){return Lf(e,r,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>Hl&&this.events.setMaxListeners(Hl)}};const Kl="error",jx="wss://relay.walletconnect.org",kx="wc",Hx="universal_provider",Vl=`${kx}@2:${Hx}:`,vb="https://rpc.walletconnect.org/v1/",Dn="generic",Kx=`${vb}bundler`,mr={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};var Oa=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof ne<"u"?ne:typeof self<"u"?self:{};function Vx(){this.__data__=[],this.size=0}var Wx=Vx;function Gx(t,e){return t===e||t!==t&&e!==e}var jo=Gx,Jx=jo;function Yx(t,e){for(var r=t.length;r--;)if(Jx(t[r][0],e))return r;return-1}var ko=Yx,Zx=ko,Xx=Array.prototype,Qx=Xx.splice;function eI(t){var e=this.__data__,r=Zx(e,t);if(r<0)return!1;var i=e.length-1;return r==i?e.pop():Qx.call(e,r,1),--this.size,!0}var tI=eI,rI=ko;function iI(t){var e=this.__data__,r=rI(e,t);return r<0?void 0:e[r][1]}var nI=iI,sI=ko;function aI(t){return sI(this.__data__,t)>-1}var oI=aI,cI=ko;function fI(t,e){var r=this.__data__,i=cI(r,t);return i<0?(++this.size,r.push([t,e])):r[i][1]=e,this}var dI=fI,hI=Wx,uI=tI,lI=nI,pI=oI,bI=dI;function Un(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var i=t[e];this.set(i[0],i[1])}}Un.prototype.clear=hI,Un.prototype.delete=uI,Un.prototype.get=lI,Un.prototype.has=pI,Un.prototype.set=bI;var Ho=Un,gI=Ho;function vI(){this.__data__=new gI,this.size=0}var yI=vI;function mI(t){var e=this.__data__,r=e.delete(t);return this.size=e.size,r}var wI=mI;function _I(t){return this.__data__.get(t)}var EI=_I;function SI(t){return this.__data__.has(t)}var $I=SI,xI=typeof Oa=="object"&&Oa&&Oa.Object===Object&&Oa,yb=xI,II=yb,MI=typeof self=="object"&&self&&self.Object===Object&&self,AI=II||MI||Function("return this")(),ps=AI,PI=ps,OI=PI.Symbol,mb=OI,Wl=mb,wb=Object.prototype,RI=wb.hasOwnProperty,FI=wb.toString,Ps=Wl?Wl.toStringTag:void 0;function NI(t){var e=RI.call(t,Ps),r=t[Ps];try{t[Ps]=void 0;var i=!0}catch{}var n=FI.call(t);return i&&(e?t[Ps]=r:delete t[Ps]),n}var CI=NI,TI=Object.prototype,BI=TI.toString;function qI(t){return BI.call(t)}var LI=qI,Gl=mb,DI=CI,UI=LI,zI="[object Null]",jI="[object Undefined]",Jl=Gl?Gl.toStringTag:void 0;function kI(t){return t==null?t===void 0?jI:zI:Jl&&Jl in Object(t)?DI(t):UI(t)}var Ko=kI;function HI(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}var xn=HI,KI=Ko,VI=xn,WI="[object AsyncFunction]",GI="[object Function]",JI="[object GeneratorFunction]",YI="[object Proxy]";function ZI(t){if(!VI(t))return!1;var e=KI(t);return e==GI||e==JI||e==WI||e==YI}var xd=ZI,XI=ps,QI=XI["__core-js_shared__"],eM=QI,kc=eM,Yl=function(){var t=/[^.]+$/.exec(kc&&kc.keys&&kc.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}();function tM(t){return!!Yl&&Yl in t}var rM=tM,iM=Function.prototype,nM=iM.toString;function sM(t){if(t!=null){try{return nM.call(t)}catch{}try{return t+""}catch{}}return""}var aM=sM,oM=xd,cM=rM,fM=xn,dM=aM,hM=/[\\^$.*+?()[\]{}|]/g,uM=/^\[object .+?Constructor\]$/,lM=Function.prototype,pM=Object.prototype,bM=lM.toString,gM=pM.hasOwnProperty,vM=RegExp("^"+bM.call(gM).replace(hM,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function yM(t){if(!fM(t)||cM(t))return!1;var e=oM(t)?vM:uM;return e.test(dM(t))}var mM=yM;function wM(t,e){return t==null?void 0:t[e]}var _M=wM,EM=mM,SM=_M;function $M(t,e){var r=SM(t,e);return EM(r)?r:void 0}var Id=$M,xM=Id,IM=ps,MM=xM(IM,"Map"),_b=MM,AM=Id,PM=AM(Object,"create"),Vo=PM,Zl=Vo;function OM(){this.__data__=Zl?Zl(null):{},this.size=0}var RM=OM;function FM(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}var NM=FM,CM=Vo,TM="__lodash_hash_undefined__",BM=Object.prototype,qM=BM.hasOwnProperty;function LM(t){var e=this.__data__;if(CM){var r=e[t];return r===TM?void 0:r}return qM.call(e,t)?e[t]:void 0}var DM=LM,UM=Vo,zM=Object.prototype,jM=zM.hasOwnProperty;function kM(t){var e=this.__data__;return UM?e[t]!==void 0:jM.call(e,t)}var HM=kM,KM=Vo,VM="__lodash_hash_undefined__";function WM(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=KM&&e===void 0?VM:e,this}var GM=WM,JM=RM,YM=NM,ZM=DM,XM=HM,QM=GM;function zn(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var i=t[e];this.set(i[0],i[1])}}zn.prototype.clear=JM,zn.prototype.delete=YM,zn.prototype.get=ZM,zn.prototype.has=XM,zn.prototype.set=QM;var eA=zn,Xl=eA,tA=Ho,rA=_b;function iA(){this.size=0,this.__data__={hash:new Xl,map:new(rA||tA),string:new Xl}}var nA=iA;function sA(t){var e=typeof t;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?t!=="__proto__":t===null}var aA=sA,oA=aA;function cA(t,e){var r=t.__data__;return oA(e)?r[typeof e=="string"?"string":"hash"]:r.map}var Wo=cA,fA=Wo;function dA(t){var e=fA(this,t).delete(t);return this.size-=e?1:0,e}var hA=dA,uA=Wo;function lA(t){return uA(this,t).get(t)}var pA=lA,bA=Wo;function gA(t){return bA(this,t).has(t)}var vA=gA,yA=Wo;function mA(t,e){var r=yA(this,t),i=r.size;return r.set(t,e),this.size+=r.size==i?0:1,this}var wA=mA,_A=nA,EA=hA,SA=pA,$A=vA,xA=wA;function jn(t){var e=-1,r=t==null?0:t.length;for(this.clear();++e<r;){var i=t[e];this.set(i[0],i[1])}}jn.prototype.clear=_A,jn.prototype.delete=EA,jn.prototype.get=SA,jn.prototype.has=$A,jn.prototype.set=xA;var IA=jn,MA=Ho,AA=_b,PA=IA,OA=200;function RA(t,e){var r=this.__data__;if(r instanceof MA){var i=r.__data__;if(!AA||i.length<OA-1)return i.push([t,e]),this.size=++r.size,this;r=this.__data__=new PA(i)}return r.set(t,e),this.size=r.size,this}var FA=RA,NA=Ho,CA=yI,TA=wI,BA=EI,qA=$I,LA=FA;function kn(t){var e=this.__data__=new NA(t);this.size=e.size}kn.prototype.clear=CA,kn.prototype.delete=TA,kn.prototype.get=BA,kn.prototype.has=qA,kn.prototype.set=LA;var DA=kn,UA=Id,zA=function(){try{var t=UA(Object,"defineProperty");return t({},"",{}),t}catch{}}(),Eb=zA,Ql=Eb;function jA(t,e,r){e=="__proto__"&&Ql?Ql(t,e,{configurable:!0,enumerable:!0,value:r,writable:!0}):t[e]=r}var Md=jA,kA=Md,HA=jo;function KA(t,e,r){(r!==void 0&&!HA(t[e],r)||r===void 0&&!(e in t))&&kA(t,e,r)}var Sb=KA;function VA(t){return function(e,r,i){for(var n=-1,s=Object(e),a=i(e),c=a.length;c--;){var d=a[t?c:++n];if(r(s[d],d,s)===!1)break}return e}}var WA=VA,GA=WA,JA=GA(),YA=JA,Cf={exports:{}};(function(t,e){var r=ps,i=e&&!e.nodeType&&e,n=i&&!0&&t&&!t.nodeType&&t,s=n&&n.exports===i,a=s?r.Buffer:void 0,c=a?a.allocUnsafe:void 0;function d(u,l){if(l)return u.slice();var g=u.length,w=c?c(g):new u.constructor(g);return u.copy(w),w}t.exports=d})(Cf,Cf.exports);var ZA=ps,XA=ZA.Uint8Array,QA=XA,e0=QA;function eP(t){var e=new t.constructor(t.byteLength);return new e0(e).set(new e0(t)),e}var tP=eP,rP=tP;function iP(t,e){var r=e?rP(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.length)}var nP=iP;function sP(t,e){var r=-1,i=t.length;for(e||(e=Array(i));++r<i;)e[r]=t[r];return e}var aP=sP,oP=xn,t0=Object.create,cP=function(){function t(){}return function(e){if(!oP(e))return{};if(t0)return t0(e);t.prototype=e;var r=new t;return t.prototype=void 0,r}}(),fP=cP;function dP(t,e){return function(r){return t(e(r))}}var hP=dP,uP=hP,lP=uP(Object.getPrototypeOf,Object),$b=lP,pP=Object.prototype;function bP(t){var e=t&&t.constructor,r=typeof e=="function"&&e.prototype||pP;return t===r}var xb=bP,gP=fP,vP=$b,yP=xb;function mP(t){return typeof t.constructor=="function"&&!yP(t)?gP(vP(t)):{}}var wP=mP;function _P(t){return t!=null&&typeof t=="object"}var ca=_P,EP=Ko,SP=ca,$P="[object Arguments]";function xP(t){return SP(t)&&EP(t)==$P}var IP=xP,r0=IP,MP=ca,Ib=Object.prototype,AP=Ib.hasOwnProperty,PP=Ib.propertyIsEnumerable,OP=r0(function(){return arguments}())?r0:function(t){return MP(t)&&AP.call(t,"callee")&&!PP.call(t,"callee")},Mb=OP,RP=Array.isArray,Ab=RP,FP=9007199254740991;function NP(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=FP}var Pb=NP,CP=xd,TP=Pb;function BP(t){return t!=null&&TP(t.length)&&!CP(t)}var Ad=BP,qP=Ad,LP=ca;function DP(t){return LP(t)&&qP(t)}var UP=DP,oo={exports:{}};function zP(){return!1}var jP=zP;(function(t,e){var r=ps,i=jP,n=e&&!e.nodeType&&e,s=n&&!0&&t&&!t.nodeType&&t,a=s&&s.exports===n,c=a?r.Buffer:void 0,d=c?c.isBuffer:void 0,u=d||i;t.exports=u})(oo,oo.exports);var kP=Ko,HP=$b,KP=ca,VP="[object Object]",WP=Function.prototype,GP=Object.prototype,Ob=WP.toString,JP=GP.hasOwnProperty,YP=Ob.call(Object);function ZP(t){if(!KP(t)||kP(t)!=VP)return!1;var e=HP(t);if(e===null)return!0;var r=JP.call(e,"constructor")&&e.constructor;return typeof r=="function"&&r instanceof r&&Ob.call(r)==YP}var XP=ZP,QP=Ko,eO=Pb,tO=ca,rO="[object Arguments]",iO="[object Array]",nO="[object Boolean]",sO="[object Date]",aO="[object Error]",oO="[object Function]",cO="[object Map]",fO="[object Number]",dO="[object Object]",hO="[object RegExp]",uO="[object Set]",lO="[object String]",pO="[object WeakMap]",bO="[object ArrayBuffer]",gO="[object DataView]",vO="[object Float32Array]",yO="[object Float64Array]",mO="[object Int8Array]",wO="[object Int16Array]",_O="[object Int32Array]",EO="[object Uint8Array]",SO="[object Uint8ClampedArray]",$O="[object Uint16Array]",xO="[object Uint32Array]",Je={};Je[vO]=Je[yO]=Je[mO]=Je[wO]=Je[_O]=Je[EO]=Je[SO]=Je[$O]=Je[xO]=!0,Je[rO]=Je[iO]=Je[bO]=Je[nO]=Je[gO]=Je[sO]=Je[aO]=Je[oO]=Je[cO]=Je[fO]=Je[dO]=Je[hO]=Je[uO]=Je[lO]=Je[pO]=!1;function IO(t){return tO(t)&&eO(t.length)&&!!Je[QP(t)]}var MO=IO;function AO(t){return function(e){return t(e)}}var PO=AO,Tf={exports:{}};(function(t,e){var r=yb,i=e&&!e.nodeType&&e,n=i&&!0&&t&&!t.nodeType&&t,s=n&&n.exports===i,a=s&&r.process,c=function(){try{var d=n&&n.require&&n.require("util").types;return d||a&&a.binding&&a.binding("util")}catch{}}();t.exports=c})(Tf,Tf.exports);var OO=MO,RO=PO,i0=Tf.exports,n0=i0&&i0.isTypedArray,FO=n0?RO(n0):OO,Rb=FO;function NO(t,e){if(!(e==="constructor"&&typeof t[e]=="function")&&e!="__proto__")return t[e]}var Fb=NO,CO=Md,TO=jo,BO=Object.prototype,qO=BO.hasOwnProperty;function LO(t,e,r){var i=t[e];(!(qO.call(t,e)&&TO(i,r))||r===void 0&&!(e in t))&&CO(t,e,r)}var DO=LO,UO=DO,zO=Md;function jO(t,e,r,i){var n=!r;r||(r={});for(var s=-1,a=e.length;++s<a;){var c=e[s],d=i?i(r[c],t[c],c,r,t):void 0;d===void 0&&(d=t[c]),n?zO(r,c,d):UO(r,c,d)}return r}var kO=jO;function HO(t,e){for(var r=-1,i=Array(t);++r<t;)i[r]=e(r);return i}var KO=HO,VO=9007199254740991,WO=/^(?:0|[1-9]\d*)$/;function GO(t,e){var r=typeof t;return e=e??VO,!!e&&(r=="number"||r!="symbol"&&WO.test(t))&&t>-1&&t%1==0&&t<e}var Nb=GO,JO=KO,YO=Mb,ZO=Ab,XO=oo.exports,QO=Nb,eR=Rb,tR=Object.prototype,rR=tR.hasOwnProperty;function iR(t,e){var r=ZO(t),i=!r&&YO(t),n=!r&&!i&&XO(t),s=!r&&!i&&!n&&eR(t),a=r||i||n||s,c=a?JO(t.length,String):[],d=c.length;for(var u in t)(e||rR.call(t,u))&&!(a&&(u=="length"||n&&(u=="offset"||u=="parent")||s&&(u=="buffer"||u=="byteLength"||u=="byteOffset")||QO(u,d)))&&c.push(u);return c}var nR=iR;function sR(t){var e=[];if(t!=null)for(var r in Object(t))e.push(r);return e}var aR=sR,oR=xn,cR=xb,fR=aR,dR=Object.prototype,hR=dR.hasOwnProperty;function uR(t){if(!oR(t))return fR(t);var e=cR(t),r=[];for(var i in t)i=="constructor"&&(e||!hR.call(t,i))||r.push(i);return r}var lR=uR,pR=nR,bR=lR,gR=Ad;function vR(t){return gR(t)?pR(t,!0):bR(t)}var Cb=vR,yR=kO,mR=Cb;function wR(t){return yR(t,mR(t))}var _R=wR,s0=Sb,ER=Cf.exports,SR=nP,$R=aP,xR=wP,a0=Mb,o0=Ab,IR=UP,MR=oo.exports,AR=xd,PR=xn,OR=XP,RR=Rb,c0=Fb,FR=_R;function NR(t,e,r,i,n,s,a){var c=c0(t,r),d=c0(e,r),u=a.get(d);if(u){s0(t,r,u);return}var l=s?s(c,d,r+"",t,e,a):void 0,g=l===void 0;if(g){var w=o0(d),E=!w&&MR(d),$=!w&&!E&&RR(d);l=d,w||E||$?o0(c)?l=c:IR(c)?l=$R(c):E?(g=!1,l=ER(d,!0)):$?(g=!1,l=SR(d,!0)):l=[]:OR(d)||a0(d)?(l=c,a0(c)?l=FR(c):(!PR(c)||AR(c))&&(l=xR(d))):g=!1}g&&(a.set(d,l),n(l,d,i,s,a),a.delete(d)),s0(t,r,l)}var CR=NR,TR=DA,BR=Sb,qR=YA,LR=CR,DR=xn,UR=Cb,zR=Fb;function Tb(t,e,r,i,n){t!==e&&qR(e,function(s,a){if(n||(n=new TR),DR(s))LR(t,e,a,r,Tb,i,n);else{var c=i?i(zR(t,a),s,a+"",t,e,n):void 0;c===void 0&&(c=s),BR(t,a,c)}},UR)}var jR=Tb;function kR(t){return t}var Bb=kR;function HR(t,e,r){switch(r.length){case 0:return t.call(e);case 1:return t.call(e,r[0]);case 2:return t.call(e,r[0],r[1]);case 3:return t.call(e,r[0],r[1],r[2])}return t.apply(e,r)}var KR=HR,VR=KR,f0=Math.max;function WR(t,e,r){return e=f0(e===void 0?t.length-1:e,0),function(){for(var i=arguments,n=-1,s=f0(i.length-e,0),a=Array(s);++n<s;)a[n]=i[e+n];n=-1;for(var c=Array(e+1);++n<e;)c[n]=i[n];return c[e]=r(a),VR(t,this,c)}}var GR=WR;function JR(t){return function(){return t}}var YR=JR,ZR=YR,d0=Eb,XR=Bb,QR=d0?function(t,e){return d0(t,"toString",{configurable:!0,enumerable:!1,value:ZR(e),writable:!0})}:XR,eF=QR,tF=800,rF=16,iF=Date.now;function nF(t){var e=0,r=0;return function(){var i=iF(),n=rF-(i-r);if(r=i,n>0){if(++e>=tF)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}var sF=nF,aF=eF,oF=sF,cF=oF(aF),fF=cF,dF=Bb,hF=GR,uF=fF;function lF(t,e){return uF(hF(t,e,dF),t+"")}var pF=lF,bF=jo,gF=Ad,vF=Nb,yF=xn;function mF(t,e,r){if(!yF(r))return!1;var i=typeof e;return(i=="number"?gF(r)&&vF(e,r.length):i=="string"&&e in r)?bF(r[e],t):!1}var wF=mF,_F=pF,EF=wF;function SF(t){return _F(function(e,r){var i=-1,n=r.length,s=n>1?r[n-1]:void 0,a=n>2?r[2]:void 0;for(s=t.length>3&&typeof s=="function"?(n--,s):void 0,a&&EF(r[0],r[1],a)&&(s=n<3?void 0:s,n=1),e=Object(e);++i<n;){var c=r[i];c&&t(e,c,i,s)}return e})}var $F=SF,xF=jR,IF=$F,MF=IF(function(t,e,r){xF(t,e,r)}),AF=MF,PF=Object.defineProperty,OF=Object.defineProperties,RF=Object.getOwnPropertyDescriptors,h0=Object.getOwnPropertySymbols,FF=Object.prototype.hasOwnProperty,NF=Object.prototype.propertyIsEnumerable,u0=(t,e,r)=>e in t?PF(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Ra=(t,e)=>{for(var r in e||(e={}))FF.call(e,r)&&u0(t,r,e[r]);if(h0)for(var r of h0(e))NF.call(e,r)&&u0(t,r,e[r]);return t},CF=(t,e)=>OF(t,RF(e));function rr(t,e,r){var i;const n=Jn(t);return((i=e.rpcMap)==null?void 0:i[n.reference])||`${vb}?chainId=${n.namespace}:${n.reference}&projectId=${r}`}function In(t){return t.includes(":")?t.split(":")[1]:t}function qb(t){return t.map(e=>`${e.split(":")[0]}:${e.split(":")[1]}`)}function TF(t,e){const r=Object.keys(e.namespaces).filter(n=>n.includes(t));if(!r.length)return[];const i=[];return r.forEach(n=>{const s=e.namespaces[n].accounts;i.push(...s)}),i}function Hc(t={},e={}){const r=l0(t),i=l0(e);return AF(r,i)}function l0(t){var e,r,i,n;const s={};if(!js(t))return s;for(const[a,c]of Object.entries(t)){const d=Ed(a)?[a]:c.chains,u=c.methods||[],l=c.events||[],g=c.rpcMap||{},w=Rs(a);s[w]=CF(Ra(Ra({},s[w]),c),{chains:La(d,(e=s[w])==null?void 0:e.chains),methods:La(u,(r=s[w])==null?void 0:r.methods),events:La(l,(i=s[w])==null?void 0:i.events),rpcMap:Ra(Ra({},g),(n=s[w])==null?void 0:n.rpcMap)})}return s}function BF(t){return t.includes(":")?t.split(":")[2]:t}function p0(t){const e={};for(const[r,i]of Object.entries(t)){const n=i.methods||[],s=i.events||[],a=i.accounts||[],c=Ed(r)?[r]:i.chains?i.chains:qb(i.accounts);e[r]={chains:c,methods:n,events:s,accounts:a}}return e}function Kc(t){return typeof t=="number"?t:t.includes("0x")?parseInt(t,16):(t=t.includes(":")?t.split(":")[1]:t,isNaN(Number(t))?t:Number(t))}const Lb={},ze=t=>Lb[t],Vc=(t,e)=>{Lb[t]=e};class qF{constructor(e){this.name="polkadot",this.namespace=e.namespace,this.events=ze("events"),this.client=ze("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,r){this.httpProviders[e]||this.setHttpProvider(e,r),this.chainId=e,this.events.emit(mr.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getAccounts(){const e=this.namespace.accounts;return e?e.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2])||[]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(r=>{var i;const n=In(r);e[n]=this.createHttpProvider(n,(i=this.namespace.rpcMap)==null?void 0:i[r])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,r=this.httpProviders[e];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return r}setHttpProvider(e,r){const i=this.createHttpProvider(e,r);i&&(this.httpProviders[e]=i)}createHttpProvider(e,r){const i=r||rr(e,this.namespace,this.client.core.projectId);if(!i)throw new Error(`No RPC url provided for chainId: ${e}`);return new yr(new Tr(i,ze("disableProviderPing")))}}var LF=Object.defineProperty,DF=Object.defineProperties,UF=Object.getOwnPropertyDescriptors,b0=Object.getOwnPropertySymbols,zF=Object.prototype.hasOwnProperty,jF=Object.prototype.propertyIsEnumerable,g0=(t,e,r)=>e in t?LF(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,v0=(t,e)=>{for(var r in e||(e={}))zF.call(e,r)&&g0(t,r,e[r]);if(b0)for(var r of b0(e))jF.call(e,r)&&g0(t,r,e[r]);return t},y0=(t,e)=>DF(t,UF(e));class kF{constructor(e){this.name="eip155",this.namespace=e.namespace,this.events=ze("events"),this.client=ze("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(e){switch(e.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(e);case"eth_chainId":return parseInt(this.getDefaultChain());case"wallet_getCapabilities":return await this.getCapabilities(e);case"wallet_getCallsStatus":return await this.getCallStatus(e)}return this.namespace.methods.includes(e.request.method)?await this.client.request(e):this.getHttpProvider().request(e.request)}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}setDefaultChain(e,r){this.httpProviders[e]||this.setHttpProvider(parseInt(e),r),this.chainId=parseInt(e),this.events.emit(mr.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}createHttpProvider(e,r){const i=r||rr(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!i)throw new Error(`No RPC url provided for chainId: ${e}`);return new yr(new Tr(i,ze("disableProviderPing")))}setHttpProvider(e,r){const i=this.createHttpProvider(e,r);i&&(this.httpProviders[e]=i)}createHttpProviders(){const e={};return this.namespace.chains.forEach(r=>{var i;const n=parseInt(In(r));e[n]=this.createHttpProvider(n,(i=this.namespace.rpcMap)==null?void 0:i[r])}),e}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}getHttpProvider(){const e=this.chainId,r=this.httpProviders[e];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return r}async handleSwitchChain(e){var r,i;let n=e.request.params?(r=e.request.params[0])==null?void 0:r.chainId:"0x0";n=n.startsWith("0x")?n:`0x${n}`;const s=parseInt(n,16);if(this.isChainApproved(s))this.setDefaultChain(`${s}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))await this.client.request({topic:e.topic,request:{method:e.request.method,params:[{chainId:n}]},chainId:(i=this.namespace.chains)==null?void 0:i[0]}),this.setDefaultChain(`${s}`);else throw new Error(`Failed to switch to chain 'eip155:${s}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null}isChainApproved(e){return this.namespace.chains.includes(`${this.name}:${e}`)}async getCapabilities(e){var r,i,n;const s=(i=(r=e.request)==null?void 0:r.params)==null?void 0:i[0];if(!s)throw new Error("Missing address parameter in `wallet_getCapabilities` request");const a=this.client.session.get(e.topic),c=((n=a==null?void 0:a.sessionProperties)==null?void 0:n.capabilities)||{};if(c!=null&&c[s])return c==null?void 0:c[s];const d=await this.client.request(e);try{await this.client.session.update(e.topic,{sessionProperties:y0(v0({},a.sessionProperties||{}),{capabilities:y0(v0({},c||{}),{[s]:d})})})}catch(u){console.warn("Failed to update session with capabilities",u)}return d}async getCallStatus(e){var r,i;const n=this.client.session.get(e.topic),s=(r=n.sessionProperties)==null?void 0:r.bundler_name;if(s){const c=this.getBundlerUrl(e.chainId,s);try{return await this.getUserOperationReceipt(c,e)}catch(d){console.warn("Failed to fetch call status from bundler",d,c)}}const a=(i=n.sessionProperties)==null?void 0:i.bundler_url;if(a)try{return await this.getUserOperationReceipt(a,e)}catch(c){console.warn("Failed to fetch call status from custom bundler",c,a)}if(this.namespace.methods.includes(e.request.method))return await this.client.request(e);throw new Error("Fetching call status not approved by the wallet.")}async getUserOperationReceipt(e,r){var i;const n=new URL(e),s=await fetch(n,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Ei("eth_getUserOperationReceipt",[(i=r.request.params)==null?void 0:i[0]]))});if(!s.ok)throw new Error(`Failed to fetch user operation receipt - ${s.status}`);return await s.json()}getBundlerUrl(e,r){return`${Kx}?projectId=${this.client.core.projectId}&chainId=${e}&bundler=${r}`}}class HF{constructor(e){this.name="solana",this.namespace=e.namespace,this.events=ze("events"),this.client=ze("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,r){this.httpProviders[e]||this.setHttpProvider(e,r),this.chainId=e,this.events.emit(mr.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(r=>{var i;const n=In(r);e[n]=this.createHttpProvider(n,(i=this.namespace.rpcMap)==null?void 0:i[r])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,r=this.httpProviders[e];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return r}setHttpProvider(e,r){const i=this.createHttpProvider(e,r);i&&(this.httpProviders[e]=i)}createHttpProvider(e,r){const i=r||rr(e,this.namespace,this.client.core.projectId);if(!i)throw new Error(`No RPC url provided for chainId: ${e}`);return new yr(new Tr(i,ze("disableProviderPing")))}}class KF{constructor(e){this.name="cosmos",this.namespace=e.namespace,this.events=ze("events"),this.client=ze("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,r){this.httpProviders[e]||this.setHttpProvider(e,r),this.chainId=e,this.events.emit(mr.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(r=>{var i;const n=In(r);e[n]=this.createHttpProvider(n,(i=this.namespace.rpcMap)==null?void 0:i[r])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,r=this.httpProviders[e];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return r}setHttpProvider(e,r){const i=this.createHttpProvider(e,r);i&&(this.httpProviders[e]=i)}createHttpProvider(e,r){const i=r||rr(e,this.namespace,this.client.core.projectId);if(!i)throw new Error(`No RPC url provided for chainId: ${e}`);return new yr(new Tr(i,ze("disableProviderPing")))}}class VF{constructor(e){this.name="algorand",this.namespace=e.namespace,this.events=ze("events"),this.client=ze("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,r){if(!this.httpProviders[e]){const i=r||rr(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!i)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,i)}this.chainId=e,this.events.emit(mr.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(r=>{var i;e[r]=this.createHttpProvider(r,(i=this.namespace.rpcMap)==null?void 0:i[r])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,r=this.httpProviders[e];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return r}setHttpProvider(e,r){const i=this.createHttpProvider(e,r);i&&(this.httpProviders[e]=i)}createHttpProvider(e,r){const i=r||rr(e,this.namespace,this.client.core.projectId);return typeof i>"u"?void 0:new yr(new Tr(i,ze("disableProviderPing")))}}class WF{constructor(e){this.name="cip34",this.namespace=e.namespace,this.events=ze("events"),this.client=ze("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,r){this.httpProviders[e]||this.setHttpProvider(e,r),this.chainId=e,this.events.emit(mr.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(r=>{const i=this.getCardanoRPCUrl(r),n=In(r);e[n]=this.createHttpProvider(n,i)}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,r=this.httpProviders[e];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return r}getCardanoRPCUrl(e){const r=this.namespace.rpcMap;if(r)return r[e]}setHttpProvider(e,r){const i=this.createHttpProvider(e,r);i&&(this.httpProviders[e]=i)}createHttpProvider(e,r){const i=r||this.getCardanoRPCUrl(e);if(!i)throw new Error(`No RPC url provided for chainId: ${e}`);return new yr(new Tr(i,ze("disableProviderPing")))}}class GF{constructor(e){this.name="elrond",this.namespace=e.namespace,this.events=ze("events"),this.client=ze("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,r){this.httpProviders[e]||this.setHttpProvider(e,r),this.chainId=e,this.events.emit(mr.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(r=>{var i;const n=In(r);e[n]=this.createHttpProvider(n,(i=this.namespace.rpcMap)==null?void 0:i[r])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,r=this.httpProviders[e];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return r}setHttpProvider(e,r){const i=this.createHttpProvider(e,r);i&&(this.httpProviders[e]=i)}createHttpProvider(e,r){const i=r||rr(e,this.namespace,this.client.core.projectId);if(!i)throw new Error(`No RPC url provided for chainId: ${e}`);return new yr(new Tr(i,ze("disableProviderPing")))}}class JF{constructor(e){this.name="multiversx",this.namespace=e.namespace,this.events=ze("events"),this.client=ze("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,r){this.httpProviders[e]||this.setHttpProvider(e,r),this.chainId=e,this.events.emit(mr.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(r=>{var i;const n=In(r);e[n]=this.createHttpProvider(n,(i=this.namespace.rpcMap)==null?void 0:i[r])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,r=this.httpProviders[e];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return r}setHttpProvider(e,r){const i=this.createHttpProvider(e,r);i&&(this.httpProviders[e]=i)}createHttpProvider(e,r){const i=r||rr(e,this.namespace,this.client.core.projectId);if(!i)throw new Error(`No RPC url provided for chainId: ${e}`);return new yr(new Tr(i,ze("disableProviderPing")))}}class YF{constructor(e){this.name="near",this.namespace=e.namespace,this.events=ze("events"),this.client=ze("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,r){if(this.chainId=e,!this.httpProviders[e]){const i=r||rr(`${this.name}:${e}`,this.namespace);if(!i)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,i)}this.events.emit(mr.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?e.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2])||[]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(r=>{var i;e[r]=this.createHttpProvider(r,(i=this.namespace.rpcMap)==null?void 0:i[r])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,r=this.httpProviders[e];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return r}setHttpProvider(e,r){const i=this.createHttpProvider(e,r);i&&(this.httpProviders[e]=i)}createHttpProvider(e,r){const i=r||rr(e,this.namespace);return typeof i>"u"?void 0:new yr(new Tr(i,ze("disableProviderPing")))}}class ZF{constructor(e){this.name="tezos",this.namespace=e.namespace,this.events=ze("events"),this.client=ze("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,r){if(this.chainId=e,!this.httpProviders[e]){const i=r||rr(`${this.name}:${e}`,this.namespace);if(!i)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,i)}this.events.emit(mr.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?e.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2])||[]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(r=>{e[r]=this.createHttpProvider(r)}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,r=this.httpProviders[e];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return r}setHttpProvider(e,r){const i=this.createHttpProvider(e,r);i&&(this.httpProviders[e]=i)}createHttpProvider(e,r){const i=r||rr(e,this.namespace);return typeof i>"u"?void 0:new yr(new Tr(i))}}class XF{constructor(e){this.name=Dn,this.namespace=e.namespace,this.events=ze("events"),this.client=ze("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace.chains=[...new Set((this.namespace.chains||[]).concat(e.chains||[]))],this.namespace.accounts=[...new Set((this.namespace.accounts||[]).concat(e.accounts||[]))],this.namespace.methods=[...new Set((this.namespace.methods||[]).concat(e.methods||[]))],this.namespace.events=[...new Set((this.namespace.events||[]).concat(e.events||[]))],this.httpProviders=this.createHttpProviders()}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider(e.chainId).request(e.request)}setDefaultChain(e,r){this.httpProviders[e]||this.setHttpProvider(e,r),this.chainId=e,this.events.emit(mr.DEFAULT_CHAIN_CHANGED,`${this.name}:${e}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){var e,r;const i={};return(r=(e=this.namespace)==null?void 0:e.accounts)==null||r.forEach(n=>{const s=Jn(n);i[`${s.namespace}:${s.reference}`]=this.createHttpProvider(n)}),i}getHttpProvider(e){const r=this.httpProviders[e];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return r}setHttpProvider(e,r){const i=this.createHttpProvider(e,r);i&&(this.httpProviders[e]=i)}createHttpProvider(e,r){const i=r||rr(e,this.namespace,this.client.core.projectId);if(!i)throw new Error(`No RPC url provided for chainId: ${e}`);return new yr(new Tr(i,ze("disableProviderPing")))}}var QF=Object.defineProperty,eN=Object.defineProperties,tN=Object.getOwnPropertyDescriptors,m0=Object.getOwnPropertySymbols,rN=Object.prototype.hasOwnProperty,iN=Object.prototype.propertyIsEnumerable,w0=(t,e,r)=>e in t?QF(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Fa=(t,e)=>{for(var r in e||(e={}))rN.call(e,r)&&w0(t,r,e[r]);if(m0)for(var r of m0(e))iN.call(e,r)&&w0(t,r,e[r]);return t},Wc=(t,e)=>eN(t,tN(e));let nN=class Db{constructor(e){this.events=new Bf,this.rpcProviders={},this.shouldAbortPairingAttempt=!1,this.maxPairingAttempts=10,this.disableProviderPing=!1,this.providerOpts=e,this.logger=typeof(e==null?void 0:e.logger)<"u"&&typeof(e==null?void 0:e.logger)!="string"?e.logger:Zs(Io({level:(e==null?void 0:e.logger)||Kl})),this.disableProviderPing=(e==null?void 0:e.disableProviderPing)||!1}static async init(e){const r=new Db(e);return await r.initialize(),r}async request(e,r,i){const[n,s]=this.validateChain(r);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(n).request({request:Fa({},e),chainId:`${n}:${s}`,topic:this.session.topic,expiry:i})}sendAsync(e,r,i,n){const s=new Date().getTime();this.request(e,i,n).then(a=>r(null,po(s,a))).catch(a=>r(a,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties}),await this.requestAccounts()}async disconnect(){var e;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(e=this.session)==null?void 0:e.topic,reason:je("USER_DISCONNECTED")}),await this.cleanup()}async connect(e){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(e),await this.cleanupPendingPairings(),!e.skipPairing)return await this.pair(e.pairingTopic)}async authenticate(e,r){if(!this.client)throw new Error("Sign Client not initialized");this.setNamespaces(e),await this.cleanupPendingPairings();const{uri:i,response:n}=await this.client.authenticate(e,r);i&&(this.uri=i,this.events.emit("display_uri",i));const s=await n();if(this.session=s.session,this.session){const a=p0(this.session.namespaces);this.namespaces=Hc(this.namespaces,a),this.persist("namespaces",this.namespaces),this.onConnect()}return s}on(e,r){this.events.on(e,r)}once(e,r){this.events.once(e,r)}removeListener(e,r){this.events.removeListener(e,r)}off(e,r){this.events.off(e,r)}get isWalletConnect(){return!0}async pair(e){this.shouldAbortPairingAttempt=!1;let r=0;do{if(this.shouldAbortPairingAttempt)throw new Error("Pairing aborted");if(r>=this.maxPairingAttempts)throw new Error("Max auto pairing attempts reached");const{uri:i,approval:n}=await this.client.connect({pairingTopic:e,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties});i&&(this.uri=i,this.events.emit("display_uri",i)),await n().then(s=>{this.session=s;const a=p0(s.namespaces);this.namespaces=Hc(this.namespaces,a),this.persist("namespaces",this.namespaces)}).catch(s=>{if(s.message!==bb)throw s;r++})}while(!this.session);return this.onConnect(),this.session}setDefaultChain(e,r){try{if(!this.session)return;const[i,n]=this.validateChain(e),s=this.getProvider(i);s.name===Dn?s.setDefaultChain(`${i}:${n}`,r):s.setDefaultChain(n,r)}catch(i){if(!/Please call connect/.test(i.message))throw i}}async cleanupPendingPairings(e={}){this.logger.info("Cleaning up inactive pairings...");const r=this.client.pairing.getAll();if(rs(r)){for(const i of r)e.deletePairings?this.client.core.expirer.set(i.topic,0):await this.client.core.relayer.subscriber.unsubscribe(i.topic);this.logger.info(`Inactive pairings cleared: ${r.length}`)}}abortPairingAttempt(){this.shouldAbortPairingAttempt=!0}async checkStorage(){if(this.namespaces=await this.getFromStore("namespaces"),this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.client.session.length){const e=this.client.session.keys.length-1;this.session=this.client.session.get(this.client.session.keys[e]),this.createProviders()}}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){this.client=this.providerOpts.client||await Cx.init({core:this.providerOpts.core,logger:this.providerOpts.logger||Kl,relayUrl:this.providerOpts.relayUrl||jx,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,storage:this.providerOpts.storage,name:this.providerOpts.name,customStoragePrefix:this.providerOpts.customStoragePrefix,telemetryEnabled:this.providerOpts.telemetryEnabled}),this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");const e=[...new Set(Object.keys(this.session.namespaces).map(r=>Rs(r)))];Vc("client",this.client),Vc("events",this.events),Vc("disableProviderPing",this.disableProviderPing),e.forEach(r=>{if(!this.session)return;const i=TF(r,this.session),n=qb(i),s=Hc(this.namespaces,this.optionalNamespaces),a=Wc(Fa({},s[r]),{accounts:i,chains:n});switch(r){case"eip155":this.rpcProviders[r]=new kF({namespace:a});break;case"algorand":this.rpcProviders[r]=new VF({namespace:a});break;case"solana":this.rpcProviders[r]=new HF({namespace:a});break;case"cosmos":this.rpcProviders[r]=new KF({namespace:a});break;case"polkadot":this.rpcProviders[r]=new qF({namespace:a});break;case"cip34":this.rpcProviders[r]=new WF({namespace:a});break;case"elrond":this.rpcProviders[r]=new GF({namespace:a});break;case"multiversx":this.rpcProviders[r]=new JF({namespace:a});break;case"near":this.rpcProviders[r]=new YF({namespace:a});break;case"tezos":this.rpcProviders[r]=new ZF({namespace:a});break;default:this.rpcProviders[Dn]?this.rpcProviders[Dn].updateNamespace(a):this.rpcProviders[Dn]=new XF({namespace:a})}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",e=>{this.events.emit("session_ping",e)}),this.client.on("session_event",e=>{const{params:r}=e,{event:i}=r;if(i.name==="accountsChanged"){const n=i.data;n&&rs(n)&&this.events.emit("accountsChanged",n.map(BF))}else if(i.name==="chainChanged"){const n=r.chainId,s=r.event.data,a=Rs(n),c=Kc(n)!==Kc(s)?`${a}:${Kc(s)}`:n;this.onChainChanged(c)}else this.events.emit(i.name,i.data);this.events.emit("session_event",e)}),this.client.on("session_update",({topic:e,params:r})=>{var i;const{namespaces:n}=r,s=(i=this.client)==null?void 0:i.session.get(e);this.session=Wc(Fa({},s),{namespaces:n}),this.onSessionUpdate(),this.events.emit("session_update",{topic:e,params:r})}),this.client.on("session_delete",async e=>{await this.cleanup(),this.events.emit("session_delete",e),this.events.emit("disconnect",Wc(Fa({},je("USER_DISCONNECTED")),{data:e.topic}))}),this.on(mr.DEFAULT_CHAIN_CHANGED,e=>{this.onChainChanged(e,!0)})}getProvider(e){return this.rpcProviders[e]||this.rpcProviders[Dn]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(e=>{var r;this.getProvider(e).updateNamespace((r=this.session)==null?void 0:r.namespaces[e])})}setNamespaces(e){const{namespaces:r,optionalNamespaces:i,sessionProperties:n}=e;r&&Object.keys(r).length&&(this.namespaces=r),i&&Object.keys(i).length&&(this.optionalNamespaces=i),this.sessionProperties=n,this.persist("namespaces",r),this.persist("optionalNamespaces",i)}validateChain(e){const[r,i]=(e==null?void 0:e.split(":"))||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[r,i];if(r&&!Object.keys(this.namespaces||{}).map(a=>Rs(a)).includes(r))throw new Error(`Namespace '${r}' is not configured. Please call connect() first with namespace config.`);if(r&&i)return[r,i];const n=Rs(Object.keys(this.namespaces)[0]),s=this.rpcProviders[n].getDefaultChain();return[n,s]}async requestAccounts(){const[e]=this.validateChain();return await this.getProvider(e).requestAccounts()}onChainChanged(e,r=!1){if(!this.namespaces)return;const[i,n]=this.validateChain(e);n&&(r||this.getProvider(i).setDefaultChain(n),this.namespaces[i]?this.namespaces[i].defaultChain=n:this.namespaces[`${i}:${n}`]?this.namespaces[`${i}:${n}`].defaultChain=n:this.namespaces[`${i}:${n}`]={defaultChain:n},this.persist("namespaces",this.namespaces),this.events.emit("chainChanged",n))}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.session=void 0,this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,this.persist("namespaces",void 0),this.persist("optionalNamespaces",void 0),this.persist("sessionProperties",void 0),await this.cleanupPendingPairings({deletePairings:!0})}persist(e,r){this.client.core.storage.setItem(`${Vl}/${e}`,r)}async getFromStore(e){return await this.client.core.storage.getItem(`${Vl}/${e}`)}};const sN=nN,aN="wc",oN="ethereum_provider",cN=`${aN}@2:${oN}:`,fN="https://rpc.walletconnect.org/v1/",co=["eth_sendTransaction","personal_sign"],Ub=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode","wallet_sendCalls","wallet_getCapabilities","wallet_getCallsStatus","wallet_showCallsStatus"],fo=["chainChanged","accountsChanged"],zb=["chainChanged","accountsChanged","message","disconnect","connect"];var dN=Object.defineProperty,hN=Object.defineProperties,uN=Object.getOwnPropertyDescriptors,_0=Object.getOwnPropertySymbols,lN=Object.prototype.hasOwnProperty,pN=Object.prototype.propertyIsEnumerable,E0=(t,e,r)=>e in t?dN(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Hn=(t,e)=>{for(var r in e||(e={}))lN.call(e,r)&&E0(t,r,e[r]);if(_0)for(var r of _0(e))pN.call(e,r)&&E0(t,r,e[r]);return t},Gc=(t,e)=>hN(t,uN(e));function ho(t){return Number(t[0].split(":")[1])}function Na(t){return`0x${t.toString(16)}`}function bN(t){const{chains:e,optionalChains:r,methods:i,optionalMethods:n,events:s,optionalEvents:a,rpcMap:c}=t;if(!lf(e))throw new Error("Invalid chains");const d={chains:e,methods:i||co,events:s||fo,rpcMap:Hn({},e.length?{[ho(e)]:c[ho(e)]}:{})},u=s==null?void 0:s.filter(E=>!fo.includes(E)),l=i==null?void 0:i.filter(E=>!co.includes(E));if(!r&&!a&&!n&&!(u!=null&&u.length)&&!(l!=null&&l.length))return{required:e.length?d:void 0};const g=(u==null?void 0:u.length)&&(l==null?void 0:l.length)||!r,w={chains:[...new Set(g?d.chains.concat(r||[]):r)],methods:[...new Set(d.methods.concat(n!=null&&n.length?n:Ub))],events:[...new Set(d.events.concat(a!=null&&a.length?a:zb))],rpcMap:c};return{required:e.length?d:void 0,optional:r.length?w:void 0}}class Go{constructor(){this.events=new Ht.EventEmitter,this.namespace="eip155",this.accounts=[],this.chainId=1,this.STORAGE_KEY=cN,this.on=(e,r)=>(this.events.on(e,r),this),this.once=(e,r)=>(this.events.once(e,r),this),this.removeListener=(e,r)=>(this.events.removeListener(e,r),this),this.off=(e,r)=>(this.events.off(e,r),this),this.parseAccount=e=>this.isCompatibleChainId(e)?this.parseAccountId(e).address:e,this.signer={},this.rpc={}}static async init(e){const r=new Go;return await r.initialize(e),r}async request(e,r){return await this.signer.request(e,this.formatChainId(this.chainId),r)}sendAsync(e,r,i){this.signer.sendAsync(e,r,this.formatChainId(this.chainId),i)}get connected(){return this.signer.client?this.signer.client.core.relayer.connected:!1}get connecting(){return this.signer.client?this.signer.client.core.relayer.connecting:!1}async enable(){return this.session||await this.connect(),await this.request({method:"eth_requestAccounts"})}async connect(e){if(!this.signer.client)throw new Error("Provider not initialized. Call init() first");this.loadConnectOpts(e);const{required:r,optional:i}=bN(this.rpc);try{const n=await new Promise(async(a,c)=>{var d;this.rpc.showQrModal&&((d=this.modal)==null||d.subscribeModal(u=>{!u.open&&!this.signer.session&&(this.signer.abortPairingAttempt(),c(new Error("Connection request reset. Please try again.")))})),await this.signer.connect(Gc(Hn({namespaces:Hn({},r&&{[this.namespace]:r})},i&&{optionalNamespaces:{[this.namespace]:i}}),{pairingTopic:e==null?void 0:e.pairingTopic})).then(u=>{a(u)}).catch(u=>{c(new Error(u.message))})});if(!n)return;const s=Ih(n.namespaces,[this.namespace]);this.setChainIds(this.rpc.chains.length?this.rpc.chains:s),this.setAccounts(s),this.events.emit("connect",{chainId:Na(this.chainId)})}catch(n){throw this.signer.logger.error(n),n}finally{this.modal&&this.modal.closeModal()}}async authenticate(e,r){if(!this.signer.client)throw new Error("Provider not initialized. Call init() first");this.loadConnectOpts({chains:e==null?void 0:e.chains});try{const i=await new Promise(async(s,a)=>{var c;this.rpc.showQrModal&&((c=this.modal)==null||c.subscribeModal(d=>{!d.open&&!this.signer.session&&(this.signer.abortPairingAttempt(),a(new Error("Connection request reset. Please try again.")))})),await this.signer.authenticate(Gc(Hn({},e),{chains:this.rpc.chains}),r).then(d=>{s(d)}).catch(d=>{a(new Error(d.message))})}),n=i.session;if(n){const s=Ih(n.namespaces,[this.namespace]);this.setChainIds(this.rpc.chains.length?this.rpc.chains:s),this.setAccounts(s),this.events.emit("connect",{chainId:Na(this.chainId)})}return i}catch(i){throw this.signer.logger.error(i),i}finally{this.modal&&this.modal.closeModal()}}async disconnect(){this.session&&await this.signer.disconnect(),this.reset()}get isWalletConnect(){return!0}get session(){return this.signer.session}registerEventListeners(){this.signer.on("session_event",e=>{const{params:r}=e,{event:i}=r;i.name==="accountsChanged"?(this.accounts=this.parseAccounts(i.data),this.events.emit("accountsChanged",this.accounts)):i.name==="chainChanged"?this.setChainId(this.formatChainId(i.data)):this.events.emit(i.name,i.data),this.events.emit("session_event",e)}),this.signer.on("chainChanged",e=>{const r=parseInt(e);this.chainId=r,this.events.emit("chainChanged",Na(this.chainId)),this.persist()}),this.signer.on("session_update",e=>{this.events.emit("session_update",e)}),this.signer.on("session_delete",e=>{this.reset(),this.events.emit("session_delete",e),this.events.emit("disconnect",Gc(Hn({},Fy("USER_DISCONNECTED")),{data:e.topic,name:"USER_DISCONNECTED"}))}),this.signer.on("display_uri",e=>{var r,i;this.rpc.showQrModal&&((r=this.modal)==null||r.closeModal(),(i=this.modal)==null||i.openModal({uri:e})),this.events.emit("display_uri",e)})}switchEthereumChain(e){this.request({method:"wallet_switchEthereumChain",params:[{chainId:e.toString(16)}]})}isCompatibleChainId(e){return typeof e=="string"?e.startsWith(`${this.namespace}:`):!1}formatChainId(e){return`${this.namespace}:${e}`}parseChainId(e){return Number(e.split(":")[1])}setChainIds(e){const r=e.filter(i=>this.isCompatibleChainId(i)).map(i=>this.parseChainId(i));r.length&&(this.chainId=r[0],this.events.emit("chainChanged",Na(this.chainId)),this.persist())}setChainId(e){if(this.isCompatibleChainId(e)){const r=this.parseChainId(e);this.chainId=r,this.switchEthereumChain(r)}}parseAccountId(e){const[r,i,n]=e.split(":");return{chainId:`${r}:${i}`,address:n}}setAccounts(e){this.accounts=e.filter(r=>this.parseChainId(this.parseAccountId(r).chainId)===this.chainId).map(r=>this.parseAccountId(r).address),this.events.emit("accountsChanged",this.accounts)}getRpcConfig(e){var r,i;const n=(r=e==null?void 0:e.chains)!=null?r:[],s=(i=e==null?void 0:e.optionalChains)!=null?i:[],a=n.concat(s);if(!a.length)throw new Error("No chains specified in either `chains` or `optionalChains`");const c=n.length?(e==null?void 0:e.methods)||co:[],d=n.length?(e==null?void 0:e.events)||fo:[],u=(e==null?void 0:e.optionalMethods)||[],l=(e==null?void 0:e.optionalEvents)||[],g=(e==null?void 0:e.rpcMap)||this.buildRpcMap(a,e.projectId),w=(e==null?void 0:e.qrModalOptions)||void 0;return{chains:n==null?void 0:n.map(E=>this.formatChainId(E)),optionalChains:s.map(E=>this.formatChainId(E)),methods:c,events:d,optionalMethods:u,optionalEvents:l,rpcMap:g,showQrModal:!!(e!=null&&e.showQrModal),qrModalOptions:w,projectId:e.projectId,metadata:e.metadata}}buildRpcMap(e,r){const i={};return e.forEach(n=>{i[n]=this.getRpcUrl(n,r)}),i}async initialize(e){if(this.rpc=this.getRpcConfig(e),this.chainId=this.rpc.chains.length?ho(this.rpc.chains):ho(this.rpc.optionalChains),this.signer=await sN.init({projectId:this.rpc.projectId,metadata:this.rpc.metadata,disableProviderPing:e.disableProviderPing,relayUrl:e.relayUrl,storageOptions:e.storageOptions,customStoragePrefix:e.customStoragePrefix,telemetryEnabled:e.telemetryEnabled,logger:e.logger}),this.registerEventListeners(),await this.loadPersistedSession(),this.rpc.showQrModal){let r;try{const{WalletConnectModal:i}=await h2(()=>import("./index-CckdlN3v.js").then(n=>n.i),__vite__mapDeps([0,1,2,3,4,5,6,7]),import.meta.url);r=i}catch{throw new Error("To use QR modal, please install @walletconnect/modal package")}if(r)try{this.modal=new r(Hn({projectId:this.rpc.projectId},this.rpc.qrModalOptions))}catch(i){throw this.signer.logger.error(i),new Error("Could not generate WalletConnectModal Instance")}}}loadConnectOpts(e){if(!e)return;const{chains:r,optionalChains:i,rpcMap:n}=e;r&&lf(r)&&(this.rpc.chains=r.map(s=>this.formatChainId(s)),r.forEach(s=>{this.rpc.rpcMap[s]=(n==null?void 0:n[s])||this.getRpcUrl(s)})),i&&lf(i)&&(this.rpc.optionalChains=[],this.rpc.optionalChains=i==null?void 0:i.map(s=>this.formatChainId(s)),i.forEach(s=>{this.rpc.rpcMap[s]=(n==null?void 0:n[s])||this.getRpcUrl(s)}))}getRpcUrl(e,r){var i;return((i=this.rpc.rpcMap)==null?void 0:i[e])||`${fN}?chainId=eip155:${e}&projectId=${r||this.rpc.projectId}`}async loadPersistedSession(){if(this.session)try{const e=await this.signer.client.core.storage.getItem(`${this.STORAGE_KEY}/chainId`),r=this.session.namespaces[`${this.namespace}:${e}`]?this.session.namespaces[`${this.namespace}:${e}`]:this.session.namespaces[this.namespace];this.setChainIds(e?[this.formatChainId(e)]:r==null?void 0:r.accounts),this.setAccounts(r==null?void 0:r.accounts)}catch(e){this.signer.logger.error("Failed to load persisted session, clearing state..."),this.signer.logger.error(e),await this.disconnect().catch(r=>this.signer.logger.warn(r))}}reset(){this.chainId=1,this.accounts=[]}persist(){this.session&&this.signer.client.core.storage.setItem(`${this.STORAGE_KEY}/chainId`,this.chainId)}parseAccounts(e){return typeof e=="string"||e instanceof String?[this.parseAccount(e)]:e.map(r=>this.parseAccount(r))}}const gN=Go,vN=Object.freeze(Object.defineProperty({__proto__:null,EthereumProvider:gN,OPTIONAL_EVENTS:zb,OPTIONAL_METHODS:Ub,REQUIRED_EVENTS:fo,REQUIRED_METHODS:co,default:Go},Symbol.toStringTag,{value:"Module"})),yN=ks(vN);(function(t){var e=Ue&&Ue.__createBinding||(Object.create?function(w,E,$,I){I===void 0&&(I=$);var M=Object.getOwnPropertyDescriptor(E,$);(!M||("get"in M?!E.__esModule:M.writable||M.configurable))&&(M={enumerable:!0,get:function(){return E[$]}}),Object.defineProperty(w,I,M)}:function(w,E,$,I){I===void 0&&(I=$),w[I]=E[$]}),r=Ue&&Ue.__setModuleDefault||(Object.create?function(w,E){Object.defineProperty(w,"default",{enumerable:!0,value:E})}:function(w,E){w.default=E}),i=Ue&&Ue.__importStar||function(w){if(w&&w.__esModule)return w;var E={};if(w!=null)for(var $ in w)$!=="default"&&Object.prototype.hasOwnProperty.call(w,$)&&e(E,w,$);return r(E,w),E},n=Ue&&Ue.__awaiter||function(w,E,$,I){function M(P){return P instanceof $?P:new $(function(A){A(P)})}return new($||($=Promise))(function(P,A){function R(U){try{D(I.next(U))}catch(j){A(j)}}function C(U){try{D(I.throw(U))}catch(j){A(j)}}function D(U){U.done?P(U.value):M(U.value).then(R,C)}D((I=I.apply(w,E||[])).next())})},s=Ue&&Ue.__rest||function(w,E){var $={};for(var I in w)Object.prototype.hasOwnProperty.call(w,I)&&E.indexOf(I)<0&&($[I]=w[I]);if(w!=null&&typeof Object.getOwnPropertySymbols=="function")for(var M=0,I=Object.getOwnPropertySymbols(w);M<I.length;M++)E.indexOf(I[M])<0&&Object.prototype.propertyIsEnumerable.call(w,I[M])&&($[I[M]]=w[I[M]]);return $},a=Ue&&Ue.__importDefault||function(w){return w&&w.__esModule?w:{default:w}};Object.defineProperty(t,"__esModule",{value:!0}),t.WalletConnect=t.URI_AVAILABLE=void 0;const c=l2,d=a(u2),u=ki;t.URI_AVAILABLE="URI_AVAILABLE";const l=5e3;class g extends c.Connector{constructor({actions:E,defaultChainId:$,options:I,timeout:M=l,onError:P}){super(E,P),this.events=new d.default,this.disconnectListener=j=>{var z;this.actions.resetState(),j&&((z=this.onError)===null||z===void 0||z.call(this,j))},this.chainChangedListener=j=>{this.actions.update({chainId:Number.parseInt(j,16)})},this.accountsChangedListener=j=>{this.actions.update({accounts:j})},this.URIListener=j=>{this.events.emit(t.URI_AVAILABLE,j)};const{rpcMap:A,rpc:R}=I,C=s(I,["rpcMap","rpc"]);this.options=C,this.defaultChainId=$,this.rpcMap=A||R,this.timeout=M;const{chains:D,optionalChains:U}=this.getChainProps(C.chains,C.optionalChains,$);this.chains=D,this.optionalChains=U}initializeProvider(E=this.defaultChainId){return n(this,void 0,void 0,function*(){const $=this.rpcMap?(0,u.getBestUrlMap)(this.rpcMap,this.timeout):void 0,I=this.getChainProps(this.chains,this.optionalChains,E),M=yield Promise.resolve().then(()=>i(yN));return this.provider=yield M.default.init(Object.assign(Object.assign(Object.assign({},this.options),I),{rpcMap:yield $})),this.provider.on("disconnect",this.disconnectListener).on("chainChanged",this.chainChangedListener).on("accountsChanged",this.accountsChangedListener).on("display_uri",this.URIListener)})}getChainProps(E,$,I=this.defaultChainId){const M=(0,u.getChainsWithDefault)(E,I),P=(0,u.getChainsWithDefault)($,I);if((0,u.isArrayOneOrMore)(M))return{chains:M,optionalChains:P};if((0,u.isArrayOneOrMore)(P))return{chains:M,optionalChains:P};throw new Error("Either chains or optionalChains must have at least one item.")}isomorphicInitialize(E=this.defaultChainId){return this.eagerConnection?this.eagerConnection:this.eagerConnection=this.initializeProvider(E)}connectEagerly(){return n(this,void 0,void 0,function*(){const E=this.actions.startActivation();try{const $=yield this.isomorphicInitialize();if(!$.session)throw new Error("No active session found. Connect your wallet first.");this.actions.update({accounts:$.accounts,chainId:$.chainId})}catch($){throw yield this.deactivate(),E(),$}})}activate(E){var $;return n(this,void 0,void 0,function*(){const I=yield this.isomorphicInitialize(E);if(I.session){if(!E||E===I.chainId)return;if(!I.session.namespaces.eip155.accounts.some(A=>A.startsWith(`eip155:${E}:`)))throw!(($=this.options.optionalChains)===null||$===void 0)&&$.includes(E)?new Error(`Cannot activate an optional chain (${E}), as the wallet is not connected to it.
	You should handle this error in application code, as there is no guarantee that a wallet is connected to a chain configured in "optionalChains".`):new Error(`Unknown chain (${E}). Make sure to include any chains you might connect to in the "chains" or "optionalChains" parameters when initializing WalletConnect.`);return I.request({method:"wallet_switchEthereumChain",params:[{chainId:`0x${E.toString(16)}`}]})}const M=this.actions.startActivation();try{yield I.enable(),this.actions.update({chainId:I.chainId,accounts:I.accounts})}catch(P){throw yield this.deactivate(),M(),P}})}deactivate(){var E;return n(this,void 0,void 0,function*(){(E=this.provider)===null||E===void 0||E.removeListener("disconnect",this.disconnectListener).removeListener("chainChanged",this.chainChangedListener).removeListener("accountsChanged",this.accountsChangedListener).removeListener("display_uri",this.URIListener).disconnect(),this.provider=void 0,this.eagerConnection=void 0,this.actions.resetState()})}}t.WalletConnect=g})(A0);class YC extends A0.WalletConnect{async activate(e){var i;const r=!!((i=this.provider)!=null&&i.session);await super.activate(r?e:void 0),this.provider&&this.actions.update({chainId:this.provider.chainId,accounts:this.provider.accounts})}}export{YC as WalletConnectV2Connector};
