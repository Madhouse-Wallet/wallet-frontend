import{d as N$,e as W$,g as V3,h as M1}from"./chunk-1m9bj8n0.js";import{$c as UN,Zc as mD,_c as x0,ad as s8}from"./chunk-p967kwt7.js";import{hd as R4,id as L4}from"./chunk-w38asa2a.js";import{kd as $X}from"./chunk-c4w4zgtk.js";import{Se as dD,Te as FD,Ue as vD,Ve as k,We as DD,Xe as T$,Ye as J$}from"./chunk-trjbmn7w.js";var iD={};DD(iD,{__values:()=>g1,__spreadArrays:()=>yJ,__spread:()=>dJ,__rest:()=>jJ,__read:()=>S$,__param:()=>mJ,__metadata:()=>hJ,__makeTemplateObject:()=>nJ,__importStar:()=>lJ,__importDefault:()=>iJ,__generator:()=>uJ,__extends:()=>_J,__exportStar:()=>bJ,__decorate:()=>xJ,__createBinding:()=>kJ,__classPrivateFieldSet:()=>oJ,__classPrivateFieldGet:()=>rJ,__awaiter:()=>gJ,__await:()=>q0,__asyncValues:()=>pJ,__asyncGenerator:()=>cJ,__asyncDelegator:()=>vJ,__assign:()=>h1});function _J(D,w){m1(D,w);function C(){this.constructor=D}D.prototype=w===null?Object.create(w):(C.prototype=w.prototype,new C)}function jJ(D,w){var C={};for(var $ in D)if(Object.prototype.hasOwnProperty.call(D,$)&&w.indexOf($)<0)C[$]=D[$];if(D!=null&&typeof Object.getOwnPropertySymbols==="function"){for(var X=0,$=Object.getOwnPropertySymbols(D);X<$.length;X++)if(w.indexOf($[X])<0&&Object.prototype.propertyIsEnumerable.call(D,$[X]))C[$[X]]=D[$[X]]}return C}function xJ(D,w,C,$){var X=arguments.length,Y=X<3?w:$===null?$=Object.getOwnPropertyDescriptor(w,C):$,E;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")Y=Reflect.decorate(D,w,C,$);else for(var K=D.length-1;K>=0;K--)if(E=D[K])Y=(X<3?E(Y):X>3?E(w,C,Y):E(w,C))||Y;return X>3&&Y&&Object.defineProperty(w,C,Y),Y}function mJ(D,w){return function(C,$){w(C,$,D)}}function hJ(D,w){if(typeof Reflect==="object"&&typeof Reflect.metadata==="function")return Reflect.metadata(D,w)}function gJ(D,w,C,$){function X(Y){return Y instanceof C?Y:new C(function(E){E(Y)})}return new(C||(C=Promise))(function(Y,E){function K(B){try{Z($.next(B))}catch(J){E(J)}}function Q(B){try{Z($.throw(B))}catch(J){E(J)}}function Z(B){B.done?Y(B.value):X(B.value).then(K,Q)}Z(($=$.apply(D,w||[])).next())})}function uJ(D,w){var C={label:0,sent:function(){if(Y[0]&1)throw Y[1];return Y[1]},trys:[],ops:[]},$,X,Y,E;return E={next:K(0),throw:K(1),return:K(2)},typeof Symbol==="function"&&(E[Symbol.iterator]=function(){return this}),E;function K(Z){return function(B){return Q([Z,B])}}function Q(Z){if($)throw new TypeError("Generator is already executing.");while(C)try{if($=1,X&&(Y=Z[0]&2?X.return:Z[0]?X.throw||((Y=X.return)&&Y.call(X),0):X.next)&&!(Y=Y.call(X,Z[1])).done)return Y;if(X=0,Y)Z=[Z[0]&2,Y.value];switch(Z[0]){case 0:case 1:Y=Z;break;case 4:return C.label++,{value:Z[1],done:!1};case 5:C.label++,X=Z[1],Z=[0];continue;case 7:Z=C.ops.pop(),C.trys.pop();continue;default:if((Y=C.trys,!(Y=Y.length>0&&Y[Y.length-1]))&&(Z[0]===6||Z[0]===2)){C=0;continue}if(Z[0]===3&&(!Y||Z[1]>Y[0]&&Z[1]<Y[3])){C.label=Z[1];break}if(Z[0]===6&&C.label<Y[1]){C.label=Y[1],Y=Z;break}if(Y&&C.label<Y[2]){C.label=Y[2],C.ops.push(Z);break}if(Y[2])C.ops.pop();C.trys.pop();continue}Z=w.call(D,C)}catch(B){Z=[6,B],X=0}finally{$=Y=0}if(Z[0]&5)throw Z[1];return{value:Z[0]?Z[1]:void 0,done:!0}}}function kJ(D,w,C,$){if($===void 0)$=C;D[$]=w[C]}function bJ(D,w){for(var C in D)if(C!=="default"&&!w.hasOwnProperty(C))w[C]=D[C]}function g1(D){var w=typeof Symbol==="function"&&Symbol.iterator,C=w&&D[w],$=0;if(C)return C.call(D);if(D&&typeof D.length==="number")return{next:function(){if(D&&$>=D.length)D=void 0;return{value:D&&D[$++],done:!D}}};throw new TypeError(w?"Object is not iterable.":"Symbol.iterator is not defined.")}function S$(D,w){var C=typeof Symbol==="function"&&D[Symbol.iterator];if(!C)return D;var $=C.call(D),X,Y=[],E;try{while((w===void 0||w-- >0)&&!(X=$.next()).done)Y.push(X.value)}catch(K){E={error:K}}finally{try{if(X&&!X.done&&(C=$.return))C.call($)}finally{if(E)throw E.error}}return Y}function dJ(){for(var D=[],w=0;w<arguments.length;w++)D=D.concat(S$(arguments[w]));return D}function yJ(){for(var D=0,w=0,C=arguments.length;w<C;w++)D+=arguments[w].length;for(var $=Array(D),X=0,w=0;w<C;w++)for(var Y=arguments[w],E=0,K=Y.length;E<K;E++,X++)$[X]=Y[E];return $}function q0(D){return this instanceof q0?(this.v=D,this):new q0(D)}function cJ(D,w,C){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var $=C.apply(D,w||[]),X,Y=[];return X={},E("next"),E("throw"),E("return"),X[Symbol.asyncIterator]=function(){return this},X;function E(F){if($[F])X[F]=function(W){return new Promise(function(N,G){Y.push([F,W,N,G])>1||K(F,W)})}}function K(F,W){try{Q($[F](W))}catch(N){J(Y[0][3],N)}}function Q(F){F.value instanceof q0?Promise.resolve(F.value.v).then(Z,B):J(Y[0][2],F)}function Z(F){K("next",F)}function B(F){K("throw",F)}function J(F,W){if(F(W),Y.shift(),Y.length)K(Y[0][0],Y[0][1])}}function vJ(D){var w,C;return w={},$("next"),$("throw",function(X){throw X}),$("return"),w[Symbol.iterator]=function(){return this},w;function $(X,Y){w[X]=D[X]?function(E){return(C=!C)?{value:q0(D[X](E)),done:X==="return"}:Y?Y(E):E}:Y}}function pJ(D){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var w=D[Symbol.asyncIterator],C;return w?w.call(D):(D=typeof g1==="function"?g1(D):D[Symbol.iterator](),C={},$("next"),$("throw"),$("return"),C[Symbol.asyncIterator]=function(){return this},C);function $(Y){C[Y]=D[Y]&&function(E){return new Promise(function(K,Q){E=D[Y](E),X(K,Q,E.done,E.value)})}}function X(Y,E,K,Q){Promise.resolve(Q).then(function(Z){Y({value:Z,done:K})},E)}}function nJ(D,w){if(Object.defineProperty)Object.defineProperty(D,"raw",{value:w});else D.raw=w;return D}function lJ(D){if(D&&D.__esModule)return D;var w={};if(D!=null){for(var C in D)if(Object.hasOwnProperty.call(D,C))w[C]=D[C]}return w.default=D,w}function iJ(D){return D&&D.__esModule?D:{default:D}}function rJ(D,w){if(!w.has(D))throw new TypeError("attempted to get private field on non-instance");return w.get(D)}function oJ(D,w,C){if(!w.has(D))throw new TypeError("attempted to set private field on non-instance");return w.set(D,C),C}var m1=function(D,w){return m1=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(C,$){C.__proto__=$}||function(C,$){for(var X in $)if($.hasOwnProperty(X))C[X]=$[X]},m1(D,w)},h1=function(){return h1=Object.assign||function D(w){for(var C,$=1,X=arguments.length;$<X;$++){C=arguments[$];for(var Y in C)if(Object.prototype.hasOwnProperty.call(C,Y))w[Y]=C[Y]}return w},h1.apply(this,arguments)};var rD=T$(()=>{/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */});var _$=k((R$)=>{Object.defineProperty(R$,"__esModule",{value:!0});R$.delay=void 0;function sJ(D){return new Promise((w)=>{setTimeout(()=>{w(!0)},D)})}R$.delay=sJ});var m$=k((j$)=>{Object.defineProperty(j$,"__esModule",{value:!0});j$.ONE_THOUSAND=j$.ONE_HUNDRED=void 0;j$.ONE_HUNDRED=100;j$.ONE_THOUSAND=1000});var y$=k((h$)=>{Object.defineProperty(h$,"__esModule",{value:!0});h$.ONE_YEAR=h$.FOUR_WEEKS=h$.THREE_WEEKS=h$.TWO_WEEKS=h$.ONE_WEEK=h$.THIRTY_DAYS=h$.SEVEN_DAYS=h$.FIVE_DAYS=h$.THREE_DAYS=h$.ONE_DAY=h$.TWENTY_FOUR_HOURS=h$.TWELVE_HOURS=h$.SIX_HOURS=h$.THREE_HOURS=h$.ONE_HOUR=h$.SIXTY_MINUTES=h$.THIRTY_MINUTES=h$.TEN_MINUTES=h$.FIVE_MINUTES=h$.ONE_MINUTE=h$.SIXTY_SECONDS=h$.THIRTY_SECONDS=h$.TEN_SECONDS=h$.FIVE_SECONDS=h$.ONE_SECOND=void 0;h$.ONE_SECOND=1;h$.FIVE_SECONDS=5;h$.TEN_SECONDS=10;h$.THIRTY_SECONDS=30;h$.SIXTY_SECONDS=60;h$.ONE_MINUTE=h$.SIXTY_SECONDS;h$.FIVE_MINUTES=h$.ONE_MINUTE*5;h$.TEN_MINUTES=h$.ONE_MINUTE*10;h$.THIRTY_MINUTES=h$.ONE_MINUTE*30;h$.SIXTY_MINUTES=h$.ONE_MINUTE*60;h$.ONE_HOUR=h$.SIXTY_MINUTES;h$.THREE_HOURS=h$.ONE_HOUR*3;h$.SIX_HOURS=h$.ONE_HOUR*6;h$.TWELVE_HOURS=h$.ONE_HOUR*12;h$.TWENTY_FOUR_HOURS=h$.ONE_HOUR*24;h$.ONE_DAY=h$.TWENTY_FOUR_HOURS;h$.THREE_DAYS=h$.ONE_DAY*3;h$.FIVE_DAYS=h$.ONE_DAY*5;h$.SEVEN_DAYS=h$.ONE_DAY*7;h$.THIRTY_DAYS=h$.ONE_DAY*30;h$.ONE_WEEK=h$.SEVEN_DAYS;h$.TWO_WEEKS=h$.ONE_WEEK*2;h$.THREE_WEEKS=h$.ONE_WEEK*3;h$.FOUR_WEEKS=h$.ONE_WEEK*4;h$.ONE_YEAR=h$.ONE_DAY*365});var u1=k((I3)=>{Object.defineProperty(I3,"__esModule",{value:!0});var c$=(rD(),vD(iD));c$.__exportStar(m$(),I3);c$.__exportStar(y$(),I3)});var l$=k((p$)=>{Object.defineProperty(p$,"__esModule",{value:!0});p$.fromMiliseconds=p$.toMiliseconds=void 0;var v$=u1();function FN(D){return D*v$.ONE_THOUSAND}p$.toMiliseconds=FN;function GN(D){return Math.floor(D/v$.ONE_THOUSAND)}p$.fromMiliseconds=GN});var r$=k((H3)=>{Object.defineProperty(H3,"__esModule",{value:!0});var i$=(rD(),vD(iD));i$.__exportStar(_$(),H3);i$.__exportStar(l$(),H3)});var a$=k((o$)=>{Object.defineProperty(o$,"__esModule",{value:!0});o$.Watch=void 0;class k1{constructor(){this.timestamps=new Map}start(D){if(this.timestamps.has(D))throw new Error(`Watch already started for label: ${D}`);this.timestamps.set(D,{started:Date.now()})}stop(D){let w=this.get(D);if(typeof w.elapsed!=="undefined")throw new Error(`Watch already stopped for label: ${D}`);let C=Date.now()-w.started;this.timestamps.set(D,{started:w.started,elapsed:C})}get(D){let w=this.timestamps.get(D);if(typeof w==="undefined")throw new Error(`No timestamp found for label: ${D}`);return w}elapsed(D){let w=this.get(D);return w.elapsed||Date.now()-w.started}}o$.Watch=k1;o$.default=k1});var wX=k((e$)=>{Object.defineProperty(e$,"__esModule",{value:!0});e$.IWatch=void 0;class t${}e$.IWatch=t$});var CX=k((b1)=>{Object.defineProperty(b1,"__esModule",{value:!0});var VN=(rD(),vD(iD));VN.__exportStar(wX(),b1)});var _8=k((o8)=>{Object.defineProperty(o8,"__esModule",{value:!0});var f3=(rD(),vD(iD));f3.__exportStar(r$(),o8);f3.__exportStar(a$(),o8);f3.__exportStar(CX(),o8);f3.__exportStar(u1(),o8)});class E8{}var XX={};DD(XX,{IEvents:()=>E8});var d1=()=>{};var QX=k((EX)=>{Object.defineProperty(EX,"__esModule",{value:!0});EX.IHeartBeat=void 0;var zN=(d1(),vD(XX));class YX extends zN.IEvents{constructor(D){super()}}EX.IHeartBeat=YX});var c1=k((y1)=>{Object.defineProperty(y1,"__esModule",{value:!0});var AN=(rD(),vD(iD));AN.__exportStar(QX(),y1)});var JX=k((ZX)=>{Object.defineProperty(ZX,"__esModule",{value:!0});ZX.HEARTBEAT_EVENTS=ZX.HEARTBEAT_INTERVAL=void 0;var IN=_8();ZX.HEARTBEAT_INTERVAL=IN.FIVE_SECONDS;ZX.HEARTBEAT_EVENTS={pulse:"heartbeat_pulse"}});var p1=k((v1)=>{Object.defineProperty(v1,"__esModule",{value:!0});var fN=(rD(),vD(iD));fN.__exportStar(JX(),v1)});var FX=k((NX)=>{Object.defineProperty(NX,"__esModule",{value:!0});NX.HeartBeat=void 0;var n1=(rD(),vD(iD)),qN=(s8(),vD(UN)),MN=_8(),TN=c1(),l1=p1();class i1 extends TN.IHeartBeat{constructor(D){super(D);this.events=new qN.EventEmitter,this.interval=l1.HEARTBEAT_INTERVAL,this.interval=(D===null||D===void 0?void 0:D.interval)||l1.HEARTBEAT_INTERVAL}static init(D){return n1.__awaiter(this,void 0,void 0,function*(){let w=new i1(D);return yield w.init(),w})}init(){return n1.__awaiter(this,void 0,void 0,function*(){yield this.initialize()})}stop(){clearInterval(this.intervalRef)}on(D,w){this.events.on(D,w)}once(D,w){this.events.once(D,w)}off(D,w){this.events.off(D,w)}removeListener(D,w){this.events.removeListener(D,w)}initialize(){return n1.__awaiter(this,void 0,void 0,function*(){this.intervalRef=setInterval(()=>this.pulse(),MN.toMiliseconds(this.interval))})}pulse(){this.events.emit(l1.HEARTBEAT_EVENTS.pulse)}}NX.HeartBeat=i1});var GX=k((S0)=>{Object.defineProperty(S0,"__esModule",{value:!0});var r1=(rD(),vD(iD));r1.__exportStar(FX(),S0);r1.__exportStar(c1(),S0);r1.__exportStar(p1(),S0)});var PX=k((R5,OX)=>{function SN(D){try{return JSON.stringify(D)}catch(w){return'"[Circular]"'}}OX.exports=RN;function RN(D,w,C){var $=C&&C.stringify||SN,X=1;if(typeof D==="object"&&D!==null){var Y=w.length+X;if(Y===1)return D;var E=new Array(Y);E[0]=$(D);for(var K=1;K<Y;K++)E[K]=$(w[K]);return E.join(" ")}if(typeof D!=="string")return D;var Q=w.length;if(Q===0)return D;var Z="",B=1-X,J=-1,F=D&&D.length||0;for(var W=0;W<F;){if(D.charCodeAt(W)===37&&W+1<F){switch(J=J>-1?J:0,D.charCodeAt(W+1)){case 100:case 102:if(B>=Q)break;if(w[B]==null)break;if(J<W)Z+=D.slice(J,W);Z+=Number(w[B]),J=W+2,W++;break;case 105:if(B>=Q)break;if(w[B]==null)break;if(J<W)Z+=D.slice(J,W);Z+=Math.floor(Number(w[B])),J=W+2,W++;break;case 79:case 111:case 106:if(B>=Q)break;if(w[B]===void 0)break;if(J<W)Z+=D.slice(J,W);var N=typeof w[B];if(N==="string"){Z+="'"+w[B]+"'",J=W+2,W++;break}if(N==="function"){Z+=w[B].name||"<anonymous>",J=W+2,W++;break}Z+=$(w[B]),J=W+2,W++;break;case 115:if(B>=Q)break;if(J<W)Z+=D.slice(J,W);Z+=String(w[B]),J=W+2,W++;break;case 37:if(J<W)Z+=D.slice(J,W);Z+="%",J=W+2,W++,B--;break}++B}++W}if(J===-1)return D;else if(J<F)Z+=D.slice(J);return Z}});var a1=k((L5,IX)=>{var VX=PX();IX.exports=oD;var R0=bN().console||{},LN={mapHttpRequest:U3,mapHttpResponse:U3,wrapRequestSerializer:o1,wrapResponseSerializer:o1,wrapErrorSerializer:o1,req:U3,res:U3,err:hN};function _N(D,w){if(Array.isArray(D))return D.filter(function($){return $!=="!stdSerializers.err"});else if(D===!0)return Object.keys(w);return!1}function oD(D){D=D||{},D.browser=D.browser||{};let w=D.browser.transmit;if(w&&typeof w.send!=="function")throw Error("pino: transmit option must have a send function");let C=D.browser.write||R0;if(D.browser.write)D.browser.asObject=!0;let $=D.serializers||{},X=_N(D.browser.serialize,$),Y=D.browser.serialize;if(Array.isArray(D.browser.serialize)&&D.browser.serialize.indexOf("!stdSerializers.err")>-1)Y=!1;let E=["error","fatal","warn","info","debug","trace"];if(typeof C==="function")C.error=C.fatal=C.warn=C.info=C.debug=C.trace=C;if(D.enabled===!1)D.level="silent";let K=D.level||"info",Q=Object.create(C);if(!Q.log)Q.log=L0;Object.defineProperty(Q,"levelVal",{get:B}),Object.defineProperty(Q,"level",{get:J,set:F});let Z={transmit:w,serialize:X,asObject:D.browser.asObject,levels:E,timestamp:gN(D)};if(Q.levels=oD.levels,Q.level=K,Q.setMaxListeners=Q.getMaxListeners=Q.emit=Q.addListener=Q.on=Q.prependListener=Q.once=Q.prependOnceListener=Q.removeListener=Q.removeAllListeners=Q.listeners=Q.listenerCount=Q.eventNames=Q.write=Q.flush=L0,Q.serializers=$,Q._serialize=X,Q._stdErrSerialize=Y,Q.child=W,w)Q._logEvent=s1();function B(){return this.level==="silent"?1/0:this.levels.values[this.level]}function J(){return this._level}function F(N){if(N!=="silent"&&!this.levels.values[N])throw Error("unknown level "+N);this._level=N,a8(Z,Q,"error","log"),a8(Z,Q,"fatal","error"),a8(Z,Q,"warn","error"),a8(Z,Q,"info","log"),a8(Z,Q,"debug","log"),a8(Z,Q,"trace","log")}function W(N,G){if(!N)throw new Error("missing bindings for child Pino");if(G=G||{},X&&N.serializers)G.serializers=N.serializers;let V=G.serializers;if(X&&V){var H=Object.assign({},$,V),z=D.browser.serialize===!0?Object.keys(H):X;delete N.serializers,q3([N],z,H,this._stdErrSerialize)}function O(A){if(this._childLevel=(A._childLevel|0)+1,this.error=t8(A,N,"error"),this.fatal=t8(A,N,"fatal"),this.warn=t8(A,N,"warn"),this.info=t8(A,N,"info"),this.debug=t8(A,N,"debug"),this.trace=t8(A,N,"trace"),H)this.serializers=H,this._serialize=z;if(w)this._logEvent=s1([].concat(A._logEvent.bindings,N))}return O.prototype=this,new O(this)}return Q}oD.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}};oD.stdSerializers=LN;oD.stdTimeFunctions=Object.assign({},{nullTime:zX,epochTime:AX,unixTime:uN,isoTime:kN});function a8(D,w,C,$){let X=Object.getPrototypeOf(w);w[C]=w.levelVal>w.levels.values[C]?L0:X[C]?X[C]:R0[C]||R0[$]||L0,jN(D,w,C)}function jN(D,w,C){if(!D.transmit&&w[C]===L0)return;w[C]=function($){return function X(){let Y=D.timestamp(),E=new Array(arguments.length),K=Object.getPrototypeOf&&Object.getPrototypeOf(this)===R0?R0:this;for(var Q=0;Q<E.length;Q++)E[Q]=arguments[Q];if(D.serialize&&!D.asObject)q3(E,this._serialize,this.serializers,this._stdErrSerialize);if(D.asObject)$.call(K,xN(this,C,E,Y));else $.apply(K,E);if(D.transmit){let Z=D.transmit.level||w.level,B=oD.levels.values[Z],J=oD.levels.values[C];if(J<B)return;mN(this,{ts:Y,methodLevel:C,methodValue:J,transmitLevel:Z,transmitValue:oD.levels.values[D.transmit.level||w.level],send:D.transmit.send,val:w.levelVal},E)}}}(w[C])}function xN(D,w,C,$){if(D._serialize)q3(C,D._serialize,D.serializers,D._stdErrSerialize);let X=C.slice(),Y=X[0],E={};if($)E.time=$;E.level=oD.levels.values[w];let K=(D._childLevel|0)+1;if(K<1)K=1;if(Y!==null&&typeof Y==="object"){while(K--&&typeof X[0]==="object")Object.assign(E,X.shift());Y=X.length?VX(X.shift(),X):void 0}else if(typeof Y==="string")Y=VX(X.shift(),X);if(Y!==void 0)E.msg=Y;return E}function q3(D,w,C,$){for(let X in D)if($&&D[X]instanceof Error)D[X]=oD.stdSerializers.err(D[X]);else if(typeof D[X]==="object"&&!Array.isArray(D[X])){for(let Y in D[X])if(w&&w.indexOf(Y)>-1&&Y in C)D[X][Y]=C[Y](D[X][Y])}}function t8(D,w,C){return function(){let $=new Array(1+arguments.length);$[0]=w;for(var X=1;X<$.length;X++)$[X]=arguments[X-1];return D[C].apply(this,$)}}function mN(D,w,C){let{send:$,ts:X,methodLevel:Y,methodValue:E,val:K}=w,Q=D._logEvent.bindings;q3(C,D._serialize||Object.keys(D.serializers),D.serializers,D._stdErrSerialize===void 0?!0:D._stdErrSerialize),D._logEvent.ts=X,D._logEvent.messages=C.filter(function(Z){return Q.indexOf(Z)===-1}),D._logEvent.level.label=Y,D._logEvent.level.value=E,$(Y,D._logEvent,K),D._logEvent=s1(Q)}function s1(D){return{ts:0,messages:[],bindings:D||[],level:{label:"",value:0}}}function hN(D){let w={type:D.constructor.name,msg:D.message,stack:D.stack};for(let C in D)if(w[C]===void 0)w[C]=D[C];return w}function gN(D){if(typeof D.timestamp==="function")return D.timestamp;if(D.timestamp===!1)return zX;return AX}function U3(){return{}}function o1(D){return D}function L0(){}function zX(){return!1}function AX(){return Date.now()}function uN(){return Math.round(Date.now()/1000)}function kN(){return new Date(Date.now()).toISOString()}function bN(){function D(w){return typeof w!=="undefined"&&w}try{if(typeof globalThis!=="undefined")return globalThis;return Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch(w){return D(self)||D(window)||D(this)||{}}}});var RY=k((TY)=>{Object.defineProperty(TY,"__esModule",{value:!0});function mG(D,w){var C=D>>>16&65535,$=D&65535,X=w>>>16&65535,Y=w&65535;return $*Y+(C*Y+$*X<<16>>>0)|0}TY.mul=Math.imul||mG;function hG(D,w){return D+w|0}TY.add=hG;function gG(D,w){return D-w|0}TY.sub=gG;function uG(D,w){return D<<w|D>>>32-w}TY.rotl=uG;function kG(D,w){return D<<32-w|D>>>w}TY.rotr=kG;function bG(D){return typeof D==="number"&&isFinite(D)&&Math.floor(D)===D}TY.isInteger=Number.isInteger||bG;TY.MAX_SAFE_INTEGER=9007199254740991;TY.isSafeInteger=function(D){return TY.isInteger(D)&&(D>=-TY.MAX_SAFE_INTEGER&&D<=TY.MAX_SAFE_INTEGER)}});var g0=k((hY)=>{Object.defineProperty(hY,"__esModule",{value:!0});var LY=RY();function lG(D,w){if(w===void 0)w=0;return(D[w+0]<<8|D[w+1])<<16>>16}hY.readInt16BE=lG;function iG(D,w){if(w===void 0)w=0;return(D[w+0]<<8|D[w+1])>>>0}hY.readUint16BE=iG;function rG(D,w){if(w===void 0)w=0;return(D[w+1]<<8|D[w])<<16>>16}hY.readInt16LE=rG;function oG(D,w){if(w===void 0)w=0;return(D[w+1]<<8|D[w])>>>0}hY.readUint16LE=oG;function _Y(D,w,C){if(w===void 0)w=new Uint8Array(2);if(C===void 0)C=0;return w[C+0]=D>>>8,w[C+1]=D>>>0,w}hY.writeUint16BE=_Y;hY.writeInt16BE=_Y;function jY(D,w,C){if(w===void 0)w=new Uint8Array(2);if(C===void 0)C=0;return w[C+0]=D>>>0,w[C+1]=D>>>8,w}hY.writeUint16LE=jY;hY.writeInt16LE=jY;function mw(D,w){if(w===void 0)w=0;return D[w]<<24|D[w+1]<<16|D[w+2]<<8|D[w+3]}hY.readInt32BE=mw;function hw(D,w){if(w===void 0)w=0;return(D[w]<<24|D[w+1]<<16|D[w+2]<<8|D[w+3])>>>0}hY.readUint32BE=hw;function gw(D,w){if(w===void 0)w=0;return D[w+3]<<24|D[w+2]<<16|D[w+1]<<8|D[w]}hY.readInt32LE=gw;function uw(D,w){if(w===void 0)w=0;return(D[w+3]<<24|D[w+2]<<16|D[w+1]<<8|D[w])>>>0}hY.readUint32LE=uw;function j3(D,w,C){if(w===void 0)w=new Uint8Array(4);if(C===void 0)C=0;return w[C+0]=D>>>24,w[C+1]=D>>>16,w[C+2]=D>>>8,w[C+3]=D>>>0,w}hY.writeUint32BE=j3;hY.writeInt32BE=j3;function x3(D,w,C){if(w===void 0)w=new Uint8Array(4);if(C===void 0)C=0;return w[C+0]=D>>>0,w[C+1]=D>>>8,w[C+2]=D>>>16,w[C+3]=D>>>24,w}hY.writeUint32LE=x3;hY.writeInt32LE=x3;function sG(D,w){if(w===void 0)w=0;var C=mw(D,w),$=mw(D,w+4);return C*4294967296+$-($>>31)*4294967296}hY.readInt64BE=sG;function aG(D,w){if(w===void 0)w=0;var C=hw(D,w),$=hw(D,w+4);return C*4294967296+$}hY.readUint64BE=aG;function tG(D,w){if(w===void 0)w=0;var C=gw(D,w),$=gw(D,w+4);return $*4294967296+C-(C>>31)*4294967296}hY.readInt64LE=tG;function eG(D,w){if(w===void 0)w=0;var C=uw(D,w),$=uw(D,w+4);return $*4294967296+C}hY.readUint64LE=eG;function xY(D,w,C){if(w===void 0)w=new Uint8Array(8);if(C===void 0)C=0;return j3(D/4294967296>>>0,w,C),j3(D>>>0,w,C+4),w}hY.writeUint64BE=xY;hY.writeInt64BE=xY;function mY(D,w,C){if(w===void 0)w=new Uint8Array(8);if(C===void 0)C=0;return x3(D>>>0,w,C),x3(D/4294967296>>>0,w,C+4),w}hY.writeUint64LE=mY;hY.writeInt64LE=mY;function DO(D,w,C){if(C===void 0)C=0;if(D%8!==0)throw new Error("readUintBE supports only bitLengths divisible by 8");if(D/8>w.length-C)throw new Error("readUintBE: array is too short for the given bitLength");var $=0,X=1;for(var Y=D/8+C-1;Y>=C;Y--)$+=w[Y]*X,X*=256;return $}hY.readUintBE=DO;function wO(D,w,C){if(C===void 0)C=0;if(D%8!==0)throw new Error("readUintLE supports only bitLengths divisible by 8");if(D/8>w.length-C)throw new Error("readUintLE: array is too short for the given bitLength");var $=0,X=1;for(var Y=C;Y<C+D/8;Y++)$+=w[Y]*X,X*=256;return $}hY.readUintLE=wO;function CO(D,w,C,$){if(C===void 0)C=new Uint8Array(D/8);if($===void 0)$=0;if(D%8!==0)throw new Error("writeUintBE supports only bitLengths divisible by 8");if(!LY.isSafeInteger(w))throw new Error("writeUintBE value must be an integer");var X=1;for(var Y=D/8+$-1;Y>=$;Y--)C[Y]=w/X&255,X*=256;return C}hY.writeUintBE=CO;function $O(D,w,C,$){if(C===void 0)C=new Uint8Array(D/8);if($===void 0)$=0;if(D%8!==0)throw new Error("writeUintLE supports only bitLengths divisible by 8");if(!LY.isSafeInteger(w))throw new Error("writeUintLE value must be an integer");var X=1;for(var Y=$;Y<$+D/8;Y++)C[Y]=w/X&255,X*=256;return C}hY.writeUintLE=$O;function XO(D,w){if(w===void 0)w=0;var C=new DataView(D.buffer,D.byteOffset,D.byteLength);return C.getFloat32(w)}hY.readFloat32BE=XO;function YO(D,w){if(w===void 0)w=0;var C=new DataView(D.buffer,D.byteOffset,D.byteLength);return C.getFloat32(w,!0)}hY.readFloat32LE=YO;function EO(D,w){if(w===void 0)w=0;var C=new DataView(D.buffer,D.byteOffset,D.byteLength);return C.getFloat64(w)}hY.readFloat64BE=EO;function KO(D,w){if(w===void 0)w=0;var C=new DataView(D.buffer,D.byteOffset,D.byteLength);return C.getFloat64(w,!0)}hY.readFloat64LE=KO;function QO(D,w,C){if(w===void 0)w=new Uint8Array(4);if(C===void 0)C=0;var $=new DataView(w.buffer,w.byteOffset,w.byteLength);return $.setFloat32(C,D),w}hY.writeFloat32BE=QO;function ZO(D,w,C){if(w===void 0)w=new Uint8Array(4);if(C===void 0)C=0;var $=new DataView(w.buffer,w.byteOffset,w.byteLength);return $.setFloat32(C,D,!0),w}hY.writeFloat32LE=ZO;function BO(D,w,C){if(w===void 0)w=new Uint8Array(8);if(C===void 0)C=0;var $=new DataView(w.buffer,w.byteOffset,w.byteLength);return $.setFloat64(C,D),w}hY.writeFloat64BE=BO;function JO(D,w,C){if(w===void 0)w=new Uint8Array(8);if(C===void 0)C=0;var $=new DataView(w.buffer,w.byteOffset,w.byteLength);return $.setFloat64(C,D,!0),w}hY.writeFloat64LE=JO});var aD=k((gY)=>{Object.defineProperty(gY,"__esModule",{value:!0});function rO(D){for(var w=0;w<D.length;w++)D[w]=0;return D}gY.wipe=rO});var bY=k((kY)=>{Object.defineProperty(kY,"__esModule",{value:!0});var fD=g0(),kw=aD(),sO=20;function aO(D,w,C){var $=1634760805,X=857760878,Y=2036477234,E=1797285236,K=C[3]<<24|C[2]<<16|C[1]<<8|C[0],Q=C[7]<<24|C[6]<<16|C[5]<<8|C[4],Z=C[11]<<24|C[10]<<16|C[9]<<8|C[8],B=C[15]<<24|C[14]<<16|C[13]<<8|C[12],J=C[19]<<24|C[18]<<16|C[17]<<8|C[16],F=C[23]<<24|C[22]<<16|C[21]<<8|C[20],W=C[27]<<24|C[26]<<16|C[25]<<8|C[24],N=C[31]<<24|C[30]<<16|C[29]<<8|C[28],G=w[3]<<24|w[2]<<16|w[1]<<8|w[0],V=w[7]<<24|w[6]<<16|w[5]<<8|w[4],H=w[11]<<24|w[10]<<16|w[9]<<8|w[8],z=w[15]<<24|w[14]<<16|w[13]<<8|w[12],O=$,A=X,M=Y,T=E,f=K,q=Q,L=Z,d=B,v=J,n=F,i=W,r=N,I=G,U=V,P=H,S=z;for(var u=0;u<sO;u+=2)O=O+f|0,I^=O,I=I>>>16|I<<16,v=v+I|0,f^=v,f=f>>>20|f<<12,A=A+q|0,U^=A,U=U>>>16|U<<16,n=n+U|0,q^=n,q=q>>>20|q<<12,M=M+L|0,P^=M,P=P>>>16|P<<16,i=i+P|0,L^=i,L=L>>>20|L<<12,T=T+d|0,S^=T,S=S>>>16|S<<16,r=r+S|0,d^=r,d=d>>>20|d<<12,M=M+L|0,P^=M,P=P>>>24|P<<8,i=i+P|0,L^=i,L=L>>>25|L<<7,T=T+d|0,S^=T,S=S>>>24|S<<8,r=r+S|0,d^=r,d=d>>>25|d<<7,A=A+q|0,U^=A,U=U>>>24|U<<8,n=n+U|0,q^=n,q=q>>>25|q<<7,O=O+f|0,I^=O,I=I>>>24|I<<8,v=v+I|0,f^=v,f=f>>>25|f<<7,O=O+q|0,S^=O,S=S>>>16|S<<16,i=i+S|0,q^=i,q=q>>>20|q<<12,A=A+L|0,I^=A,I=I>>>16|I<<16,r=r+I|0,L^=r,L=L>>>20|L<<12,M=M+d|0,U^=M,U=U>>>16|U<<16,v=v+U|0,d^=v,d=d>>>20|d<<12,T=T+f|0,P^=T,P=P>>>16|P<<16,n=n+P|0,f^=n,f=f>>>20|f<<12,M=M+d|0,U^=M,U=U>>>24|U<<8,v=v+U|0,d^=v,d=d>>>25|d<<7,T=T+f|0,P^=T,P=P>>>24|P<<8,n=n+P|0,f^=n,f=f>>>25|f<<7,A=A+L|0,I^=A,I=I>>>24|I<<8,r=r+I|0,L^=r,L=L>>>25|L<<7,O=O+q|0,S^=O,S=S>>>24|S<<8,i=i+S|0,q^=i,q=q>>>25|q<<7;fD.writeUint32LE(O+$|0,D,0),fD.writeUint32LE(A+X|0,D,4),fD.writeUint32LE(M+Y|0,D,8),fD.writeUint32LE(T+E|0,D,12),fD.writeUint32LE(f+K|0,D,16),fD.writeUint32LE(q+Q|0,D,20),fD.writeUint32LE(L+Z|0,D,24),fD.writeUint32LE(d+B|0,D,28),fD.writeUint32LE(v+J|0,D,32),fD.writeUint32LE(n+F|0,D,36),fD.writeUint32LE(i+W|0,D,40),fD.writeUint32LE(r+N|0,D,44),fD.writeUint32LE(I+G|0,D,48),fD.writeUint32LE(U+V|0,D,52),fD.writeUint32LE(P+H|0,D,56),fD.writeUint32LE(S+z|0,D,60)}function uY(D,w,C,$,X){if(X===void 0)X=0;if(D.length!==32)throw new Error("ChaCha: key size must be 32 bytes");if($.length<C.length)throw new Error("ChaCha: destination is shorter than source");var Y,E;if(X===0){if(w.length!==8&&w.length!==12)throw new Error("ChaCha nonce must be 8 or 12 bytes");Y=new Uint8Array(16),E=Y.length-w.length,Y.set(w,E)}else{if(w.length!==16)throw new Error("ChaCha nonce with counter must be 16 bytes");Y=w,E=X}var K=new Uint8Array(64);for(var Q=0;Q<C.length;Q+=64){aO(K,Y,D);for(var Z=Q;Z<Q+64&&Z<C.length;Z++)$[Z]=C[Z]^K[Z-Q];eO(Y,0,E)}if(kw.wipe(K),X===0)kw.wipe(Y);return $}kY.streamXOR=uY;function tO(D,w,C,$){if($===void 0)$=0;return kw.wipe(C),uY(D,w,C,C,$)}kY.stream=tO;function eO(D,w,C){var $=1;while(C--)$=$+(D[w]&255)|0,D[w]=$&255,$>>>=8,w++;if($>0)throw new Error("ChaCha: counter overflow")}});var m3=k((yY)=>{Object.defineProperty(yY,"__esModule",{value:!0});function C4(D,w,C){return~(D-1)&w|D-1&C}yY.select=C4;function $4(D,w){return(D|0)-(w|0)-1>>>31&1}yY.lessOrEqual=$4;function dY(D,w){if(D.length!==w.length)return 0;var C=0;for(var $=0;$<D.length;$++)C|=D[$]^w[$];return 1&C-1>>>8}yY.compare=dY;function X4(D,w){if(D.length===0||w.length===0)return!1;return dY(D,w)!==0}yY.equal=X4});var pY=k((vY)=>{Object.defineProperty(vY,"__esModule",{value:!0});var Z4=m3(),h3=aD();vY.DIGEST_LENGTH=16;var cY=function(){function D(w){this.digestLength=vY.DIGEST_LENGTH,this._buffer=new Uint8Array(16),this._r=new Uint16Array(10),this._h=new Uint16Array(10),this._pad=new Uint16Array(8),this._leftover=0,this._fin=0,this._finished=!1;var C=w[0]|w[1]<<8;this._r[0]=C&8191;var $=w[2]|w[3]<<8;this._r[1]=(C>>>13|$<<3)&8191;var X=w[4]|w[5]<<8;this._r[2]=($>>>10|X<<6)&7939;var Y=w[6]|w[7]<<8;this._r[3]=(X>>>7|Y<<9)&8191;var E=w[8]|w[9]<<8;this._r[4]=(Y>>>4|E<<12)&255,this._r[5]=E>>>1&8190;var K=w[10]|w[11]<<8;this._r[6]=(E>>>14|K<<2)&8191;var Q=w[12]|w[13]<<8;this._r[7]=(K>>>11|Q<<5)&8065;var Z=w[14]|w[15]<<8;this._r[8]=(Q>>>8|Z<<8)&8191,this._r[9]=Z>>>5&127,this._pad[0]=w[16]|w[17]<<8,this._pad[1]=w[18]|w[19]<<8,this._pad[2]=w[20]|w[21]<<8,this._pad[3]=w[22]|w[23]<<8,this._pad[4]=w[24]|w[25]<<8,this._pad[5]=w[26]|w[27]<<8,this._pad[6]=w[28]|w[29]<<8,this._pad[7]=w[30]|w[31]<<8}return D.prototype._blocks=function(w,C,$){var X=this._fin?0:2048,Y=this._h[0],E=this._h[1],K=this._h[2],Q=this._h[3],Z=this._h[4],B=this._h[5],J=this._h[6],F=this._h[7],W=this._h[8],N=this._h[9],G=this._r[0],V=this._r[1],H=this._r[2],z=this._r[3],O=this._r[4],A=this._r[5],M=this._r[6],T=this._r[7],f=this._r[8],q=this._r[9];while($>=16){var L=w[C+0]|w[C+1]<<8;Y+=L&8191;var d=w[C+2]|w[C+3]<<8;E+=(L>>>13|d<<3)&8191;var v=w[C+4]|w[C+5]<<8;K+=(d>>>10|v<<6)&8191;var n=w[C+6]|w[C+7]<<8;Q+=(v>>>7|n<<9)&8191;var i=w[C+8]|w[C+9]<<8;Z+=(n>>>4|i<<12)&8191,B+=i>>>1&8191;var r=w[C+10]|w[C+11]<<8;J+=(i>>>14|r<<2)&8191;var I=w[C+12]|w[C+13]<<8;F+=(r>>>11|I<<5)&8191;var U=w[C+14]|w[C+15]<<8;W+=(I>>>8|U<<8)&8191,N+=U>>>5|X;var P=0,S=P;S+=Y*G,S+=E*(5*q),S+=K*(5*f),S+=Q*(5*T),S+=Z*(5*M),P=S>>>13,S&=8191,S+=B*(5*A),S+=J*(5*O),S+=F*(5*z),S+=W*(5*H),S+=N*(5*V),P+=S>>>13,S&=8191;var u=P;u+=Y*V,u+=E*G,u+=K*(5*q),u+=Q*(5*f),u+=Z*(5*T),P=u>>>13,u&=8191,u+=B*(5*M),u+=J*(5*A),u+=F*(5*O),u+=W*(5*z),u+=N*(5*H),P+=u>>>13,u&=8191;var _=P;_+=Y*H,_+=E*V,_+=K*G,_+=Q*(5*q),_+=Z*(5*f),P=_>>>13,_&=8191,_+=B*(5*T),_+=J*(5*M),_+=F*(5*A),_+=W*(5*O),_+=N*(5*z),P+=_>>>13,_&=8191;var j=P;j+=Y*z,j+=E*H,j+=K*V,j+=Q*G,j+=Z*(5*q),P=j>>>13,j&=8191,j+=B*(5*f),j+=J*(5*T),j+=F*(5*M),j+=W*(5*A),j+=N*(5*O),P+=j>>>13,j&=8191;var x=P;x+=Y*O,x+=E*z,x+=K*H,x+=Q*V,x+=Z*G,P=x>>>13,x&=8191,x+=B*(5*q),x+=J*(5*f),x+=F*(5*T),x+=W*(5*M),x+=N*(5*A),P+=x>>>13,x&=8191;var m=P;m+=Y*A,m+=E*O,m+=K*z,m+=Q*H,m+=Z*V,P=m>>>13,m&=8191,m+=B*G,m+=J*(5*q),m+=F*(5*f),m+=W*(5*T),m+=N*(5*M),P+=m>>>13,m&=8191;var h=P;h+=Y*M,h+=E*A,h+=K*O,h+=Q*z,h+=Z*H,P=h>>>13,h&=8191,h+=B*V,h+=J*G,h+=F*(5*q),h+=W*(5*f),h+=N*(5*T),P+=h>>>13,h&=8191;var g=P;g+=Y*T,g+=E*M,g+=K*A,g+=Q*O,g+=Z*z,P=g>>>13,g&=8191,g+=B*H,g+=J*V,g+=F*G,g+=W*(5*q),g+=N*(5*f),P+=g>>>13,g&=8191;var b=P;b+=Y*f,b+=E*T,b+=K*M,b+=Q*A,b+=Z*O,P=b>>>13,b&=8191,b+=B*z,b+=J*H,b+=F*V,b+=W*G,b+=N*(5*q),P+=b>>>13,b&=8191;var y=P;y+=Y*q,y+=E*f,y+=K*T,y+=Q*M,y+=Z*A,P=y>>>13,y&=8191,y+=B*O,y+=J*z,y+=F*H,y+=W*V,y+=N*G,P+=y>>>13,y&=8191,P=(P<<2)+P|0,P=P+S|0,S=P&8191,P=P>>>13,u+=P,Y=S,E=u,K=_,Q=j,Z=x,B=m,J=h,F=g,W=b,N=y,C+=16,$-=16}this._h[0]=Y,this._h[1]=E,this._h[2]=K,this._h[3]=Q,this._h[4]=Z,this._h[5]=B,this._h[6]=J,this._h[7]=F,this._h[8]=W,this._h[9]=N},D.prototype.finish=function(w,C){if(C===void 0)C=0;var $=new Uint16Array(10),X,Y,E,K;if(this._leftover){K=this._leftover,this._buffer[K++]=1;for(;K<16;K++)this._buffer[K]=0;this._fin=1,this._blocks(this._buffer,0,16)}X=this._h[1]>>>13,this._h[1]&=8191;for(K=2;K<10;K++)this._h[K]+=X,X=this._h[K]>>>13,this._h[K]&=8191;this._h[0]+=X*5,X=this._h[0]>>>13,this._h[0]&=8191,this._h[1]+=X,X=this._h[1]>>>13,this._h[1]&=8191,this._h[2]+=X,$[0]=this._h[0]+5,X=$[0]>>>13,$[0]&=8191;for(K=1;K<10;K++)$[K]=this._h[K]+X,X=$[K]>>>13,$[K]&=8191;$[9]-=8192,Y=(X^1)-1;for(K=0;K<10;K++)$[K]&=Y;Y=~Y;for(K=0;K<10;K++)this._h[K]=this._h[K]&Y|$[K];this._h[0]=(this._h[0]|this._h[1]<<13)&65535,this._h[1]=(this._h[1]>>>3|this._h[2]<<10)&65535,this._h[2]=(this._h[2]>>>6|this._h[3]<<7)&65535,this._h[3]=(this._h[3]>>>9|this._h[4]<<4)&65535,this._h[4]=(this._h[4]>>>12|this._h[5]<<1|this._h[6]<<14)&65535,this._h[5]=(this._h[6]>>>2|this._h[7]<<11)&65535,this._h[6]=(this._h[7]>>>5|this._h[8]<<8)&65535,this._h[7]=(this._h[8]>>>8|this._h[9]<<5)&65535,E=this._h[0]+this._pad[0],this._h[0]=E&65535;for(K=1;K<8;K++)E=(this._h[K]+this._pad[K]|0)+(E>>>16)|0,this._h[K]=E&65535;return w[C+0]=this._h[0]>>>0,w[C+1]=this._h[0]>>>8,w[C+2]=this._h[1]>>>0,w[C+3]=this._h[1]>>>8,w[C+4]=this._h[2]>>>0,w[C+5]=this._h[2]>>>8,w[C+6]=this._h[3]>>>0,w[C+7]=this._h[3]>>>8,w[C+8]=this._h[4]>>>0,w[C+9]=this._h[4]>>>8,w[C+10]=this._h[5]>>>0,w[C+11]=this._h[5]>>>8,w[C+12]=this._h[6]>>>0,w[C+13]=this._h[6]>>>8,w[C+14]=this._h[7]>>>0,w[C+15]=this._h[7]>>>8,this._finished=!0,this},D.prototype.update=function(w){var C=0,$=w.length,X;if(this._leftover){if(X=16-this._leftover,X>$)X=$;for(var Y=0;Y<X;Y++)this._buffer[this._leftover+Y]=w[C+Y];if($-=X,C+=X,this._leftover+=X,this._leftover<16)return this;this._blocks(this._buffer,0,16),this._leftover=0}if($>=16)X=$-$%16,this._blocks(w,C,X),C+=X,$-=X;if($){for(var Y=0;Y<$;Y++)this._buffer[this._leftover+Y]=w[C+Y];this._leftover+=$}return this},D.prototype.digest=function(){if(this._finished)throw new Error("Poly1305 was finished");var w=new Uint8Array(16);return this.finish(w),w},D.prototype.clean=function(){return h3.wipe(this._buffer),h3.wipe(this._r),h3.wipe(this._h),h3.wipe(this._pad),this._leftover=0,this._fin=0,this._finished=!0,this},D}();vY.Poly1305=cY;function B4(D,w){var C=new cY(D);C.update(w);var $=C.digest();return C.clean(),$}vY.oneTimeAuth=B4;function J4(D,w){if(D.length!==vY.DIGEST_LENGTH||w.length!==vY.DIGEST_LENGTH)return!1;return Z4.equal(D,w)}vY.equal=J4});var aY=k((iY)=>{Object.defineProperty(iY,"__esModule",{value:!0});var u3=bY(),G4=pY(),u0=aD(),nY=g0(),O4=m3();iY.KEY_LENGTH=32;iY.NONCE_LENGTH=12;iY.TAG_LENGTH=16;var lY=new Uint8Array(16),P4=function(){function D(w){if(this.nonceLength=iY.NONCE_LENGTH,this.tagLength=iY.TAG_LENGTH,w.length!==iY.KEY_LENGTH)throw new Error("ChaCha20Poly1305 needs 32-byte key");this._key=new Uint8Array(w)}return D.prototype.seal=function(w,C,$,X){if(w.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");var Y=new Uint8Array(16);Y.set(w,Y.length-w.length);var E=new Uint8Array(32);u3.stream(this._key,Y,E,4);var K=C.length+this.tagLength,Q;if(X){if(X.length!==K)throw new Error("ChaCha20Poly1305: incorrect destination length");Q=X}else Q=new Uint8Array(K);return u3.streamXOR(this._key,Y,C,Q,4),this._authenticate(Q.subarray(Q.length-this.tagLength,Q.length),E,Q.subarray(0,Q.length-this.tagLength),$),u0.wipe(Y),Q},D.prototype.open=function(w,C,$,X){if(w.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");if(C.length<this.tagLength)return null;var Y=new Uint8Array(16);Y.set(w,Y.length-w.length);var E=new Uint8Array(32);u3.stream(this._key,Y,E,4);var K=new Uint8Array(this.tagLength);if(this._authenticate(K,E,C.subarray(0,C.length-this.tagLength),$),!O4.equal(K,C.subarray(C.length-this.tagLength,C.length)))return null;var Q=C.length-this.tagLength,Z;if(X){if(X.length!==Q)throw new Error("ChaCha20Poly1305: incorrect destination length");Z=X}else Z=new Uint8Array(Q);return u3.streamXOR(this._key,Y,C.subarray(0,C.length-this.tagLength),Z,4),u0.wipe(Y),Z},D.prototype.clean=function(){return u0.wipe(this._key),this},D.prototype._authenticate=function(w,C,$,X){var Y=new G4.Poly1305(C);if(X){if(Y.update(X),X.length%16>0)Y.update(lY.subarray(X.length%16))}if(Y.update($),$.length%16>0)Y.update(lY.subarray($.length%16));var E=new Uint8Array(8);if(X)nY.writeUint64LE(X.length,E);Y.update(E),nY.writeUint64LE($.length,E),Y.update(E);var K=Y.digest();for(var Q=0;Q<K.length;Q++)w[Q]=K[Q];Y.clean(),u0.wipe(K),u0.wipe(E)},D}();iY.ChaCha20Poly1305=P4});var eY=k((tY)=>{Object.defineProperty(tY,"__esModule",{value:!0});function z4(D){return typeof D.saveState!=="undefined"&&typeof D.restoreState!=="undefined"&&typeof D.cleanSavedState!=="undefined"}tY.isSerializableHash=z4});var CE=k((wE)=>{Object.defineProperty(wE,"__esModule",{value:!0});var tD=eY(),I4=m3(),H4=aD(),DE=function(){function D(w,C){this._finished=!1,this._inner=new w,this._outer=new w,this.blockSize=this._outer.blockSize,this.digestLength=this._outer.digestLength;var $=new Uint8Array(this.blockSize);if(C.length>this.blockSize)this._inner.update(C).finish($).clean();else $.set(C);for(var X=0;X<$.length;X++)$[X]^=54;this._inner.update($);for(var X=0;X<$.length;X++)$[X]^=106;if(this._outer.update($),tD.isSerializableHash(this._inner)&&tD.isSerializableHash(this._outer))this._innerKeyedState=this._inner.saveState(),this._outerKeyedState=this._outer.saveState();H4.wipe($)}return D.prototype.reset=function(){if(!tD.isSerializableHash(this._inner)||!tD.isSerializableHash(this._outer))throw new Error("hmac: can't reset() because hash doesn't implement restoreState()");return this._inner.restoreState(this._innerKeyedState),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},D.prototype.clean=function(){if(tD.isSerializableHash(this._inner))this._inner.cleanSavedState(this._innerKeyedState);if(tD.isSerializableHash(this._outer))this._outer.cleanSavedState(this._outerKeyedState);this._inner.clean(),this._outer.clean()},D.prototype.update=function(w){return this._inner.update(w),this},D.prototype.finish=function(w){if(this._finished)return this._outer.finish(w),this;return this._inner.finish(w),this._outer.update(w.subarray(0,this.digestLength)).finish(w),this._finished=!0,this},D.prototype.digest=function(){var w=new Uint8Array(this.digestLength);return this.finish(w),w},D.prototype.saveState=function(){if(!tD.isSerializableHash(this._inner))throw new Error("hmac: can't saveState() because hash doesn't implement it");return this._inner.saveState()},D.prototype.restoreState=function(w){if(!tD.isSerializableHash(this._inner)||!tD.isSerializableHash(this._outer))throw new Error("hmac: can't restoreState() because hash doesn't implement it");return this._inner.restoreState(w),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},D.prototype.cleanSavedState=function(w){if(!tD.isSerializableHash(this._inner))throw new Error("hmac: can't cleanSavedState() because hash doesn't implement it");this._inner.cleanSavedState(w)},D}();wE.HMAC=DE;function f4(D,w,C){var $=new DE(D,w);$.update(C);var X=$.digest();return $.clean(),X}wE.hmac=f4;wE.equal=I4.equal});var EE=k((YE)=>{Object.defineProperty(YE,"__esModule",{value:!0});var $E=CE(),XE=aD(),T4=function(){function D(w,C,$,X){if($===void 0)$=new Uint8Array(0);this._counter=new Uint8Array(1),this._hash=w,this._info=X;var Y=$E.hmac(this._hash,$,C);this._hmac=new $E.HMAC(w,Y),this._buffer=new Uint8Array(this._hmac.digestLength),this._bufpos=this._buffer.length}return D.prototype._fillBuffer=function(){this._counter[0]++;var w=this._counter[0];if(w===0)throw new Error("hkdf: cannot expand more");if(this._hmac.reset(),w>1)this._hmac.update(this._buffer);if(this._info)this._hmac.update(this._info);this._hmac.update(this._counter),this._hmac.finish(this._buffer),this._bufpos=0},D.prototype.expand=function(w){var C=new Uint8Array(w);for(var $=0;$<C.length;$++){if(this._bufpos===this._buffer.length)this._fillBuffer();C[$]=this._buffer[this._bufpos++]}return C},D.prototype.clean=function(){this._hmac.clean(),XE.wipe(this._buffer),XE.wipe(this._counter),this._bufpos=0},D}();YE.HKDF=T4});var JE=k((ZE)=>{Object.defineProperty(ZE,"__esModule",{value:!0});ZE.BrowserRandomSource=void 0;var KE=65536;class QE{constructor(){this.isAvailable=!1,this.isInstantiated=!1;let D=typeof self!=="undefined"?self.crypto||self.msCrypto:null;if(D&&D.getRandomValues!==void 0)this._crypto=D,this.isAvailable=!0,this.isInstantiated=!0}randomBytes(D){if(!this.isAvailable||!this._crypto)throw new Error("Browser random byte generator is not available.");let w=new Uint8Array(D);for(let C=0;C<w.length;C+=KE)this._crypto.getRandomValues(w.subarray(C,C+Math.min(w.length-C,KE)));return w}}ZE.BrowserRandomSource=QE});var GE=k((WE)=>{Object.defineProperty(WE,"__esModule",{value:!0});WE.NodeRandomSource=void 0;var _4=aD();class NE{constructor(){this.isAvailable=!1,this.isInstantiated=!1;{let D=(L4(),vD(R4));if(D&&D.randomBytes)this._crypto=D,this.isAvailable=!0,this.isInstantiated=!0}}randomBytes(D){if(!this.isAvailable||!this._crypto)throw new Error("Node.js random byte generator is not available.");let w=this._crypto.randomBytes(D);if(w.length!==D)throw new Error("NodeRandomSource: got fewer bytes than requested");let C=new Uint8Array(D);for(let $=0;$<C.length;$++)C[$]=w[$];return _4.wipe(w),C}}WE.NodeRandomSource=NE});var zE=k((PE)=>{Object.defineProperty(PE,"__esModule",{value:!0});PE.SystemRandomSource=void 0;var j4=JE(),x4=GE();class OE{constructor(){if(this.isAvailable=!1,this.name="",this._source=new j4.BrowserRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Browser";return}if(this._source=new x4.NodeRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Node";return}}randomBytes(D){if(!this.isAvailable)throw new Error("System random byte generator is not available.");return this._source.randomBytes(D)}}PE.SystemRandomSource=OE});var dw=k((fE)=>{Object.defineProperty(fE,"__esModule",{value:!0});fE.randomStringForEntropy=fE.randomString=fE.randomUint32=fE.randomBytes=fE.defaultRandomSource=void 0;var m4=zE(),h4=g0(),AE=aD();fE.defaultRandomSource=new m4.SystemRandomSource;function bw(D,w=fE.defaultRandomSource){return w.randomBytes(D)}fE.randomBytes=bw;function g4(D=fE.defaultRandomSource){let w=bw(4,D),C=h4.readUint32LE(w);return AE.wipe(w),C}fE.randomUint32=g4;var IE="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function HE(D,w=IE,C=fE.defaultRandomSource){if(w.length<2)throw new Error("randomString charset is too short");if(w.length>256)throw new Error("randomString charset is too long");let $="",X=w.length,Y=256-256%X;while(D>0){let E=bw(Math.ceil(D*256/Y),C);for(let K=0;K<E.length&&D>0;K++){let Q=E[K];if(Q<Y)$+=w.charAt(Q%X),D--}AE.wipe(E)}return $}fE.randomString=HE;function u4(D,w=IE,C=fE.defaultRandomSource){let $=Math.ceil(D/(Math.log(w.length)/Math.LN2));return HE($,w,C)}fE.randomStringForEntropy=u4});var RE=k((ME)=>{Object.defineProperty(ME,"__esModule",{value:!0});var b3=g0(),k3=aD();ME.DIGEST_LENGTH=32;ME.BLOCK_SIZE=64;var qE=function(){function D(){this.digestLength=ME.DIGEST_LENGTH,this.blockSize=ME.BLOCK_SIZE,this._state=new Int32Array(8),this._temp=new Int32Array(64),this._buffer=new Uint8Array(128),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return D.prototype._initState=function(){this._state[0]=1779033703,this._state[1]=3144134277,this._state[2]=1013904242,this._state[3]=2773480762,this._state[4]=1359893119,this._state[5]=2600822924,this._state[6]=528734635,this._state[7]=1541459225},D.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},D.prototype.clean=function(){k3.wipe(this._buffer),k3.wipe(this._temp),this.reset()},D.prototype.update=function(w,C){if(C===void 0)C=w.length;if(this._finished)throw new Error("SHA256: can't update because hash was finished.");var $=0;if(this._bytesHashed+=C,this._bufferLength>0){while(this._bufferLength<this.blockSize&&C>0)this._buffer[this._bufferLength++]=w[$++],C--;if(this._bufferLength===this.blockSize)yw(this._temp,this._state,this._buffer,0,this.blockSize),this._bufferLength=0}if(C>=this.blockSize)$=yw(this._temp,this._state,w,$,C),C%=this.blockSize;while(C>0)this._buffer[this._bufferLength++]=w[$++],C--;return this},D.prototype.finish=function(w){if(!this._finished){var C=this._bytesHashed,$=this._bufferLength,X=C/536870912|0,Y=C<<3,E=C%64<56?64:128;this._buffer[$]=128;for(var K=$+1;K<E-8;K++)this._buffer[K]=0;b3.writeUint32BE(X,this._buffer,E-8),b3.writeUint32BE(Y,this._buffer,E-4),yw(this._temp,this._state,this._buffer,0,E),this._finished=!0}for(var K=0;K<this.digestLength/4;K++)b3.writeUint32BE(this._state[K],w,K*4);return this},D.prototype.digest=function(){var w=new Uint8Array(this.digestLength);return this.finish(w),w},D.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{state:new Int32Array(this._state),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},D.prototype.restoreState=function(w){if(this._state.set(w.state),this._bufferLength=w.bufferLength,w.buffer)this._buffer.set(w.buffer);return this._bytesHashed=w.bytesHashed,this._finished=!1,this},D.prototype.cleanSavedState=function(w){if(k3.wipe(w.state),w.buffer)k3.wipe(w.buffer);w.bufferLength=0,w.bytesHashed=0},D}();ME.SHA256=qE;var y4=new Int32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function yw(D,w,C,$,X){while(X>=64){var Y=w[0],E=w[1],K=w[2],Q=w[3],Z=w[4],B=w[5],J=w[6],F=w[7];for(var W=0;W<16;W++){var N=$+W*4;D[W]=b3.readUint32BE(C,N)}for(var W=16;W<64;W++){var G=D[W-2],V=(G>>>17|G<<15)^(G>>>19|G<<13)^G>>>10;G=D[W-15];var H=(G>>>7|G<<25)^(G>>>18|G<<14)^G>>>3;D[W]=(V+D[W-7]|0)+(H+D[W-16]|0)}for(var W=0;W<64;W++){var V=(((Z>>>6|Z<<26)^(Z>>>11|Z<<21)^(Z>>>25|Z<<7))+(Z&B^~Z&J)|0)+(F+(y4[W]+D[W]|0)|0)|0,H=((Y>>>2|Y<<30)^(Y>>>13|Y<<19)^(Y>>>22|Y<<10))+(Y&E^Y&K^E&K)|0;F=J,J=B,B=Z,Z=Q+V|0,Q=K,K=E,E=Y,Y=V+H|0}w[0]+=Y,w[1]+=E,w[2]+=K,w[3]+=Q,w[4]+=Z,w[5]+=B,w[6]+=J,w[7]+=F,$+=64,X-=64}return $}function c4(D){var w=new qE;w.update(D);var C=w.digest();return w.clean(),C}ME.hash=c4});var hE=k((xE)=>{Object.defineProperty(xE,"__esModule",{value:!0});xE.sharedKey=xE.generateKeyPair=xE.generateKeyPairFromSeed=xE.scalarMultBase=xE.scalarMult=xE.SHARED_KEY_LENGTH=xE.SECRET_KEY_LENGTH=xE.PUBLIC_KEY_LENGTH=void 0;var n4=dw(),l4=aD();xE.PUBLIC_KEY_LENGTH=32;xE.SECRET_KEY_LENGTH=32;xE.SHARED_KEY_LENGTH=32;function eD(D){let w=new Float64Array(16);if(D)for(let C=0;C<D.length;C++)w[C]=D[C];return w}var LE=new Uint8Array(32);LE[0]=9;var i4=eD([56129,1]);function cw(D){let w=1;for(let C=0;C<16;C++){let $=D[C]+w+65535;w=Math.floor($/65536),D[C]=$-w*65536}D[0]+=w-1+37*(w-1)}function b0(D,w,C){let $=~(C-1);for(let X=0;X<16;X++){let Y=$&(D[X]^w[X]);D[X]^=Y,w[X]^=Y}}function r4(D,w){let C=eD(),$=eD();for(let X=0;X<16;X++)$[X]=w[X];cw($),cw($),cw($);for(let X=0;X<2;X++){C[0]=$[0]-65517;for(let E=1;E<15;E++)C[E]=$[E]-65535-(C[E-1]>>16&1),C[E-1]&=65535;C[15]=$[15]-32767-(C[14]>>16&1);let Y=C[15]>>16&1;C[14]&=65535,b0($,C,1-Y)}for(let X=0;X<16;X++)D[2*X]=$[X]&255,D[2*X+1]=$[X]>>8}function o4(D,w){for(let C=0;C<16;C++)D[C]=w[2*C]+(w[2*C+1]<<8);D[15]&=32767}function d3(D,w,C){for(let $=0;$<16;$++)D[$]=w[$]+C[$]}function y3(D,w,C){for(let $=0;$<16;$++)D[$]=w[$]-C[$]}function Z8(D,w,C){let $,X,Y=0,E=0,K=0,Q=0,Z=0,B=0,J=0,F=0,W=0,N=0,G=0,V=0,H=0,z=0,O=0,A=0,M=0,T=0,f=0,q=0,L=0,d=0,v=0,n=0,i=0,r=0,I=0,U=0,P=0,S=0,u=0,_=C[0],j=C[1],x=C[2],m=C[3],h=C[4],g=C[5],b=C[6],y=C[7],o=C[8],a=C[9],s=C[10],$D=C[11],QD=C[12],ZD=C[13],ND=C[14],WD=C[15];$=w[0],Y+=$*_,E+=$*j,K+=$*x,Q+=$*m,Z+=$*h,B+=$*g,J+=$*b,F+=$*y,W+=$*o,N+=$*a,G+=$*s,V+=$*$D,H+=$*QD,z+=$*ZD,O+=$*ND,A+=$*WD,$=w[1],E+=$*_,K+=$*j,Q+=$*x,Z+=$*m,B+=$*h,J+=$*g,F+=$*b,W+=$*y,N+=$*o,G+=$*a,V+=$*s,H+=$*$D,z+=$*QD,O+=$*ZD,A+=$*ND,M+=$*WD,$=w[2],K+=$*_,Q+=$*j,Z+=$*x,B+=$*m,J+=$*h,F+=$*g,W+=$*b,N+=$*y,G+=$*o,V+=$*a,H+=$*s,z+=$*$D,O+=$*QD,A+=$*ZD,M+=$*ND,T+=$*WD,$=w[3],Q+=$*_,Z+=$*j,B+=$*x,J+=$*m,F+=$*h,W+=$*g,N+=$*b,G+=$*y,V+=$*o,H+=$*a,z+=$*s,O+=$*$D,A+=$*QD,M+=$*ZD,T+=$*ND,f+=$*WD,$=w[4],Z+=$*_,B+=$*j,J+=$*x,F+=$*m,W+=$*h,N+=$*g,G+=$*b,V+=$*y,H+=$*o,z+=$*a,O+=$*s,A+=$*$D,M+=$*QD,T+=$*ZD,f+=$*ND,q+=$*WD,$=w[5],B+=$*_,J+=$*j,F+=$*x,W+=$*m,N+=$*h,G+=$*g,V+=$*b,H+=$*y,z+=$*o,O+=$*a,A+=$*s,M+=$*$D,T+=$*QD,f+=$*ZD,q+=$*ND,L+=$*WD,$=w[6],J+=$*_,F+=$*j,W+=$*x,N+=$*m,G+=$*h,V+=$*g,H+=$*b,z+=$*y,O+=$*o,A+=$*a,M+=$*s,T+=$*$D,f+=$*QD,q+=$*ZD,L+=$*ND,d+=$*WD,$=w[7],F+=$*_,W+=$*j,N+=$*x,G+=$*m,V+=$*h,H+=$*g,z+=$*b,O+=$*y,A+=$*o,M+=$*a,T+=$*s,f+=$*$D,q+=$*QD,L+=$*ZD,d+=$*ND,v+=$*WD,$=w[8],W+=$*_,N+=$*j,G+=$*x,V+=$*m,H+=$*h,z+=$*g,O+=$*b,A+=$*y,M+=$*o,T+=$*a,f+=$*s,q+=$*$D,L+=$*QD,d+=$*ZD,v+=$*ND,n+=$*WD,$=w[9],N+=$*_,G+=$*j,V+=$*x,H+=$*m,z+=$*h,O+=$*g,A+=$*b,M+=$*y,T+=$*o,f+=$*a,q+=$*s,L+=$*$D,d+=$*QD,v+=$*ZD,n+=$*ND,i+=$*WD,$=w[10],G+=$*_,V+=$*j,H+=$*x,z+=$*m,O+=$*h,A+=$*g,M+=$*b,T+=$*y,f+=$*o,q+=$*a,L+=$*s,d+=$*$D,v+=$*QD,n+=$*ZD,i+=$*ND,r+=$*WD,$=w[11],V+=$*_,H+=$*j,z+=$*x,O+=$*m,A+=$*h,M+=$*g,T+=$*b,f+=$*y,q+=$*o,L+=$*a,d+=$*s,v+=$*$D,n+=$*QD,i+=$*ZD,r+=$*ND,I+=$*WD,$=w[12],H+=$*_,z+=$*j,O+=$*x,A+=$*m,M+=$*h,T+=$*g,f+=$*b,q+=$*y,L+=$*o,d+=$*a,v+=$*s,n+=$*$D,i+=$*QD,r+=$*ZD,I+=$*ND,U+=$*WD,$=w[13],z+=$*_,O+=$*j,A+=$*x,M+=$*m,T+=$*h,f+=$*g,q+=$*b,L+=$*y,d+=$*o,v+=$*a,n+=$*s,i+=$*$D,r+=$*QD,I+=$*ZD,U+=$*ND,P+=$*WD,$=w[14],O+=$*_,A+=$*j,M+=$*x,T+=$*m,f+=$*h,q+=$*g,L+=$*b,d+=$*y,v+=$*o,n+=$*a,i+=$*s,r+=$*$D,I+=$*QD,U+=$*ZD,P+=$*ND,S+=$*WD,$=w[15],A+=$*_,M+=$*j,T+=$*x,f+=$*m,q+=$*h,L+=$*g,d+=$*b,v+=$*y,n+=$*o,i+=$*a,r+=$*s,I+=$*$D,U+=$*QD,P+=$*ZD,S+=$*ND,u+=$*WD,Y+=38*M,E+=38*T,K+=38*f,Q+=38*q,Z+=38*L,B+=38*d,J+=38*v,F+=38*n,W+=38*i,N+=38*r,G+=38*I,V+=38*U,H+=38*P,z+=38*S,O+=38*u,X=1,$=Y+X+65535,X=Math.floor($/65536),Y=$-X*65536,$=E+X+65535,X=Math.floor($/65536),E=$-X*65536,$=K+X+65535,X=Math.floor($/65536),K=$-X*65536,$=Q+X+65535,X=Math.floor($/65536),Q=$-X*65536,$=Z+X+65535,X=Math.floor($/65536),Z=$-X*65536,$=B+X+65535,X=Math.floor($/65536),B=$-X*65536,$=J+X+65535,X=Math.floor($/65536),J=$-X*65536,$=F+X+65535,X=Math.floor($/65536),F=$-X*65536,$=W+X+65535,X=Math.floor($/65536),W=$-X*65536,$=N+X+65535,X=Math.floor($/65536),N=$-X*65536,$=G+X+65535,X=Math.floor($/65536),G=$-X*65536,$=V+X+65535,X=Math.floor($/65536),V=$-X*65536,$=H+X+65535,X=Math.floor($/65536),H=$-X*65536,$=z+X+65535,X=Math.floor($/65536),z=$-X*65536,$=O+X+65535,X=Math.floor($/65536),O=$-X*65536,$=A+X+65535,X=Math.floor($/65536),A=$-X*65536,Y+=X-1+37*(X-1),X=1,$=Y+X+65535,X=Math.floor($/65536),Y=$-X*65536,$=E+X+65535,X=Math.floor($/65536),E=$-X*65536,$=K+X+65535,X=Math.floor($/65536),K=$-X*65536,$=Q+X+65535,X=Math.floor($/65536),Q=$-X*65536,$=Z+X+65535,X=Math.floor($/65536),Z=$-X*65536,$=B+X+65535,X=Math.floor($/65536),B=$-X*65536,$=J+X+65535,X=Math.floor($/65536),J=$-X*65536,$=F+X+65535,X=Math.floor($/65536),F=$-X*65536,$=W+X+65535,X=Math.floor($/65536),W=$-X*65536,$=N+X+65535,X=Math.floor($/65536),N=$-X*65536,$=G+X+65535,X=Math.floor($/65536),G=$-X*65536,$=V+X+65535,X=Math.floor($/65536),V=$-X*65536,$=H+X+65535,X=Math.floor($/65536),H=$-X*65536,$=z+X+65535,X=Math.floor($/65536),z=$-X*65536,$=O+X+65535,X=Math.floor($/65536),O=$-X*65536,$=A+X+65535,X=Math.floor($/65536),A=$-X*65536,Y+=X-1+37*(X-1),D[0]=Y,D[1]=E,D[2]=K,D[3]=Q,D[4]=Z,D[5]=B,D[6]=J,D[7]=F,D[8]=W,D[9]=N,D[10]=G,D[11]=V,D[12]=H,D[13]=z,D[14]=O,D[15]=A}function d0(D,w){Z8(D,w,w)}function s4(D,w){let C=eD();for(let $=0;$<16;$++)C[$]=w[$];for(let $=253;$>=0;$--)if(d0(C,C),$!==2&&$!==4)Z8(C,C,w);for(let $=0;$<16;$++)D[$]=C[$]}function nw(D,w){let C=new Uint8Array(32),$=new Float64Array(80),X=eD(),Y=eD(),E=eD(),K=eD(),Q=eD(),Z=eD();for(let W=0;W<31;W++)C[W]=D[W];C[31]=D[31]&127|64,C[0]&=248,o4($,w);for(let W=0;W<16;W++)Y[W]=$[W];X[0]=K[0]=1;for(let W=254;W>=0;--W){let N=C[W>>>3]>>>(W&7)&1;b0(X,Y,N),b0(E,K,N),d3(Q,X,E),y3(X,X,E),d3(E,Y,K),y3(Y,Y,K),d0(K,Q),d0(Z,X),Z8(X,E,X),Z8(E,Y,Q),d3(Q,X,E),y3(X,X,E),d0(Y,X),y3(E,K,Z),Z8(X,E,i4),d3(X,X,K),Z8(E,E,X),Z8(X,K,Z),Z8(K,Y,$),d0(Y,Q),b0(X,Y,N),b0(E,K,N)}for(let W=0;W<16;W++)$[W+16]=X[W],$[W+32]=E[W],$[W+48]=Y[W],$[W+64]=K[W];let B=$.subarray(32),J=$.subarray(16);s4(B,B),Z8(J,J,B);let F=new Uint8Array(32);return r4(F,J),F}xE.scalarMult=nw;function _E(D){return nw(D,LE)}xE.scalarMultBase=_E;function jE(D){if(D.length!==xE.SECRET_KEY_LENGTH)throw new Error(`x25519: seed must be ${xE.SECRET_KEY_LENGTH} bytes`);let w=new Uint8Array(D);return{publicKey:_E(w),secretKey:w}}xE.generateKeyPairFromSeed=jE;function a4(D){let w=n4.randomBytes(32,D),C=jE(w);return l4.wipe(w),C}xE.generateKeyPair=a4;function t4(D,w,C=!1){if(D.length!==xE.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect secret key length");if(w.length!==xE.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect public key length");let $=nw(D,w);if(C){let X=0;for(let Y=0;Y<$.length;Y++)X|=$[Y];if(X===0)throw new Error("X25519: invalid shared key")}return $}xE.sharedKey=t4});var QC=k((NK)=>{Object.defineProperty(NK,"__esModule",{value:!0});NK.getLocalStorage=NK.getLocalStorageOrThrow=NK.getCrypto=NK.getCryptoOrThrow=NK.getLocation=NK.getLocationOrThrow=NK.getNavigator=NK.getNavigatorOrThrow=NK.getDocument=NK.getDocumentOrThrow=NK.getFromWindowOrThrow=NK.getFromWindow=void 0;function h8(D){let w=void 0;if(typeof window!=="undefined"&&typeof window[D]!=="undefined")w=window[D];return w}NK.getFromWindow=h8;function Y0(D){let w=h8(D);if(!w)throw new Error(`${D} is not defined in Window`);return w}NK.getFromWindowOrThrow=Y0;function MV(){return Y0("document")}NK.getDocumentOrThrow=MV;function TV(){return h8("document")}NK.getDocument=TV;function SV(){return Y0("navigator")}NK.getNavigatorOrThrow=SV;function RV(){return h8("navigator")}NK.getNavigator=RV;function LV(){return Y0("location")}NK.getLocationOrThrow=LV;function _V(){return h8("location")}NK.getLocation=_V;function jV(){return Y0("crypto")}NK.getCryptoOrThrow=jV;function xV(){return h8("crypto")}NK.getCrypto=xV;function mV(){return Y0("localStorage")}NK.getLocalStorageOrThrow=mV;function hV(){return h8("localStorage")}NK.getLocalStorage=hV});var PK=k((GK)=>{Object.defineProperty(GK,"__esModule",{value:!0});GK.getWindowMetadata=void 0;var FK=QC();function iV(){let D,w;try{D=FK.getDocumentOrThrow(),w=FK.getLocationOrThrow()}catch(J){return null}function C(){let J=D.getElementsByTagName("link"),F=[];for(let W=0;W<J.length;W++){let N=J[W],G=N.getAttribute("rel");if(G){if(G.toLowerCase().indexOf("icon")>-1){let V=N.getAttribute("href");if(V)if(V.toLowerCase().indexOf("https:")===-1&&V.toLowerCase().indexOf("http:")===-1&&V.indexOf("//")!==0){let H=w.protocol+"//"+w.host;if(V.indexOf("/")===0)H+=V;else{let z=w.pathname.split("/");z.pop();let O=z.join("/");H+=O+"/"+V}F.push(H)}else if(V.indexOf("//")===0){let H=w.protocol+V;F.push(H)}else F.push(V)}}}return F}function $(...J){let F=D.getElementsByTagName("meta");for(let W=0;W<F.length;W++){let N=F[W],G=["itemprop","property","name"].map((V)=>N.getAttribute(V)).filter((V)=>{if(V)return J.includes(V);return!1});if(G.length&&G){let V=N.getAttribute("content");if(V)return V}}return""}function X(){let J=$("name","og:site_name","og:title","twitter:title");if(!J)J=D.title;return J}function Y(){return $("description","og:description","twitter:description","keywords")}let E=X(),K=Y(),Q=w.origin,Z=C();return{description:K,url:Q,icons:Z,name:E}}GK.getWindowMetadata=iV});var zK=k((Zf,VK)=>{VK.exports=(D)=>encodeURIComponent(D).replace(/[!'()*]/g,(w)=>`%${w.charCodeAt(0).toString(16).toUpperCase()}`)});var UK=k((Bf,fK)=>{var HK="%[a-f0-9]{2}",AK=new RegExp("("+HK+")|([^%]+?)","gi"),IK=new RegExp("("+HK+")+","gi");function ZC(D,w){try{return[decodeURIComponent(D.join(""))]}catch(X){}if(D.length===1)return D;w=w||1;var C=D.slice(0,w),$=D.slice(w);return Array.prototype.concat.call([],ZC(C),ZC($))}function rV(D){try{return decodeURIComponent(D)}catch($){var w=D.match(AK)||[];for(var C=1;C<w.length;C++)D=ZC(w,C).join(""),w=D.match(AK)||[];return D}}function oV(D){var w={"%FE%FF":"��","%FF%FE":"��"},C=IK.exec(D);while(C){try{w[C[0]]=decodeURIComponent(C[0])}catch(K){var $=rV(C[0]);if($!==C[0])w[C[0]]=$}C=IK.exec(D)}w["%C2"]="�";var X=Object.keys(w);for(var Y=0;Y<X.length;Y++){var E=X[Y];D=D.replace(new RegExp(E,"g"),w[E])}return D}fK.exports=function(D){if(typeof D!=="string")throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof D+"`");try{return D=D.replace(/\+/g," "),decodeURIComponent(D)}catch(w){return oV(D)}}});var MK=k((Jf,qK)=>{qK.exports=(D,w)=>{if(!(typeof D==="string"&&typeof w==="string"))throw new TypeError("Expected the arguments to be of type `string`");if(w==="")return[D];let C=D.indexOf(w);if(C===-1)return[D];return[D.slice(0,C),D.slice(C+w.length)]}});var SK=k((Nf,TK)=>{TK.exports=function(D,w){var C={},$=Object.keys(D),X=Array.isArray(w);for(var Y=0;Y<$.length;Y++){var E=$[Y],K=D[E];if(X?w.indexOf(E)!==-1:w(E,K,D))C[E]=K}return C}});var hQ=k((xQ)=>{Object.defineProperty(xQ,"__esModule",{value:!0});xQ.isBrowserCryptoAvailable=xQ.getSubtleCrypto=xQ.getBrowerCrypto=void 0;function TC(){return(global===null||global===void 0?void 0:global.crypto)||(global===null||global===void 0?void 0:global.msCrypto)||{}}xQ.getBrowerCrypto=TC;function jQ(){let D=TC();return D.subtle||D.webkitSubtle}xQ.getSubtleCrypto=jQ;function cz(){return!!TC()&&!!jQ()}xQ.isBrowserCryptoAvailable=cz});var dQ=k((kQ)=>{Object.defineProperty(kQ,"__esModule",{value:!0});kQ.isBrowser=kQ.isNode=kQ.isReactNative=void 0;function gQ(){return typeof document==="undefined"&&typeof navigator!=="undefined"&&navigator.product==="ReactNative"}kQ.isReactNative=gQ;function uQ(){return typeof process!=="undefined"&&typeof process.versions!=="undefined"&&typeof process.versions.node!=="undefined"}kQ.isNode=uQ;function nz(){return!gQ()&&!uQ()}kQ.isBrowser=nz});var SC=k((Y1)=>{Object.defineProperty(Y1,"__esModule",{value:!0});var yQ=(rD(),vD(iD));yQ.__exportStar(hQ(),Y1);yQ.__exportStar(dQ(),Y1)});var CZ=k((tf,wZ)=>{wZ.exports=function(){throw new Error("ws does not work in the browser. Browser clients must use the native WebSocket object")}});var vZ=k((Z1,P0)=>{var sz=200,vC="__lodash_hash_undefined__",P1=1,AZ=2,IZ=9007199254740991,B1="[object Arguments]",gC="[object Array]",az="[object AsyncFunction]",HZ="[object Boolean]",fZ="[object Date]",UZ="[object Error]",qZ="[object Function]",tz="[object GeneratorFunction]",J1="[object Map]",MZ="[object Number]",ez="[object Null]",O0="[object Object]",ZZ="[object Promise]",DA="[object Proxy]",TZ="[object RegExp]",N1="[object Set]",SZ="[object String]",wA="[object Symbol]",CA="[object Undefined]",uC="[object WeakMap]",RZ="[object ArrayBuffer]",W1="[object DataView]",$A="[object Float32Array]",XA="[object Float64Array]",YA="[object Int8Array]",EA="[object Int16Array]",KA="[object Int32Array]",QA="[object Uint8Array]",ZA="[object Uint8ClampedArray]",BA="[object Uint16Array]",JA="[object Uint32Array]",NA=/[\\^$.*+?()[\]{}|]/g,WA=/^\[object .+?Constructor\]$/,FA=/^(?:0|[1-9]\d*)$/,t={};t[$A]=t[XA]=t[YA]=t[EA]=t[KA]=t[QA]=t[ZA]=t[BA]=t[JA]=!0;t[B1]=t[gC]=t[RZ]=t[HZ]=t[W1]=t[fZ]=t[UZ]=t[qZ]=t[J1]=t[MZ]=t[O0]=t[TZ]=t[N1]=t[SZ]=t[uC]=!1;var LZ=typeof global=="object"&&global&&global.Object===Object&&global,GA=typeof self=="object"&&self&&self.Object===Object&&self,G8=LZ||GA||Function("return this")(),_Z=typeof Z1=="object"&&Z1&&!Z1.nodeType&&Z1,BZ=_Z&&typeof P0=="object"&&P0&&!P0.nodeType&&P0,jZ=BZ&&BZ.exports===_Z,xC=jZ&&LZ.process,JZ=function(){try{return xC&&xC.binding&&xC.binding("util")}catch(D){}}(),NZ=JZ&&JZ.isTypedArray;function OA(D,w){var C=-1,$=D==null?0:D.length,X=0,Y=[];while(++C<$){var E=D[C];if(w(E,C,D))Y[X++]=E}return Y}function PA(D,w){var C=-1,$=w.length,X=D.length;while(++C<$)D[X+C]=w[C];return D}function VA(D,w){var C=-1,$=D==null?0:D.length;while(++C<$)if(w(D[C],C,D))return!0;return!1}function zA(D,w){var C=-1,$=Array(D);while(++C<D)$[C]=w(C);return $}function AA(D){return function(w){return D(w)}}function IA(D,w){return D.has(w)}function HA(D,w){return D==null?void 0:D[w]}function fA(D){var w=-1,C=Array(D.size);return D.forEach(function($,X){C[++w]=[X,$]}),C}function UA(D,w){return function(C){return D(w(C))}}function qA(D){var w=-1,C=Array(D.size);return D.forEach(function($){C[++w]=$}),C}var MA=Array.prototype,TA=Function.prototype,V1=Object.prototype,mC=G8["__core-js_shared__"],xZ=TA.toString,$8=V1.hasOwnProperty,WZ=function(){var D=/[^.]+$/.exec(mC&&mC.keys&&mC.keys.IE_PROTO||"");return D?"Symbol(src)_1."+D:""}(),mZ=V1.toString,SA=RegExp("^"+xZ.call($8).replace(NA,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),FZ=jZ?G8.Buffer:void 0,F1=G8.Symbol,GZ=G8.Uint8Array,hZ=V1.propertyIsEnumerable,RA=MA.splice,y8=F1?F1.toStringTag:void 0,OZ=Object.getOwnPropertySymbols,LA=FZ?FZ.isBuffer:void 0,_A=UA(Object.keys,Object),kC=V0(G8,"DataView"),K3=V0(G8,"Map"),bC=V0(G8,"Promise"),dC=V0(G8,"Set"),yC=V0(G8,"WeakMap"),Q3=V0(Object,"create"),jA=p8(kC),xA=p8(K3),mA=p8(bC),hA=p8(dC),gA=p8(yC),PZ=F1?F1.prototype:void 0,hC=PZ?PZ.valueOf:void 0;function c8(D){var w=-1,C=D==null?0:D.length;this.clear();while(++w<C){var $=D[w];this.set($[0],$[1])}}function uA(){this.__data__=Q3?Q3(null):{},this.size=0}function kA(D){var w=this.has(D)&&delete this.__data__[D];return this.size-=w?1:0,w}function bA(D){var w=this.__data__;if(Q3){var C=w[D];return C===vC?void 0:C}return $8.call(w,D)?w[D]:void 0}function dA(D){var w=this.__data__;return Q3?w[D]!==void 0:$8.call(w,D)}function yA(D,w){var C=this.__data__;return this.size+=this.has(D)?0:1,C[D]=Q3&&w===void 0?vC:w,this}c8.prototype.clear=uA;c8.prototype.delete=kA;c8.prototype.get=bA;c8.prototype.has=dA;c8.prototype.set=yA;function O8(D){var w=-1,C=D==null?0:D.length;this.clear();while(++w<C){var $=D[w];this.set($[0],$[1])}}function cA(){this.__data__=[],this.size=0}function vA(D){var w=this.__data__,C=z1(w,D);if(C<0)return!1;var $=w.length-1;if(C==$)w.pop();else RA.call(w,C,1);return--this.size,!0}function pA(D){var w=this.__data__,C=z1(w,D);return C<0?void 0:w[C][1]}function nA(D){return z1(this.__data__,D)>-1}function lA(D,w){var C=this.__data__,$=z1(C,D);if($<0)++this.size,C.push([D,w]);else C[$][1]=w;return this}O8.prototype.clear=cA;O8.prototype.delete=vA;O8.prototype.get=pA;O8.prototype.has=nA;O8.prototype.set=lA;function v8(D){var w=-1,C=D==null?0:D.length;this.clear();while(++w<C){var $=D[w];this.set($[0],$[1])}}function iA(){this.size=0,this.__data__={hash:new c8,map:new(K3||O8),string:new c8}}function rA(D){var w=A1(this,D).delete(D);return this.size-=w?1:0,w}function oA(D){return A1(this,D).get(D)}function sA(D){return A1(this,D).has(D)}function aA(D,w){var C=A1(this,D),$=C.size;return C.set(D,w),this.size+=C.size==$?0:1,this}v8.prototype.clear=iA;v8.prototype.delete=rA;v8.prototype.get=oA;v8.prototype.has=sA;v8.prototype.set=aA;function G1(D){var w=-1,C=D==null?0:D.length;this.__data__=new v8;while(++w<C)this.add(D[w])}function tA(D){return this.__data__.set(D,vC),this}function eA(D){return this.__data__.has(D)}G1.prototype.add=G1.prototype.push=tA;G1.prototype.has=eA;function S8(D){var w=this.__data__=new O8(D);this.size=w.size}function DI(){this.__data__=new O8,this.size=0}function wI(D){var w=this.__data__,C=w.delete(D);return this.size=w.size,C}function CI(D){return this.__data__.get(D)}function $I(D){return this.__data__.has(D)}function XI(D,w){var C=this.__data__;if(C instanceof O8){var $=C.__data__;if(!K3||$.length<sz-1)return $.push([D,w]),this.size=++C.size,this;C=this.__data__=new v8($)}return C.set(D,w),this.size=C.size,this}S8.prototype.clear=DI;S8.prototype.delete=wI;S8.prototype.get=CI;S8.prototype.has=$I;S8.prototype.set=XI;function YI(D,w){var C=O1(D),$=!C&&AI(D),X=!C&&!$&&cC(D),Y=!C&&!$&&!X&&cZ(D),E=C||$||X||Y,K=E?zA(D.length,String):[],Q=K.length;for(var Z in D)if((w||$8.call(D,Z))&&!(E&&(Z=="length"||X&&(Z=="offset"||Z=="parent")||Y&&(Z=="buffer"||Z=="byteLength"||Z=="byteOffset")||GI(Z,Q))))K.push(Z);return K}function z1(D,w){var C=D.length;while(C--)if(kZ(D[C][0],w))return C;return-1}function EI(D,w,C){var $=w(D);return O1(D)?$:PA($,C(D))}function B3(D){if(D==null)return D===void 0?CA:ez;return y8&&y8 in Object(D)?WI(D):zI(D)}function VZ(D){return Z3(D)&&B3(D)==B1}function gZ(D,w,C,$,X){if(D===w)return!0;if(D==null||w==null||!Z3(D)&&!Z3(w))return D!==D&&w!==w;return KI(D,w,C,$,gZ,X)}function KI(D,w,C,$,X,Y){var E=O1(D),K=O1(w),Q=E?gC:T8(D),Z=K?gC:T8(w);Q=Q==B1?O0:Q,Z=Z==B1?O0:Z;var B=Q==O0,J=Z==O0,F=Q==Z;if(F&&cC(D)){if(!cC(w))return!1;E=!0,B=!1}if(F&&!B)return Y||(Y=new S8),E||cZ(D)?uZ(D,w,C,$,X,Y):JI(D,w,Q,C,$,X,Y);if(!(C&P1)){var W=B&&$8.call(D,"__wrapped__"),N=J&&$8.call(w,"__wrapped__");if(W||N){var G=W?D.value():D,V=N?w.value():w;return Y||(Y=new S8),X(G,V,C,$,Y)}}if(!F)return!1;return Y||(Y=new S8),NI(D,w,C,$,X,Y)}function QI(D){if(!yZ(D)||PI(D))return!1;var w=bZ(D)?SA:WA;return w.test(p8(D))}function ZI(D){return Z3(D)&&dZ(D.length)&&!!t[B3(D)]}function BI(D){if(!VI(D))return _A(D);var w=[];for(var C in Object(D))if($8.call(D,C)&&C!="constructor")w.push(C);return w}function uZ(D,w,C,$,X,Y){var E=C&P1,K=D.length,Q=w.length;if(K!=Q&&!(E&&Q>K))return!1;var Z=Y.get(D);if(Z&&Y.get(w))return Z==w;var B=-1,J=!0,F=C&AZ?new G1:void 0;Y.set(D,w),Y.set(w,D);while(++B<K){var W=D[B],N=w[B];if($)var G=E?$(N,W,B,w,D,Y):$(W,N,B,D,w,Y);if(G!==void 0){if(G)continue;J=!1;break}if(F){if(!VA(w,function(V,H){if(!IA(F,H)&&(W===V||X(W,V,C,$,Y)))return F.push(H)})){J=!1;break}}else if(!(W===N||X(W,N,C,$,Y))){J=!1;break}}return Y.delete(D),Y.delete(w),J}function JI(D,w,C,$,X,Y,E){switch(C){case W1:if(D.byteLength!=w.byteLength||D.byteOffset!=w.byteOffset)return!1;D=D.buffer,w=w.buffer;case RZ:if(D.byteLength!=w.byteLength||!Y(new GZ(D),new GZ(w)))return!1;return!0;case HZ:case fZ:case MZ:return kZ(+D,+w);case UZ:return D.name==w.name&&D.message==w.message;case TZ:case SZ:return D==w+"";case J1:var K=fA;case N1:var Q=$&P1;if(K||(K=qA),D.size!=w.size&&!Q)return!1;var Z=E.get(D);if(Z)return Z==w;$|=AZ,E.set(D,w);var B=uZ(K(D),K(w),$,X,Y,E);return E.delete(D),B;case wA:if(hC)return hC.call(D)==hC.call(w)}return!1}function NI(D,w,C,$,X,Y){var E=C&P1,K=zZ(D),Q=K.length,Z=zZ(w),B=Z.length;if(Q!=B&&!E)return!1;var J=Q;while(J--){var F=K[J];if(!(E?F in w:$8.call(w,F)))return!1}var W=Y.get(D);if(W&&Y.get(w))return W==w;var N=!0;Y.set(D,w),Y.set(w,D);var G=E;while(++J<Q){F=K[J];var V=D[F],H=w[F];if($)var z=E?$(H,V,F,w,D,Y):$(V,H,F,D,w,Y);if(!(z===void 0?V===H||X(V,H,C,$,Y):z)){N=!1;break}G||(G=F=="constructor")}if(N&&!G){var O=D.constructor,A=w.constructor;if(O!=A&&(("constructor"in D)&&("constructor"in w))&&!(typeof O=="function"&&O instanceof O&&typeof A=="function"&&A instanceof A))N=!1}return Y.delete(D),Y.delete(w),N}function zZ(D){return EI(D,fI,FI)}function A1(D,w){var C=D.__data__;return OI(w)?C[typeof w=="string"?"string":"hash"]:C.map}function V0(D,w){var C=HA(D,w);return QI(C)?C:void 0}function WI(D){var w=$8.call(D,y8),C=D[y8];try{D[y8]=void 0;var $=!0}catch(Y){}var X=mZ.call(D);if($)if(w)D[y8]=C;else delete D[y8];return X}var FI=!OZ?UI:function(D){if(D==null)return[];return D=Object(D),OA(OZ(D),function(w){return hZ.call(D,w)})},T8=B3;if(kC&&T8(new kC(new ArrayBuffer(1)))!=W1||K3&&T8(new K3)!=J1||bC&&T8(bC.resolve())!=ZZ||dC&&T8(new dC)!=N1||yC&&T8(new yC)!=uC)T8=function(D){var w=B3(D),C=w==O0?D.constructor:void 0,$=C?p8(C):"";if($)switch($){case jA:return W1;case xA:return J1;case mA:return ZZ;case hA:return N1;case gA:return uC}return w};function GI(D,w){return w=w==null?IZ:w,!!w&&(typeof D=="number"||FA.test(D))&&(D>-1&&D%1==0&&D<w)}function OI(D){var w=typeof D;return w=="string"||w=="number"||w=="symbol"||w=="boolean"?D!=="__proto__":D===null}function PI(D){return!!WZ&&WZ in D}function VI(D){var w=D&&D.constructor,C=typeof w=="function"&&w.prototype||V1;return D===C}function zI(D){return mZ.call(D)}function p8(D){if(D!=null){try{return xZ.call(D)}catch(w){}try{return D+""}catch(w){}}return""}function kZ(D,w){return D===w||D!==D&&w!==w}var AI=VZ(function(){return arguments}())?VZ:function(D){return Z3(D)&&$8.call(D,"callee")&&!hZ.call(D,"callee")},O1=Array.isArray;function II(D){return D!=null&&dZ(D.length)&&!bZ(D)}var cC=LA||qI;function HI(D,w){return gZ(D,w)}function bZ(D){if(!yZ(D))return!1;var w=B3(D);return w==qZ||w==tz||w==az||w==DA}function dZ(D){return typeof D=="number"&&D>-1&&D%1==0&&D<=IZ}function yZ(D){var w=typeof D;return D!=null&&(w=="object"||w=="function")}function Z3(D){return D!=null&&typeof D=="object"}var cZ=NZ?AA(NZ):ZI;function fI(D){return II(D)?YI(D):BI(D)}function UI(){return[]}function qI(){return!1}P0.exports=HI});class T1{constructor(D){this.openModal=V3.open,this.closeModal=V3.close,this.subscribeModal=V3.subscribe,this.setTheme=M1.setThemeConfig,M1.setThemeConfig(D),W$.setConfig(D),this.initUi()}async initUi(){if(typeof window<"u"){await import("./chunk-jrc84sb2.js");let D=document.createElement("wcm-modal");document.body.insertAdjacentElement("beforeend",D),N$.setIsUiLoaded(!0)}}}s8();var KJ=/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,QJ=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,ZJ=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/;function BJ(D,w){if(D==="__proto__"||D==="constructor"&&w&&typeof w==="object"&&"prototype"in w){JJ(D);return}return w}function JJ(D){console.warn(`[destr] Dropping "${D}" key to prevent prototype pollution.`)}function I0(D,w={}){if(typeof D!=="string")return D;let C=D.trim();if(D[0]==='"'&&D.endsWith('"')&&!D.includes("\\"))return C.slice(1,-1);if(C.length<=9){let $=C.toLowerCase();if($==="true")return!0;if($==="false")return!1;if($==="undefined")return;if($==="null")return null;if($==="nan")return Number.NaN;if($==="infinity")return Number.POSITIVE_INFINITY;if($==="-infinity")return Number.NEGATIVE_INFINITY}if(!ZJ.test(D)){if(w.strict)throw new SyntaxError("[destr] Invalid JSON");return D}try{if(KJ.test(D)||QJ.test(D)){if(w.strict)throw new Error("[destr] Possible prototype pollution");return JSON.parse(D,BJ)}return JSON.parse(D)}catch($){if(w.strict)throw $;return D}}function NJ(D){if(!D||typeof D.then!=="function")return Promise.resolve(D);return D}function BD(D,...w){try{return NJ(D(...w))}catch(C){return Promise.reject(C)}}function WJ(D){let w=typeof D;return D===null||w!=="object"&&w!=="function"}function FJ(D){let w=Object.getPrototypeOf(D);return!w||w.isPrototypeOf(Object)}function H0(D){if(WJ(D))return String(D);if(FJ(D)||Array.isArray(D))return JSON.stringify(D);if(typeof D.toJSON==="function")return H0(D.toJSON());throw new Error("[unstorage] Cannot stringify value!")}var S1="base64:";function F$(D){if(typeof D==="string")return D;return S1+OJ(D)}function G$(D){if(typeof D!=="string")return D;if(!D.startsWith(S1))return D;return GJ(D.slice(S1.length))}function GJ(D){if(globalThis.Buffer)return Buffer.from(D,"base64");return Uint8Array.from(globalThis.atob(D),(w)=>w.codePointAt(0))}function OJ(D){if(globalThis.Buffer)return Buffer.from(D).toString("base64");return globalThis.btoa(String.fromCodePoint(...D))}function RD(D){if(!D)return"";return D.split("?")[0]?.replace(/[/\\]/g,":").replace(/:+/g,":").replace(/^:|:$/g,"")||""}function O$(...D){return RD(D.join(":"))}function f0(D){return D=RD(D),D?D+":":""}function PJ(D){return D}var VJ="memory",zJ=PJ(()=>{let D=new Map;return{name:VJ,getInstance:()=>D,hasItem(w){return D.has(w)},getItem(w){return D.get(w)??null},getItemRaw(w){return D.get(w)??null},setItem(w,C){D.set(w,C)},setItemRaw(w,C){D.set(w,C)},removeItem(w){D.delete(w)},getKeys(){return[...D.keys()]},clear(){D.clear()},dispose(){D.clear()}}});function z$(D={}){let w={mounts:{"":D.driver||zJ()},mountpoints:[""],watching:!1,watchListeners:[],unwatch:{}},C=(Z)=>{for(let B of w.mountpoints)if(Z.startsWith(B))return{base:B,relativeKey:Z.slice(B.length),driver:w.mounts[B]};return{base:"",relativeKey:Z,driver:w.mounts[""]}},$=(Z,B)=>{return w.mountpoints.filter((J)=>J.startsWith(Z)||B&&Z.startsWith(J)).map((J)=>({relativeBase:Z.length>J.length?Z.slice(J.length):void 0,mountpoint:J,driver:w.mounts[J]}))},X=(Z,B)=>{if(!w.watching)return;B=RD(B);for(let J of w.watchListeners)J(Z,B)},Y=async()=>{if(w.watching)return;w.watching=!0;for(let Z in w.mounts)w.unwatch[Z]=await P$(w.mounts[Z],X,Z)},E=async()=>{if(!w.watching)return;for(let Z in w.unwatch)await w.unwatch[Z]();w.unwatch={},w.watching=!1},K=(Z,B,J)=>{let F=new Map,W=(N)=>{let G=F.get(N.base);if(!G)G={driver:N.driver,base:N.base,items:[]},F.set(N.base,G);return G};for(let N of Z){let G=typeof N==="string",V=RD(G?N:N.key),H=G?void 0:N.value,z=G||!N.options?B:{...B,...N.options},O=C(V);W(O).items.push({key:V,value:H,relativeKey:O.relativeKey,options:z})}return Promise.all([...F.values()].map((N)=>J(N))).then((N)=>N.flat())},Q={hasItem(Z,B={}){Z=RD(Z);let{relativeKey:J,driver:F}=C(Z);return BD(F.hasItem,J,B)},getItem(Z,B={}){Z=RD(Z);let{relativeKey:J,driver:F}=C(Z);return BD(F.getItem,J,B).then((W)=>I0(W))},getItems(Z,B={}){return K(Z,B,(J)=>{if(J.driver.getItems)return BD(J.driver.getItems,J.items.map((F)=>({key:F.relativeKey,options:F.options})),B).then((F)=>F.map((W)=>({key:O$(J.base,W.key),value:I0(W.value)})));return Promise.all(J.items.map((F)=>{return BD(J.driver.getItem,F.relativeKey,F.options).then((W)=>({key:F.key,value:I0(W)}))}))})},getItemRaw(Z,B={}){Z=RD(Z);let{relativeKey:J,driver:F}=C(Z);if(F.getItemRaw)return BD(F.getItemRaw,J,B);return BD(F.getItem,J,B).then((W)=>G$(W))},async setItem(Z,B,J={}){if(B===void 0)return Q.removeItem(Z);Z=RD(Z);let{relativeKey:F,driver:W}=C(Z);if(!W.setItem)return;if(await BD(W.setItem,F,H0(B),J),!W.watch)X("update",Z)},async setItems(Z,B){await K(Z,B,async(J)=>{if(J.driver.setItems)return BD(J.driver.setItems,J.items.map((F)=>({key:F.relativeKey,value:H0(F.value),options:F.options})),B);if(!J.driver.setItem)return;await Promise.all(J.items.map((F)=>{return BD(J.driver.setItem,F.relativeKey,H0(F.value),F.options)}))})},async setItemRaw(Z,B,J={}){if(B===void 0)return Q.removeItem(Z,J);Z=RD(Z);let{relativeKey:F,driver:W}=C(Z);if(W.setItemRaw)await BD(W.setItemRaw,F,B,J);else if(W.setItem)await BD(W.setItem,F,F$(B),J);else return;if(!W.watch)X("update",Z)},async removeItem(Z,B={}){if(typeof B==="boolean")B={removeMeta:B};Z=RD(Z);let{relativeKey:J,driver:F}=C(Z);if(!F.removeItem)return;if(await BD(F.removeItem,J,B),B.removeMeta||B.removeMata)await BD(F.removeItem,J+"$",B);if(!F.watch)X("remove",Z)},async getMeta(Z,B={}){if(typeof B==="boolean")B={nativeOnly:B};Z=RD(Z);let{relativeKey:J,driver:F}=C(Z),W=Object.create(null);if(F.getMeta)Object.assign(W,await BD(F.getMeta,J,B));if(!B.nativeOnly){let N=await BD(F.getItem,J+"$",B).then((G)=>I0(G));if(N&&typeof N==="object"){if(typeof N.atime==="string")N.atime=new Date(N.atime);if(typeof N.mtime==="string")N.mtime=new Date(N.mtime);Object.assign(W,N)}}return W},setMeta(Z,B,J={}){return this.setItem(Z+"$",B,J)},removeMeta(Z,B={}){return this.removeItem(Z+"$",B)},async getKeys(Z,B={}){Z=f0(Z);let J=$(Z,!0),F=[],W=[];for(let N of J){let G=await BD(N.driver.getKeys,N.relativeBase,B);for(let V of G){let H=N.mountpoint+RD(V);if(!F.some((z)=>H.startsWith(z)))W.push(H)}F=[N.mountpoint,...F.filter((V)=>!V.startsWith(N.mountpoint))]}return Z?W.filter((N)=>N.startsWith(Z)&&N[N.length-1]!=="$"):W.filter((N)=>N[N.length-1]!=="$")},async clear(Z,B={}){Z=f0(Z),await Promise.all($(Z,!1).map(async(J)=>{if(J.driver.clear)return BD(J.driver.clear,J.relativeBase,B);if(J.driver.removeItem){let F=await J.driver.getKeys(J.relativeBase||"",B);return Promise.all(F.map((W)=>J.driver.removeItem(W,B)))}}))},async dispose(){await Promise.all(Object.values(w.mounts).map((Z)=>V$(Z)))},async watch(Z){return await Y(),w.watchListeners.push(Z),async()=>{if(w.watchListeners=w.watchListeners.filter((B)=>B!==Z),w.watchListeners.length===0)await E()}},async unwatch(){w.watchListeners=[],await E()},mount(Z,B){if(Z=f0(Z),Z&&w.mounts[Z])throw new Error(`already mounted at ${Z}`);if(Z)w.mountpoints.push(Z),w.mountpoints.sort((J,F)=>F.length-J.length);if(w.mounts[Z]=B,w.watching)Promise.resolve(P$(B,X,Z)).then((J)=>{w.unwatch[Z]=J}).catch(console.error);return Q},async unmount(Z,B=!0){if(Z=f0(Z),!Z||!w.mounts[Z])return;if(w.watching&&Z in w.unwatch)w.unwatch[Z]?.(),delete w.unwatch[Z];if(B)await V$(w.mounts[Z]);w.mountpoints=w.mountpoints.filter((J)=>J!==Z),delete w.mounts[Z]},getMount(Z=""){Z=RD(Z)+":";let B=C(Z);return{driver:B.driver,base:B.base}},getMounts(Z="",B={}){return Z=RD(Z),$(Z,B.parents).map((F)=>({driver:F.driver,base:F.mountpoint}))},keys:(Z,B={})=>Q.getKeys(Z,B),get:(Z,B={})=>Q.getItem(Z,B),set:(Z,B,J={})=>Q.setItem(Z,B,J),has:(Z,B={})=>Q.hasItem(Z,B),del:(Z,B={})=>Q.removeItem(Z,B),remove:(Z,B={})=>Q.removeItem(Z,B)};return Q}function P$(D,w,C){return D.watch?D.watch(($,X)=>w($,C+X)):()=>{}}async function V$(D){if(typeof D.dispose==="function")await BD(D.dispose)}function L8(D){return new Promise((w,C)=>{D.oncomplete=D.onsuccess=()=>w(D.result),D.onabort=D.onerror=()=>C(D.error)})}function L1(D,w){let C=indexedDB.open(D);C.onupgradeneeded=()=>C.result.createObjectStore(w);let $=L8(C);return(X,Y)=>$.then((E)=>Y(E.transaction(w,X).objectStore(w)))}var R1;function U0(){if(!R1)R1=L1("keyval-store","keyval");return R1}function _1(D,w=U0()){return w("readonly",(C)=>L8(C.get(D)))}function A$(D,w,C=U0()){return C("readwrite",($)=>{return $.put(w,D),L8($.transaction)})}function I$(D,w=U0()){return w("readwrite",(C)=>{return C.delete(D),L8(C.transaction)})}function H$(D=U0()){return D("readwrite",(w)=>{return w.clear(),L8(w.transaction)})}function AJ(D,w){return D.openCursor().onsuccess=function(){if(!this.result)return;w(this.result),this.result.continue()},L8(D.transaction)}function f$(D=U0()){return D("readonly",(w)=>{if(w.getAllKeys)return L8(w.getAllKeys());let C=[];return AJ(w,($)=>C.push($.key)).then(()=>C)})}var IJ=(D)=>JSON.stringify(D,(w,C)=>typeof C==="bigint"?C.toString()+"n":C),HJ=(D)=>{let w=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,C=D.replace(w,'$1"$2n"$3');return JSON.parse(C,($,X)=>{if(typeof X==="string"&&X.match(/^\d+n$/))return BigInt(X.substring(0,X.length-1));return X})};function z8(D){if(typeof D!=="string")throw new Error(`Cannot safe json parse value of type ${typeof D}`);try{return HJ(D)}catch(w){return D}}function lD(D){return typeof D==="string"?D:IJ(D)||""}var fJ="idb-keyval",UJ=(D={})=>{let w=D.base&&D.base.length>0?`${D.base}:`:"",C=(X)=>w+X,$;return D.dbName&&D.storeName&&($=L1(D.dbName,D.storeName)),{name:fJ,options:D,async hasItem(X){return!(typeof await _1(C(X),$)>"u")},async getItem(X){return await _1(C(X),$)??null},setItem(X,Y){return A$(C(X),Y,$)},removeItem(X){return I$(C(X),$)},getKeys(){return f$($)},clear(){return H$($)}}},qJ="WALLET_CONNECT_V2_INDEXED_DB",MJ="keyvaluestorage";class q${constructor(){this.indexedDb=z$({driver:UJ({dbName:qJ,storeName:MJ})})}async getKeys(){return this.indexedDb.getKeys()}async getEntries(){return(await this.indexedDb.getItems(await this.indexedDb.getKeys())).map((D)=>[D.key,D.value])}async getItem(D){let w=await this.indexedDb.getItem(D);if(w!==null)return w}async setItem(D,w){await this.indexedDb.setItem(D,lD(w))}async removeItem(D){await this.indexedDb.removeItem(D)}}var j1=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},z3={exports:{}};(function(){let D;function w(){}D=w,D.prototype.getItem=function(C){return this.hasOwnProperty(C)?String(this[C]):null},D.prototype.setItem=function(C,$){this[C]=String($)},D.prototype.removeItem=function(C){delete this[C]},D.prototype.clear=function(){let C=this;Object.keys(C).forEach(function($){C[$]=void 0,delete C[$]})},D.prototype.key=function(C){return C=C||0,Object.keys(this)[C]},D.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof j1<"u"&&j1.localStorage?z3.exports=j1.localStorage:typeof window<"u"&&window.localStorage?z3.exports=window.localStorage:z3.exports=new w})();function TJ(D){var w;return[D[0],z8((w=D[1])!=null?w:"")]}class M${constructor(){this.localStorage=z3.exports}async getKeys(){return Object.keys(this.localStorage)}async getEntries(){return Object.entries(this.localStorage).map(TJ)}async getItem(D){let w=this.localStorage.getItem(D);if(w!==null)return z8(w)}async setItem(D,w){this.localStorage.setItem(D,lD(w))}async removeItem(D){this.localStorage.removeItem(D)}}var SJ="wc_storage_version",U$=1,RJ=async(D,w,C)=>{let $=SJ,X=await w.getItem($);if(X&&X>=U$){C(w);return}let Y=await D.getKeys();if(!Y.length){C(w);return}let E=[];for(;Y.length;){let K=Y.shift();if(!K)continue;let Q=K.toLowerCase();if(Q.includes("wc@")||Q.includes("walletconnect")||Q.includes("wc_")||Q.includes("wallet_connect")){let Z=await D.getItem(K);await w.setItem(K,Z),E.push(K)}}await w.setItem($,U$),C(w),LJ(D,E)},LJ=async(D,w)=>{w.length&&w.forEach(async(C)=>{await D.removeItem(C)})};class x1{constructor(){this.initialized=!1,this.setInitialized=(w)=>{this.storage=w,this.initialized=!0};let D=new M$;this.storage=D;try{let w=new q$;RJ(D,w,this.setInitialized)}catch{this.initialized=!0}}async getKeys(){return await this.initialize(),this.storage.getKeys()}async getEntries(){return await this.initialize(),this.storage.getEntries()}async getItem(D){return await this.initialize(),this.storage.getItem(D)}async setItem(D,w){return await this.initialize(),this.storage.setItem(D,w)}async removeItem(D){return await this.initialize(),this.storage.removeItem(D)}async initialize(){this.initialized||await new Promise((D)=>{let w=setInterval(()=>{this.initialized&&(clearInterval(w),D())},20)})}}var n8=FD(GX(),1);var UX=FD(a1(),1),e8=FD(a1(),1);var dN={level:"info"},_0="custom_context";var{defineProperty:yN,defineProperties:cN,getOwnPropertyDescriptors:vN,getOwnPropertySymbols:HX}=Object,pN=Object.prototype.hasOwnProperty,nN=Object.prototype.propertyIsEnumerable,fX=(D,w,C)=>(w in D)?yN(D,w,{enumerable:!0,configurable:!0,writable:!0,value:C}):D[w]=C,lN=(D,w)=>{for(var C in w||(w={}))pN.call(w,C)&&fX(D,C,w[C]);if(HX)for(var C of HX(w))nN.call(w,C)&&fX(D,C,w[C]);return D},iN=(D,w)=>cN(D,vN(w));function j0(D){return iN(lN({},D),{level:D?.level||dN.level})}function rN(D,w=_0){return D[w]||""}function oN(D,w,C=_0){return D[C]=w,D}function HD(D,w=_0){let C="";return typeof D.bindings>"u"?C=rN(D,w):C=D.bindings().context||"",C}function sN(D,w,C=_0){let $=HD(D,C);return $.trim()?`${$}/${w}`:w}function LD(D,w,C=_0){let $=sN(D,w,C),X=D.child({context:$});return oN(X,$,C)}d1();s8();class t1 extends E8{constructor(D){super(),this.opts=D,this.protocol="wc",this.version=2}}class e1 extends E8{constructor(D,w){super(),this.core=D,this.logger=w,this.records=new Map}}class Dw{constructor(D,w){this.logger=D,this.core=w}}class ww extends E8{constructor(D,w){super(),this.relayer=D,this.logger=w}}class Cw extends E8{constructor(D){super()}}class $w{constructor(D,w,C,$){this.core=D,this.logger=w,this.name=C}}class Xw extends E8{constructor(D,w){super(),this.relayer=D,this.logger=w}}class Yw extends E8{constructor(D,w){super(),this.core=D,this.logger=w}}class Ew{constructor(D,w){this.projectId=D,this.logger=w}}class Kw{constructor(D){this.opts=D,this.protocol="wc",this.version=2}}class Qw{constructor(D){this.client=D}}var cX=FD(_8(),1);function aN(D){return D instanceof Uint8Array||ArrayBuffer.isView(D)&&D.constructor.name==="Uint8Array"}function vX(D,...w){if(!aN(D))throw new Error("Uint8Array expected");if(w.length>0&&!w.includes(D.length))throw new Error("Uint8Array expected of length "+w+", got length="+D.length)}function qX(D,w=!0){if(D.destroyed)throw new Error("Hash instance has been destroyed");if(w&&D.finished)throw new Error("Hash#digest() has already been called")}function tN(D,w){vX(D);let C=w.outputLen;if(D.length<C)throw new Error("digestInto() expects output buffer of length at least "+C)}var D0=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */var Zw=(D)=>new DataView(D.buffer,D.byteOffset,D.byteLength);function eN(D){if(typeof D!="string")throw new Error("utf8ToBytes expected string, got "+typeof D);return new Uint8Array(new TextEncoder().encode(D))}function pX(D){return typeof D=="string"&&(D=eN(D)),vX(D),D}class nX{clone(){return this._cloneInto()}}function DW(D){let w=($)=>D().update(pX($)).digest(),C=D();return w.outputLen=C.outputLen,w.blockLen=C.blockLen,w.create=()=>D(),w}function lX(D=32){if(D0&&typeof D0.getRandomValues=="function")return D0.getRandomValues(new Uint8Array(D));if(D0&&typeof D0.randomBytes=="function")return D0.randomBytes(D);throw new Error("crypto.getRandomValues must be defined")}function wW(D,w,C,$){if(typeof D.setBigUint64=="function")return D.setBigUint64(w,C,$);let X=BigInt(32),Y=BigInt(4294967295),E=Number(C>>X&Y),K=Number(C&Y),Q=$?4:0,Z=$?0:4;D.setUint32(w+Q,E,$),D.setUint32(w+Z,K,$)}class iX extends nX{constructor(D,w,C,$){super(),this.blockLen=D,this.outputLen=w,this.padOffset=C,this.isLE=$,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(D),this.view=Zw(this.buffer)}update(D){qX(this);let{view:w,buffer:C,blockLen:$}=this;D=pX(D);let X=D.length;for(let Y=0;Y<X;){let E=Math.min($-this.pos,X-Y);if(E===$){let K=Zw(D);for(;$<=X-Y;Y+=$)this.process(K,Y);continue}C.set(D.subarray(Y,Y+E),this.pos),this.pos+=E,Y+=E,this.pos===$&&(this.process(w,0),this.pos=0)}return this.length+=D.length,this.roundClean(),this}digestInto(D){qX(this),tN(D,this),this.finished=!0;let{buffer:w,view:C,blockLen:$,isLE:X}=this,{pos:Y}=this;w[Y++]=128,this.buffer.subarray(Y).fill(0),this.padOffset>$-Y&&(this.process(C,0),Y=0);for(let B=Y;B<$;B++)w[B]=0;wW(C,$-8,BigInt(this.length*8),X),this.process(C,0);let E=Zw(D),K=this.outputLen;if(K%4)throw new Error("_sha2: outputLen should be aligned to 32bit");let Q=K/4,Z=this.get();if(Q>Z.length)throw new Error("_sha2: outputLen bigger than state");for(let B=0;B<Q;B++)E.setUint32(4*B,Z[B],X)}digest(){let{buffer:D,outputLen:w}=this;this.digestInto(D);let C=D.slice(0,w);return this.destroy(),C}_cloneInto(D){D||(D=new this.constructor),D.set(...this.get());let{blockLen:w,buffer:C,length:$,finished:X,destroyed:Y,pos:E}=this;return D.length=$,D.pos=E,D.finished=X,D.destroyed=Y,$%w&&D.buffer.set(C),D}}var M3=BigInt(4294967295),Pw=BigInt(32);function rX(D,w=!1){return w?{h:Number(D&M3),l:Number(D>>Pw&M3)}:{h:Number(D>>Pw&M3)|0,l:Number(D&M3)|0}}function CW(D,w=!1){let C=new Uint32Array(D.length),$=new Uint32Array(D.length);for(let X=0;X<D.length;X++){let{h:Y,l:E}=rX(D[X],w);[C[X],$[X]]=[Y,E]}return[C,$]}var $W=(D,w)=>BigInt(D>>>0)<<Pw|BigInt(w>>>0),XW=(D,w,C)=>D>>>C,YW=(D,w,C)=>D<<32-C|w>>>C,EW=(D,w,C)=>D>>>C|w<<32-C,KW=(D,w,C)=>D<<32-C|w>>>C,QW=(D,w,C)=>D<<64-C|w>>>C-32,ZW=(D,w,C)=>D>>>C-32|w<<64-C,BW=(D,w)=>w,JW=(D,w)=>D,NW=(D,w,C)=>D<<C|w>>>32-C,WW=(D,w,C)=>w<<C|D>>>32-C,FW=(D,w,C)=>w<<C-32|D>>>64-C,GW=(D,w,C)=>D<<C-32|w>>>64-C;function OW(D,w,C,$){let X=(w>>>0)+($>>>0);return{h:D+C+(X/4294967296|0)|0,l:X|0}}var PW=(D,w,C)=>(D>>>0)+(w>>>0)+(C>>>0),VW=(D,w,C,$)=>w+C+$+(D/4294967296|0)|0,zW=(D,w,C,$)=>(D>>>0)+(w>>>0)+(C>>>0)+($>>>0),AW=(D,w,C,$,X)=>w+C+$+X+(D/4294967296|0)|0,IW=(D,w,C,$,X)=>(D>>>0)+(w>>>0)+(C>>>0)+($>>>0)+(X>>>0),HW=(D,w,C,$,X,Y)=>w+C+$+X+Y+(D/4294967296|0)|0,c={fromBig:rX,split:CW,toBig:$W,shrSH:XW,shrSL:YW,rotrSH:EW,rotrSL:KW,rotrBH:QW,rotrBL:ZW,rotr32H:BW,rotr32L:JW,rotlSH:NW,rotlSL:WW,rotlBH:FW,rotlBL:GW,add:OW,add3L:PW,add3H:VW,add4L:zW,add4H:AW,add5H:HW,add5L:IW},[fW,UW]=(()=>c.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map((D)=>BigInt(D))))(),A8=new Uint32Array(80),I8=new Uint32Array(80);class oX extends iX{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){let{Ah:D,Al:w,Bh:C,Bl:$,Ch:X,Cl:Y,Dh:E,Dl:K,Eh:Q,El:Z,Fh:B,Fl:J,Gh:F,Gl:W,Hh:N,Hl:G}=this;return[D,w,C,$,X,Y,E,K,Q,Z,B,J,F,W,N,G]}set(D,w,C,$,X,Y,E,K,Q,Z,B,J,F,W,N,G){this.Ah=D|0,this.Al=w|0,this.Bh=C|0,this.Bl=$|0,this.Ch=X|0,this.Cl=Y|0,this.Dh=E|0,this.Dl=K|0,this.Eh=Q|0,this.El=Z|0,this.Fh=B|0,this.Fl=J|0,this.Gh=F|0,this.Gl=W|0,this.Hh=N|0,this.Hl=G|0}process(D,w){for(let z=0;z<16;z++,w+=4)A8[z]=D.getUint32(w),I8[z]=D.getUint32(w+=4);for(let z=16;z<80;z++){let O=A8[z-15]|0,A=I8[z-15]|0,M=c.rotrSH(O,A,1)^c.rotrSH(O,A,8)^c.shrSH(O,A,7),T=c.rotrSL(O,A,1)^c.rotrSL(O,A,8)^c.shrSL(O,A,7),f=A8[z-2]|0,q=I8[z-2]|0,L=c.rotrSH(f,q,19)^c.rotrBH(f,q,61)^c.shrSH(f,q,6),d=c.rotrSL(f,q,19)^c.rotrBL(f,q,61)^c.shrSL(f,q,6),v=c.add4L(T,d,I8[z-7],I8[z-16]),n=c.add4H(v,M,L,A8[z-7],A8[z-16]);A8[z]=n|0,I8[z]=v|0}let{Ah:C,Al:$,Bh:X,Bl:Y,Ch:E,Cl:K,Dh:Q,Dl:Z,Eh:B,El:J,Fh:F,Fl:W,Gh:N,Gl:G,Hh:V,Hl:H}=this;for(let z=0;z<80;z++){let O=c.rotrSH(B,J,14)^c.rotrSH(B,J,18)^c.rotrBH(B,J,41),A=c.rotrSL(B,J,14)^c.rotrSL(B,J,18)^c.rotrBL(B,J,41),M=B&F^~B&N,T=J&W^~J&G,f=c.add5L(H,A,T,UW[z],I8[z]),q=c.add5H(f,V,O,M,fW[z],A8[z]),L=f|0,d=c.rotrSH(C,$,28)^c.rotrBH(C,$,34)^c.rotrBH(C,$,39),v=c.rotrSL(C,$,28)^c.rotrBL(C,$,34)^c.rotrBL(C,$,39),n=C&X^C&E^X&E,i=$&Y^$&K^Y&K;V=N|0,H=G|0,N=F|0,G=W|0,F=B|0,W=J|0,{h:B,l:J}=c.add(Q|0,Z|0,q|0,L|0),Q=E|0,Z=K|0,E=X|0,K=Y|0,X=C|0,Y=$|0;let r=c.add3L(L,v,i);C=c.add3H(r,q,d,n),$=r|0}({h:C,l:$}=c.add(this.Ah|0,this.Al|0,C|0,$|0)),{h:X,l:Y}=c.add(this.Bh|0,this.Bl|0,X|0,Y|0),{h:E,l:K}=c.add(this.Ch|0,this.Cl|0,E|0,K|0),{h:Q,l:Z}=c.add(this.Dh|0,this.Dl|0,Q|0,Z|0),{h:B,l:J}=c.add(this.Eh|0,this.El|0,B|0,J|0),{h:F,l:W}=c.add(this.Fh|0,this.Fl|0,F|0,W|0),{h:N,l:G}=c.add(this.Gh|0,this.Gl|0,N|0,G|0),{h:V,l:H}=c.add(this.Hh|0,this.Hl|0,V|0,H|0),this.set(C,$,X,Y,E,K,Q,Z,B,J,F,W,N,G,V,H)}roundClean(){A8.fill(0),I8.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}var qW=DW(()=>new oX);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */var Hw=BigInt(0),sX=BigInt(1),MW=BigInt(2);function fw(D){return D instanceof Uint8Array||ArrayBuffer.isView(D)&&D.constructor.name==="Uint8Array"}function Uw(D){if(!fw(D))throw new Error("Uint8Array expected")}function Bw(D,w){if(typeof w!="boolean")throw new Error(D+" boolean expected, got "+w)}var TW=Array.from({length:256},(D,w)=>w.toString(16).padStart(2,"0"));function qw(D){Uw(D);let w="";for(let C=0;C<D.length;C++)w+=TW[D[C]];return w}function aX(D){if(typeof D!="string")throw new Error("hex string expected, got "+typeof D);return D===""?Hw:BigInt("0x"+D)}var K8={_0:48,_9:57,A:65,F:70,a:97,f:102};function MX(D){if(D>=K8._0&&D<=K8._9)return D-K8._0;if(D>=K8.A&&D<=K8.F)return D-(K8.A-10);if(D>=K8.a&&D<=K8.f)return D-(K8.a-10)}function tX(D){if(typeof D!="string")throw new Error("hex string expected, got "+typeof D);let w=D.length,C=w/2;if(w%2)throw new Error("hex string expected, got unpadded hex of length "+w);let $=new Uint8Array(C);for(let X=0,Y=0;X<C;X++,Y+=2){let E=MX(D.charCodeAt(Y)),K=MX(D.charCodeAt(Y+1));if(E===void 0||K===void 0){let Q=D[Y]+D[Y+1];throw new Error('hex string expected, got non-hex character "'+Q+'" at index '+Y)}$[X]=E*16+K}return $}function SW(D){return aX(qw(D))}function R3(D){return Uw(D),aX(qw(Uint8Array.from(D).reverse()))}function eX(D,w){return tX(D.toString(16).padStart(w*2,"0"))}function Vw(D,w){return eX(D,w).reverse()}function Q8(D,w,C){let $;if(typeof w=="string")try{$=tX(w)}catch(Y){throw new Error(D+" must be hex string or Uint8Array, cause: "+Y)}else if(fw(w))$=Uint8Array.from(w);else throw new Error(D+" must be hex string or Uint8Array");let X=$.length;if(typeof C=="number"&&X!==C)throw new Error(D+" of length "+C+" expected, got "+X);return $}function TX(...D){let w=0;for(let $=0;$<D.length;$++){let X=D[$];Uw(X),w+=X.length}let C=new Uint8Array(w);for(let $=0,X=0;$<D.length;$++){let Y=D[$];C.set(Y,X),X+=Y.length}return C}var Jw=(D)=>typeof D=="bigint"&&Hw<=D;function RW(D,w,C){return Jw(D)&&Jw(w)&&Jw(C)&&w<=D&&D<C}function m0(D,w,C,$){if(!RW(w,C,$))throw new Error("expected valid "+D+": "+C+" <= n < "+$+", got "+w)}function LW(D){let w;for(w=0;D>Hw;D>>=sX,w+=1);return w}var _W=(D)=>(MW<<BigInt(D-1))-sX,jW={bigint:(D)=>typeof D=="bigint",function:(D)=>typeof D=="function",boolean:(D)=>typeof D=="boolean",string:(D)=>typeof D=="string",stringOrUint8Array:(D)=>typeof D=="string"||fw(D),isSafeInteger:(D)=>Number.isSafeInteger(D),array:(D)=>Array.isArray(D),field:(D,w)=>w.Fp.isValid(D),hash:(D)=>typeof D=="function"&&Number.isSafeInteger(D.outputLen)};function Mw(D,w,C={}){let $=(X,Y,E)=>{let K=jW[Y];if(typeof K!="function")throw new Error("invalid validator function");let Q=D[X];if(!(E&&Q===void 0)&&!K(Q,D))throw new Error("param "+String(X)+" is invalid. Expected "+Y+", got "+Q)};for(let[X,Y]of Object.entries(w))$(X,Y,!1);for(let[X,Y]of Object.entries(C))$(X,Y,!0);return D}function SX(D){let w=new WeakMap;return(C,...$)=>{let X=w.get(C);if(X!==void 0)return X;let Y=D(C,...$);return w.set(C,Y),Y}}var GD=BigInt(0),XD=BigInt(1),j8=BigInt(2),xW=BigInt(3),zw=BigInt(4),RX=BigInt(5),LX=BigInt(8);function JD(D,w){let C=D%w;return C>=GD?C:w+C}function mW(D,w,C){if(w<GD)throw new Error("invalid exponent, negatives unsupported");if(C<=GD)throw new Error("invalid modulus");if(C===XD)return GD;let $=XD;for(;w>GD;)w&XD&&($=$*D%C),D=D*D%C,w>>=XD;return $}function sD(D,w,C){let $=D;for(;w-- >GD;)$*=$,$%=C;return $}function _X(D,w){if(D===GD)throw new Error("invert: expected non-zero number");if(w<=GD)throw new Error("invert: expected positive modulus, got "+w);let C=JD(D,w),$=w,X=GD,Y=XD;for(;C!==GD;){let E=$/C,K=$%C,Q=X-Y*E;$=C,C=K,X=Y,Y=Q}if($!==XD)throw new Error("invert: does not exist");return JD(X,w)}function hW(D){let w=(D-XD)/j8,C,$,X;for(C=D-XD,$=0;C%j8===GD;C/=j8,$++);for(X=j8;X<D&&mW(X,w,D)!==D-XD;X++)if(X>1000)throw new Error("Cannot find square root: likely non-prime P");if($===1){let E=(D+XD)/zw;return function(K,Q){let Z=K.pow(Q,E);if(!K.eql(K.sqr(Z),Q))throw new Error("Cannot find square root");return Z}}let Y=(C+XD)/j8;return function(E,K){if(E.pow(K,w)===E.neg(E.ONE))throw new Error("Cannot find square root");let Q=$,Z=E.pow(E.mul(E.ONE,X),C),B=E.pow(K,Y),J=E.pow(K,C);for(;!E.eql(J,E.ONE);){if(E.eql(J,E.ZERO))return E.ZERO;let F=1;for(let N=E.sqr(J);F<Q&&!E.eql(N,E.ONE);F++)N=E.sqr(N);let W=E.pow(Z,XD<<BigInt(Q-F-1));Z=E.sqr(W),B=E.mul(B,W),J=E.mul(J,Z),Q=F}return B}}function gW(D){if(D%zw===xW){let w=(D+XD)/zw;return function(C,$){let X=C.pow($,w);if(!C.eql(C.sqr(X),$))throw new Error("Cannot find square root");return X}}if(D%LX===RX){let w=(D-RX)/LX;return function(C,$){let X=C.mul($,j8),Y=C.pow(X,w),E=C.mul($,Y),K=C.mul(C.mul(E,j8),Y),Q=C.mul(E,C.sub(K,C.ONE));if(!C.eql(C.sqr(Q),$))throw new Error("Cannot find square root");return Q}}return hW(D)}var uW=(D,w)=>(JD(D,w)&XD)===XD,kW=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function bW(D){let w={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},C=kW.reduce(($,X)=>($[X]="function",$),w);return Mw(D,C)}function dW(D,w,C){if(C<GD)throw new Error("invalid exponent, negatives unsupported");if(C===GD)return D.ONE;if(C===XD)return w;let $=D.ONE,X=w;for(;C>GD;)C&XD&&($=D.mul($,X)),X=D.sqr(X),C>>=XD;return $}function yW(D,w){let C=new Array(w.length),$=w.reduce((Y,E,K)=>D.is0(E)?Y:(C[K]=Y,D.mul(Y,E)),D.ONE),X=D.inv($);return w.reduceRight((Y,E,K)=>D.is0(E)?Y:(C[K]=D.mul(Y,C[K]),D.mul(Y,E)),X),C}function DY(D,w){let C=w!==void 0?w:D.toString(2).length,$=Math.ceil(C/8);return{nBitLength:C,nByteLength:$}}function wY(D,w,C=!1,$={}){if(D<=GD)throw new Error("invalid field: expected ORDER > 0, got "+D);let{nBitLength:X,nByteLength:Y}=DY(D,w);if(Y>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let E,K=Object.freeze({ORDER:D,isLE:C,BITS:X,BYTES:Y,MASK:_W(X),ZERO:GD,ONE:XD,create:(Q)=>JD(Q,D),isValid:(Q)=>{if(typeof Q!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof Q);return GD<=Q&&Q<D},is0:(Q)=>Q===GD,isOdd:(Q)=>(Q&XD)===XD,neg:(Q)=>JD(-Q,D),eql:(Q,Z)=>Q===Z,sqr:(Q)=>JD(Q*Q,D),add:(Q,Z)=>JD(Q+Z,D),sub:(Q,Z)=>JD(Q-Z,D),mul:(Q,Z)=>JD(Q*Z,D),pow:(Q,Z)=>dW(K,Q,Z),div:(Q,Z)=>JD(Q*_X(Z,D),D),sqrN:(Q)=>Q*Q,addN:(Q,Z)=>Q+Z,subN:(Q,Z)=>Q-Z,mulN:(Q,Z)=>Q*Z,inv:(Q)=>_X(Q,D),sqrt:$.sqrt||((Q)=>(E||(E=gW(D)),E(K,Q))),invertBatch:(Q)=>yW(K,Q),cmov:(Q,Z,B)=>B?Z:Q,toBytes:(Q)=>C?Vw(Q,Y):eX(Q,Y),fromBytes:(Q)=>{if(Q.length!==Y)throw new Error("Field.fromBytes: expected "+Y+" bytes, got "+Q.length);return C?R3(Q):SW(Q)}});return Object.freeze(K)}var jX=BigInt(0),T3=BigInt(1);function Nw(D,w){let C=w.negate();return D?C:w}function CY(D,w){if(!Number.isSafeInteger(D)||D<=0||D>w)throw new Error("invalid window size, expected [1.."+w+"], got W="+D)}function Ww(D,w){CY(D,w);let C=Math.ceil(w/D)+1,$=2**(D-1);return{windows:C,windowSize:$}}function cW(D,w){if(!Array.isArray(D))throw new Error("array expected");D.forEach((C,$)=>{if(!(C instanceof w))throw new Error("invalid point at index "+$)})}function vW(D,w){if(!Array.isArray(D))throw new Error("array of scalars expected");D.forEach((C,$)=>{if(!w.isValid(C))throw new Error("invalid scalar at index "+$)})}var Fw=new WeakMap,$Y=new WeakMap;function Gw(D){return $Y.get(D)||1}function pW(D,w){return{constTimeNegate:Nw,hasPrecomputes(C){return Gw(C)!==1},unsafeLadder(C,$,X=D.ZERO){let Y=C;for(;$>jX;)$&T3&&(X=X.add(Y)),Y=Y.double(),$>>=T3;return X},precomputeWindow(C,$){let{windows:X,windowSize:Y}=Ww($,w),E=[],K=C,Q=K;for(let Z=0;Z<X;Z++){Q=K,E.push(Q);for(let B=1;B<Y;B++)Q=Q.add(K),E.push(Q);K=Q.double()}return E},wNAF(C,$,X){let{windows:Y,windowSize:E}=Ww(C,w),K=D.ZERO,Q=D.BASE,Z=BigInt(2**C-1),B=2**C,J=BigInt(C);for(let F=0;F<Y;F++){let W=F*E,N=Number(X&Z);X>>=J,N>E&&(N-=B,X+=T3);let G=W,V=W+Math.abs(N)-1,H=F%2!==0,z=N<0;N===0?Q=Q.add(Nw(H,$[G])):K=K.add(Nw(z,$[V]))}return{p:K,f:Q}},wNAFUnsafe(C,$,X,Y=D.ZERO){let{windows:E,windowSize:K}=Ww(C,w),Q=BigInt(2**C-1),Z=2**C,B=BigInt(C);for(let J=0;J<E;J++){let F=J*K;if(X===jX)break;let W=Number(X&Q);if(X>>=B,W>K&&(W-=Z,X+=T3),W===0)continue;let N=$[F+Math.abs(W)-1];W<0&&(N=N.negate()),Y=Y.add(N)}return Y},getPrecomputes(C,$,X){let Y=Fw.get($);return Y||(Y=this.precomputeWindow($,C),C!==1&&Fw.set($,X(Y))),Y},wNAFCached(C,$,X){let Y=Gw(C);return this.wNAF(Y,this.getPrecomputes(Y,C,X),$)},wNAFCachedUnsafe(C,$,X,Y){let E=Gw(C);return E===1?this.unsafeLadder(C,$,Y):this.wNAFUnsafe(E,this.getPrecomputes(E,C,X),$,Y)},setWindowSize(C,$){CY($,w),$Y.set(C,$),Fw.delete(C)}}}function nW(D,w,C,$){if(cW(C,D),vW($,w),C.length!==$.length)throw new Error("arrays of points and scalars must have equal length");let X=D.ZERO,Y=LW(BigInt(C.length)),E=Y>12?Y-3:Y>4?Y-2:Y?2:1,K=(1<<E)-1,Q=new Array(K+1).fill(X),Z=Math.floor((w.BITS-1)/E)*E,B=X;for(let J=Z;J>=0;J-=E){Q.fill(X);for(let W=0;W<$.length;W++){let N=$[W],G=Number(N>>BigInt(J)&BigInt(K));Q[G]=Q[G].add(C[W])}let F=X;for(let W=Q.length-1,N=X;W>0;W--)N=N.add(Q[W]),F=F.add(N);if(B=B.add(F),J!==0)for(let W=0;W<E;W++)B=B.double()}return B}function lW(D){return bW(D.Fp),Mw(D,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...DY(D.n,D.nBitLength),...D,p:D.Fp.ORDER})}var nD=BigInt(0),hD=BigInt(1),S3=BigInt(2),iW=BigInt(8),rW={zip215:!0};function oW(D){let w=lW(D);return Mw(D,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...w})}function sW(D){let w=oW(D),{Fp:C,n:$,prehash:X,hash:Y,randomBytes:E,nByteLength:K,h:Q}=w,Z=S3<<BigInt(K*8)-hD,B=C.create,J=wY(w.n,w.nBitLength),F=w.uvRatio||((I,U)=>{try{return{isValid:!0,value:C.sqrt(I*C.inv(U))}}catch{return{isValid:!1,value:nD}}}),W=w.adjustScalarBytes||((I)=>I),N=w.domain||((I,U,P)=>{if(Bw("phflag",P),U.length||P)throw new Error("Contexts/pre-hash are not supported");return I});function G(I,U){m0("coordinate "+I,U,nD,Z)}function V(I){if(!(I instanceof O))throw new Error("ExtendedPoint expected")}let H=SX((I,U)=>{let{ex:P,ey:S,ez:u}=I,_=I.is0();U==null&&(U=_?iW:C.inv(u));let j=B(P*U),x=B(S*U),m=B(u*U);if(_)return{x:nD,y:hD};if(m!==hD)throw new Error("invZ was invalid");return{x:j,y:x}}),z=SX((I)=>{let{a:U,d:P}=w;if(I.is0())throw new Error("bad point: ZERO");let{ex:S,ey:u,ez:_,et:j}=I,x=B(S*S),m=B(u*u),h=B(_*_),g=B(h*h),b=B(x*U),y=B(h*B(b+m)),o=B(g+B(P*B(x*m)));if(y!==o)throw new Error("bad point: equation left != right (1)");let a=B(S*u),s=B(_*j);if(a!==s)throw new Error("bad point: equation left != right (2)");return!0});class O{constructor(I,U,P,S){this.ex=I,this.ey=U,this.ez=P,this.et=S,G("x",I),G("y",U),G("z",P),G("t",S),Object.freeze(this)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(I){if(I instanceof O)throw new Error("extended point not allowed");let{x:U,y:P}=I||{};return G("x",U),G("y",P),new O(U,P,hD,B(U*P))}static normalizeZ(I){let U=C.invertBatch(I.map((P)=>P.ez));return I.map((P,S)=>P.toAffine(U[S])).map(O.fromAffine)}static msm(I,U){return nW(O,J,I,U)}_setWindowSize(I){T.setWindowSize(this,I)}assertValidity(){z(this)}equals(I){V(I);let{ex:U,ey:P,ez:S}=this,{ex:u,ey:_,ez:j}=I,x=B(U*j),m=B(u*S),h=B(P*j),g=B(_*S);return x===m&&h===g}is0(){return this.equals(O.ZERO)}negate(){return new O(B(-this.ex),this.ey,this.ez,B(-this.et))}double(){let{a:I}=w,{ex:U,ey:P,ez:S}=this,u=B(U*U),_=B(P*P),j=B(S3*B(S*S)),x=B(I*u),m=U+P,h=B(B(m*m)-u-_),g=x+_,b=g-j,y=x-_,o=B(h*b),a=B(g*y),s=B(h*y),$D=B(b*g);return new O(o,a,$D,s)}add(I){V(I);let{a:U,d:P}=w,{ex:S,ey:u,ez:_,et:j}=this,{ex:x,ey:m,ez:h,et:g}=I;if(U===BigInt(-1)){let X$=B((u-S)*(m+x)),Y$=B((u+S)*(m-x)),q1=B(Y$-X$);if(q1===nD)return this.double();let E$=B(_*S3*g),K$=B(j*S3*h),Q$=K$+E$,Z$=Y$+X$,B$=K$-E$,$J=B(Q$*q1),XJ=B(Z$*B$),YJ=B(Q$*B$),EJ=B(q1*Z$);return new O($J,XJ,EJ,YJ)}let b=B(S*x),y=B(u*m),o=B(j*P*g),a=B(_*h),s=B((S+u)*(x+m)-b-y),$D=a-o,QD=a+o,ZD=B(y-U*b),ND=B(s*$D),WD=B(QD*ZD),wJ=B(s*ZD),CJ=B($D*QD);return new O(ND,WD,CJ,wJ)}subtract(I){return this.add(I.negate())}wNAF(I){return T.wNAFCached(this,I,O.normalizeZ)}multiply(I){let U=I;m0("scalar",U,hD,$);let{p:P,f:S}=this.wNAF(U);return O.normalizeZ([P,S])[0]}multiplyUnsafe(I,U=O.ZERO){let P=I;return m0("scalar",P,nD,$),P===nD?M:this.is0()||P===hD?this:T.wNAFCachedUnsafe(this,P,O.normalizeZ,U)}isSmallOrder(){return this.multiplyUnsafe(Q).is0()}isTorsionFree(){return T.unsafeLadder(this,$).is0()}toAffine(I){return H(this,I)}clearCofactor(){let{h:I}=w;return I===hD?this:this.multiplyUnsafe(I)}static fromHex(I,U=!1){let{d:P,a:S}=w,u=C.BYTES;I=Q8("pointHex",I,u),Bw("zip215",U);let _=I.slice(),j=I[u-1];_[u-1]=j&-129;let x=R3(_),m=U?Z:C.ORDER;m0("pointHex.y",x,nD,m);let h=B(x*x),g=B(h-hD),b=B(P*h-S),{isValid:y,value:o}=F(g,b);if(!y)throw new Error("Point.fromHex: invalid y coordinate");let a=(o&hD)===hD,s=(j&128)!==0;if(!U&&o===nD&&s)throw new Error("Point.fromHex: x=0 and x_0=1");return s!==a&&(o=B(-o)),O.fromAffine({x:o,y:x})}static fromPrivateKey(I){return L(I).point}toRawBytes(){let{x:I,y:U}=this.toAffine(),P=Vw(U,C.BYTES);return P[P.length-1]|=I&hD?128:0,P}toHex(){return qw(this.toRawBytes())}}O.BASE=new O(w.Gx,w.Gy,hD,B(w.Gx*w.Gy)),O.ZERO=new O(nD,hD,hD,nD);let{BASE:A,ZERO:M}=O,T=pW(O,K*8);function f(I){return JD(I,$)}function q(I){return f(R3(I))}function L(I){let U=C.BYTES;I=Q8("private key",I,U);let P=Q8("hashed private key",Y(I),2*U),S=W(P.slice(0,U)),u=P.slice(U,2*U),_=q(S),j=A.multiply(_),x=j.toRawBytes();return{head:S,prefix:u,scalar:_,point:j,pointBytes:x}}function d(I){return L(I).pointBytes}function v(I=new Uint8Array,...U){let P=TX(...U);return q(Y(N(P,Q8("context",I),!!X)))}function n(I,U,P={}){I=Q8("message",I),X&&(I=X(I));let{prefix:S,scalar:u,pointBytes:_}=L(U),j=v(P.context,S,I),x=A.multiply(j).toRawBytes(),m=v(P.context,x,_,I),h=f(j+m*u);m0("signature.s",h,nD,$);let g=TX(x,Vw(h,C.BYTES));return Q8("result",g,C.BYTES*2)}let i=rW;function r(I,U,P,S=i){let{context:u,zip215:_}=S,j=C.BYTES;I=Q8("signature",I,2*j),U=Q8("message",U),P=Q8("publicKey",P,j),_!==void 0&&Bw("zip215",_),X&&(U=X(U));let x=R3(I.slice(j,2*j)),m,h,g;try{m=O.fromHex(P,_),h=O.fromHex(I.slice(0,j),_),g=A.multiplyUnsafe(x)}catch{return!1}if(!_&&m.isSmallOrder())return!1;let b=v(u,h.toRawBytes(),m.toRawBytes(),U);return h.add(m.multiplyUnsafe(b)).subtract(g).clearCofactor().equals(O.ZERO)}return A._setWindowSize(8),{CURVE:w,getPublicKey:d,sign:n,verify:r,ExtendedPoint:O,utils:{getExtendedPublicKey:L,randomPrivateKey:()=>E(C.BYTES),precompute(I=8,U=O.BASE){return U._setWindowSize(I),U.multiply(BigInt(3)),U}}}}BigInt(0),BigInt(1);var Tw=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),xX=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752");BigInt(0);var aW=BigInt(1),mX=BigInt(2);BigInt(3);var tW=BigInt(5),eW=BigInt(8);function DF(D){let w=BigInt(10),C=BigInt(20),$=BigInt(40),X=BigInt(80),Y=Tw,E=D*D%Y*D%Y,K=sD(E,mX,Y)*E%Y,Q=sD(K,aW,Y)*D%Y,Z=sD(Q,tW,Y)*Q%Y,B=sD(Z,w,Y)*Z%Y,J=sD(B,C,Y)*B%Y,F=sD(J,$,Y)*J%Y,W=sD(F,X,Y)*F%Y,N=sD(W,X,Y)*F%Y,G=sD(N,w,Y)*Z%Y;return{pow_p_5_8:sD(G,mX,Y)*D%Y,b2:E}}function wF(D){return D[0]&=248,D[31]&=127,D[31]|=64,D}function CF(D,w){let C=Tw,$=JD(w*w*w,C),X=JD($*$*w,C),Y=DF(D*X).pow_p_5_8,E=JD(D*$*Y,C),K=JD(w*E*E,C),Q=E,Z=JD(E*xX,C),B=K===D,J=K===JD(-D,C),F=K===JD(-D*xX,C);return B&&(E=Q),(J||F)&&(E=Z),uW(E,C)&&(E=JD(-E,C)),{isValid:B||J,value:E}}var $F=(()=>wY(Tw,void 0,!0))(),XF=(()=>({a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:$F,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:eW,Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:qW,randomBytes:lX,adjustScalarBytes:wF,uvRatio:CF}))(),XY=(()=>sW(XF))(),YF="EdDSA",EF="JWT",YY=".",EY="base64url",KF="utf8",QF="utf8",ZF=":",BF="did",JF="key",hX="base58btc",NF="z",WF="K36";var FF=32;function Sw(D){return globalThis.Buffer!=null?new Uint8Array(D.buffer,D.byteOffset,D.byteLength):D}function KY(D=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?Sw(globalThis.Buffer.allocUnsafe(D)):new Uint8Array(D)}function QY(D,w){w||(w=D.reduce((X,Y)=>X+Y.length,0));let C=KY(w),$=0;for(let X of D)C.set(X,$),$+=X.length;return Sw(C)}function GF(D,w){if(D.length>=255)throw new TypeError("Alphabet too long");for(var C=new Uint8Array(256),$=0;$<C.length;$++)C[$]=255;for(var X=0;X<D.length;X++){var Y=D.charAt(X),E=Y.charCodeAt(0);if(C[E]!==255)throw new TypeError(Y+" is ambiguous");C[E]=X}var K=D.length,Q=D.charAt(0),Z=Math.log(K)/Math.log(256),B=Math.log(256)/Math.log(K);function J(N){if(N instanceof Uint8Array||(ArrayBuffer.isView(N)?N=new Uint8Array(N.buffer,N.byteOffset,N.byteLength):Array.isArray(N)&&(N=Uint8Array.from(N))),!(N instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(N.length===0)return"";for(var G=0,V=0,H=0,z=N.length;H!==z&&N[H]===0;)H++,G++;for(var O=(z-H)*B+1>>>0,A=new Uint8Array(O);H!==z;){for(var M=N[H],T=0,f=O-1;(M!==0||T<V)&&f!==-1;f--,T++)M+=256*A[f]>>>0,A[f]=M%K>>>0,M=M/K>>>0;if(M!==0)throw new Error("Non-zero carry");V=T,H++}for(var q=O-V;q!==O&&A[q]===0;)q++;for(var L=Q.repeat(G);q<O;++q)L+=D.charAt(A[q]);return L}function F(N){if(typeof N!="string")throw new TypeError("Expected String");if(N.length===0)return new Uint8Array;var G=0;if(N[G]!==" "){for(var V=0,H=0;N[G]===Q;)V++,G++;for(var z=(N.length-G)*Z+1>>>0,O=new Uint8Array(z);N[G];){var A=C[N.charCodeAt(G)];if(A===255)return;for(var M=0,T=z-1;(A!==0||M<H)&&T!==-1;T--,M++)A+=K*O[T]>>>0,O[T]=A%256>>>0,A=A/256>>>0;if(A!==0)throw new Error("Non-zero carry");H=M,G++}if(N[G]!==" "){for(var f=z-H;f!==z&&O[f]===0;)f++;for(var q=new Uint8Array(V+(z-f)),L=V;f!==z;)q[L++]=O[f++];return q}}}function W(N){var G=F(N);if(G)return G;throw new Error(`Non-${w} character`)}return{encode:J,decodeUnsafe:F,decode:W}}var OF=GF,PF=OF,ZY=(D)=>{if(D instanceof Uint8Array&&D.constructor.name==="Uint8Array")return D;if(D instanceof ArrayBuffer)return new Uint8Array(D);if(ArrayBuffer.isView(D))return new Uint8Array(D.buffer,D.byteOffset,D.byteLength);throw new Error("Unknown type, must be binary type")},VF=(D)=>new TextEncoder().encode(D),zF=(D)=>new TextDecoder().decode(D);class BY{constructor(D,w,C){this.name=D,this.prefix=w,this.baseEncode=C}encode(D){if(D instanceof Uint8Array)return`${this.prefix}${this.baseEncode(D)}`;throw Error("Unknown type, must be binary type")}}class JY{constructor(D,w,C){if(this.name=D,this.prefix=w,w.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=w.codePointAt(0),this.baseDecode=C}decode(D){if(typeof D=="string"){if(D.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(D)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(D.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(D){return WY(this,D)}}class NY{constructor(D){this.decoders=D}or(D){return WY(this,D)}decode(D){let w=D[0],C=this.decoders[w];if(C)return C.decode(D);throw RangeError(`Unable to decode multibase string ${JSON.stringify(D)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}var WY=(D,w)=>new NY({...D.decoders||{[D.prefix]:D},...w.decoders||{[w.prefix]:w}});class FY{constructor(D,w,C,$){this.name=D,this.prefix=w,this.baseEncode=C,this.baseDecode=$,this.encoder=new BY(D,w,C),this.decoder=new JY(D,w,$)}encode(D){return this.encoder.encode(D)}decode(D){return this.decoder.decode(D)}}var _3=({name:D,prefix:w,encode:C,decode:$})=>new FY(D,w,C,$),h0=({prefix:D,name:w,alphabet:C})=>{let{encode:$,decode:X}=PF(C,w);return _3({prefix:D,name:w,encode:$,decode:(Y)=>ZY(X(Y))})},AF=(D,w,C,$)=>{let X={};for(let B=0;B<w.length;++B)X[w[B]]=B;let Y=D.length;for(;D[Y-1]==="=";)--Y;let E=new Uint8Array(Y*C/8|0),K=0,Q=0,Z=0;for(let B=0;B<Y;++B){let J=X[D[B]];if(J===void 0)throw new SyntaxError(`Non-${$} character`);Q=Q<<C|J,K+=C,K>=8&&(K-=8,E[Z++]=255&Q>>K)}if(K>=C||255&Q<<8-K)throw new SyntaxError("Unexpected end of data");return E},IF=(D,w,C)=>{let $=w[w.length-1]==="=",X=(1<<C)-1,Y="",E=0,K=0;for(let Q=0;Q<D.length;++Q)for(K=K<<8|D[Q],E+=8;E>C;)E-=C,Y+=w[X&K>>E];if(E&&(Y+=w[X&K<<C-E]),$)for(;Y.length*C&7;)Y+="=";return Y},PD=({name:D,prefix:w,bitsPerChar:C,alphabet:$})=>_3({prefix:w,name:D,encode(X){return IF(X,$,C)},decode(X){return AF(X,$,C,D)}}),HF=_3({prefix:"\x00",name:"identity",encode:(D)=>zF(D),decode:(D)=>VF(D)}),fF=Object.freeze({__proto__:null,identity:HF}),UF=PD({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),qF=Object.freeze({__proto__:null,base2:UF}),MF=PD({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),TF=Object.freeze({__proto__:null,base8:MF}),SF=h0({prefix:"9",name:"base10",alphabet:"0123456789"}),RF=Object.freeze({__proto__:null,base10:SF}),LF=PD({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),_F=PD({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),jF=Object.freeze({__proto__:null,base16:LF,base16upper:_F}),xF=PD({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),mF=PD({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),hF=PD({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),gF=PD({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),uF=PD({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),kF=PD({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),bF=PD({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),dF=PD({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),yF=PD({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),cF=Object.freeze({__proto__:null,base32:xF,base32upper:mF,base32pad:hF,base32padupper:gF,base32hex:uF,base32hexupper:kF,base32hexpad:bF,base32hexpadupper:dF,base32z:yF}),vF=h0({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),pF=h0({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),nF=Object.freeze({__proto__:null,base36:vF,base36upper:pF}),lF=h0({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),iF=h0({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),rF=Object.freeze({__proto__:null,base58btc:lF,base58flickr:iF}),oF=PD({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),sF=PD({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),aF=PD({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),tF=PD({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),eF=Object.freeze({__proto__:null,base64:oF,base64pad:sF,base64url:aF,base64urlpad:tF}),GY=Array.from("\uD83D\uDE80\uD83E\uDE90☄\uD83D\uDEF0\uD83C\uDF0C\uD83C\uDF11\uD83C\uDF12\uD83C\uDF13\uD83C\uDF14\uD83C\uDF15\uD83C\uDF16\uD83C\uDF17\uD83C\uDF18\uD83C\uDF0D\uD83C\uDF0F\uD83C\uDF0E\uD83D\uDC09☀\uD83D\uDCBB\uD83D\uDDA5\uD83D\uDCBE\uD83D\uDCBF\uD83D\uDE02❤\uD83D\uDE0D\uD83E\uDD23\uD83D\uDE0A\uD83D\uDE4F\uD83D\uDC95\uD83D\uDE2D\uD83D\uDE18\uD83D\uDC4D\uD83D\uDE05\uD83D\uDC4F\uD83D\uDE01\uD83D\uDD25\uD83E\uDD70\uD83D\uDC94\uD83D\uDC96\uD83D\uDC99\uD83D\uDE22\uD83E\uDD14\uD83D\uDE06\uD83D\uDE44\uD83D\uDCAA\uD83D\uDE09☺\uD83D\uDC4C\uD83E\uDD17\uD83D\uDC9C\uD83D\uDE14\uD83D\uDE0E\uD83D\uDE07\uD83C\uDF39\uD83E\uDD26\uD83C\uDF89\uD83D\uDC9E✌✨\uD83E\uDD37\uD83D\uDE31\uD83D\uDE0C\uD83C\uDF38\uD83D\uDE4C\uD83D\uDE0B\uD83D\uDC97\uD83D\uDC9A\uD83D\uDE0F\uD83D\uDC9B\uD83D\uDE42\uD83D\uDC93\uD83E\uDD29\uD83D\uDE04\uD83D\uDE00\uD83D\uDDA4\uD83D\uDE03\uD83D\uDCAF\uD83D\uDE48\uD83D\uDC47\uD83C\uDFB6\uD83D\uDE12\uD83E\uDD2D❣\uD83D\uDE1C\uD83D\uDC8B\uD83D\uDC40\uD83D\uDE2A\uD83D\uDE11\uD83D\uDCA5\uD83D\uDE4B\uD83D\uDE1E\uD83D\uDE29\uD83D\uDE21\uD83E\uDD2A\uD83D\uDC4A\uD83E\uDD73\uD83D\uDE25\uD83E\uDD24\uD83D\uDC49\uD83D\uDC83\uD83D\uDE33✋\uD83D\uDE1A\uD83D\uDE1D\uD83D\uDE34\uD83C\uDF1F\uD83D\uDE2C\uD83D\uDE43\uD83C\uDF40\uD83C\uDF37\uD83D\uDE3B\uD83D\uDE13⭐✅\uD83E\uDD7A\uD83C\uDF08\uD83D\uDE08\uD83E\uDD18\uD83D\uDCA6✔\uD83D\uDE23\uD83C\uDFC3\uD83D\uDC90☹\uD83C\uDF8A\uD83D\uDC98\uD83D\uDE20☝\uD83D\uDE15\uD83C\uDF3A\uD83C\uDF82\uD83C\uDF3B\uD83D\uDE10\uD83D\uDD95\uD83D\uDC9D\uD83D\uDE4A\uD83D\uDE39\uD83D\uDDE3\uD83D\uDCAB\uD83D\uDC80\uD83D\uDC51\uD83C\uDFB5\uD83E\uDD1E\uD83D\uDE1B\uD83D\uDD34\uD83D\uDE24\uD83C\uDF3C\uD83D\uDE2B⚽\uD83E\uDD19☕\uD83C\uDFC6\uD83E\uDD2B\uD83D\uDC48\uD83D\uDE2E\uD83D\uDE46\uD83C\uDF7B\uD83C\uDF43\uD83D\uDC36\uD83D\uDC81\uD83D\uDE32\uD83C\uDF3F\uD83E\uDDE1\uD83C\uDF81⚡\uD83C\uDF1E\uD83C\uDF88❌✊\uD83D\uDC4B\uD83D\uDE30\uD83E\uDD28\uD83D\uDE36\uD83E\uDD1D\uD83D\uDEB6\uD83D\uDCB0\uD83C\uDF53\uD83D\uDCA2\uD83E\uDD1F\uD83D\uDE41\uD83D\uDEA8\uD83D\uDCA8\uD83E\uDD2C✈\uD83C\uDF80\uD83C\uDF7A\uD83E\uDD13\uD83D\uDE19\uD83D\uDC9F\uD83C\uDF31\uD83D\uDE16\uD83D\uDC76\uD83E\uDD74▶➡❓\uD83D\uDC8E\uD83D\uDCB8⬇\uD83D\uDE28\uD83C\uDF1A\uD83E\uDD8B\uD83D\uDE37\uD83D\uDD7A⚠\uD83D\uDE45\uD83D\uDE1F\uD83D\uDE35\uD83D\uDC4E\uD83E\uDD32\uD83E\uDD20\uD83E\uDD27\uD83D\uDCCC\uD83D\uDD35\uD83D\uDC85\uD83E\uDDD0\uD83D\uDC3E\uD83C\uDF52\uD83D\uDE17\uD83E\uDD11\uD83C\uDF0A\uD83E\uDD2F\uD83D\uDC37☎\uD83D\uDCA7\uD83D\uDE2F\uD83D\uDC86\uD83D\uDC46\uD83C\uDFA4\uD83D\uDE47\uD83C\uDF51❄\uD83C\uDF34\uD83D\uDCA3\uD83D\uDC38\uD83D\uDC8C\uD83D\uDCCD\uD83E\uDD40\uD83E\uDD22\uD83D\uDC45\uD83D\uDCA1\uD83D\uDCA9\uD83D\uDC50\uD83D\uDCF8\uD83D\uDC7B\uD83E\uDD10\uD83E\uDD2E\uD83C\uDFBC\uD83E\uDD75\uD83D\uDEA9\uD83C\uDF4E\uD83C\uDF4A\uD83D\uDC7C\uD83D\uDC8D\uD83D\uDCE3\uD83E\uDD42"),DG=GY.reduce((D,w,C)=>(D[C]=w,D),[]),wG=GY.reduce((D,w,C)=>(D[w.codePointAt(0)]=C,D),[]);function CG(D){return D.reduce((w,C)=>(w+=DG[C],w),"")}function $G(D){let w=[];for(let C of D){let $=wG[C.codePointAt(0)];if($===void 0)throw new Error(`Non-base256emoji character: ${C}`);w.push($)}return new Uint8Array(w)}var XG=_3({prefix:"\uD83D\uDE80",name:"base256emoji",encode:CG,decode:$G}),YG=Object.freeze({__proto__:null,base256emoji:XG}),EG=OY,gX=128,KG=127,QG=~KG,ZG=Math.pow(2,31);function OY(D,w,C){w=w||[],C=C||0;for(var $=C;D>=ZG;)w[C++]=D&255|gX,D/=128;for(;D&QG;)w[C++]=D&255|gX,D>>>=7;return w[C]=D|0,OY.bytes=C-$+1,w}var BG=Aw,JG=128,uX=127;function Aw(D,$){var C=0,$=$||0,X=0,Y=$,E,K=D.length;do{if(Y>=K)throw Aw.bytes=0,new RangeError("Could not decode varint");E=D[Y++],C+=X<28?(E&uX)<<X:(E&uX)*Math.pow(2,X),X+=7}while(E>=JG);return Aw.bytes=Y-$,C}var NG=Math.pow(2,7),WG=Math.pow(2,14),FG=Math.pow(2,21),GG=Math.pow(2,28),OG=Math.pow(2,35),PG=Math.pow(2,42),VG=Math.pow(2,49),zG=Math.pow(2,56),AG=Math.pow(2,63),IG=function(D){return D<NG?1:D<WG?2:D<FG?3:D<GG?4:D<OG?5:D<PG?6:D<VG?7:D<zG?8:D<AG?9:10},HG={encode:EG,decode:BG,encodingLength:IG},PY=HG,kX=(D,w,C=0)=>(PY.encode(D,w,C),w),bX=(D)=>PY.encodingLength(D),Iw=(D,w)=>{let C=w.byteLength,$=bX(D),X=$+bX(C),Y=new Uint8Array(X+C);return kX(D,Y,0),kX(C,Y,$),Y.set(w,X),new VY(D,C,w,Y)};class VY{constructor(D,w,C,$){this.code=D,this.size=w,this.digest=C,this.bytes=$}}var zY=({name:D,code:w,encode:C})=>new AY(D,w,C);class AY{constructor(D,w,C){this.name=D,this.code=w,this.encode=C}digest(D){if(D instanceof Uint8Array){let w=this.encode(D);return w instanceof Uint8Array?Iw(this.code,w):w.then((C)=>Iw(this.code,C))}else throw Error("Unknown type, must be binary type")}}var IY=(D)=>async(w)=>new Uint8Array(await crypto.subtle.digest(D,w)),fG=zY({name:"sha2-256",code:18,encode:IY("SHA-256")}),UG=zY({name:"sha2-512",code:19,encode:IY("SHA-512")}),qG=Object.freeze({__proto__:null,sha256:fG,sha512:UG}),HY=0,MG="identity",fY=ZY,TG=(D)=>Iw(HY,fY(D)),SG={code:HY,name:MG,encode:fY,digest:TG},RG=Object.freeze({__proto__:null,identity:SG});var dX={...fF,...qF,...TF,...RF,...jF,...cF,...nF,...rF,...eF,...YG};({...qG,...RG});function UY(D,w,C,$){return{name:D,prefix:w,encoder:{name:D,prefix:w,encode:C},decoder:{decode:$}}}var yX=UY("utf8","u",(D)=>"u"+new TextDecoder("utf8").decode(D),(D)=>new TextEncoder().encode(D.substring(1))),Ow=UY("ascii","a",(D)=>{let w="a";for(let C=0;C<D.length;C++)w+=String.fromCharCode(D[C]);return w},(D)=>{D=D.substring(1);let w=KY(D.length);for(let C=0;C<D.length;C++)w[C]=D.charCodeAt(C);return w}),qY={utf8:yX,"utf-8":yX,hex:dX.base16,latin1:Ow,ascii:Ow,binary:Ow,...dX};function Rw(D,w="utf8"){let C=qY[w];if(!C)throw new Error(`Unsupported encoding "${w}"`);return(w==="utf8"||w==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(D.buffer,D.byteOffset,D.byteLength).toString("utf8"):C.encoder.encode(D).substring(1)}function Lw(D,w="utf8"){let C=qY[w];if(!C)throw new Error(`Unsupported encoding "${w}"`);return(w==="utf8"||w==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?Sw(globalThis.Buffer.from(D,"utf-8")):C.decoder.decode(`${C.prefix}${D}`)}function L3(D){return Rw(Lw(lD(D),KF),EY)}function _w(D){let w=Lw(WF,hX),C=NF+Rw(QY([w,D]),hX);return[BF,JF,C].join(ZF)}function LG(D){return Rw(D,EY)}function _G(D){return Lw([L3(D.header),L3(D.payload)].join(YY),QF)}function jG(D){return[L3(D.header),L3(D.payload),LG(D.signature)].join(YY)}function jw(D=lX(FF)){let w=XY.getPublicKey(D);return{secretKey:QY([D,w]),publicKey:w}}async function MY(D,w,C,$,X=cX.fromMiliseconds(Date.now())){let Y={alg:YF,typ:EF},E=_w($.publicKey),K=X+C,Q={iss:E,sub:D,aud:w,iat:X,exp:K},Z=_G({header:Y,payload:Q}),B=XY.sign(Z,$.secretKey.slice(0,32));return jG({header:Y,payload:Q,signature:B})}var WC=FD(aY(),1),yK=FD(EE(),1),FC=FD(dw(),1),i0=FD(RE(),1),s3=FD(hE(),1);function x8(D){if(globalThis.Buffer!=null)return new Uint8Array(D.buffer,D.byteOffset,D.byteLength);return D}function y0(D=0){if(globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null)return x8(globalThis.Buffer.allocUnsafe(D));return new Uint8Array(D)}function c3(D,w){if(!w)w=D.reduce((X,Y)=>X+Y.length,0);let C=y0(w),$=0;for(let X of D)C.set(X,$),$+=X.length;return x8(C)}var lw={};DD(lw,{identity:()=>ZP});function XP(D,w){if(D.length>=255)throw new TypeError("Alphabet too long");var C=new Uint8Array(256);for(var $=0;$<C.length;$++)C[$]=255;for(var X=0;X<D.length;X++){var Y=D.charAt(X),E=Y.charCodeAt(0);if(C[E]!==255)throw new TypeError(Y+" is ambiguous");C[E]=X}var K=D.length,Q=D.charAt(0),Z=Math.log(K)/Math.log(256),B=Math.log(256)/Math.log(K);function J(N){if(N instanceof Uint8Array);else if(ArrayBuffer.isView(N))N=new Uint8Array(N.buffer,N.byteOffset,N.byteLength);else if(Array.isArray(N))N=Uint8Array.from(N);if(!(N instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(N.length===0)return"";var G=0,V=0,H=0,z=N.length;while(H!==z&&N[H]===0)H++,G++;var O=(z-H)*B+1>>>0,A=new Uint8Array(O);while(H!==z){var M=N[H],T=0;for(var f=O-1;(M!==0||T<V)&&f!==-1;f--,T++)M+=256*A[f]>>>0,A[f]=M%K>>>0,M=M/K>>>0;if(M!==0)throw new Error("Non-zero carry");V=T,H++}var q=O-V;while(q!==O&&A[q]===0)q++;var L=Q.repeat(G);for(;q<O;++q)L+=D.charAt(A[q]);return L}function F(N){if(typeof N!=="string")throw new TypeError("Expected String");if(N.length===0)return new Uint8Array;var G=0;if(N[G]===" ")return;var V=0,H=0;while(N[G]===Q)V++,G++;var z=(N.length-G)*Z+1>>>0,O=new Uint8Array(z);while(N[G]){var A=C[N.charCodeAt(G)];if(A===255)return;var M=0;for(var T=z-1;(A!==0||M<H)&&T!==-1;T--,M++)A+=K*O[T]>>>0,O[T]=A%256>>>0,A=A/256>>>0;if(A!==0)throw new Error("Non-zero carry");H=M,G++}if(N[G]===" ")return;var f=z-H;while(f!==z&&O[f]===0)f++;var q=new Uint8Array(V+(z-f)),L=V;while(f!==z)q[L++]=O[f++];return q}function W(N){var G=F(N);if(G)return G;throw new Error(`Non-${w} character`)}return{encode:J,decodeUnsafe:F,decode:W}}var YP=XP,EP=YP,gE=EP;var Z9=new Uint8Array(0);var uE=(D,w)=>{if(D===w)return!0;if(D.byteLength!==w.byteLength)return!1;for(let C=0;C<D.byteLength;C++)if(D[C]!==w[C])return!1;return!0},B8=(D)=>{if(D instanceof Uint8Array&&D.constructor.name==="Uint8Array")return D;if(D instanceof ArrayBuffer)return new Uint8Array(D);if(ArrayBuffer.isView(D))return new Uint8Array(D.buffer,D.byteOffset,D.byteLength);throw new Error("Unknown type, must be binary type")};var kE=(D)=>new TextEncoder().encode(D),bE=(D)=>new TextDecoder().decode(D);class yE{constructor(D,w,C){this.name=D,this.prefix=w,this.baseEncode=C}encode(D){if(D instanceof Uint8Array)return`${this.prefix}${this.baseEncode(D)}`;else throw Error("Unknown type, must be binary type")}}class cE{constructor(D,w,C){if(this.name=D,this.prefix=w,w.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=w.codePointAt(0),this.baseDecode=C}decode(D){if(typeof D==="string"){if(D.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(D)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(D.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(D){return pE(this,D)}}class vE{constructor(D){this.decoders=D}or(D){return pE(this,D)}decode(D){let w=D[0],C=this.decoders[w];if(C)return C.decode(D);else throw RangeError(`Unable to decode multibase string ${JSON.stringify(D)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}var pE=(D,w)=>new vE({...D.decoders||{[D.prefix]:D},...w.decoders||{[w.prefix]:w}});class nE{constructor(D,w,C,$){this.name=D,this.prefix=w,this.baseEncode=C,this.baseDecode=$,this.encoder=new yE(D,w,C),this.decoder=new cE(D,w,$)}encode(D){return this.encoder.encode(D)}decode(D){return this.decoder.decode(D)}}var w0=({name:D,prefix:w,encode:C,decode:$})=>new nE(D,w,C,$),H8=({prefix:D,name:w,alphabet:C})=>{let{encode:$,decode:X}=gE(C,w);return w0({prefix:D,name:w,encode:$,decode:(Y)=>B8(X(Y))})},KP=(D,w,C,$)=>{let X={};for(let B=0;B<w.length;++B)X[w[B]]=B;let Y=D.length;while(D[Y-1]==="=")--Y;let E=new Uint8Array(Y*C/8|0),K=0,Q=0,Z=0;for(let B=0;B<Y;++B){let J=X[D[B]];if(J===void 0)throw new SyntaxError(`Non-${$} character`);if(Q=Q<<C|J,K+=C,K>=8)K-=8,E[Z++]=255&Q>>K}if(K>=C||255&Q<<8-K)throw new SyntaxError("Unexpected end of data");return E},QP=(D,w,C)=>{let $=w[w.length-1]==="=",X=(1<<C)-1,Y="",E=0,K=0;for(let Q=0;Q<D.length;++Q){K=K<<8|D[Q],E+=8;while(E>C)E-=C,Y+=w[X&K>>E]}if(E)Y+=w[X&K<<C-E];if($)while(Y.length*C&7)Y+="=";return Y},wD=({name:D,prefix:w,bitsPerChar:C,alphabet:$})=>{return w0({prefix:w,name:D,encode(X){return QP(X,$,C)},decode(X){return KP(X,$,C,D)}})};var ZP=w0({prefix:"\x00",name:"identity",encode:(D)=>bE(D),decode:(D)=>kE(D)});var iw={};DD(iw,{base2:()=>BP});var BP=wD({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var rw={};DD(rw,{base8:()=>JP});var JP=wD({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var ow={};DD(ow,{base10:()=>NP});var NP=H8({prefix:"9",name:"base10",alphabet:"0123456789"});var sw={};DD(sw,{base16upper:()=>FP,base16:()=>WP});var WP=wD({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),FP=wD({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var aw={};DD(aw,{base32z:()=>HP,base32upper:()=>GP,base32padupper:()=>PP,base32pad:()=>OP,base32hexupper:()=>zP,base32hexpadupper:()=>IP,base32hexpad:()=>AP,base32hex:()=>VP,base32:()=>C0});var C0=wD({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),GP=wD({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),OP=wD({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),PP=wD({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),VP=wD({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),zP=wD({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),AP=wD({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),IP=wD({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),HP=wD({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var tw={};DD(tw,{base36upper:()=>UP,base36:()=>fP});var fP=H8({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),UP=H8({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var ew={};DD(ew,{base58flickr:()=>qP,base58btc:()=>D8});var D8=H8({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),qP=H8({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var DC={};DD(DC,{base64urlpad:()=>RP,base64url:()=>SP,base64pad:()=>TP,base64:()=>MP});var MP=wD({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),TP=wD({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),SP=wD({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),RP=wD({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var wC={};DD(wC,{base256emoji:()=>mP});var lE=Array.from("\uD83D\uDE80\uD83E\uDE90☄\uD83D\uDEF0\uD83C\uDF0C\uD83C\uDF11\uD83C\uDF12\uD83C\uDF13\uD83C\uDF14\uD83C\uDF15\uD83C\uDF16\uD83C\uDF17\uD83C\uDF18\uD83C\uDF0D\uD83C\uDF0F\uD83C\uDF0E\uD83D\uDC09☀\uD83D\uDCBB\uD83D\uDDA5\uD83D\uDCBE\uD83D\uDCBF\uD83D\uDE02❤\uD83D\uDE0D\uD83E\uDD23\uD83D\uDE0A\uD83D\uDE4F\uD83D\uDC95\uD83D\uDE2D\uD83D\uDE18\uD83D\uDC4D\uD83D\uDE05\uD83D\uDC4F\uD83D\uDE01\uD83D\uDD25\uD83E\uDD70\uD83D\uDC94\uD83D\uDC96\uD83D\uDC99\uD83D\uDE22\uD83E\uDD14\uD83D\uDE06\uD83D\uDE44\uD83D\uDCAA\uD83D\uDE09☺\uD83D\uDC4C\uD83E\uDD17\uD83D\uDC9C\uD83D\uDE14\uD83D\uDE0E\uD83D\uDE07\uD83C\uDF39\uD83E\uDD26\uD83C\uDF89\uD83D\uDC9E✌✨\uD83E\uDD37\uD83D\uDE31\uD83D\uDE0C\uD83C\uDF38\uD83D\uDE4C\uD83D\uDE0B\uD83D\uDC97\uD83D\uDC9A\uD83D\uDE0F\uD83D\uDC9B\uD83D\uDE42\uD83D\uDC93\uD83E\uDD29\uD83D\uDE04\uD83D\uDE00\uD83D\uDDA4\uD83D\uDE03\uD83D\uDCAF\uD83D\uDE48\uD83D\uDC47\uD83C\uDFB6\uD83D\uDE12\uD83E\uDD2D❣\uD83D\uDE1C\uD83D\uDC8B\uD83D\uDC40\uD83D\uDE2A\uD83D\uDE11\uD83D\uDCA5\uD83D\uDE4B\uD83D\uDE1E\uD83D\uDE29\uD83D\uDE21\uD83E\uDD2A\uD83D\uDC4A\uD83E\uDD73\uD83D\uDE25\uD83E\uDD24\uD83D\uDC49\uD83D\uDC83\uD83D\uDE33✋\uD83D\uDE1A\uD83D\uDE1D\uD83D\uDE34\uD83C\uDF1F\uD83D\uDE2C\uD83D\uDE43\uD83C\uDF40\uD83C\uDF37\uD83D\uDE3B\uD83D\uDE13⭐✅\uD83E\uDD7A\uD83C\uDF08\uD83D\uDE08\uD83E\uDD18\uD83D\uDCA6✔\uD83D\uDE23\uD83C\uDFC3\uD83D\uDC90☹\uD83C\uDF8A\uD83D\uDC98\uD83D\uDE20☝\uD83D\uDE15\uD83C\uDF3A\uD83C\uDF82\uD83C\uDF3B\uD83D\uDE10\uD83D\uDD95\uD83D\uDC9D\uD83D\uDE4A\uD83D\uDE39\uD83D\uDDE3\uD83D\uDCAB\uD83D\uDC80\uD83D\uDC51\uD83C\uDFB5\uD83E\uDD1E\uD83D\uDE1B\uD83D\uDD34\uD83D\uDE24\uD83C\uDF3C\uD83D\uDE2B⚽\uD83E\uDD19☕\uD83C\uDFC6\uD83E\uDD2B\uD83D\uDC48\uD83D\uDE2E\uD83D\uDE46\uD83C\uDF7B\uD83C\uDF43\uD83D\uDC36\uD83D\uDC81\uD83D\uDE32\uD83C\uDF3F\uD83E\uDDE1\uD83C\uDF81⚡\uD83C\uDF1E\uD83C\uDF88❌✊\uD83D\uDC4B\uD83D\uDE30\uD83E\uDD28\uD83D\uDE36\uD83E\uDD1D\uD83D\uDEB6\uD83D\uDCB0\uD83C\uDF53\uD83D\uDCA2\uD83E\uDD1F\uD83D\uDE41\uD83D\uDEA8\uD83D\uDCA8\uD83E\uDD2C✈\uD83C\uDF80\uD83C\uDF7A\uD83E\uDD13\uD83D\uDE19\uD83D\uDC9F\uD83C\uDF31\uD83D\uDE16\uD83D\uDC76\uD83E\uDD74▶➡❓\uD83D\uDC8E\uD83D\uDCB8⬇\uD83D\uDE28\uD83C\uDF1A\uD83E\uDD8B\uD83D\uDE37\uD83D\uDD7A⚠\uD83D\uDE45\uD83D\uDE1F\uD83D\uDE35\uD83D\uDC4E\uD83E\uDD32\uD83E\uDD20\uD83E\uDD27\uD83D\uDCCC\uD83D\uDD35\uD83D\uDC85\uD83E\uDDD0\uD83D\uDC3E\uD83C\uDF52\uD83D\uDE17\uD83E\uDD11\uD83C\uDF0A\uD83E\uDD2F\uD83D\uDC37☎\uD83D\uDCA7\uD83D\uDE2F\uD83D\uDC86\uD83D\uDC46\uD83C\uDFA4\uD83D\uDE47\uD83C\uDF51❄\uD83C\uDF34\uD83D\uDCA3\uD83D\uDC38\uD83D\uDC8C\uD83D\uDCCD\uD83E\uDD40\uD83E\uDD22\uD83D\uDC45\uD83D\uDCA1\uD83D\uDCA9\uD83D\uDC50\uD83D\uDCF8\uD83D\uDC7B\uD83E\uDD10\uD83E\uDD2E\uD83C\uDFBC\uD83E\uDD75\uD83D\uDEA9\uD83C\uDF4E\uD83C\uDF4A\uD83D\uDC7C\uD83D\uDC8D\uD83D\uDCE3\uD83E\uDD42"),LP=lE.reduce((D,w,C)=>{return D[C]=w,D},[]),_P=lE.reduce((D,w,C)=>{return D[w.codePointAt(0)]=C,D},[]);function jP(D){return D.reduce((w,C)=>{return w+=LP[C],w},"")}function xP(D){let w=[];for(let C of D){let $=_P[C.codePointAt(0)];if($===void 0)throw new Error(`Non-base256emoji character: ${C}`);w.push($)}return new Uint8Array(w)}var mP=w0({prefix:"\uD83D\uDE80",name:"base256emoji",encode:jP,decode:xP});var XC={};DD(XC,{sha512:()=>DV,sha256:()=>eP});var hP=oE,iE=128,gP=127,uP=~gP,kP=Math.pow(2,31);function oE(D,w,C){w=w||[],C=C||0;var $=C;while(D>=kP)w[C++]=D&255|iE,D/=128;while(D&uP)w[C++]=D&255|iE,D>>>=7;return w[C]=D|0,oE.bytes=C-$+1,w}var bP=CC,dP=128,rE=127;function CC(D,$){var C=0,$=$||0,X=0,Y=$,E,K=D.length;do{if(Y>=K)throw CC.bytes=0,new RangeError("Could not decode varint");E=D[Y++],C+=X<28?(E&rE)<<X:(E&rE)*Math.pow(2,X),X+=7}while(E>=dP);return CC.bytes=Y-$,C}var yP=Math.pow(2,7),cP=Math.pow(2,14),vP=Math.pow(2,21),pP=Math.pow(2,28),nP=Math.pow(2,35),lP=Math.pow(2,42),iP=Math.pow(2,49),rP=Math.pow(2,56),oP=Math.pow(2,63),sP=function(D){return D<yP?1:D<cP?2:D<vP?3:D<pP?4:D<nP?5:D<lP?6:D<iP?7:D<rP?8:D<oP?9:10},aP={encode:hP,decode:bP,encodingLength:sP},tP=aP,c0=tP;var v0=(D,w=0)=>{return[c0.decode(D,w),c0.decode.bytes]},$0=(D,w,C=0)=>{return c0.encode(D,w,C),w},X0=(D)=>{return c0.encodingLength(D)};var m8=(D,w)=>{let C=w.byteLength,$=X0(D),X=$+X0(C),Y=new Uint8Array(X+C);return $0(D,Y,0),$0(C,Y,$),Y.set(w,X),new p0(D,C,w,Y)},sE=(D)=>{let w=B8(D),[C,$]=v0(w),[X,Y]=v0(w.subarray($)),E=w.subarray($+Y);if(E.byteLength!==X)throw new Error("Incorrect length");return new p0(C,X,E,w)},aE=(D,w)=>{if(D===w)return!0;else return D.code===w.code&&D.size===w.size&&uE(D.bytes,w.bytes)};class p0{constructor(D,w,C,$){this.code=D,this.size=w,this.digest=C,this.bytes=$}}var $C=({name:D,code:w,encode:C})=>new tE(D,w,C);class tE{constructor(D,w,C){this.name=D,this.code=w,this.encode=C}digest(D){if(D instanceof Uint8Array){let w=this.encode(D);return w instanceof Uint8Array?m8(this.code,w):w.then((C)=>m8(this.code,C))}else throw Error("Unknown type, must be binary type")}}var DK=(D)=>async(w)=>new Uint8Array(await crypto.subtle.digest(D,w)),eP=$C({name:"sha2-256",code:18,encode:DK("SHA-256")}),DV=$C({name:"sha2-512",code:19,encode:DK("SHA-512")});var YC={};DD(YC,{identity:()=>$V});var wK=0,wV="identity",CK=B8,CV=(D)=>m8(wK,CK(D)),$V={code:wK,name:wV,encode:CK,digest:CV};class VD{constructor(D,w,C,$){this.code=w,this.version=D,this.multihash=C,this.bytes=$,this.byteOffset=$.byteOffset,this.byteLength=$.byteLength,this.asCID=this,this._baseCache=new Map,Object.defineProperties(this,{byteOffset:n3,byteLength:n3,code:p3,version:p3,multihash:p3,bytes:p3,_baseCache:n3,asCID:n3})}toV0(){switch(this.version){case 0:return this;default:{let{code:D,multihash:w}=this;if(D!==l0)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(w.code!==ZV)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return VD.createV0(w)}}}toV1(){switch(this.version){case 0:{let{code:D,digest:w}=this.multihash,C=m8(D,w);return VD.createV1(this.code,C)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}equals(D){return D&&this.code===D.code&&this.version===D.version&&aE(this.multihash,D.multihash)}toString(D){let{bytes:w,version:C,_baseCache:$}=this;switch(C){case 0:return KV(w,$,D||D8.encoder);default:return QV(w,$,D||C0.encoder)}}toJSON(){return{code:this.code,version:this.version,hash:this.multihash.bytes}}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return"CID("+this.toString()+")"}static isCID(D){return JV(/^0\.0/,NV),!!(D&&(D[XK]||D.asCID===D))}get toBaseEncodedString(){throw new Error("Deprecated, use .toString()")}get codec(){throw new Error('"codec" property is deprecated, use integer "code" property instead')}get buffer(){throw new Error("Deprecated .buffer property, use .bytes to get Uint8Array instead")}get multibaseName(){throw new Error('"multibaseName" property is deprecated')}get prefix(){throw new Error('"prefix" property is deprecated')}static asCID(D){if(D instanceof VD)return D;else if(D!=null&&D.asCID===D){let{version:w,code:C,multihash:$,bytes:X}=D;return new VD(w,C,$,X||$K(w,C,$.bytes))}else if(D!=null&&D[XK]===!0){let{version:w,multihash:C,code:$}=D,X=sE(C);return VD.create(w,$,X)}else return null}static create(D,w,C){if(typeof w!=="number")throw new Error("String codecs are no longer supported");switch(D){case 0:if(w!==l0)throw new Error(`Version 0 CID must use dag-pb (code: ${l0}) block encoding`);else return new VD(D,w,C,C.bytes);case 1:{let $=$K(D,w,C.bytes);return new VD(D,w,C,$)}default:throw new Error("Invalid version")}}static createV0(D){return VD.create(0,l0,D)}static createV1(D,w){return VD.create(1,D,w)}static decode(D){let[w,C]=VD.decodeFirst(D);if(C.length)throw new Error("Incorrect length");return w}static decodeFirst(D){let w=VD.inspectBytes(D),C=w.size-w.multihashSize,$=B8(D.subarray(C,C+w.multihashSize));if($.byteLength!==w.multihashSize)throw new Error("Incorrect length");let X=$.subarray(w.multihashSize-w.digestSize),Y=new p0(w.multihashCode,w.digestSize,X,$);return[w.version===0?VD.createV0(Y):VD.createV1(w.codec,Y),D.subarray(w.size)]}static inspectBytes(D){let w=0,C=()=>{let[B,J]=v0(D.subarray(w));return w+=J,B},$=C(),X=l0;if($===18)$=0,w=0;else if($===1)X=C();if($!==0&&$!==1)throw new RangeError(`Invalid CID version ${$}`);let Y=w,E=C(),K=C(),Q=w+K,Z=Q-Y;return{version:$,codec:X,multihashCode:E,digestSize:K,multihashSize:Z,size:Q}}static parse(D,w){let[C,$]=EV(D,w),X=VD.decode($);return X._baseCache.set(C,D),X}}var EV=(D,w)=>{switch(D[0]){case"Q":{let C=w||D8;return[D8.prefix,C.decode(`${D8.prefix}${D}`)]}case D8.prefix:{let C=w||D8;return[D8.prefix,C.decode(D)]}case C0.prefix:{let C=w||C0;return[C0.prefix,C.decode(D)]}default:{if(w==null)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[D[0],w.decode(D)]}}},KV=(D,w,C)=>{let{prefix:$}=C;if($!==D8.prefix)throw Error(`Cannot string encode V0 in ${C.name} encoding`);let X=w.get($);if(X==null){let Y=C.encode(D).slice(1);return w.set($,Y),Y}else return X},QV=(D,w,C)=>{let{prefix:$}=C,X=w.get($);if(X==null){let Y=C.encode(D);return w.set($,Y),Y}else return X},l0=112,ZV=18,$K=(D,w,C)=>{let $=X0(D),X=$+X0(w),Y=new Uint8Array(X+C.byteLength);return $0(D,Y,0),$0(w,Y,$),Y.set(C,X),Y},XK=Symbol.for("@ipld/js-cid/CID"),p3={writable:!1,configurable:!1,enumerable:!0},n3={writable:!1,enumerable:!1,configurable:!1},BV="0.0.0-dev",JV=(D,w)=>{if(D.test(BV))console.warn(w);else throw new Error(w)},NV=`CID.isCID(v) is deprecated and will be removed in the next major release.
Following code pattern:

if (CID.isCID(value)) {
  doSomethingWithCID(value)
}

Is replaced with:

const cid = CID.asCID(value)
if (cid) {
  // Make sure to use cid instead of value
  doSomethingWithCID(cid)
}
`;var EC={...lw,...iw,...rw,...ow,...sw,...aw,...tw,...ew,...DC,...wC},u9={...XC,...YC};function EK(D,w,C,$){return{name:D,prefix:w,encoder:{name:D,prefix:w,encode:C},decoder:{decode:$}}}var YK=EK("utf8","u",(D)=>{return"u"+new TextDecoder("utf8").decode(D)},(D)=>{return new TextEncoder().encode(D.substring(1))}),KC=EK("ascii","a",(D)=>{let w="a";for(let C=0;C<D.length;C++)w+=String.fromCharCode(D[C]);return w},(D)=>{D=D.substring(1);let w=y0(D.length);for(let C=0;C<D.length;C++)w[C]=D.charCodeAt(C);return w}),WV={utf8:YK,"utf-8":YK,hex:EC.base16,latin1:KC,ascii:KC,binary:KC,...EC},l3=WV;function kD(D,w="utf8"){let C=l3[w];if(!C)throw new Error(`Unsupported encoding "${w}"`);if((w==="utf8"||w==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null)return x8(globalThis.Buffer.from(D,"utf-8"));return C.decoder.decode(`${C.prefix}${D}`)}function _D(D,w="utf8"){let C=l3[w];if(!C)throw new Error(`Unsupported encoding "${w}"`);if((w==="utf8"||w==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null)return globalThis.Buffer.from(D.buffer,D.byteOffset,D.byteLength).toString("utf8");return C.encoder.encode(D).substring(1)}var KK=function(D,w,C){if(C||arguments.length===2){for(var $=0,X=w.length,Y;$<X;$++)if(Y||!($ in w)){if(!Y)Y=Array.prototype.slice.call(w,0,$);Y[$]=w[$]}}return D.concat(Y||Array.prototype.slice.call(w))},FV=function(){function D(w,C,$){this.name=w,this.version=C,this.os=$,this.type="browser"}return D}();var GV=function(){function D(w){this.version=w,this.type="node",this.name="node",this.os=process.platform}return D}();var OV=function(){function D(w,C,$,X){this.name=w,this.version=C,this.os=$,this.bot=X,this.type="bot-device"}return D}();var PV=function(){function D(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null}return D}();var VV=function(){function D(){this.type="react-native",this.name="react-native",this.version=null,this.os=null}return D}();var zV=/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/,AV=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,QK=3,IV=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",zV]],ZK=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function JK(D){if(D)return BK(D);if(typeof document==="undefined"&&typeof navigator!=="undefined"&&navigator.product==="ReactNative")return new VV;if(typeof navigator!=="undefined")return BK(navigator.userAgent);return UV()}function HV(D){return D!==""&&IV.reduce(function(w,C){var $=C[0],X=C[1];if(w)return w;var Y=X.exec(D);return!!Y&&[$,Y]},!1)}function BK(D){var w=HV(D);if(!w)return null;var C=w[0],$=w[1];if(C==="searchbot")return new PV;var X=$[1]&&$[1].split(".").join("_").split("_").slice(0,3);if(X){if(X.length<QK)X=KK(KK([],X,!0),qV(QK-X.length),!0)}else X=[];var Y=X.join("."),E=fV(D),K=AV.exec(D);if(K&&K[1])return new OV(C,Y,E,K[1]);return new FV(C,Y,E)}function fV(D){for(var w=0,C=ZK.length;w<C;w++){var $=ZK[w],X=$[0],Y=$[1],E=Y.exec(D);if(E)return X}return null}function UV(){var D=typeof process!=="undefined"&&process.version;return D?new GV(process.version.slice(1)):null}function qV(D){var w=[];for(var C=0;C<D;C++)w.push("0");return w}var J8=FD(_8(),1),u8=FD(QC(),1),cK=FD(PK(),1);var sV=zK(),aV=UK(),tV=MK(),Wf=SK(),eV=(D)=>D===null||D===void 0,Ff=Symbol("encodeFragmentIdentifier");function Dz(D){switch(D.arrayFormat){case"index":return(w)=>(C,$)=>{let X=C.length;if($===void 0||D.skipNull&&$===null||D.skipEmptyString&&$==="")return C;if($===null)return[...C,[YD(w,D),"[",X,"]"].join("")];return[...C,[YD(w,D),"[",YD(X,D),"]=",YD($,D)].join("")]};case"bracket":return(w)=>(C,$)=>{if($===void 0||D.skipNull&&$===null||D.skipEmptyString&&$==="")return C;if($===null)return[...C,[YD(w,D),"[]"].join("")];return[...C,[YD(w,D),"[]=",YD($,D)].join("")]};case"colon-list-separator":return(w)=>(C,$)=>{if($===void 0||D.skipNull&&$===null||D.skipEmptyString&&$==="")return C;if($===null)return[...C,[YD(w,D),":list="].join("")];return[...C,[YD(w,D),":list=",YD($,D)].join("")]};case"comma":case"separator":case"bracket-separator":{let w=D.arrayFormat==="bracket-separator"?"[]=":"=";return(C)=>($,X)=>{if(X===void 0||D.skipNull&&X===null||D.skipEmptyString&&X==="")return $;if(X=X===null?"":X,$.length===0)return[[YD(C,D),w,YD(X,D)].join("")];return[[$,YD(X,D)].join(D.arrayFormatSeparator)]}}default:return(w)=>(C,$)=>{if($===void 0||D.skipNull&&$===null||D.skipEmptyString&&$==="")return C;if($===null)return[...C,YD(w,D)];return[...C,[YD(w,D),"=",YD($,D)].join("")]}}}function wz(D){let w;switch(D.arrayFormat){case"index":return(C,$,X)=>{if(w=/\[(\d*)\]$/.exec(C),C=C.replace(/\[\d*\]$/,""),!w){X[C]=$;return}if(X[C]===void 0)X[C]={};X[C][w[1]]=$};case"bracket":return(C,$,X)=>{if(w=/(\[\])$/.exec(C),C=C.replace(/\[\]$/,""),!w){X[C]=$;return}if(X[C]===void 0){X[C]=[$];return}X[C]=[].concat(X[C],$)};case"colon-list-separator":return(C,$,X)=>{if(w=/(:list)$/.exec(C),C=C.replace(/:list$/,""),!w){X[C]=$;return}if(X[C]===void 0){X[C]=[$];return}X[C]=[].concat(X[C],$)};case"comma":case"separator":return(C,$,X)=>{let Y=typeof $==="string"&&$.includes(D.arrayFormatSeparator),E=typeof $==="string"&&!Y&&f8($,D).includes(D.arrayFormatSeparator);$=E?f8($,D):$;let K=Y||E?$.split(D.arrayFormatSeparator).map((Q)=>f8(Q,D)):$===null?$:f8($,D);X[C]=K};case"bracket-separator":return(C,$,X)=>{let Y=/(\[\])$/.test(C);if(C=C.replace(/\[\]$/,""),!Y){X[C]=$?f8($,D):$;return}let E=$===null?[]:$.split(D.arrayFormatSeparator).map((K)=>f8(K,D));if(X[C]===void 0){X[C]=E;return}X[C]=[].concat(X[C],E)};default:return(C,$,X)=>{if(X[C]===void 0){X[C]=$;return}X[C]=[].concat(X[C],$)}}}function LK(D){if(typeof D!=="string"||D.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function YD(D,w){if(w.encode)return w.strict?sV(D):encodeURIComponent(D);return D}function f8(D,w){if(w.decode)return aV(D);return D}function _K(D){if(Array.isArray(D))return D.sort();if(typeof D==="object")return _K(Object.keys(D)).sort((w,C)=>Number(w)-Number(C)).map((w)=>D[w]);return D}function RK(D,w){if(w.parseNumbers&&!Number.isNaN(Number(D))&&(typeof D==="string"&&D.trim()!==""))D=Number(D);else if(w.parseBooleans&&D!==null&&(D.toLowerCase()==="true"||D.toLowerCase()==="false"))D=D.toLowerCase()==="true";return D}function Cz(D,w){w=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},w),LK(w.arrayFormatSeparator);let C=wz(w),$=Object.create(null);if(typeof D!=="string")return $;if(D=D.trim().replace(/^[?#&]/,""),!D)return $;for(let X of D.split("&")){if(X==="")continue;let[Y,E]=tV(w.decode?X.replace(/\+/g," "):X,"=");E=E===void 0?null:["comma","separator","bracket-separator"].includes(w.arrayFormat)?E:f8(E,w),C(f8(Y,w),E,$)}for(let X of Object.keys($)){let Y=$[X];if(typeof Y==="object"&&Y!==null)for(let E of Object.keys(Y))Y[E]=RK(Y[E],w);else $[X]=RK(Y,w)}if(w.sort===!1)return $;return(w.sort===!0?Object.keys($).sort():Object.keys($).sort(w.sort)).reduce((X,Y)=>{let E=$[Y];if(Boolean(E)&&typeof E==="object"&&!Array.isArray(E))X[Y]=_K(E);else X[Y]=E;return X},Object.create(null))}var i3=Cz,r3=(D,w)=>{if(!D)return"";w=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},w),LK(w.arrayFormatSeparator);let C=(E)=>w.skipNull&&eV(D[E])||w.skipEmptyString&&D[E]==="",$=Dz(w),X={};for(let E of Object.keys(D))if(!C(E))X[E]=D[E];let Y=Object.keys(X);if(w.sort!==!1)Y.sort(w.sort);return Y.map((E)=>{let K=D[E];if(K===void 0)return"";if(K===null)return YD(E,w);if(Array.isArray(K)){if(K.length===0&&w.arrayFormat==="bracket-separator")return YD(E,w)+"[]";return K.reduce($(E),[]).join("&")}return YD(E,w)+"="+YD(K,w)}).filter((E)=>E.length>0).join("&")};var jK={waku:{publish:"waku_publish",batchPublish:"waku_batchPublish",subscribe:"waku_subscribe",batchSubscribe:"waku_batchSubscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe",batchUnsubscribe:"waku_batchUnsubscribe",batchFetchMessages:"waku_batchFetchMessages"},irn:{publish:"irn_publish",batchPublish:"irn_batchPublish",subscribe:"irn_subscribe",batchSubscribe:"irn_batchSubscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe",batchUnsubscribe:"irn_batchUnsubscribe",batchFetchMessages:"irn_batchFetchMessages"},iridium:{publish:"iridium_publish",batchPublish:"iridium_batchPublish",subscribe:"iridium_subscribe",batchSubscribe:"iridium_batchSubscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe",batchUnsubscribe:"iridium_batchUnsubscribe",batchFetchMessages:"iridium_batchFetchMessages"}};function vK(D,w){return D.includes(":")?[D]:w.chains||[]}var pK="base10",UD="base16",JC="base64pad",GC="utf8",nK=0,N8=1,Xz=0,xK=1,NC=12,OC=32;function lK(){let D=s3.generateKeyPair();return{privateKey:_D(D.secretKey,UD),publicKey:_D(D.publicKey,UD)}}function a3(){let D=FC.randomBytes(OC);return _D(D,UD)}function iK(D,w){let C=s3.sharedKey(kD(D,UD),kD(w,UD)),$=new yK.HKDF(i0.SHA256,C).expand(OC);return _D($,UD)}function rK(D){let w=i0.hash(kD(D,UD));return _D(w,UD)}function U8(D){let w=i0.hash(kD(D,GC));return _D(w,UD)}function Yz(D){return kD(`${D}`,pK)}function E0(D){return Number(_D(D,pK))}function oK(D){let w=Yz(typeof D.type<"u"?D.type:nK);if(E0(w)===N8&&typeof D.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");let C=typeof D.senderPublicKey<"u"?kD(D.senderPublicKey,UD):void 0,$=typeof D.iv<"u"?kD(D.iv,UD):FC.randomBytes(NC),X=new WC.ChaCha20Poly1305(kD(D.symKey,UD)).seal($,kD(D.message,GC));return Ez({type:w,sealed:X,iv:$,senderPublicKey:C})}function sK(D){let w=new WC.ChaCha20Poly1305(kD(D.symKey,UD)),{sealed:C,iv:$}=r0(D.encoded),X=w.open($,C);if(X===null)throw new Error("Failed to decrypt");return _D(X,GC)}function Ez(D){if(E0(D.type)===N8){if(typeof D.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return _D(c3([D.type,D.senderPublicKey,D.iv,D.sealed]),JC)}return _D(c3([D.type,D.iv,D.sealed]),JC)}function r0(D){let w=kD(D,JC),C=w.slice(Xz,xK),$=xK;if(E0(C)===N8){let K=$+OC,Q=K+NC,Z=w.slice($,K),B=w.slice(K,Q),J=w.slice(Q);return{type:C,sealed:J,iv:B,senderPublicKey:Z}}let X=$+NC,Y=w.slice($,X),E=w.slice(X);return{type:C,sealed:E,iv:Y}}function aK(D,w){let C=r0(D);return PC({type:E0(C.type),senderPublicKey:typeof C.senderPublicKey<"u"?_D(C.senderPublicKey,UD):void 0,receiverPublicKey:w?.receiverPublicKey})}function PC(D){let w=D?.type||nK;if(w===N8){if(typeof D?.senderPublicKey>"u")throw new Error("missing sender public key");if(typeof D?.receiverPublicKey>"u")throw new Error("missing receiver public key")}return{type:w,senderPublicKey:D?.senderPublicKey,receiverPublicKey:D?.receiverPublicKey}}function VC(D){return D.type===N8&&typeof D.senderPublicKey=="string"&&typeof D.receiverPublicKey=="string"}var{defineProperty:Kz,getOwnPropertySymbols:mK}=Object,Qz=Object.prototype.hasOwnProperty,Zz=Object.prototype.propertyIsEnumerable,hK=(D,w,C)=>(w in D)?Kz(D,w,{enumerable:!0,configurable:!0,writable:!0,value:C}):D[w]=C,gK=(D,w)=>{for(var C in w||(w={}))Qz.call(w,C)&&hK(D,C,w[C]);if(mK)for(var C of mK(w))Zz.call(w,C)&&hK(D,C,w[C]);return D},Bz="ReactNative",gD={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"};var Jz="js";function t3(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}function o0(){return!u8.getDocument()&&!!u8.getNavigator()&&navigator.product===Bz}function k8(){return!t3()&&!!u8.getNavigator()}function s0(){return o0()?gD.reactNative:t3()?gD.node:k8()?gD.browser:gD.unknown}function Nz(D,w){let C=i3(D);return C=gK(gK({},C),w),D=r3(C),D}function tK(){return cK.getWindowMetadata()||{name:"",description:"",url:"",icons:[""]}}function Wz(){if(s0()===gD.reactNative&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"){let{OS:C,Version:$}=global.Platform;return[C,$].join("-")}let D=JK();if(D===null)return"unknown";let w=D.os?D.os.replace(" ","").toLowerCase():"unknown";return D.type==="browser"?[w,D.name,D.version].join("-"):[w,D.version].join("-")}function Fz(){var D;let w=s0();return w===gD.browser?[w,((D=u8.getLocation())==null?void 0:D.host)||"unknown"].join(":"):w}function Gz(D,w,C){let $=Wz(),X=Fz();return[[D,w].join("-"),[Jz,C].join("-"),$,X].join("/")}function eK({protocol:D,version:w,relayUrl:C,sdkVersion:$,auth:X,projectId:Y,useOnCloseEvent:E}){let K=C.split("?"),Q=Gz(D,w,$),Z={auth:X,ua:Q,projectId:Y,useOnCloseEvent:E||void 0},B=Nz(K[1]||"",Z);return K[0]+"?"+B}function g8(D,w){return D.filter((C)=>w.includes(C)).length===D.length}function zC(D){return Object.fromEntries(D.entries())}function AC(D){return new Map(Object.entries(D))}function q8(D=J8.FIVE_MINUTES,w){let C=J8.toMiliseconds(D||J8.FIVE_MINUTES),$,X,Y;return{resolve:(E)=>{Y&&$&&(clearTimeout(Y),$(E))},reject:(E)=>{Y&&X&&(clearTimeout(Y),X(E))},done:()=>new Promise((E,K)=>{Y=setTimeout(()=>{K(new Error(w))},C),$=E,X=K})}}function K0(D,w,C){return new Promise(async($,X)=>{let Y=setTimeout(()=>X(new Error(C)),w);try{let E=await D;$(E)}catch(E){X(E)}clearTimeout(Y)})}function DQ(D,w){if(typeof w=="string"&&w.startsWith(`${D}:`))return w;if(D.toLowerCase()==="topic"){if(typeof w!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${w}`}else if(D.toLowerCase()==="id"){if(typeof w!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${w}`}throw new Error(`Unknown expirer target type: ${D}`)}function wQ(D){return DQ("topic",D)}function CQ(D){return DQ("id",D)}function e3(D){let[w,C]=D.split(":"),$={id:void 0,topic:void 0};if(w==="topic"&&typeof C=="string")$.topic=C;else if(w==="id"&&Number.isInteger(Number(C)))$.id=Number(C);else throw new Error(`Invalid target, expected id:number or topic:string, got ${w}:${C}`);return $}function bD(D,w){return J8.fromMiliseconds((w||Date.now())+J8.toMiliseconds(D))}function w8(D){return Date.now()>=J8.toMiliseconds(D)}function CD(D,w){return`${D}${w?`:${w}`:""}`}async function $Q({id:D,topic:w,wcDeepLink:C}){try{if(!C)return;let X=(typeof C=="string"?JSON.parse(C):C)?.href;if(typeof X!="string")return;X.endsWith("/")&&(X=X.slice(0,-1));let Y=`${X}/wc?requestId=${D}&sessionTopic=${w}`,E=s0();E===gD.browser?Y.startsWith("https://")?window.open(Y,"_blank","noreferrer noopener"):window.open(Y,"_self","noreferrer noopener"):E===gD.reactNative&&typeof(global==null?void 0:global.Linking)<"u"&&await global.Linking.openURL(Y)}catch($){console.error($)}}var Oz="irn";function D1(D){return D?.relay||{protocol:Oz}}function a0(D){let w=jK[D];if(typeof w>"u")throw new Error(`Relay Protocol not supported: ${D}`);return w}var{defineProperty:Pz,getOwnPropertySymbols:uK}=Object,Vz=Object.prototype.hasOwnProperty,zz=Object.prototype.propertyIsEnumerable,kK=(D,w,C)=>(w in D)?Pz(D,w,{enumerable:!0,configurable:!0,writable:!0,value:C}):D[w]=C,Az=(D,w)=>{for(var C in w||(w={}))Vz.call(w,C)&&kK(D,C,w[C]);if(uK)for(var C of uK(w))zz.call(w,C)&&kK(D,C,w[C]);return D};function Iz(D,w="-"){let C={},$="relay"+w;return Object.keys(D).forEach((X)=>{if(X.startsWith($)){let Y=X.replace($,""),E=D[X];C[Y]=E}}),C}function XQ(D){let w=D.indexOf(":"),C=D.indexOf("?")!==-1?D.indexOf("?"):void 0,$=D.substring(0,w),X=D.substring(w+1,C).split("@"),Y=typeof C<"u"?D.substring(C):"",E=i3(Y);return{protocol:$,topic:Hz(X[0]),version:parseInt(X[1],10),symKey:E.symKey,relay:Iz(E)}}function Hz(D){return D.startsWith("//")?D.substring(2):D}function fz(D,w="-"){let $={};return Object.keys(D).forEach((X)=>{let Y="relay"+w+X;D[X]&&($[Y]=D[X])}),$}function YQ(D){return`${D.protocol}:${D.topic}@${D.version}?`+r3(Az({symKey:D.symKey},fz(D.relay)))}function Q0(D){let w=[];return D.forEach((C)=>{let[$,X]=C.split(":");w.push(`${$}:${X}`)}),w}function Uz(D){let w=[];return Object.values(D).forEach((C)=>{w.push(...Q0(C.accounts))}),w}function qz(D,w){let C=[];return Object.values(D).forEach(($)=>{Q0($.accounts).includes(w)&&C.push(...$.methods)}),C}function Mz(D,w){let C=[];return Object.values(D).forEach(($)=>{Q0($.accounts).includes(w)&&C.push(...$.events)}),C}function EQ(D,w){let C=t0(D,w);if(C)throw new Error(C.message);let $={};for(let[X,Y]of Object.entries(D))$[X]={methods:Y.methods,events:Y.events,chains:Y.accounts.map((E)=>`${E.split(":")[0]}:${E.split(":")[1]}`)};return $}var Tz={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5000},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6000},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7000},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},Sz={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function R(D,w){let{message:C,code:$}=Sz[D];return{message:w?`${C} ${w}`:C,code:$}}function ED(D,w){let{message:C,code:$}=Tz[D];return{message:w?`${C} ${w}`:C,code:$}}function Z0(D,w){return Array.isArray(D)?typeof w<"u"&&D.length?D.every(w):!0:!1}function B0(D){return Object.getPrototypeOf(D)===Object.prototype&&Object.keys(D).length}function zD(D){return typeof D>"u"}function KD(D,w){return w&&zD(D)?!0:typeof D=="string"&&!!D.trim().length}function IC(D,w){return w&&zD(D)?!0:typeof D=="number"&&!isNaN(D)}function KQ(D,w){let{requiredNamespaces:C}=w,$=Object.keys(D.namespaces),X=Object.keys(C),Y=!0;return g8(X,$)?($.forEach((E)=>{let{accounts:K,methods:Q,events:Z}=D.namespaces[E],B=Q0(K),J=C[E];(!g8(vK(E,J),B)||!g8(J.methods,Q)||!g8(J.events,Z))&&(Y=!1)}),Y):!1}function o3(D){return KD(D,!1)&&D.includes(":")?D.split(":").length===2:!1}function Rz(D){if(KD(D,!1)&&D.includes(":")){let w=D.split(":");if(w.length===3){let C=w[0]+":"+w[1];return!!w[2]&&o3(C)}}return!1}function QQ(D){if(KD(D,!1))try{return typeof new URL(D)<"u"}catch{return!1}return!1}function ZQ(D){var w;return(w=D?.proposer)==null?void 0:w.publicKey}function BQ(D){return D?.topic}function JQ(D,w){let C=null;return KD(D?.publicKey,!1)||(C=R("MISSING_OR_INVALID",`${w} controller public key should be a string`)),C}function bK(D){let w=!0;return Z0(D)?D.length&&(w=D.every((C)=>KD(C,!1))):w=!1,w}function Lz(D,w,C){let $=null;return Z0(w)&&w.length?w.forEach((X)=>{$||o3(X)||($=ED("UNSUPPORTED_CHAINS",`${C}, chain ${X} should be a string and conform to "namespace:chainId" format`))}):o3(D)||($=ED("UNSUPPORTED_CHAINS",`${C}, chains must be defined as "namespace:chainId" e.g. "eip155:1": {...} in the namespace key OR as an array of CAIP-2 chainIds e.g. eip155: { chains: ["eip155:1", "eip155:5"] }`)),$}function _z(D,w,C){let $=null;return Object.entries(D).forEach(([X,Y])=>{if($)return;let E=Lz(X,vK(X,Y),`${w} ${C}`);E&&($=E)}),$}function jz(D,w){let C=null;return Z0(D)?D.forEach(($)=>{C||Rz($)||(C=ED("UNSUPPORTED_ACCOUNTS",`${w}, account ${$} should be a string and conform to "namespace:chainId:address" format`))}):C=ED("UNSUPPORTED_ACCOUNTS",`${w}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),C}function xz(D,w){let C=null;return Object.values(D).forEach(($)=>{if(C)return;let X=jz($?.accounts,`${w} namespace`);X&&(C=X)}),C}function mz(D,w){let C=null;return bK(D?.methods)?bK(D?.events)||(C=ED("UNSUPPORTED_EVENTS",`${w}, events should be an array of strings or empty array for no events`)):C=ED("UNSUPPORTED_METHODS",`${w}, methods should be an array of strings or empty array for no methods`),C}function NQ(D,w){let C=null;return Object.values(D).forEach(($)=>{if(C)return;let X=mz($,`${w}, namespace`);X&&(C=X)}),C}function WQ(D,w,C){let $=null;if(D&&B0(D)){let X=NQ(D,w);X&&($=X);let Y=_z(D,w,C);Y&&($=Y)}else $=R("MISSING_OR_INVALID",`${w}, ${C} should be an object with data`);return $}function t0(D,w){let C=null;if(D&&B0(D)){let $=NQ(D,w);$&&(C=$);let X=xz(D,w);X&&(C=X)}else C=R("MISSING_OR_INVALID",`${w}, namespaces should be an object with data`);return C}function HC(D){return KD(D.protocol,!0)}function FQ(D,w){let C=!1;return w&&!D?C=!0:D&&Z0(D)&&D.length&&D.forEach(($)=>{C=HC($)}),C}function GQ(D){return typeof D=="number"}function qD(D){return typeof D<"u"&&typeof D!==null}function OQ(D){return!(!D||typeof D!="object"||!D.code||!IC(D.code,!1)||!D.message||!KD(D.message,!1))}function PQ(D){return!(zD(D)||!KD(D.method,!1))}function VQ(D){return!(zD(D)||zD(D.result)&&zD(D.error)||!IC(D.id,!1)||!KD(D.jsonrpc,!1))}function zQ(D){return!(zD(D)||!KD(D.name,!1))}function fC(D,w){return!(!o3(w)||!Uz(D).includes(w))}function AQ(D,w,C){return KD(C,!1)?qz(D,w).includes(C):!1}function IQ(D,w,C){return KD(C,!1)?Mz(D,w).includes(C):!1}function UC(D,w,C){let $=null,X=hz(D),Y=gz(w),E=Object.keys(X),K=Object.keys(Y),Q=dK(Object.keys(D)),Z=dK(Object.keys(w)),B=Q.filter((J)=>!Z.includes(J));return B.length&&($=R("NON_CONFORMING_NAMESPACES",`${C} namespaces keys don't satisfy requiredNamespaces.
      Required: ${B.toString()}
      Received: ${Object.keys(w).toString()}`)),g8(E,K)||($=R("NON_CONFORMING_NAMESPACES",`${C} namespaces chains don't satisfy required namespaces.
      Required: ${E.toString()}
      Approved: ${K.toString()}`)),Object.keys(w).forEach((J)=>{if(!J.includes(":")||$)return;let F=Q0(w[J].accounts);F.includes(J)||($=R("NON_CONFORMING_NAMESPACES",`${C} namespaces accounts don't satisfy namespace accounts for ${J}
        Required: ${J}
        Approved: ${F.toString()}`))}),E.forEach((J)=>{$||(g8(X[J].methods,Y[J].methods)?g8(X[J].events,Y[J].events)||($=R("NON_CONFORMING_NAMESPACES",`${C} namespaces events don't satisfy namespace events for ${J}`)):$=R("NON_CONFORMING_NAMESPACES",`${C} namespaces methods don't satisfy namespace methods for ${J}`))}),$}function hz(D){let w={};return Object.keys(D).forEach((C)=>{var $;C.includes(":")?w[C]=D[C]:($=D[C].chains)==null||$.forEach((X)=>{w[X]={methods:D[C].methods,events:D[C].events}})}),w}function dK(D){return[...new Set(D.map((w)=>w.includes(":")?w.split(":")[0]:w))]}function gz(D){let w={};return Object.keys(D).forEach((C)=>{if(C.includes(":"))w[C]=D[C];else Q0(D[C].accounts)?.forEach((X)=>{w[X]={accounts:D[C].accounts.filter((Y)=>Y.includes(`${X}:`)),methods:D[C].methods,events:D[C].events}})}),w}function HQ(D,w){return IC(D,!1)&&D<=w.max&&D>=w.min}function qC(){let D=s0();return new Promise((w)=>{switch(D){case gD.browser:w(uz());break;case gD.reactNative:w(kz());break;case gD.node:w(bz());break;default:w(!0)}})}function uz(){return k8()&&navigator?.onLine}async function kz(){if(o0()&&typeof global<"u"&&global!=null&&global.NetInfo)return(await(global==null?void 0:global.NetInfo.fetch()))?.isConnected;return!0}function bz(){return!0}function fQ(D){switch(s0()){case gD.browser:dz(D);break;case gD.reactNative:yz(D);break;case gD.node:break}}function dz(D){k8()&&(window.addEventListener("online",()=>D(!0)),window.addEventListener("offline",()=>D(!1)))}function yz(D){o0()&&typeof global<"u"&&global!=null&&global.NetInfo&&global?.NetInfo.addEventListener((w)=>D(w?.isConnected))}var BC={};class J0{static get(D){return BC[D]}static set(D,w){BC[D]=w}static delete(D){delete BC[D]}}var p=FD(_8(),1);s8();var pD={};DD(pD,{validateJsonRpcError:()=>LQ,payloadId:()=>W0,parseConnectionError:()=>X1,isWsUrl:()=>E3,isValidWildcardRoute:()=>X3,isValidTrailingWildcardRoute:()=>iQ,isValidRoute:()=>nQ,isValidLeadingWildcardRoute:()=>lQ,isValidErrorCode:()=>MC,isValidDefaultRoute:()=>$3,isServerErrorCode:()=>RQ,isReservedErrorCode:()=>D3,isNodeJs:()=>vQ,isLocalhostUrl:()=>K1,isJsonRpcValidationInvalid:()=>eQ,isJsonRpcResult:()=>yD,isJsonRpcResponse:()=>F8,isJsonRpcRequest:()=>d8,isJsonRpcPayload:()=>Q1,isJsonRpcError:()=>MD,isHttpUrl:()=>aQ,getErrorByCode:()=>C3,getError:()=>w3,getBigIntRpcId:()=>F0,formatJsonRpcResult:()=>b8,formatJsonRpcRequest:()=>C8,formatJsonRpcError:()=>M8,formatErrorMessage:()=>RC,STANDARD_ERROR_MAP:()=>W8,SERVER_ERROR_CODE_RANGE:()=>e0,SERVER_ERROR:()=>C1,RESERVED_ERROR_CODES:()=>$1,PARSE_ERROR:()=>UQ,METHOD_NOT_FOUND:()=>MQ,INVALID_REQUEST:()=>qQ,INVALID_PARAMS:()=>TQ,INTERNAL_ERROR:()=>w1,IJsonRpcProvider:()=>Y3,IJsonRpcConnection:()=>LC,IEvents:()=>G0,IBaseJsonRpcProvider:()=>E1,DEFAULT_ERROR:()=>N0});var SQ={};DD(SQ,{STANDARD_ERROR_MAP:()=>W8,SERVER_ERROR_CODE_RANGE:()=>e0,SERVER_ERROR:()=>C1,RESERVED_ERROR_CODES:()=>$1,PARSE_ERROR:()=>UQ,METHOD_NOT_FOUND:()=>MQ,INVALID_REQUEST:()=>qQ,INVALID_PARAMS:()=>TQ,INTERNAL_ERROR:()=>w1,DEFAULT_ERROR:()=>N0});var UQ="PARSE_ERROR",qQ="INVALID_REQUEST",MQ="METHOD_NOT_FOUND",TQ="INVALID_PARAMS",w1="INTERNAL_ERROR",C1="SERVER_ERROR",$1=[-32700,-32600,-32601,-32602,-32603],e0=[-32000,-32099],W8={["PARSE_ERROR"]:{code:-32700,message:"Parse error"},["INVALID_REQUEST"]:{code:-32600,message:"Invalid Request"},["METHOD_NOT_FOUND"]:{code:-32601,message:"Method not found"},["INVALID_PARAMS"]:{code:-32602,message:"Invalid params"},["INTERNAL_ERROR"]:{code:-32603,message:"Internal error"},["SERVER_ERROR"]:{code:-32000,message:"Server error"}},N0="SERVER_ERROR";var _Q={};DD(_Q,{validateJsonRpcError:()=>LQ,parseConnectionError:()=>X1,isValidErrorCode:()=>MC,isServerErrorCode:()=>RQ,isReservedErrorCode:()=>D3,getErrorByCode:()=>C3,getError:()=>w3});function RQ(D){return D<=e0[0]&&D>=e0[1]}function D3(D){return $1.includes(D)}function MC(D){return typeof D==="number"}function w3(D){if(!Object.keys(W8).includes(D))return W8[N0];return W8[D]}function C3(D){let w=Object.values(W8).find((C)=>C.code===D);if(!w)return W8[N0];return w}function LQ(D){if(typeof D.error.code==="undefined")return{valid:!1,error:"Missing code for JSON-RPC error"};if(typeof D.error.message==="undefined")return{valid:!1,error:"Missing message for JSON-RPC error"};if(!MC(D.error.code))return{valid:!1,error:`Invalid error code type for JSON-RPC: ${D.error.code}`};if(D3(D.error.code)){let w=C3(D.error.code);if(w.message!==W8[N0].message&&D.error.message===w.message)return{valid:!1,error:`Invalid error code message for JSON-RPC: ${D.error.code}`}}return{valid:!0}}function X1(D,w,C){return D.message.includes("getaddrinfo ENOTFOUND")||D.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${C} RPC url at ${w}`):D}var jD={};DD(jD,{isNodeJs:()=>vQ});var cQ=FD(SC(),1);dD(jD,FD(SC(),1));var vQ=cQ.isNode;dD(pD,jD);var pQ={};DD(pQ,{payloadId:()=>W0,getBigIntRpcId:()=>F0,formatJsonRpcResult:()=>b8,formatJsonRpcRequest:()=>C8,formatJsonRpcError:()=>M8,formatErrorMessage:()=>RC});function W0(D=3){let w=Date.now()*Math.pow(10,D),C=Math.floor(Math.random()*Math.pow(10,D));return w+C}function F0(D=6){return BigInt(W0(D))}function C8(D,w,C){return{id:C||W0(),jsonrpc:"2.0",method:D,params:w}}function b8(D,w){return{id:D,jsonrpc:"2.0",result:w}}function M8(D,w,C){return{id:D,jsonrpc:"2.0",error:RC(w,C)}}function RC(D,w){if(typeof D==="undefined")return w3(w1);if(typeof D==="string")D=Object.assign(Object.assign({},w3(C1)),{message:D});if(typeof w!=="undefined")D.data=w;if(D3(D.code))D=C3(D.code);return D}var rQ={};DD(rQ,{isValidWildcardRoute:()=>X3,isValidTrailingWildcardRoute:()=>iQ,isValidRoute:()=>nQ,isValidLeadingWildcardRoute:()=>lQ,isValidDefaultRoute:()=>$3});function nQ(D){if(D.includes("*"))return X3(D);if(/\W/g.test(D))return!1;return!0}function $3(D){return D==="*"}function X3(D){if($3(D))return!0;if(!D.includes("*"))return!1;if(D.split("*").length!==2)return!1;if(D.split("*").filter((w)=>w.trim()==="").length!==1)return!1;return!0}function lQ(D){return!$3(D)&&X3(D)&&!D.split("*")[0].trim()}function iQ(D){return!$3(D)&&X3(D)&&!D.split("*")[1].trim()}var oQ={};DD(oQ,{IJsonRpcProvider:()=>Y3,IJsonRpcConnection:()=>LC,IEvents:()=>G0,IBaseJsonRpcProvider:()=>E1});class G0{}class LC extends G0{constructor(D){super()}}class E1 extends G0{constructor(){super()}}class Y3 extends E1{constructor(D){super()}}var tQ={};DD(tQ,{isWsUrl:()=>E3,isLocalhostUrl:()=>K1,isHttpUrl:()=>aQ});function rz(D){let w=D.match(new RegExp(/^\w+:/,"gi"));if(!w||!w.length)return;return w[0]}function sQ(D,w){let C=rz(D);if(typeof C==="undefined")return!1;return new RegExp(w).test(C)}function aQ(D){return sQ(D,"^https?:")}function E3(D){return sQ(D,"^wss?:")}function K1(D){return new RegExp("wss?://localhost(:d{2,5})?").test(D)}var DZ={};DD(DZ,{isJsonRpcValidationInvalid:()=>eQ,isJsonRpcResult:()=>yD,isJsonRpcResponse:()=>F8,isJsonRpcRequest:()=>d8,isJsonRpcPayload:()=>Q1,isJsonRpcError:()=>MD});function Q1(D){return typeof D==="object"&&"id"in D&&"jsonrpc"in D&&D.jsonrpc==="2.0"}function d8(D){return Q1(D)&&"method"in D}function F8(D){return Q1(D)&&(yD(D)||MD(D))}function yD(D){return"result"in D}function MD(D){return"error"in D}function eQ(D){return"error"in D&&D.valid===!1}class _C extends Y3{constructor(D){super(D);if(this.events=new mD,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(D),this.connection.connected)this.registerEventListeners()}async connect(D=this.connection){await this.open(D)}async disconnect(){await this.close()}on(D,w){this.events.on(D,w)}once(D,w){this.events.once(D,w)}off(D,w){this.events.off(D,w)}removeListener(D,w){this.events.removeListener(D,w)}async request(D,w){return this.requestStrict(C8(D.method,D.params||[],D.id||F0().toString()),w)}async requestStrict(D,w){return new Promise(async(C,$)=>{if(!this.connection.connected)try{await this.open()}catch(X){$(X)}this.events.on(`${D.id}`,(X)=>{if(MD(X))$(X.error);else C(X.result)});try{await this.connection.send(D,w)}catch(X){$(X)}})}setConnection(D=this.connection){return D}onPayload(D){if(this.events.emit("payload",D),F8(D))this.events.emit(`${D.id}`,D);else this.events.emit("message",{type:D.method,data:D.params})}onClose(D){if(D&&D.code===3000)this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${D.code} ${D.reason?`(${D.reason})`:""}`));this.events.emit("disconnect")}async open(D=this.connection){if(this.connection===D&&this.connection.connected)return;if(this.connection.connected)this.close();if(typeof D==="string")await this.connection.open(D),D=this.connection;this.connection=this.setConnection(D),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect")}async close(){await this.connection.close()}registerEventListeners(){if(this.hasRegisteredEventListeners)return;this.connection.on("payload",(D)=>this.onPayload(D)),this.connection.on("close",(D)=>this.onClose(D)),this.connection.on("error",(D)=>this.events.emit("error",D)),this.connection.on("register_error",(D)=>this.onClose()),this.hasRegisteredEventListeners=!0}}s8();var $Z=()=>{if(typeof WebSocket!=="undefined")return WebSocket;else if(typeof global!=="undefined"&&typeof global.WebSocket!=="undefined")return global.WebSocket;else if(typeof window!=="undefined"&&typeof window.WebSocket!=="undefined")return window.WebSocket;else if(typeof self!=="undefined"&&typeof self.WebSocket!=="undefined")return self.WebSocket;return CZ()},XZ=()=>typeof WebSocket!=="undefined"||typeof global!=="undefined"&&typeof global.WebSocket!=="undefined"||typeof window!=="undefined"&&typeof window.WebSocket!=="undefined"||typeof self!=="undefined"&&typeof self.WebSocket!=="undefined";var jC=(D)=>D.split("?")[0];var YZ=10,oz=$Z();class EZ{constructor(D){if(this.url=D,this.events=new mD,this.registering=!1,!E3(D))throw new Error(`Provided URL is not compatible with WebSocket connection: ${D}`);this.url=D}get connected(){return typeof this.socket!=="undefined"}get connecting(){return this.registering}on(D,w){this.events.on(D,w)}once(D,w){this.events.once(D,w)}off(D,w){this.events.off(D,w)}removeListener(D,w){this.events.removeListener(D,w)}async open(D=this.url){await this.register(D)}async close(){return new Promise((D,w)=>{if(typeof this.socket==="undefined"){w(new Error("Connection already closed"));return}this.socket.onclose=(C)=>{this.onClose(C),D()},this.socket.close()})}async send(D,w){if(typeof this.socket==="undefined")this.socket=await this.register();try{this.socket.send(lD(D))}catch(C){this.onError(D.id,C)}}register(D=this.url){if(!E3(D))throw new Error(`Provided URL is not compatible with WebSocket connection: ${D}`);if(this.registering){let w=this.events.getMaxListeners();if(this.events.listenerCount("register_error")>=w||this.events.listenerCount("open")>=w)this.events.setMaxListeners(w+1);return new Promise((C,$)=>{this.events.once("register_error",(X)=>{this.resetMaxListeners(),$(X)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket==="undefined")return $(new Error("WebSocket connection is missing or invalid"));C(this.socket)})})}return this.url=D,this.registering=!0,new Promise((w,C)=>{let $=!pD.isReactNative()?{rejectUnauthorized:!K1(D)}:void 0,X=new oz(D,[],$);if(XZ())X.onerror=(Y)=>{let E=Y;C(this.emitError(E.error))};else X.on("error",(Y)=>{C(this.emitError(Y))});X.onopen=()=>{this.onOpen(X),w(X)}})}onOpen(D){D.onmessage=(w)=>this.onPayload(w),D.onclose=(w)=>this.onClose(w),this.socket=D,this.registering=!1,this.events.emit("open")}onClose(D){this.socket=void 0,this.registering=!1,this.events.emit("close",D)}onPayload(D){if(typeof D.data==="undefined")return;let w=typeof D.data==="string"?z8(D.data):D.data;this.events.emit("payload",w)}onError(D,w){let C=this.parseError(w),$=C.message||C.toString(),X=M8(D,$);this.events.emit("payload",X)}parseError(D,w=this.url){return X1(D,jC(w),"WS")}resetMaxListeners(){if(this.events.getMaxListeners()>YZ)this.events.setMaxListeners(YZ)}emitError(D){let w=this.parseError(new Error((D===null||D===void 0?void 0:D.message)||`WebSocket connection failed for host: ${jC(this.url)}`));return this.events.emit("register_error",w),w}}var KZ=EZ;var QZ=KZ;var ZB=FD(vZ(),1);function MI(D,w){if(D.length>=255)throw new TypeError("Alphabet too long");for(var C=new Uint8Array(256),$=0;$<C.length;$++)C[$]=255;for(var X=0;X<D.length;X++){var Y=D.charAt(X),E=Y.charCodeAt(0);if(C[E]!==255)throw new TypeError(Y+" is ambiguous");C[E]=X}var K=D.length,Q=D.charAt(0),Z=Math.log(K)/Math.log(256),B=Math.log(256)/Math.log(K);function J(N){if(N instanceof Uint8Array||(ArrayBuffer.isView(N)?N=new Uint8Array(N.buffer,N.byteOffset,N.byteLength):Array.isArray(N)&&(N=Uint8Array.from(N))),!(N instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(N.length===0)return"";for(var G=0,V=0,H=0,z=N.length;H!==z&&N[H]===0;)H++,G++;for(var O=(z-H)*B+1>>>0,A=new Uint8Array(O);H!==z;){for(var M=N[H],T=0,f=O-1;(M!==0||T<V)&&f!==-1;f--,T++)M+=256*A[f]>>>0,A[f]=M%K>>>0,M=M/K>>>0;if(M!==0)throw new Error("Non-zero carry");V=T,H++}for(var q=O-V;q!==O&&A[q]===0;)q++;for(var L=Q.repeat(G);q<O;++q)L+=D.charAt(A[q]);return L}function F(N){if(typeof N!="string")throw new TypeError("Expected String");if(N.length===0)return new Uint8Array;var G=0;if(N[G]!==" "){for(var V=0,H=0;N[G]===Q;)V++,G++;for(var z=(N.length-G)*Z+1>>>0,O=new Uint8Array(z);N[G];){var A=C[N.charCodeAt(G)];if(A===255)return;for(var M=0,T=z-1;(A!==0||M<H)&&T!==-1;T--,M++)A+=K*O[T]>>>0,O[T]=A%256>>>0,A=A/256>>>0;if(A!==0)throw new Error("Non-zero carry");H=M,G++}if(N[G]!==" "){for(var f=z-H;f!==z&&O[f]===0;)f++;for(var q=new Uint8Array(V+(z-f)),L=V;f!==z;)q[L++]=O[f++];return q}}}function W(N){var G=F(N);if(G)return G;throw new Error(`Non-${w} character`)}return{encode:J,decodeUnsafe:F,decode:W}}var TI=MI,SI=TI,BB=(D)=>{if(D instanceof Uint8Array&&D.constructor.name==="Uint8Array")return D;if(D instanceof ArrayBuffer)return new Uint8Array(D);if(ArrayBuffer.isView(D))return new Uint8Array(D.buffer,D.byteOffset,D.byteLength);throw new Error("Unknown type, must be binary type")},RI=(D)=>new TextEncoder().encode(D),LI=(D)=>new TextDecoder().decode(D);class JB{constructor(D,w,C){this.name=D,this.prefix=w,this.baseEncode=C}encode(D){if(D instanceof Uint8Array)return`${this.prefix}${this.baseEncode(D)}`;throw Error("Unknown type, must be binary type")}}class NB{constructor(D,w,C){if(this.name=D,this.prefix=w,w.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=w.codePointAt(0),this.baseDecode=C}decode(D){if(typeof D=="string"){if(D.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(D)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(D.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(D){return FB(this,D)}}class WB{constructor(D){this.decoders=D}or(D){return FB(this,D)}decode(D){let w=D[0],C=this.decoders[w];if(C)return C.decode(D);throw RangeError(`Unable to decode multibase string ${JSON.stringify(D)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}var FB=(D,w)=>new WB({...D.decoders||{[D.prefix]:D},...w.decoders||{[w.prefix]:w}});class GB{constructor(D,w,C,$){this.name=D,this.prefix=w,this.baseEncode=C,this.baseDecode=$,this.encoder=new JB(D,w,C),this.decoder=new NB(D,w,$)}encode(D){return this.encoder.encode(D)}decode(D){return this.decoder.decode(D)}}var I1=({name:D,prefix:w,encode:C,decode:$})=>new GB(D,w,C,$),F3=({prefix:D,name:w,alphabet:C})=>{let{encode:$,decode:X}=SI(C,w);return I1({prefix:D,name:w,encode:$,decode:(Y)=>BB(X(Y))})},_I=(D,w,C,$)=>{let X={};for(let B=0;B<w.length;++B)X[w[B]]=B;let Y=D.length;for(;D[Y-1]==="=";)--Y;let E=new Uint8Array(Y*C/8|0),K=0,Q=0,Z=0;for(let B=0;B<Y;++B){let J=X[D[B]];if(J===void 0)throw new SyntaxError(`Non-${$} character`);Q=Q<<C|J,K+=C,K>=8&&(K-=8,E[Z++]=255&Q>>K)}if(K>=C||255&Q<<8-K)throw new SyntaxError("Unexpected end of data");return E},jI=(D,w,C)=>{let $=w[w.length-1]==="=",X=(1<<C)-1,Y="",E=0,K=0;for(let Q=0;Q<D.length;++Q)for(K=K<<8|D[Q],E+=8;E>C;)E-=C,Y+=w[X&K>>E];if(E&&(Y+=w[X&K<<C-E]),$)for(;Y.length*C&7;)Y+="=";return Y},ID=({name:D,prefix:w,bitsPerChar:C,alphabet:$})=>I1({prefix:w,name:D,encode(X){return jI(X,$,C)},decode(X){return _I(X,$,C,D)}}),xI=I1({prefix:"\x00",name:"identity",encode:(D)=>LI(D),decode:(D)=>RI(D)}),mI=Object.freeze({__proto__:null,identity:xI}),hI=ID({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1}),gI=Object.freeze({__proto__:null,base2:hI}),uI=ID({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3}),kI=Object.freeze({__proto__:null,base8:uI}),bI=F3({prefix:"9",name:"base10",alphabet:"0123456789"}),dI=Object.freeze({__proto__:null,base10:bI}),yI=ID({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),cI=ID({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4}),vI=Object.freeze({__proto__:null,base16:yI,base16upper:cI}),pI=ID({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),nI=ID({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),lI=ID({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),iI=ID({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),rI=ID({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),oI=ID({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),sI=ID({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),aI=ID({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),tI=ID({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5}),eI=Object.freeze({__proto__:null,base32:pI,base32upper:nI,base32pad:lI,base32padupper:iI,base32hex:rI,base32hexupper:oI,base32hexpad:sI,base32hexpadupper:aI,base32z:tI}),DH=F3({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),wH=F3({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"}),CH=Object.freeze({__proto__:null,base36:DH,base36upper:wH}),$H=F3({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),XH=F3({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"}),YH=Object.freeze({__proto__:null,base58btc:$H,base58flickr:XH}),EH=ID({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),KH=ID({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),QH=ID({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),ZH=ID({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6}),BH=Object.freeze({__proto__:null,base64:EH,base64pad:KH,base64url:QH,base64urlpad:ZH}),OB=Array.from("\uD83D\uDE80\uD83E\uDE90☄\uD83D\uDEF0\uD83C\uDF0C\uD83C\uDF11\uD83C\uDF12\uD83C\uDF13\uD83C\uDF14\uD83C\uDF15\uD83C\uDF16\uD83C\uDF17\uD83C\uDF18\uD83C\uDF0D\uD83C\uDF0F\uD83C\uDF0E\uD83D\uDC09☀\uD83D\uDCBB\uD83D\uDDA5\uD83D\uDCBE\uD83D\uDCBF\uD83D\uDE02❤\uD83D\uDE0D\uD83E\uDD23\uD83D\uDE0A\uD83D\uDE4F\uD83D\uDC95\uD83D\uDE2D\uD83D\uDE18\uD83D\uDC4D\uD83D\uDE05\uD83D\uDC4F\uD83D\uDE01\uD83D\uDD25\uD83E\uDD70\uD83D\uDC94\uD83D\uDC96\uD83D\uDC99\uD83D\uDE22\uD83E\uDD14\uD83D\uDE06\uD83D\uDE44\uD83D\uDCAA\uD83D\uDE09☺\uD83D\uDC4C\uD83E\uDD17\uD83D\uDC9C\uD83D\uDE14\uD83D\uDE0E\uD83D\uDE07\uD83C\uDF39\uD83E\uDD26\uD83C\uDF89\uD83D\uDC9E✌✨\uD83E\uDD37\uD83D\uDE31\uD83D\uDE0C\uD83C\uDF38\uD83D\uDE4C\uD83D\uDE0B\uD83D\uDC97\uD83D\uDC9A\uD83D\uDE0F\uD83D\uDC9B\uD83D\uDE42\uD83D\uDC93\uD83E\uDD29\uD83D\uDE04\uD83D\uDE00\uD83D\uDDA4\uD83D\uDE03\uD83D\uDCAF\uD83D\uDE48\uD83D\uDC47\uD83C\uDFB6\uD83D\uDE12\uD83E\uDD2D❣\uD83D\uDE1C\uD83D\uDC8B\uD83D\uDC40\uD83D\uDE2A\uD83D\uDE11\uD83D\uDCA5\uD83D\uDE4B\uD83D\uDE1E\uD83D\uDE29\uD83D\uDE21\uD83E\uDD2A\uD83D\uDC4A\uD83E\uDD73\uD83D\uDE25\uD83E\uDD24\uD83D\uDC49\uD83D\uDC83\uD83D\uDE33✋\uD83D\uDE1A\uD83D\uDE1D\uD83D\uDE34\uD83C\uDF1F\uD83D\uDE2C\uD83D\uDE43\uD83C\uDF40\uD83C\uDF37\uD83D\uDE3B\uD83D\uDE13⭐✅\uD83E\uDD7A\uD83C\uDF08\uD83D\uDE08\uD83E\uDD18\uD83D\uDCA6✔\uD83D\uDE23\uD83C\uDFC3\uD83D\uDC90☹\uD83C\uDF8A\uD83D\uDC98\uD83D\uDE20☝\uD83D\uDE15\uD83C\uDF3A\uD83C\uDF82\uD83C\uDF3B\uD83D\uDE10\uD83D\uDD95\uD83D\uDC9D\uD83D\uDE4A\uD83D\uDE39\uD83D\uDDE3\uD83D\uDCAB\uD83D\uDC80\uD83D\uDC51\uD83C\uDFB5\uD83E\uDD1E\uD83D\uDE1B\uD83D\uDD34\uD83D\uDE24\uD83C\uDF3C\uD83D\uDE2B⚽\uD83E\uDD19☕\uD83C\uDFC6\uD83E\uDD2B\uD83D\uDC48\uD83D\uDE2E\uD83D\uDE46\uD83C\uDF7B\uD83C\uDF43\uD83D\uDC36\uD83D\uDC81\uD83D\uDE32\uD83C\uDF3F\uD83E\uDDE1\uD83C\uDF81⚡\uD83C\uDF1E\uD83C\uDF88❌✊\uD83D\uDC4B\uD83D\uDE30\uD83E\uDD28\uD83D\uDE36\uD83E\uDD1D\uD83D\uDEB6\uD83D\uDCB0\uD83C\uDF53\uD83D\uDCA2\uD83E\uDD1F\uD83D\uDE41\uD83D\uDEA8\uD83D\uDCA8\uD83E\uDD2C✈\uD83C\uDF80\uD83C\uDF7A\uD83E\uDD13\uD83D\uDE19\uD83D\uDC9F\uD83C\uDF31\uD83D\uDE16\uD83D\uDC76\uD83E\uDD74▶➡❓\uD83D\uDC8E\uD83D\uDCB8⬇\uD83D\uDE28\uD83C\uDF1A\uD83E\uDD8B\uD83D\uDE37\uD83D\uDD7A⚠\uD83D\uDE45\uD83D\uDE1F\uD83D\uDE35\uD83D\uDC4E\uD83E\uDD32\uD83E\uDD20\uD83E\uDD27\uD83D\uDCCC\uD83D\uDD35\uD83D\uDC85\uD83E\uDDD0\uD83D\uDC3E\uD83C\uDF52\uD83D\uDE17\uD83E\uDD11\uD83C\uDF0A\uD83E\uDD2F\uD83D\uDC37☎\uD83D\uDCA7\uD83D\uDE2F\uD83D\uDC86\uD83D\uDC46\uD83C\uDFA4\uD83D\uDE47\uD83C\uDF51❄\uD83C\uDF34\uD83D\uDCA3\uD83D\uDC38\uD83D\uDC8C\uD83D\uDCCD\uD83E\uDD40\uD83E\uDD22\uD83D\uDC45\uD83D\uDCA1\uD83D\uDCA9\uD83D\uDC50\uD83D\uDCF8\uD83D\uDC7B\uD83E\uDD10\uD83E\uDD2E\uD83C\uDFBC\uD83E\uDD75\uD83D\uDEA9\uD83C\uDF4E\uD83C\uDF4A\uD83D\uDC7C\uD83D\uDC8D\uD83D\uDCE3\uD83E\uDD42"),JH=OB.reduce((D,w,C)=>(D[C]=w,D),[]),NH=OB.reduce((D,w,C)=>(D[w.codePointAt(0)]=C,D),[]);function WH(D){return D.reduce((w,C)=>(w+=JH[C],w),"")}function FH(D){let w=[];for(let C of D){let $=NH[C.codePointAt(0)];if($===void 0)throw new Error(`Non-base256emoji character: ${C}`);w.push($)}return new Uint8Array(w)}var GH=I1({prefix:"\uD83D\uDE80",name:"base256emoji",encode:WH,decode:FH}),OH=Object.freeze({__proto__:null,base256emoji:GH}),PH=PB,pZ=128,VH=127,zH=~VH,AH=Math.pow(2,31);function PB(D,w,C){w=w||[],C=C||0;for(var $=C;D>=AH;)w[C++]=D&255|pZ,D/=128;for(;D&zH;)w[C++]=D&255|pZ,D>>>=7;return w[C]=D|0,PB.bytes=C-$+1,w}var IH=iC,HH=128,nZ=127;function iC(D,$){var C=0,$=$||0,X=0,Y=$,E,K=D.length;do{if(Y>=K)throw iC.bytes=0,new RangeError("Could not decode varint");E=D[Y++],C+=X<28?(E&nZ)<<X:(E&nZ)*Math.pow(2,X),X+=7}while(E>=HH);return iC.bytes=Y-$,C}var fH=Math.pow(2,7),UH=Math.pow(2,14),qH=Math.pow(2,21),MH=Math.pow(2,28),TH=Math.pow(2,35),SH=Math.pow(2,42),RH=Math.pow(2,49),LH=Math.pow(2,56),_H=Math.pow(2,63),jH=function(D){return D<fH?1:D<UH?2:D<qH?3:D<MH?4:D<TH?5:D<SH?6:D<RH?7:D<LH?8:D<_H?9:10},xH={encode:PH,decode:IH,encodingLength:jH},VB=xH,lZ=(D,w,C=0)=>(VB.encode(D,w,C),w),iZ=(D)=>VB.encodingLength(D),rC=(D,w)=>{let C=w.byteLength,$=iZ(D),X=$+iZ(C),Y=new Uint8Array(X+C);return lZ(D,Y,0),lZ(C,Y,$),Y.set(w,X),new zB(D,C,w,Y)};class zB{constructor(D,w,C,$){this.code=D,this.size=w,this.digest=C,this.bytes=$}}var AB=({name:D,code:w,encode:C})=>new IB(D,w,C);class IB{constructor(D,w,C){this.name=D,this.code=w,this.encode=C}digest(D){if(D instanceof Uint8Array){let w=this.encode(D);return w instanceof Uint8Array?rC(this.code,w):w.then((C)=>rC(this.code,C))}else throw Error("Unknown type, must be binary type")}}var HB=(D)=>async(w)=>new Uint8Array(await crypto.subtle.digest(D,w)),mH=AB({name:"sha2-256",code:18,encode:HB("SHA-256")}),hH=AB({name:"sha2-512",code:19,encode:HB("SHA-512")}),gH=Object.freeze({__proto__:null,sha256:mH,sha512:hH}),fB=0,uH="identity",UB=BB,kH=(D)=>rC(fB,UB(D)),bH={code:fB,name:uH,encode:UB,digest:kH},dH=Object.freeze({__proto__:null,identity:bH});var rZ={...mI,...gI,...kI,...dI,...vI,...eI,...CH,...YH,...BH,...OH};({...gH,...dH});function qB(D){return globalThis.Buffer!=null?new Uint8Array(D.buffer,D.byteOffset,D.byteLength):D}function yH(D=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?qB(globalThis.Buffer.allocUnsafe(D)):new Uint8Array(D)}function MB(D,w,C,$){return{name:D,prefix:w,encoder:{name:D,prefix:w,encode:C},decoder:{decode:$}}}var oZ=MB("utf8","u",(D)=>"u"+new TextDecoder("utf8").decode(D),(D)=>new TextEncoder().encode(D.substring(1))),pC=MB("ascii","a",(D)=>{let w="a";for(let C=0;C<D.length;C++)w+=String.fromCharCode(D[C]);return w},(D)=>{D=D.substring(1);let w=yH(D.length);for(let C=0;C<D.length;C++)w[C]=D.charCodeAt(C);return w}),cH={utf8:oZ,"utf-8":oZ,hex:rZ.base16,latin1:pC,ascii:pC,binary:pC,...rZ};function vH(D,w="utf8"){let C=cH[w];if(!C)throw new Error(`Unsupported encoding "${w}"`);return(w==="utf8"||w==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?qB(globalThis.Buffer.from(D,"utf-8")):C.decoder.decode(`${C.prefix}${D}`)}var TB="wc",pH=2,oC="core",R8=`${TB}@2:${oC}:`,nH={name:oC,logger:"error"},lH={database:":memory:"},iH="crypto",sZ="client_ed25519_seed",rH=p.ONE_DAY,oH="keychain",sH="0.3",aH="messages",tH="0.3",eH=p.SIX_HOURS,D6="publisher",sC="irn",w6="error",SB="wss://relay.walletconnect.com",aZ="wss://relay.walletconnect.org",C6="relayer",AD={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},$6="_subscription",P8={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},X6=p.ONE_SECOND;var Y6="2.10.0",E6=1e4,K6="0.3",Q6="WALLETCONNECT_CLIENT_ID",Y8={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"};var Z6="subscription",B6="0.3",J6=p.FIVE_SECONDS*1000,N6="pairing",W6="0.3";var J3={wc_pairingDelete:{req:{ttl:p.ONE_DAY,prompt:!1,tag:1000},res:{ttl:p.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:p.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:p.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:p.ONE_DAY,prompt:!1,tag:0},res:{ttl:p.ONE_DAY,prompt:!1,tag:0}}},X8={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},F6="history",G6="0.3",O6="expirer",cD={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},P6="0.3";var nC="verify-api",W3="https://verify.walletconnect.com",tZ="https://verify.walletconnect.org";class RB{constructor(D,w){this.core=D,this.logger=w,this.keychain=new Map,this.name=oH,this.version=sH,this.initialized=!1,this.storagePrefix=R8,this.init=async()=>{if(!this.initialized){let C=await this.getKeyChain();typeof C<"u"&&(this.keychain=C),this.initialized=!0}},this.has=(C)=>(this.isInitialized(),this.keychain.has(C)),this.set=async(C,$)=>{this.isInitialized(),this.keychain.set(C,$),await this.persist()},this.get=(C)=>{this.isInitialized();let $=this.keychain.get(C);if(typeof $>"u"){let{message:X}=R("NO_MATCHING_KEY",`${this.name}: ${C}`);throw new Error(X)}return $},this.del=async(C)=>{this.isInitialized(),this.keychain.delete(C),await this.persist()},this.core=D,this.logger=LD(w,this.name)}get context(){return HD(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setKeyChain(D){await this.core.storage.setItem(this.storageKey,zC(D))}async getKeyChain(){let D=await this.core.storage.getItem(this.storageKey);return typeof D<"u"?AC(D):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){let{message:D}=R("NOT_INITIALIZED",this.name);throw new Error(D)}}}class LB{constructor(D,w,C){this.core=D,this.logger=w,this.name=iH,this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=($)=>(this.isInitialized(),this.keychain.has($)),this.getClientId=async()=>{this.isInitialized();let $=await this.getClientSeed(),X=jw($);return _w(X.publicKey)},this.generateKeyPair=()=>{this.isInitialized();let $=lK();return this.setPrivateKey($.publicKey,$.privateKey)},this.signJWT=async($)=>{this.isInitialized();let X=await this.getClientSeed(),Y=jw(X),E=a3();return await MY(E,$,rH,Y)},this.generateSharedKey=($,X,Y)=>{this.isInitialized();let E=this.getPrivateKey($),K=iK(E,X);return this.setSymKey(K,Y)},this.setSymKey=async($,X)=>{this.isInitialized();let Y=X||rK($);return await this.keychain.set(Y,$),Y},this.deleteKeyPair=async($)=>{this.isInitialized(),await this.keychain.del($)},this.deleteSymKey=async($)=>{this.isInitialized(),await this.keychain.del($)},this.encode=async($,X,Y)=>{this.isInitialized();let E=PC(Y),K=lD(X);if(VC(E)){let{senderPublicKey:J,receiverPublicKey:F}=E;$=await this.generateSharedKey(J,F)}let Q=this.getSymKey($),{type:Z,senderPublicKey:B}=E;return oK({type:Z,symKey:Q,message:K,senderPublicKey:B})},this.decode=async($,X,Y)=>{this.isInitialized();let E=aK(X,Y);if(VC(E)){let{receiverPublicKey:K,senderPublicKey:Q}=E;$=await this.generateSharedKey(K,Q)}try{let K=this.getSymKey($),Q=sK({symKey:K,encoded:X});return z8(Q)}catch(K){this.logger.error(`Failed to decode message from topic: '${$}', clientId: '${await this.getClientId()}'`),this.logger.error(K)}},this.getPayloadType=($)=>{let X=r0($);return E0(X.type)},this.getPayloadSenderPublicKey=($)=>{let X=r0($);return X.senderPublicKey?_D(X.senderPublicKey,UD):void 0},this.core=D,this.logger=LD(w,this.name),this.keychain=C||new RB(this.core,this.logger)}get context(){return HD(this.logger)}async setPrivateKey(D,w){return await this.keychain.set(D,w),D}getPrivateKey(D){return this.keychain.get(D)}async getClientSeed(){let D="";try{D=this.keychain.get(sZ)}catch{D=a3(),await this.keychain.set(sZ,D)}return vH(D,"base16")}getSymKey(D){return this.keychain.get(D)}isInitialized(){if(!this.initialized){let{message:D}=R("NOT_INITIALIZED",this.name);throw new Error(D)}}}class _B extends Dw{constructor(D,w){super(D,w),this.logger=D,this.core=w,this.messages=new Map,this.name=aH,this.version=tH,this.initialized=!1,this.storagePrefix=R8,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{let C=await this.getRelayerMessages();typeof C<"u"&&(this.messages=C),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(C){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(C)}finally{this.initialized=!0}}},this.set=async(C,$)=>{this.isInitialized();let X=U8($),Y=this.messages.get(C);return typeof Y>"u"&&(Y={}),typeof Y[X]<"u"||(Y[X]=$,this.messages.set(C,Y),await this.persist()),X},this.get=(C)=>{this.isInitialized();let $=this.messages.get(C);return typeof $>"u"&&($={}),$},this.has=(C,$)=>{this.isInitialized();let X=this.get(C),Y=U8($);return typeof X[Y]<"u"},this.del=async(C)=>{this.isInitialized(),this.messages.delete(C),await this.persist()},this.logger=LD(D,this.name),this.core=w}get context(){return HD(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setRelayerMessages(D){await this.core.storage.setItem(this.storageKey,zC(D))}async getRelayerMessages(){let D=await this.core.storage.getItem(this.storageKey);return typeof D<"u"?AC(D):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){let{message:D}=R("NOT_INITIALIZED",this.name);throw new Error(D)}}}class jB extends ww{constructor(D,w){super(D,w),this.relayer=D,this.logger=w,this.events=new mD,this.name=D6,this.queue=new Map,this.publishTimeout=p.toMiliseconds(p.TEN_SECONDS),this.needsTransportRestart=!1,this.publish=async(C,$,X)=>{var Y;this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:C,message:$,opts:X}});try{let E=X?.ttl||eH,K=D1(X),Q=X?.prompt||!1,Z=X?.tag||0,B=X?.id||F0().toString(),J={topic:C,message:$,opts:{ttl:E,relay:K,prompt:Q,tag:Z,id:B}},F=setTimeout(()=>this.queue.set(B,J),this.publishTimeout);try{await await K0(this.rpcPublish(C,$,E,K,Q,Z,B),this.publishTimeout,"Failed to publish payload, please try again."),this.removeRequestFromQueue(B),this.relayer.events.emit(AD.publish,J)}catch(W){if(this.logger.debug("Publishing Payload stalled"),this.needsTransportRestart=!0,(Y=X?.internal)!=null&&Y.throwOnFailedPublish)throw this.removeRequestFromQueue(B),W;return}finally{clearTimeout(F)}this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:C,message:$,opts:X}})}catch(E){throw this.logger.debug("Failed to Publish Payload"),this.logger.error(E),E}},this.on=(C,$)=>{this.events.on(C,$)},this.once=(C,$)=>{this.events.once(C,$)},this.off=(C,$)=>{this.events.off(C,$)},this.removeListener=(C,$)=>{this.events.removeListener(C,$)},this.relayer=D,this.logger=LD(w,this.name),this.registerEventListeners()}get context(){return HD(this.logger)}rpcPublish(D,w,C,$,X,Y,E){var K,Q,Z,B;let J={method:a0($.protocol).publish,params:{topic:D,message:w,ttl:C,prompt:X,tag:Y},id:E};return zD((K=J.params)==null?void 0:K.prompt)&&((Q=J.params)==null||delete Q.prompt),zD((Z=J.params)==null?void 0:Z.tag)&&((B=J.params)==null||delete B.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:J}),this.relayer.request(J)}removeRequestFromQueue(D){this.queue.delete(D)}checkQueue(){this.queue.forEach(async(D)=>{let{topic:w,message:C,opts:$}=D;await this.publish(w,C,$)})}registerEventListeners(){this.relayer.core.heartbeat.on(n8.HEARTBEAT_EVENTS.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(AD.connection_stalled);return}this.checkQueue()}),this.relayer.on(AD.message_ack,(D)=>{this.removeRequestFromQueue(D.id.toString())})}}class xB{constructor(){this.map=new Map,this.set=(D,w)=>{let C=this.get(D);this.exists(D,w)||this.map.set(D,[...C,w])},this.get=(D)=>this.map.get(D)||[],this.exists=(D,w)=>this.get(D).includes(w),this.delete=(D,w)=>{if(typeof w>"u"){this.map.delete(D);return}if(!this.map.has(D))return;let C=this.get(D);if(!this.exists(D,w))return;let $=C.filter((X)=>X!==w);if(!$.length){this.map.delete(D);return}this.map.set(D,$)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}}var{defineProperty:V6,defineProperties:z6,getOwnPropertyDescriptors:A6,getOwnPropertySymbols:eZ}=Object,I6=Object.prototype.hasOwnProperty,H6=Object.prototype.propertyIsEnumerable,DB=(D,w,C)=>(w in D)?V6(D,w,{enumerable:!0,configurable:!0,writable:!0,value:C}):D[w]=C,N3=(D,w)=>{for(var C in w||(w={}))I6.call(w,C)&&DB(D,C,w[C]);if(eZ)for(var C of eZ(w))H6.call(w,C)&&DB(D,C,w[C]);return D},lC=(D,w)=>z6(D,A6(w));class mB extends Xw{constructor(D,w){super(D,w),this.relayer=D,this.logger=w,this.subscriptions=new Map,this.topicMap=new xB,this.events=new mD,this.name=Z6,this.version=B6,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pollingInterval=20,this.storagePrefix=R8,this.subscribeTimeout=1e4,this.restartInProgress=!1,this.batchSubscribeTopicsLimit=500,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),this.registerEventListeners(),this.clientId=await this.relayer.core.crypto.getClientId())},this.subscribe=async(C,$)=>{await this.restartToComplete(),this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:C,opts:$}});try{let X=D1($),Y={topic:C,relay:X};this.pending.set(C,Y);let E=await this.rpcSubscribe(C,X);return this.onSubscribe(E,Y),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:C,opts:$}}),E}catch(X){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(X),X}},this.unsubscribe=async(C,$)=>{await this.restartToComplete(),this.isInitialized(),typeof $?.id<"u"?await this.unsubscribeById(C,$.id,$):await this.unsubscribeByTopic(C,$)},this.isSubscribed=async(C)=>this.topics.includes(C)?!0:await new Promise(($,X)=>{let Y=new p.Watch;Y.start(this.pendingSubscriptionWatchLabel);let E=setInterval(()=>{!this.pending.has(C)&&this.topics.includes(C)&&(clearInterval(E),Y.stop(this.pendingSubscriptionWatchLabel),$(!0)),Y.elapsed(this.pendingSubscriptionWatchLabel)>=J6&&(clearInterval(E),Y.stop(this.pendingSubscriptionWatchLabel),X(new Error("Subscription resolution timeout")))},this.pollingInterval)}).catch(()=>!1),this.on=(C,$)=>{this.events.on(C,$)},this.once=(C,$)=>{this.events.once(C,$)},this.off=(C,$)=>{this.events.off(C,$)},this.removeListener=(C,$)=>{this.events.removeListener(C,$)},this.restart=async()=>{this.restartInProgress=!0,await this.restore(),await this.reset(),this.restartInProgress=!1},this.relayer=D,this.logger=LD(w,this.name),this.clientId=""}get context(){return HD(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(D,w){let C=!1;try{C=this.getSubscription(D).topic===w}catch{}return C}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(D,w){let C=this.topicMap.get(D);await Promise.all(C.map(async($)=>await this.unsubscribeById(D,$,w)))}async unsubscribeById(D,w,C){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:D,id:w,opts:C}});try{let $=D1(C);await this.rpcUnsubscribe(D,w,$);let X=ED("USER_DISCONNECTED",`${this.name}, ${D}`);await this.onUnsubscribe(D,w,X),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:D,id:w,opts:C}})}catch($){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error($),$}}async rpcSubscribe(D,w){let C={method:a0(w.protocol).subscribe,params:{topic:D}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:C});try{await await K0(this.relayer.request(C),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(AD.connection_stalled)}return U8(D+this.clientId)}async rpcBatchSubscribe(D){if(!D.length)return;let w=D[0].relay,C={method:a0(w.protocol).batchSubscribe,params:{topics:D.map(($)=>$.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:C});try{return await await K0(this.relayer.request(C),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Payload stalled"),this.relayer.events.emit(AD.connection_stalled)}}rpcUnsubscribe(D,w,C){let $={method:a0(C.protocol).unsubscribe,params:{topic:D,id:w}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:$}),this.relayer.request($)}onSubscribe(D,w){this.setSubscription(D,lC(N3({},w),{id:D})),this.pending.delete(w.topic)}onBatchSubscribe(D){D.length&&D.forEach((w)=>{this.setSubscription(w.id,N3({},w)),this.pending.delete(w.topic)})}async onUnsubscribe(D,w,C){this.events.removeAllListeners(w),this.hasSubscription(w,D)&&this.deleteSubscription(w,C),await this.relayer.messages.del(D)}async setRelayerSubscriptions(D){await this.relayer.core.storage.setItem(this.storageKey,D)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(D,w){this.subscriptions.has(D)||(this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:D,subscription:w}),this.addSubscription(D,w))}addSubscription(D,w){this.subscriptions.set(D,N3({},w)),this.topicMap.set(w.topic,D),this.events.emit(Y8.created,w)}getSubscription(D){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:D});let w=this.subscriptions.get(D);if(!w){let{message:C}=R("NO_MATCHING_KEY",`${this.name}: ${D}`);throw new Error(C)}return w}deleteSubscription(D,w){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:D,reason:w});let C=this.getSubscription(D);this.subscriptions.delete(D),this.topicMap.delete(C.topic,D),this.events.emit(Y8.deleted,lC(N3({},C),{reason:w}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(Y8.sync)}async reset(){if(this.cached.length){let D=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let w=0;w<D;w++){let C=this.cached.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(C)}}this.events.emit(Y8.resubscribed)}async restore(){try{let D=await this.getRelayerSubscriptions();if(typeof D>"u"||!D.length)return;if(this.subscriptions.size){let{message:w}=R("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(w),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(w)}this.cached=D,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(D){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(D)}}async batchSubscribe(D){if(!D.length)return;let w=await this.rpcBatchSubscribe(D);Z0(w)&&this.onBatchSubscribe(w.map((C,$)=>lC(N3({},D[$]),{id:C})))}async onConnect(){this.restartInProgress||(await this.restart(),this.onEnable())}onDisconnect(){this.onDisable()}async checkPending(){if(!this.initialized||this.relayer.transportExplicitlyClosed)return;let D=[];this.pending.forEach((w)=>{D.push(w)}),await this.batchSubscribe(D)}registerEventListeners(){this.relayer.core.heartbeat.on(n8.HEARTBEAT_EVENTS.pulse,async()=>{await this.checkPending()}),this.relayer.on(AD.connect,async()=>{await this.onConnect()}),this.relayer.on(AD.disconnect,()=>{this.onDisconnect()}),this.events.on(Y8.created,async(D)=>{let w=Y8.created;this.logger.info(`Emitting ${w}`),this.logger.debug({type:"event",event:w,data:D}),await this.persist()}),this.events.on(Y8.deleted,async(D)=>{let w=Y8.deleted;this.logger.info(`Emitting ${w}`),this.logger.debug({type:"event",event:w,data:D}),await this.persist()})}isInitialized(){if(!this.initialized){let{message:D}=R("NOT_INITIALIZED",this.name);throw new Error(D)}}async restartToComplete(){this.restartInProgress&&await new Promise((D)=>{let w=setInterval(()=>{this.restartInProgress||(clearInterval(w),D())},this.pollingInterval)})}}var{defineProperty:f6,getOwnPropertySymbols:wB}=Object,U6=Object.prototype.hasOwnProperty,q6=Object.prototype.propertyIsEnumerable,CB=(D,w,C)=>(w in D)?f6(D,w,{enumerable:!0,configurable:!0,writable:!0,value:C}):D[w]=C,M6=(D,w)=>{for(var C in w||(w={}))U6.call(w,C)&&CB(D,C,w[C]);if(wB)for(var C of wB(w))q6.call(w,C)&&CB(D,C,w[C]);return D};class hB extends Cw{constructor(D){super(D),this.protocol="wc",this.version=2,this.events=new mD,this.name=C6,this.transportExplicitlyClosed=!1,this.initialized=!1,this.connectionAttemptInProgress=!1,this.connectionStatusPollingInterval=20,this.staleConnectionErrors=["socket hang up","socket stalled"],this.hasExperiencedNetworkDisruption=!1,this.request=async(w)=>{this.logger.debug("Publishing Request Payload");try{return await this.toEstablishConnection(),await this.provider.request(w)}catch(C){throw this.logger.debug("Failed to Publish Request"),this.logger.error(C),C}},this.onPayloadHandler=(w)=>{this.onProviderPayload(w)},this.onConnectHandler=()=>{this.events.emit(AD.connect)},this.onDisconnectHandler=()=>{this.onProviderDisconnect()},this.onProviderErrorHandler=(w)=>{this.logger.error(w),this.events.emit(AD.error,w)},this.registerProviderListeners=()=>{this.provider.on(P8.payload,this.onPayloadHandler),this.provider.on(P8.connect,this.onConnectHandler),this.provider.on(P8.disconnect,this.onDisconnectHandler),this.provider.on(P8.error,this.onProviderErrorHandler)},this.core=D.core,this.logger=typeof D.logger<"u"&&typeof D.logger!="string"?LD(D.logger,this.name):e8.default(j0({level:D.logger||w6})),this.messages=new _B(this.logger,D.core),this.subscriber=new mB(this,this.logger),this.publisher=new jB(this,this.logger),this.relayUrl=D?.relayUrl||SB,this.projectId=D.projectId,this.provider={}}async init(){this.logger.trace("Initialized"),this.registerEventListeners(),await this.createProvider(),await Promise.all([this.messages.init(),this.subscriber.init()]);try{await this.transportOpen()}catch{this.logger.warn(`Connection via ${this.relayUrl} failed, attempting to connect via failover domain ${aZ}...`),await this.restartTransport(aZ)}this.initialized=!0,setTimeout(async()=>{this.subscriber.topics.length===0&&(this.logger.info("No topics subscribed to after init, closing transport"),await this.transportClose(),this.transportExplicitlyClosed=!1)},E6)}get context(){return HD(this.logger)}get connected(){return this.provider.connection.connected}get connecting(){return this.provider.connection.connecting}async publish(D,w,C){this.isInitialized(),await this.publisher.publish(D,w,C),await this.recordMessageEvent({topic:D,message:w,publishedAt:Date.now()})}async subscribe(D,w){var C;this.isInitialized();let $=((C=this.subscriber.topicMap.get(D))==null?void 0:C[0])||"";return $||(await Promise.all([new Promise((X)=>{this.subscriber.once(Y8.created,(Y)=>{Y.topic===D&&X()})}),new Promise(async(X)=>{$=await this.subscriber.subscribe(D,w),X()})]),$)}async unsubscribe(D,w){this.isInitialized(),await this.subscriber.unsubscribe(D,w)}on(D,w){this.events.on(D,w)}once(D,w){this.events.once(D,w)}off(D,w){this.events.off(D,w)}removeListener(D,w){this.events.removeListener(D,w)}async transportClose(){this.transportExplicitlyClosed=!0,this.hasExperiencedNetworkDisruption&&this.connected?await K0(this.provider.disconnect(),1000,"provider.disconnect()").catch(()=>this.onProviderDisconnect()):this.connected&&await this.provider.disconnect()}async transportOpen(D){if(this.transportExplicitlyClosed=!1,await this.confirmOnlineStateOrThrow(),!this.connectionAttemptInProgress){D&&D!==this.relayUrl&&(this.relayUrl=D,await this.transportClose(),await this.createProvider()),this.connectionAttemptInProgress=!0;try{await Promise.all([new Promise((w)=>{if(!this.initialized)return w();this.subscriber.once(Y8.resubscribed,()=>{w()})}),new Promise(async(w,C)=>{try{await K0(this.provider.connect(),1e4,`Socket stalled when trying to connect to ${this.relayUrl}`)}catch($){C($);return}w()})])}catch(w){this.logger.error(w);let C=w;if(!this.isConnectionStalled(C.message))throw w;this.provider.events.emit(P8.disconnect)}finally{this.connectionAttemptInProgress=!1,this.hasExperiencedNetworkDisruption=!1}}}async restartTransport(D){await this.confirmOnlineStateOrThrow(),!this.connectionAttemptInProgress&&(this.relayUrl=D||this.relayUrl,await this.transportClose(),await this.createProvider(),await this.transportOpen())}async confirmOnlineStateOrThrow(){if(!await qC())throw new Error("No internet connection detected. Please restart your network and try again.")}isConnectionStalled(D){return this.staleConnectionErrors.some((w)=>D.includes(w))}async createProvider(){this.provider.connection&&this.unregisterProviderListeners();let D=await this.core.crypto.signJWT(this.relayUrl);this.provider=new _C(new QZ(eK({sdkVersion:Y6,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:D,useOnCloseEvent:!0}))),this.registerProviderListeners()}async recordMessageEvent(D){let{topic:w,message:C}=D;await this.messages.set(w,C)}async shouldIgnoreMessageEvent(D){let{topic:w,message:C}=D;if(!C||C.length===0)return this.logger.debug(`Ignoring invalid/empty message: ${C}`),!0;if(!await this.subscriber.isSubscribed(w))return this.logger.debug(`Ignoring message for non-subscribed topic ${w}`),!0;let $=this.messages.has(w,C);return $&&this.logger.debug(`Ignoring duplicate message: ${C}`),$}async onProviderPayload(D){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:D}),d8(D)){if(!D.method.endsWith($6))return;let w=D.params,{topic:C,message:$,publishedAt:X}=w.data,Y={topic:C,message:$,publishedAt:X};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(M6({type:"event",event:w.id},Y)),this.events.emit(w.id,Y),await this.acknowledgePayload(D),await this.onMessageEvent(Y)}else F8(D)&&this.events.emit(AD.message_ack,D)}async onMessageEvent(D){await this.shouldIgnoreMessageEvent(D)||(this.events.emit(AD.message,D),await this.recordMessageEvent(D))}async acknowledgePayload(D){let w=b8(D.id,!0);await this.provider.connection.send(w)}unregisterProviderListeners(){this.provider.off(P8.payload,this.onPayloadHandler),this.provider.off(P8.connect,this.onConnectHandler),this.provider.off(P8.disconnect,this.onDisconnectHandler),this.provider.off(P8.error,this.onProviderErrorHandler)}async registerEventListeners(){this.events.on(AD.connection_stalled,()=>{this.restartTransport().catch((w)=>this.logger.error(w))});let D=await qC();fQ(async(w)=>{this.initialized&&D!==w&&(D=w,w?await this.restartTransport().catch((C)=>this.logger.error(C)):(this.hasExperiencedNetworkDisruption=!0,await this.transportClose().catch((C)=>this.logger.error(C))))})}onProviderDisconnect(){this.events.emit(AD.disconnect),this.attemptToReconnect()}attemptToReconnect(){this.transportExplicitlyClosed||(this.logger.info("attemptToReconnect called. Connecting..."),setTimeout(async()=>{await this.restartTransport().catch((D)=>this.logger.error(D))},p.toMiliseconds(X6)))}isInitialized(){if(!this.initialized){let{message:D}=R("NOT_INITIALIZED",this.name);throw new Error(D)}}async toEstablishConnection(){if(await this.confirmOnlineStateOrThrow(),!this.connected){if(this.connectionAttemptInProgress)return await new Promise((D)=>{let w=setInterval(()=>{this.connected&&(clearInterval(w),D())},this.connectionStatusPollingInterval)});await this.restartTransport()}}}var{defineProperty:T6,getOwnPropertySymbols:$B}=Object,S6=Object.prototype.hasOwnProperty,R6=Object.prototype.propertyIsEnumerable,XB=(D,w,C)=>(w in D)?T6(D,w,{enumerable:!0,configurable:!0,writable:!0,value:C}):D[w]=C,YB=(D,w)=>{for(var C in w||(w={}))S6.call(w,C)&&XB(D,C,w[C]);if($B)for(var C of $B(w))R6.call(w,C)&&XB(D,C,w[C]);return D};class z0 extends $w{constructor(D,w,C,$=R8,X=void 0){super(D,w,C,$),this.core=D,this.logger=w,this.name=C,this.map=new Map,this.version=K6,this.cached=[],this.initialized=!1,this.storagePrefix=R8,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach((Y)=>{this.getKey&&Y!==null&&!zD(Y)?this.map.set(this.getKey(Y),Y):ZQ(Y)?this.map.set(Y.id,Y):BQ(Y)&&this.map.set(Y.topic,Y)}),this.cached=[],this.initialized=!0)},this.set=async(Y,E)=>{this.isInitialized(),this.map.has(Y)?await this.update(Y,E):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:Y,value:E}),this.map.set(Y,E),await this.persist())},this.get=(Y)=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:Y}),this.getData(Y)),this.getAll=(Y)=>(this.isInitialized(),Y?this.values.filter((E)=>Object.keys(Y).every((K)=>ZB.default(E[K],Y[K]))):this.values),this.update=async(Y,E)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:Y,update:E});let K=YB(YB({},this.getData(Y)),E);this.map.set(Y,K),await this.persist()},this.delete=async(Y,E)=>{this.isInitialized(),this.map.has(Y)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:Y,reason:E}),this.map.delete(Y),await this.persist())},this.logger=LD(w,this.name),this.storagePrefix=$,this.getKey=X}get context(){return HD(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}async setDataStore(D){await this.core.storage.setItem(this.storageKey,D)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(D){let w=this.map.get(D);if(!w){let{message:C}=R("NO_MATCHING_KEY",`${this.name}: ${D}`);throw this.logger.error(C),new Error(C)}return w}async persist(){await this.setDataStore(this.values)}async restore(){try{let D=await this.getDataStore();if(typeof D>"u"||!D.length)return;if(this.map.size){let{message:w}=R("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(w),new Error(w)}this.cached=D,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(D){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(D)}}isInitialized(){if(!this.initialized){let{message:D}=R("NOT_INITIALIZED",this.name);throw new Error(D)}}}class gB{constructor(D,w){this.core=D,this.logger=w,this.name=N6,this.version=W6,this.events=new x0,this.initialized=!1,this.storagePrefix=R8,this.ignoredPayloadTypes=[N8],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:C})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...C])]},this.create=async()=>{this.isInitialized();let C=a3(),$=await this.core.crypto.setSymKey(C),X=bD(p.FIVE_MINUTES),Y={protocol:sC},E={topic:$,expiry:X,relay:Y,active:!1},K=YQ({protocol:this.core.protocol,version:this.core.version,topic:$,symKey:C,relay:Y});return await this.pairings.set($,E),await this.core.relayer.subscribe($),this.core.expirer.set($,X),{topic:$,uri:K}},this.pair=async(C)=>{this.isInitialized(),this.isValidPair(C);let{topic:$,symKey:X,relay:Y}=XQ(C.uri);if(this.pairings.keys.includes($))throw new Error(`Pairing already exists: ${$}`);if(this.core.crypto.hasKeys($))throw new Error(`Keychain already exists: ${$}`);let E=bD(p.FIVE_MINUTES),K={topic:$,relay:Y,expiry:E,active:!1};return await this.pairings.set($,K),await this.core.crypto.setSymKey(X,$),await this.core.relayer.subscribe($,{relay:Y}),this.core.expirer.set($,E),C.activatePairing&&await this.activate({topic:$}),K},this.activate=async({topic:C})=>{this.isInitialized();let $=bD(p.THIRTY_DAYS);await this.pairings.update(C,{active:!0,expiry:$}),this.core.expirer.set(C,$)},this.ping=async(C)=>{this.isInitialized(),await this.isValidPing(C);let{topic:$}=C;if(this.pairings.keys.includes($)){let X=await this.sendRequest($,"wc_pairingPing",{}),{done:Y,resolve:E,reject:K}=q8();this.events.once(CD("pairing_ping",X),({error:Q})=>{Q?K(Q):E()}),await Y()}},this.updateExpiry=async({topic:C,expiry:$})=>{this.isInitialized(),await this.pairings.update(C,{expiry:$})},this.updateMetadata=async({topic:C,metadata:$})=>{this.isInitialized(),await this.pairings.update(C,{peerMetadata:$})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async(C)=>{this.isInitialized(),await this.isValidDisconnect(C);let{topic:$}=C;this.pairings.keys.includes($)&&(await this.sendRequest($,"wc_pairingDelete",ED("USER_DISCONNECTED")),await this.deletePairing($))},this.sendRequest=async(C,$,X)=>{let Y=C8($,X),E=await this.core.crypto.encode(C,Y),K=J3[$].req;return this.core.history.set(C,Y),this.core.relayer.publish(C,E,K),Y.id},this.sendResult=async(C,$,X)=>{let Y=b8(C,X),E=await this.core.crypto.encode($,Y),K=await this.core.history.get($,C),Q=J3[K.request.method].res;await this.core.relayer.publish($,E,Q),await this.core.history.resolve(Y)},this.sendError=async(C,$,X)=>{let Y=M8(C,X),E=await this.core.crypto.encode($,Y),K=await this.core.history.get($,C),Q=J3[K.request.method]?J3[K.request.method].res:J3.unregistered_method.res;await this.core.relayer.publish($,E,Q),await this.core.history.resolve(Y)},this.deletePairing=async(C,$)=>{await this.core.relayer.unsubscribe(C),await Promise.all([this.pairings.delete(C,ED("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(C),$?Promise.resolve():this.core.expirer.del(C)])},this.cleanup=async()=>{let C=this.pairings.getAll().filter(($)=>w8($.expiry));await Promise.all(C.map(($)=>this.deletePairing($.topic)))},this.onRelayEventRequest=(C)=>{let{topic:$,payload:X}=C;switch(X.method){case"wc_pairingPing":return this.onPairingPingRequest($,X);case"wc_pairingDelete":return this.onPairingDeleteRequest($,X);default:return this.onUnknownRpcMethodRequest($,X)}},this.onRelayEventResponse=async(C)=>{let{topic:$,payload:X}=C,Y=(await this.core.history.get($,X.id)).request.method;switch(Y){case"wc_pairingPing":return this.onPairingPingResponse($,X);default:return this.onUnknownRpcMethodResponse(Y)}},this.onPairingPingRequest=async(C,$)=>{let{id:X}=$;try{this.isValidPing({topic:C}),await this.sendResult(X,C,!0),this.events.emit("pairing_ping",{id:X,topic:C})}catch(Y){await this.sendError(X,C,Y),this.logger.error(Y)}},this.onPairingPingResponse=(C,$)=>{let{id:X}=$;setTimeout(()=>{yD($)?this.events.emit(CD("pairing_ping",X),{}):MD($)&&this.events.emit(CD("pairing_ping",X),{error:$.error})},500)},this.onPairingDeleteRequest=async(C,$)=>{let{id:X}=$;try{this.isValidDisconnect({topic:C}),await this.deletePairing(C),this.events.emit("pairing_delete",{id:X,topic:C})}catch(Y){await this.sendError(X,C,Y),this.logger.error(Y)}},this.onUnknownRpcMethodRequest=async(C,$)=>{let{id:X,method:Y}=$;try{if(this.registeredMethods.includes(Y))return;let E=ED("WC_METHOD_UNSUPPORTED",Y);await this.sendError(X,C,E),this.logger.error(E)}catch(E){await this.sendError(X,C,E),this.logger.error(E)}},this.onUnknownRpcMethodResponse=(C)=>{this.registeredMethods.includes(C)||this.logger.error(ED("WC_METHOD_UNSUPPORTED",C))},this.isValidPair=(C)=>{if(!qD(C)){let{message:$}=R("MISSING_OR_INVALID",`pair() params: ${C}`);throw new Error($)}if(!QQ(C.uri)){let{message:$}=R("MISSING_OR_INVALID",`pair() uri: ${C.uri}`);throw new Error($)}},this.isValidPing=async(C)=>{if(!qD(C)){let{message:X}=R("MISSING_OR_INVALID",`ping() params: ${C}`);throw new Error(X)}let{topic:$}=C;await this.isValidPairingTopic($)},this.isValidDisconnect=async(C)=>{if(!qD(C)){let{message:X}=R("MISSING_OR_INVALID",`disconnect() params: ${C}`);throw new Error(X)}let{topic:$}=C;await this.isValidPairingTopic($)},this.isValidPairingTopic=async(C)=>{if(!KD(C,!1)){let{message:$}=R("MISSING_OR_INVALID",`pairing topic should be a string: ${C}`);throw new Error($)}if(!this.pairings.keys.includes(C)){let{message:$}=R("NO_MATCHING_KEY",`pairing topic doesn't exist: ${C}`);throw new Error($)}if(w8(this.pairings.get(C).expiry)){await this.deletePairing(C);let{message:$}=R("EXPIRED",`pairing topic: ${C}`);throw new Error($)}},this.core=D,this.logger=LD(w,this.name),this.pairings=new z0(this.core,this.logger,this.name,this.storagePrefix)}get context(){return HD(this.logger)}isInitialized(){if(!this.initialized){let{message:D}=R("NOT_INITIALIZED",this.name);throw new Error(D)}}registerRelayerEvents(){this.core.relayer.on(AD.message,async(D)=>{let{topic:w,message:C}=D;if(!this.pairings.keys.includes(w)||this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(C)))return;let $=await this.core.crypto.decode(w,C);try{d8($)?(this.core.history.set(w,$),this.onRelayEventRequest({topic:w,payload:$})):F8($)&&(await this.core.history.resolve($),await this.onRelayEventResponse({topic:w,payload:$}),this.core.history.delete(w,$.id))}catch(X){this.logger.error(X)}})}registerExpirerEvents(){this.core.expirer.on(cD.expired,async(D)=>{let{topic:w}=e3(D.target);w&&this.pairings.keys.includes(w)&&(await this.deletePairing(w,!0),this.events.emit("pairing_expire",{topic:w}))})}}class uB extends e1{constructor(D,w){super(D,w),this.core=D,this.logger=w,this.records=new Map,this.events=new mD,this.name=F6,this.version=G6,this.cached=[],this.initialized=!1,this.storagePrefix=R8,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach((C)=>this.records.set(C.id,C)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(C,$,X)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:C,request:$,chainId:X}),this.records.has($.id))return;let Y={id:$.id,topic:C,request:{method:$.method,params:$.params||null},chainId:X,expiry:bD(p.THIRTY_DAYS)};this.records.set(Y.id,Y),this.events.emit(X8.created,Y)},this.resolve=async(C)=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:C}),!this.records.has(C.id))return;let $=await this.getRecord(C.id);typeof $.response>"u"&&($.response=MD(C)?{error:C.error}:{result:C.result},this.records.set($.id,$),this.events.emit(X8.updated,$))},this.get=async(C,$)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:C,id:$}),await this.getRecord($)),this.delete=(C,$)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:$}),this.values.forEach((X)=>{if(X.topic===C){if(typeof $<"u"&&X.id!==$)return;this.records.delete(X.id),this.events.emit(X8.deleted,X)}})},this.exists=async(C,$)=>(this.isInitialized(),this.records.has($)?(await this.getRecord($)).topic===C:!1),this.on=(C,$)=>{this.events.on(C,$)},this.once=(C,$)=>{this.events.once(C,$)},this.off=(C,$)=>{this.events.off(C,$)},this.removeListener=(C,$)=>{this.events.removeListener(C,$)},this.logger=LD(w,this.name)}get context(){return HD(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){let D=[];return this.values.forEach((w)=>{if(typeof w.response<"u")return;let C={topic:w.topic,request:C8(w.request.method,w.request.params,w.id),chainId:w.chainId};return D.push(C)}),D}async setJsonRpcRecords(D){await this.core.storage.setItem(this.storageKey,D)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(D){this.isInitialized();let w=this.records.get(D);if(!w){let{message:C}=R("NO_MATCHING_KEY",`${this.name}: ${D}`);throw new Error(C)}return w}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(X8.sync)}async restore(){try{let D=await this.getJsonRpcRecords();if(typeof D>"u"||!D.length)return;if(this.records.size){let{message:w}=R("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(w),new Error(w)}this.cached=D,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(D){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(D)}}registerEventListeners(){this.events.on(X8.created,(D)=>{let w=X8.created;this.logger.info(`Emitting ${w}`),this.logger.debug({type:"event",event:w,record:D}),this.persist()}),this.events.on(X8.updated,(D)=>{let w=X8.updated;this.logger.info(`Emitting ${w}`),this.logger.debug({type:"event",event:w,record:D}),this.persist()}),this.events.on(X8.deleted,(D)=>{let w=X8.deleted;this.logger.info(`Emitting ${w}`),this.logger.debug({type:"event",event:w,record:D}),this.persist()}),this.core.heartbeat.on(n8.HEARTBEAT_EVENTS.pulse,()=>{this.cleanup()})}cleanup(){try{this.records.forEach((D)=>{p.toMiliseconds(D.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${D.id}`),this.delete(D.topic,D.id))})}catch(D){this.logger.warn(D)}}isInitialized(){if(!this.initialized){let{message:D}=R("NOT_INITIALIZED",this.name);throw new Error(D)}}}class kB extends Yw{constructor(D,w){super(D,w),this.core=D,this.logger=w,this.expirations=new Map,this.events=new mD,this.name=O6,this.version=P6,this.cached=[],this.initialized=!1,this.storagePrefix=R8,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach((C)=>this.expirations.set(C.target,C)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=(C)=>{try{let $=this.formatTarget(C);return typeof this.getExpiration($)<"u"}catch{return!1}},this.set=(C,$)=>{this.isInitialized();let X=this.formatTarget(C),Y={target:X,expiry:$};this.expirations.set(X,Y),this.checkExpiry(X,Y),this.events.emit(cD.created,{target:X,expiration:Y})},this.get=(C)=>{this.isInitialized();let $=this.formatTarget(C);return this.getExpiration($)},this.del=(C)=>{if(this.isInitialized(),this.has(C)){let $=this.formatTarget(C),X=this.getExpiration($);this.expirations.delete($),this.events.emit(cD.deleted,{target:$,expiration:X})}},this.on=(C,$)=>{this.events.on(C,$)},this.once=(C,$)=>{this.events.once(C,$)},this.off=(C,$)=>{this.events.off(C,$)},this.removeListener=(C,$)=>{this.events.removeListener(C,$)},this.logger=LD(w,this.name)}get context(){return HD(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(D){if(typeof D=="string")return wQ(D);if(typeof D=="number")return CQ(D);let{message:w}=R("UNKNOWN_TYPE",`Target type: ${typeof D}`);throw new Error(w)}async setExpirations(D){await this.core.storage.setItem(this.storageKey,D)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(cD.sync)}async restore(){try{let D=await this.getExpirations();if(typeof D>"u"||!D.length)return;if(this.expirations.size){let{message:w}=R("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(w),new Error(w)}this.cached=D,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(D){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(D)}}getExpiration(D){let w=this.expirations.get(D);if(!w){let{message:C}=R("NO_MATCHING_KEY",`${this.name}: ${D}`);throw this.logger.error(C),new Error(C)}return w}checkExpiry(D,w){let{expiry:C}=w;p.toMiliseconds(C)-Date.now()<=0&&this.expire(D,w)}expire(D,w){this.expirations.delete(D),this.events.emit(cD.expired,{target:D,expiration:w})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((D,w)=>this.checkExpiry(w,D))}registerEventListeners(){this.core.heartbeat.on(n8.HEARTBEAT_EVENTS.pulse,()=>this.checkExpirations()),this.events.on(cD.created,(D)=>{let w=cD.created;this.logger.info(`Emitting ${w}`),this.logger.debug({type:"event",event:w,data:D}),this.persist()}),this.events.on(cD.expired,(D)=>{let w=cD.expired;this.logger.info(`Emitting ${w}`),this.logger.debug({type:"event",event:w,data:D}),this.persist()}),this.events.on(cD.deleted,(D)=>{let w=cD.deleted;this.logger.info(`Emitting ${w}`),this.logger.debug({type:"event",event:w,data:D}),this.persist()})}isInitialized(){if(!this.initialized){let{message:D}=R("NOT_INITIALIZED",this.name);throw new Error(D)}}}class bB extends Ew{constructor(D,w){super(D,w),this.projectId=D,this.logger=w,this.name=nC,this.initialized=!1,this.queue=[],this.verifyDisabled=!1,this.init=async(C)=>{if(this.verifyDisabled||o0()||!k8())return;let $=C?.verifyUrl||W3;this.verifyUrl!==$&&this.removeIframe(),this.verifyUrl=$;try{await this.createIframe()}catch(X){this.logger.warn(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.warn(X)}if(!this.initialized){this.removeIframe(),this.verifyUrl=tZ;try{await this.createIframe()}catch(X){this.logger.error(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.error(X),this.verifyDisabled=!0}}},this.register=async(C)=>{this.initialized?this.sendPost(C.attestationId):(this.addToQueue(C.attestationId),await this.init())},this.resolve=async(C)=>{if(this.isDevEnv)return"";let $=C?.verifyUrl||W3,X="";try{X=await this.fetchAttestation(C.attestationId,$)}catch(Y){this.logger.warn(`failed to resolve attestation: ${C.attestationId} from url: ${$}`),this.logger.warn(Y),X=await this.fetchAttestation(C.attestationId,tZ)}return X},this.fetchAttestation=async(C,$)=>{var X;this.logger.info(`resolving attestation: ${C} from url: ${$}`);let Y=this.startAbortTimer(p.ONE_SECOND*2),E=await fetch(`${$}/attestation/${C}`,{signal:this.abortController.signal});return clearTimeout(Y),E.status===200?(X=await E.json())==null?void 0:X.origin:""},this.addToQueue=(C)=>{this.queue.push(C)},this.processQueue=()=>{this.queue.length!==0&&(this.queue.forEach((C)=>this.sendPost(C)),this.queue=[])},this.sendPost=(C)=>{var $;try{if(!this.iframe)return;($=this.iframe.contentWindow)==null||$.postMessage(C,"*"),this.logger.info(`postMessage sent: ${C} ${this.verifyUrl}`)}catch{}},this.createIframe=async()=>{let C,$=(X)=>{X.data==="verify_ready"&&(this.initialized=!0,this.processQueue(),window.removeEventListener("message",$),C())};await Promise.race([new Promise((X)=>{if(document.getElementById(nC))return X();window.addEventListener("message",$);let Y=document.createElement("iframe");Y.id=nC,Y.src=`${this.verifyUrl}/${this.projectId}`,Y.style.display="none",document.body.append(Y),this.iframe=Y,C=X}),new Promise((X,Y)=>setTimeout(()=>{window.removeEventListener("message",$),Y("verify iframe load timeout")},p.toMiliseconds(p.FIVE_SECONDS)))])},this.removeIframe=()=>{this.iframe&&(this.iframe.remove(),this.iframe=void 0,this.initialized=!1)},this.logger=LD(w,this.name),this.verifyUrl=W3,this.abortController=new AbortController,this.isDevEnv=t3()&&process.env.IS_VITEST}get context(){return HD(this.logger)}startAbortTimer(D){return this.abortController=new AbortController,setTimeout(()=>this.abortController.abort(),p.toMiliseconds(D))}}var{defineProperty:L6,getOwnPropertySymbols:EB}=Object,_6=Object.prototype.hasOwnProperty,j6=Object.prototype.propertyIsEnumerable,KB=(D,w,C)=>(w in D)?L6(D,w,{enumerable:!0,configurable:!0,writable:!0,value:C}):D[w]=C,QB=(D,w)=>{for(var C in w||(w={}))_6.call(w,C)&&KB(D,C,w[C]);if(EB)for(var C of EB(w))j6.call(w,C)&&KB(D,C,w[C]);return D};class aC extends t1{constructor(D){super(D),this.protocol=TB,this.version=pH,this.name=oC,this.events=new mD,this.initialized=!1,this.on=(C,$)=>this.events.on(C,$),this.once=(C,$)=>this.events.once(C,$),this.off=(C,$)=>this.events.off(C,$),this.removeListener=(C,$)=>this.events.removeListener(C,$),this.projectId=D?.projectId,this.relayUrl=D?.relayUrl||SB;let w=typeof D?.logger<"u"&&typeof D?.logger!="string"?D.logger:e8.default(j0({level:D?.logger||nH.logger}));this.logger=LD(w,this.name),this.heartbeat=new n8.HeartBeat,this.crypto=new LB(this,this.logger,D?.keychain),this.history=new uB(this,this.logger),this.expirer=new kB(this,this.logger),this.storage=D!=null&&D.storage?D.storage:new x1(QB(QB({},lH),D?.storageOptions)),this.relayer=new hB({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new gB(this,this.logger),this.verify=new bB(this.projectId||"",this.logger)}static async init(D){let w=new aC(D);await w.initialize();let C=await w.crypto.getClientId();return await w.storage.setItem(Q6,C),w}get context(){return HD(this.logger)}async start(){this.initialized||await this.initialize()}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.initialized=!0,this.logger.info("Core Initialization Success")}catch(D){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,D),this.logger.error(D.message),D}}}var dB=aC;s8();var l=FD(_8(),1);var pB="wc",nB=2,lB="client",D$=`${pB}@${nB}:${lB}:`,tC={name:lB,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.com"};var yB="WALLETCONNECT_DEEPLINK_CHOICE";var x6="proposal";var m6="Proposal expired",h6="session",H1=l.SEVEN_DAYS,g6="engine",G3={wc_sessionPropose:{req:{ttl:l.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:l.FIVE_MINUTES,prompt:!1,tag:1101}},wc_sessionSettle:{req:{ttl:l.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:l.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:l.ONE_DAY,prompt:!1,tag:1104},res:{ttl:l.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:l.ONE_DAY,prompt:!1,tag:1106},res:{ttl:l.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:l.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:l.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:l.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:l.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:l.ONE_DAY,prompt:!1,tag:1112},res:{ttl:l.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:l.THIRTY_SECONDS,prompt:!1,tag:1114},res:{ttl:l.THIRTY_SECONDS,prompt:!1,tag:1115}}},eC={min:l.FIVE_MINUTES,max:l.SEVEN_DAYS},V8={idle:"IDLE",active:"ACTIVE"},u6="request",k6=["wc_sessionPropose","wc_sessionRequest","wc_authRequest"],b6=Object.defineProperty,d6=Object.defineProperties,y6=Object.getOwnPropertyDescriptors,cB=Object.getOwnPropertySymbols,c6=Object.prototype.hasOwnProperty,v6=Object.prototype.propertyIsEnumerable,vB=(D,w,C)=>(w in D)?b6(D,w,{enumerable:!0,configurable:!0,writable:!0,value:C}):D[w]=C,uD=(D,w)=>{for(var C in w||(w={}))c6.call(w,C)&&vB(D,C,w[C]);if(cB)for(var C of cB(w))v6.call(w,C)&&vB(D,C,w[C]);return D},O3=(D,w)=>d6(D,y6(w));class iB extends Qw{constructor(D){super(D),this.name=g6,this.events=new x0,this.initialized=!1,this.ignoredPayloadTypes=[N8],this.requestQueue={state:V8.idle,queue:[]},this.sessionRequestQueue={state:V8.idle,queue:[]},this.requestQueueDelay=l.ONE_SECOND,this.init=async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.client.core.pairing.register({methods:Object.keys(G3)}),this.initialized=!0,setTimeout(()=>{this.sessionRequestQueue.queue=this.getPendingSessionRequests(),this.processSessionRequestQueue()},l.toMiliseconds(this.requestQueueDelay)))},this.connect=async(w)=>{await this.isInitialized();let C=O3(uD({},w),{requiredNamespaces:w.requiredNamespaces||{},optionalNamespaces:w.optionalNamespaces||{}});await this.isValidConnect(C);let{pairingTopic:$,requiredNamespaces:X,optionalNamespaces:Y,sessionProperties:E,relays:K}=C,Q=$,Z,B=!1;if(Q&&(B=this.client.core.pairing.pairings.get(Q).active),!Q||!B){let{topic:z,uri:O}=await this.client.core.pairing.create();Q=z,Z=O}let J=await this.client.core.crypto.generateKeyPair(),F=uD({requiredNamespaces:X,optionalNamespaces:Y,relays:K??[{protocol:sC}],proposer:{publicKey:J,metadata:this.client.metadata}},E&&{sessionProperties:E}),{reject:W,resolve:N,done:G}=q8(l.FIVE_MINUTES,m6);if(this.events.once(CD("session_connect"),async({error:z,session:O})=>{if(z)W(z);else if(O){O.self.publicKey=J;let A=O3(uD({},O),{requiredNamespaces:O.requiredNamespaces,optionalNamespaces:O.optionalNamespaces});await this.client.session.set(O.topic,A),await this.setExpiry(O.topic,O.expiry),Q&&await this.client.core.pairing.updateMetadata({topic:Q,metadata:O.peer.metadata}),N(A)}}),!Q){let{message:z}=R("NO_MATCHING_KEY",`connect() pairing topic: ${Q}`);throw new Error(z)}let V=await this.sendRequest({topic:Q,method:"wc_sessionPropose",params:F}),H=bD(l.FIVE_MINUTES);return await this.setProposal(V,uD({id:V,expiry:H},F)),{uri:Z,approval:G}},this.pair=async(w)=>(await this.isInitialized(),await this.client.core.pairing.pair(w)),this.approve=async(w)=>{await this.isInitialized(),await this.isValidApprove(w);let{id:C,relayProtocol:$,namespaces:X,sessionProperties:Y}=w,E=this.client.proposal.get(C),{pairingTopic:K,proposer:Q,requiredNamespaces:Z,optionalNamespaces:B}=E;K=K||"",B0(Z)||(Z=EQ(X,"approve()"));let J=await this.client.core.crypto.generateKeyPair(),F=Q.publicKey,W=await this.client.core.crypto.generateSharedKey(J,F);K&&C&&(await this.client.core.pairing.updateMetadata({topic:K,metadata:Q.metadata}),await this.sendResult({id:C,topic:K,result:{relay:{protocol:$??"irn"},responderPublicKey:J}}),await this.client.proposal.delete(C,ED("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:K}));let N=uD({relay:{protocol:$??"irn"},namespaces:X,requiredNamespaces:Z,optionalNamespaces:B,pairingTopic:K,controller:{publicKey:J,metadata:this.client.metadata},expiry:bD(H1)},Y&&{sessionProperties:Y});await this.client.core.relayer.subscribe(W),await this.sendRequest({topic:W,method:"wc_sessionSettle",params:N,throwOnFailedPublish:!0});let G=O3(uD({},N),{topic:W,pairingTopic:K,acknowledged:!1,self:N.controller,peer:{publicKey:Q.publicKey,metadata:Q.metadata},controller:J});return await this.client.session.set(W,G),await this.setExpiry(W,bD(H1)),{topic:W,acknowledged:()=>new Promise((V)=>setTimeout(()=>V(this.client.session.get(W)),500))}},this.reject=async(w)=>{await this.isInitialized(),await this.isValidReject(w);let{id:C,reason:$}=w,{pairingTopic:X}=this.client.proposal.get(C);X&&(await this.sendError(C,X,$),await this.client.proposal.delete(C,ED("USER_DISCONNECTED")))},this.update=async(w)=>{await this.isInitialized(),await this.isValidUpdate(w);let{topic:C,namespaces:$}=w,X=await this.sendRequest({topic:C,method:"wc_sessionUpdate",params:{namespaces:$}}),{done:Y,resolve:E,reject:K}=q8();return this.events.once(CD("session_update",X),({error:Q})=>{Q?K(Q):E()}),await this.client.session.update(C,{namespaces:$}),{acknowledged:Y}},this.extend=async(w)=>{await this.isInitialized(),await this.isValidExtend(w);let{topic:C}=w,$=await this.sendRequest({topic:C,method:"wc_sessionExtend",params:{}}),{done:X,resolve:Y,reject:E}=q8();return this.events.once(CD("session_extend",$),({error:K})=>{K?E(K):Y()}),await this.setExpiry(C,bD(H1)),{acknowledged:X}},this.request=async(w)=>{await this.isInitialized(),await this.isValidRequest(w);let{chainId:C,request:$,topic:X,expiry:Y}=w,E=W0(),{done:K,resolve:Q,reject:Z}=q8(Y);return this.events.once(CD("session_request",E),({error:B,result:J})=>{B?Z(B):Q(J)}),await Promise.all([new Promise(async(B)=>{await this.sendRequest({clientRpcId:E,topic:X,method:"wc_sessionRequest",params:{request:$,chainId:C},expiry:Y,throwOnFailedPublish:!0}).catch((J)=>Z(J)),this.client.events.emit("session_request_sent",{topic:X,request:$,chainId:C,id:E}),B()}),new Promise(async(B)=>{let J=await this.client.core.storage.getItem(yB);$Q({id:E,topic:X,wcDeepLink:J}),B()}),K()]).then((B)=>B[2])},this.respond=async(w)=>{await this.isInitialized(),await this.isValidRespond(w);let{topic:C,response:$}=w,{id:X}=$;yD($)?await this.sendResult({id:X,topic:C,result:$.result,throwOnFailedPublish:!0}):MD($)&&await this.sendError(X,C,$.error),this.cleanupAfterResponse(w)},this.ping=async(w)=>{await this.isInitialized(),await this.isValidPing(w);let{topic:C}=w;if(this.client.session.keys.includes(C)){let $=await this.sendRequest({topic:C,method:"wc_sessionPing",params:{}}),{done:X,resolve:Y,reject:E}=q8();this.events.once(CD("session_ping",$),({error:K})=>{K?E(K):Y()}),await X()}else this.client.core.pairing.pairings.keys.includes(C)&&await this.client.core.pairing.ping({topic:C})},this.emit=async(w)=>{await this.isInitialized(),await this.isValidEmit(w);let{topic:C,event:$,chainId:X}=w;await this.sendRequest({topic:C,method:"wc_sessionEvent",params:{event:$,chainId:X}})},this.disconnect=async(w)=>{await this.isInitialized(),await this.isValidDisconnect(w);let{topic:C}=w;this.client.session.keys.includes(C)?(await this.sendRequest({topic:C,method:"wc_sessionDelete",params:ED("USER_DISCONNECTED"),throwOnFailedPublish:!0}),await this.deleteSession(C)):await this.client.core.pairing.disconnect({topic:C})},this.find=(w)=>(this.isInitialized(),this.client.session.getAll().filter((C)=>KQ(C,w))),this.getPendingSessionRequests=()=>(this.isInitialized(),this.client.pendingRequest.getAll()),this.cleanupDuplicatePairings=async(w)=>{if(w.pairingTopic)try{let C=this.client.core.pairing.pairings.get(w.pairingTopic),$=this.client.core.pairing.pairings.getAll().filter((X)=>{var Y,E;return((Y=X.peerMetadata)==null?void 0:Y.url)&&((E=X.peerMetadata)==null?void 0:E.url)===w.peer.metadata.url&&X.topic&&X.topic!==C.topic});if($.length===0)return;this.client.logger.info(`Cleaning up ${$.length} duplicate pairing(s)`),await Promise.all($.map((X)=>this.client.core.pairing.disconnect({topic:X.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(C){this.client.logger.error(C)}},this.deleteSession=async(w,C)=>{let{self:$}=this.client.session.get(w);await this.client.core.relayer.unsubscribe(w),this.client.session.delete(w,ED("USER_DISCONNECTED")),this.client.core.crypto.keychain.has($.publicKey)&&await this.client.core.crypto.deleteKeyPair($.publicKey),this.client.core.crypto.keychain.has(w)&&await this.client.core.crypto.deleteSymKey(w),C||this.client.core.expirer.del(w),this.client.core.storage.removeItem(yB).catch((X)=>this.client.logger.warn(X))},this.deleteProposal=async(w,C)=>{await Promise.all([this.client.proposal.delete(w,ED("USER_DISCONNECTED")),C?Promise.resolve():this.client.core.expirer.del(w)])},this.deletePendingSessionRequest=async(w,C,$=!1)=>{await Promise.all([this.client.pendingRequest.delete(w,C),$?Promise.resolve():this.client.core.expirer.del(w)]),this.sessionRequestQueue.queue=this.sessionRequestQueue.queue.filter((X)=>X.id!==w),$&&(this.sessionRequestQueue.state=V8.idle)},this.setExpiry=async(w,C)=>{this.client.session.keys.includes(w)&&await this.client.session.update(w,{expiry:C}),this.client.core.expirer.set(w,C)},this.setProposal=async(w,C)=>{await this.client.proposal.set(w,C),this.client.core.expirer.set(w,C.expiry)},this.setPendingSessionRequest=async(w)=>{let C=G3.wc_sessionRequest.req.ttl,{id:$,topic:X,params:Y}=w;await this.client.pendingRequest.set($,{id:$,topic:X,params:Y}),C&&this.client.core.expirer.set($,bD(C))},this.sendRequest=async(w)=>{let{topic:C,method:$,params:X,expiry:Y,relayRpcId:E,clientRpcId:K,throwOnFailedPublish:Q}=w,Z=C8($,X,K);if(k8()&&k6.includes($)){let F=U8(JSON.stringify(Z));this.client.core.verify.register({attestationId:F})}let B=await this.client.core.crypto.encode(C,Z),J=G3[$].req;return Y&&(J.ttl=Y),E&&(J.id=E),this.client.core.history.set(C,Z),Q?(J.internal=O3(uD({},J.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(C,B,J)):this.client.core.relayer.publish(C,B,J).catch((F)=>this.client.logger.error(F)),Z.id},this.sendResult=async(w)=>{let{id:C,topic:$,result:X,throwOnFailedPublish:Y}=w,E=b8(C,X),K=await this.client.core.crypto.encode($,E),Q=await this.client.core.history.get($,C),Z=G3[Q.request.method].res;Y?(Z.internal=O3(uD({},Z.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish($,K,Z)):this.client.core.relayer.publish($,K,Z).catch((B)=>this.client.logger.error(B)),await this.client.core.history.resolve(E)},this.sendError=async(w,C,$)=>{let X=M8(w,$),Y=await this.client.core.crypto.encode(C,X),E=await this.client.core.history.get(C,w),K=G3[E.request.method].res;this.client.core.relayer.publish(C,Y,K),await this.client.core.history.resolve(X)},this.cleanup=async()=>{let w=[],C=[];this.client.session.getAll().forEach(($)=>{w8($.expiry)&&w.push($.topic)}),this.client.proposal.getAll().forEach(($)=>{w8($.expiry)&&C.push($.id)}),await Promise.all([...w.map(($)=>this.deleteSession($)),...C.map(($)=>this.deleteProposal($))])},this.onRelayEventRequest=async(w)=>{this.requestQueue.queue.push(w),await this.processRequestsQueue()},this.processRequestsQueue=async()=>{if(this.requestQueue.state===V8.active){this.client.logger.info("Request queue already active, skipping...");return}for(this.client.logger.info(`Request queue starting with ${this.requestQueue.queue.length} requests`);this.requestQueue.queue.length>0;){this.requestQueue.state=V8.active;let w=this.requestQueue.queue.shift();if(w)try{this.processRequest(w),await new Promise((C)=>setTimeout(C,300))}catch(C){this.client.logger.warn(C)}}this.requestQueue.state=V8.idle},this.processRequest=(w)=>{let{topic:C,payload:$}=w,X=$.method;switch(X){case"wc_sessionPropose":return this.onSessionProposeRequest(C,$);case"wc_sessionSettle":return this.onSessionSettleRequest(C,$);case"wc_sessionUpdate":return this.onSessionUpdateRequest(C,$);case"wc_sessionExtend":return this.onSessionExtendRequest(C,$);case"wc_sessionPing":return this.onSessionPingRequest(C,$);case"wc_sessionDelete":return this.onSessionDeleteRequest(C,$);case"wc_sessionRequest":return this.onSessionRequest(C,$);case"wc_sessionEvent":return this.onSessionEventRequest(C,$);default:return this.client.logger.info(`Unsupported request method ${X}`)}},this.onRelayEventResponse=async(w)=>{let{topic:C,payload:$}=w,X=(await this.client.core.history.get(C,$.id)).request.method;switch(X){case"wc_sessionPropose":return this.onSessionProposeResponse(C,$);case"wc_sessionSettle":return this.onSessionSettleResponse(C,$);case"wc_sessionUpdate":return this.onSessionUpdateResponse(C,$);case"wc_sessionExtend":return this.onSessionExtendResponse(C,$);case"wc_sessionPing":return this.onSessionPingResponse(C,$);case"wc_sessionRequest":return this.onSessionRequestResponse(C,$);default:return this.client.logger.info(`Unsupported response method ${X}`)}},this.onRelayEventUnknownPayload=(w)=>{let{topic:C}=w,{message:$}=R("MISSING_OR_INVALID",`Decoded payload on topic ${C} is not identifiable as a JSON-RPC request or a response.`);throw new Error($)},this.onSessionProposeRequest=async(w,C)=>{let{params:$,id:X}=C;try{this.isValidConnect(uD({},C.params));let Y=bD(l.FIVE_MINUTES),E=uD({id:X,pairingTopic:w,expiry:Y},$);await this.setProposal(X,E);let K=U8(JSON.stringify(C)),Q=await this.getVerifyContext(K,E.proposer.metadata);this.client.events.emit("session_proposal",{id:X,params:E,verifyContext:Q})}catch(Y){await this.sendError(X,w,Y),this.client.logger.error(Y)}},this.onSessionProposeResponse=async(w,C)=>{let{id:$}=C;if(yD(C)){let{result:X}=C;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:X});let Y=this.client.proposal.get($);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:Y});let E=Y.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:E});let K=X.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:K});let Q=await this.client.core.crypto.generateSharedKey(E,K);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:Q});let Z=await this.client.core.relayer.subscribe(Q);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:Z}),await this.client.core.pairing.activate({topic:w})}else MD(C)&&(await this.client.proposal.delete($,ED("USER_DISCONNECTED")),this.events.emit(CD("session_connect"),{error:C.error}))},this.onSessionSettleRequest=async(w,C)=>{let{id:$,params:X}=C;try{this.isValidSessionSettleRequest(X);let{relay:Y,controller:E,expiry:K,namespaces:Q,requiredNamespaces:Z,optionalNamespaces:B,sessionProperties:J,pairingTopic:F}=C.params,W=uD({topic:w,relay:Y,expiry:K,namespaces:Q,acknowledged:!0,pairingTopic:F,requiredNamespaces:Z,optionalNamespaces:B,controller:E.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:E.publicKey,metadata:E.metadata}},J&&{sessionProperties:J});await this.sendResult({id:C.id,topic:w,result:!0}),this.events.emit(CD("session_connect"),{session:W}),this.cleanupDuplicatePairings(W)}catch(Y){await this.sendError($,w,Y),this.client.logger.error(Y)}},this.onSessionSettleResponse=async(w,C)=>{let{id:$}=C;yD(C)?(await this.client.session.update(w,{acknowledged:!0}),this.events.emit(CD("session_approve",$),{})):MD(C)&&(await this.client.session.delete(w,ED("USER_DISCONNECTED")),this.events.emit(CD("session_approve",$),{error:C.error}))},this.onSessionUpdateRequest=async(w,C)=>{let{params:$,id:X}=C;try{let Y=`${w}_session_update`,E=J0.get(Y);if(E&&this.isRequestOutOfSync(E,X)){this.client.logger.info(`Discarding out of sync request - ${X}`);return}this.isValidUpdate(uD({topic:w},$)),await this.client.session.update(w,{namespaces:$.namespaces}),await this.sendResult({id:X,topic:w,result:!0}),this.client.events.emit("session_update",{id:X,topic:w,params:$}),J0.set(Y,X)}catch(Y){await this.sendError(X,w,Y),this.client.logger.error(Y)}},this.isRequestOutOfSync=(w,C)=>parseInt(C.toString().slice(0,-3))<=parseInt(w.toString().slice(0,-3)),this.onSessionUpdateResponse=(w,C)=>{let{id:$}=C;yD(C)?this.events.emit(CD("session_update",$),{}):MD(C)&&this.events.emit(CD("session_update",$),{error:C.error})},this.onSessionExtendRequest=async(w,C)=>{let{id:$}=C;try{this.isValidExtend({topic:w}),await this.setExpiry(w,bD(H1)),await this.sendResult({id:$,topic:w,result:!0}),this.client.events.emit("session_extend",{id:$,topic:w})}catch(X){await this.sendError($,w,X),this.client.logger.error(X)}},this.onSessionExtendResponse=(w,C)=>{let{id:$}=C;yD(C)?this.events.emit(CD("session_extend",$),{}):MD(C)&&this.events.emit(CD("session_extend",$),{error:C.error})},this.onSessionPingRequest=async(w,C)=>{let{id:$}=C;try{this.isValidPing({topic:w}),await this.sendResult({id:$,topic:w,result:!0}),this.client.events.emit("session_ping",{id:$,topic:w})}catch(X){await this.sendError($,w,X),this.client.logger.error(X)}},this.onSessionPingResponse=(w,C)=>{let{id:$}=C;setTimeout(()=>{yD(C)?this.events.emit(CD("session_ping",$),{}):MD(C)&&this.events.emit(CD("session_ping",$),{error:C.error})},500)},this.onSessionDeleteRequest=async(w,C)=>{let{id:$}=C;try{this.isValidDisconnect({topic:w,reason:C.params}),await Promise.all([new Promise((X)=>{this.client.core.relayer.once(AD.publish,async()=>{X(await this.deleteSession(w))})}),this.sendResult({id:$,topic:w,result:!0})]),this.client.events.emit("session_delete",{id:$,topic:w})}catch(X){this.client.logger.error(X)}},this.onSessionRequest=async(w,C)=>{let{id:$,params:X}=C;try{this.isValidRequest(uD({topic:w},X)),await this.setPendingSessionRequest({id:$,topic:w,params:X}),this.addSessionRequestToSessionRequestQueue({id:$,topic:w,params:X}),await this.processSessionRequestQueue()}catch(Y){await this.sendError($,w,Y),this.client.logger.error(Y)}},this.onSessionRequestResponse=(w,C)=>{let{id:$}=C;yD(C)?this.events.emit(CD("session_request",$),{result:C.result}):MD(C)&&this.events.emit(CD("session_request",$),{error:C.error})},this.onSessionEventRequest=async(w,C)=>{let{id:$,params:X}=C;try{let Y=`${w}_session_event_${X.event.name}`,E=J0.get(Y);if(E&&this.isRequestOutOfSync(E,$)){this.client.logger.info(`Discarding out of sync request - ${$}`);return}this.isValidEmit(uD({topic:w},X)),this.client.events.emit("session_event",{id:$,topic:w,params:X}),J0.set(Y,$)}catch(Y){await this.sendError($,w,Y),this.client.logger.error(Y)}},this.addSessionRequestToSessionRequestQueue=(w)=>{this.sessionRequestQueue.queue.push(w)},this.cleanupAfterResponse=(w)=>{this.deletePendingSessionRequest(w.response.id,{message:"fulfilled",code:0}),setTimeout(()=>{this.sessionRequestQueue.state=V8.idle,this.processSessionRequestQueue()},l.toMiliseconds(this.requestQueueDelay))},this.processSessionRequestQueue=async()=>{if(this.sessionRequestQueue.state===V8.active){this.client.logger.info("session request queue is already active.");return}let w=this.sessionRequestQueue.queue[0];if(!w){this.client.logger.info("session request queue is empty.");return}try{let{id:C,topic:$,params:X}=w,Y=U8(JSON.stringify(C8("wc_sessionRequest",X,C))),E=this.client.session.get($),K=await this.getVerifyContext(Y,E.peer.metadata);this.sessionRequestQueue.state=V8.active,this.client.events.emit("session_request",{id:C,topic:$,params:X,verifyContext:K})}catch(C){this.client.logger.error(C)}},this.isValidConnect=async(w)=>{if(!qD(w)){let{message:K}=R("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(w)}`);throw new Error(K)}let{pairingTopic:C,requiredNamespaces:$,optionalNamespaces:X,sessionProperties:Y,relays:E}=w;if(zD(C)||await this.isValidPairingTopic(C),!FQ(E,!0)){let{message:K}=R("MISSING_OR_INVALID",`connect() relays: ${E}`);throw new Error(K)}!zD($)&&B0($)!==0&&this.validateNamespaces($,"requiredNamespaces"),!zD(X)&&B0(X)!==0&&this.validateNamespaces(X,"optionalNamespaces"),zD(Y)||this.validateSessionProps(Y,"sessionProperties")},this.validateNamespaces=(w,C)=>{let $=WQ(w,"connect()",C);if($)throw new Error($.message)},this.isValidApprove=async(w)=>{if(!qD(w))throw new Error(R("MISSING_OR_INVALID",`approve() params: ${w}`).message);let{id:C,namespaces:$,relayProtocol:X,sessionProperties:Y}=w;await this.isValidProposalId(C);let E=this.client.proposal.get(C),K=t0($,"approve()");if(K)throw new Error(K.message);let Q=UC(E.requiredNamespaces,$,"approve()");if(Q)throw new Error(Q.message);if(!KD(X,!0)){let{message:Z}=R("MISSING_OR_INVALID",`approve() relayProtocol: ${X}`);throw new Error(Z)}zD(Y)||this.validateSessionProps(Y,"sessionProperties")},this.isValidReject=async(w)=>{if(!qD(w)){let{message:X}=R("MISSING_OR_INVALID",`reject() params: ${w}`);throw new Error(X)}let{id:C,reason:$}=w;if(await this.isValidProposalId(C),!OQ($)){let{message:X}=R("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify($)}`);throw new Error(X)}},this.isValidSessionSettleRequest=(w)=>{if(!qD(w)){let{message:Q}=R("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${w}`);throw new Error(Q)}let{relay:C,controller:$,namespaces:X,expiry:Y}=w;if(!HC(C)){let{message:Q}=R("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(Q)}let E=JQ($,"onSessionSettleRequest()");if(E)throw new Error(E.message);let K=t0(X,"onSessionSettleRequest()");if(K)throw new Error(K.message);if(w8(Y)){let{message:Q}=R("EXPIRED","onSessionSettleRequest()");throw new Error(Q)}},this.isValidUpdate=async(w)=>{if(!qD(w)){let{message:K}=R("MISSING_OR_INVALID",`update() params: ${w}`);throw new Error(K)}let{topic:C,namespaces:$}=w;await this.isValidSessionTopic(C);let X=this.client.session.get(C),Y=t0($,"update()");if(Y)throw new Error(Y.message);let E=UC(X.requiredNamespaces,$,"update()");if(E)throw new Error(E.message)},this.isValidExtend=async(w)=>{if(!qD(w)){let{message:$}=R("MISSING_OR_INVALID",`extend() params: ${w}`);throw new Error($)}let{topic:C}=w;await this.isValidSessionTopic(C)},this.isValidRequest=async(w)=>{if(!qD(w)){let{message:K}=R("MISSING_OR_INVALID",`request() params: ${w}`);throw new Error(K)}let{topic:C,request:$,chainId:X,expiry:Y}=w;await this.isValidSessionTopic(C);let{namespaces:E}=this.client.session.get(C);if(!fC(E,X)){let{message:K}=R("MISSING_OR_INVALID",`request() chainId: ${X}`);throw new Error(K)}if(!PQ($)){let{message:K}=R("MISSING_OR_INVALID",`request() ${JSON.stringify($)}`);throw new Error(K)}if(!AQ(E,X,$.method)){let{message:K}=R("MISSING_OR_INVALID",`request() method: ${$.method}`);throw new Error(K)}if(Y&&!HQ(Y,eC)){let{message:K}=R("MISSING_OR_INVALID",`request() expiry: ${Y}. Expiry must be a number (in seconds) between ${eC.min} and ${eC.max}`);throw new Error(K)}},this.isValidRespond=async(w)=>{if(!qD(w)){let{message:X}=R("MISSING_OR_INVALID",`respond() params: ${w}`);throw new Error(X)}let{topic:C,response:$}=w;if(await this.isValidSessionTopic(C),!VQ($)){let{message:X}=R("MISSING_OR_INVALID",`respond() response: ${JSON.stringify($)}`);throw new Error(X)}},this.isValidPing=async(w)=>{if(!qD(w)){let{message:$}=R("MISSING_OR_INVALID",`ping() params: ${w}`);throw new Error($)}let{topic:C}=w;await this.isValidSessionOrPairingTopic(C)},this.isValidEmit=async(w)=>{if(!qD(w)){let{message:E}=R("MISSING_OR_INVALID",`emit() params: ${w}`);throw new Error(E)}let{topic:C,event:$,chainId:X}=w;await this.isValidSessionTopic(C);let{namespaces:Y}=this.client.session.get(C);if(!fC(Y,X)){let{message:E}=R("MISSING_OR_INVALID",`emit() chainId: ${X}`);throw new Error(E)}if(!zQ($)){let{message:E}=R("MISSING_OR_INVALID",`emit() event: ${JSON.stringify($)}`);throw new Error(E)}if(!IQ(Y,X,$.name)){let{message:E}=R("MISSING_OR_INVALID",`emit() event: ${JSON.stringify($)}`);throw new Error(E)}},this.isValidDisconnect=async(w)=>{if(!qD(w)){let{message:$}=R("MISSING_OR_INVALID",`disconnect() params: ${w}`);throw new Error($)}let{topic:C}=w;await this.isValidSessionOrPairingTopic(C)},this.getVerifyContext=async(w,C)=>{let $={verified:{verifyUrl:C.verifyUrl||W3,validation:"UNKNOWN",origin:C.url||""}};try{let X=await this.client.core.verify.resolve({attestationId:w,verifyUrl:C.verifyUrl});X&&($.verified.origin=X,$.verified.validation=X===new URL(C.url).origin?"VALID":"INVALID")}catch(X){this.client.logger.error(X)}return this.client.logger.info(`Verify context: ${JSON.stringify($)}`),$},this.validateSessionProps=(w,C)=>{Object.values(w).forEach(($)=>{if(!KD($,!1)){let{message:X}=R("MISSING_OR_INVALID",`${C} must be in Record<string, string> format. Received: ${JSON.stringify($)}`);throw new Error(X)}})}}async isInitialized(){if(!this.initialized){let{message:D}=R("NOT_INITIALIZED",this.name);throw new Error(D)}await this.client.core.relayer.confirmOnlineStateOrThrow()}registerRelayerEvents(){this.client.core.relayer.on(AD.message,async(D)=>{let{topic:w,message:C}=D;if(this.ignoredPayloadTypes.includes(this.client.core.crypto.getPayloadType(C)))return;let $=await this.client.core.crypto.decode(w,C);try{d8($)?(this.client.core.history.set(w,$),this.onRelayEventRequest({topic:w,payload:$})):F8($)?(await this.client.core.history.resolve($),await this.onRelayEventResponse({topic:w,payload:$}),this.client.core.history.delete(w,$.id)):this.onRelayEventUnknownPayload({topic:w,payload:$})}catch(X){this.client.logger.error(X)}})}registerExpirerEvents(){this.client.core.expirer.on(cD.expired,async(D)=>{let{topic:w,id:C}=e3(D.target);if(C&&this.client.pendingRequest.keys.includes(C))return await this.deletePendingSessionRequest(C,R("EXPIRED"),!0);w?this.client.session.keys.includes(w)&&(await this.deleteSession(w,!0),this.client.events.emit("session_expire",{topic:w})):C&&(await this.deleteProposal(C,!0),this.client.events.emit("proposal_expire",{id:C}))})}isValidPairingTopic(D){if(!KD(D,!1)){let{message:w}=R("MISSING_OR_INVALID",`pairing topic should be a string: ${D}`);throw new Error(w)}if(!this.client.core.pairing.pairings.keys.includes(D)){let{message:w}=R("NO_MATCHING_KEY",`pairing topic doesn't exist: ${D}`);throw new Error(w)}if(w8(this.client.core.pairing.pairings.get(D).expiry)){let{message:w}=R("EXPIRED",`pairing topic: ${D}`);throw new Error(w)}}async isValidSessionTopic(D){if(!KD(D,!1)){let{message:w}=R("MISSING_OR_INVALID",`session topic should be a string: ${D}`);throw new Error(w)}if(!this.client.session.keys.includes(D)){let{message:w}=R("NO_MATCHING_KEY",`session topic doesn't exist: ${D}`);throw new Error(w)}if(w8(this.client.session.get(D).expiry)){await this.deleteSession(D);let{message:w}=R("EXPIRED",`session topic: ${D}`);throw new Error(w)}}async isValidSessionOrPairingTopic(D){if(this.client.session.keys.includes(D))await this.isValidSessionTopic(D);else if(this.client.core.pairing.pairings.keys.includes(D))this.isValidPairingTopic(D);else if(KD(D,!1)){let{message:w}=R("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${D}`);throw new Error(w)}else{let{message:w}=R("MISSING_OR_INVALID",`session or pairing topic should be a string: ${D}`);throw new Error(w)}}async isValidProposalId(D){if(!GQ(D)){let{message:w}=R("MISSING_OR_INVALID",`proposal id should be a number: ${D}`);throw new Error(w)}if(!this.client.proposal.keys.includes(D)){let{message:w}=R("NO_MATCHING_KEY",`proposal id doesn't exist: ${D}`);throw new Error(w)}if(w8(this.client.proposal.get(D).expiry)){await this.deleteProposal(D);let{message:w}=R("EXPIRED",`proposal id: ${D}`);throw new Error(w)}}}class rB extends z0{constructor(D,w){super(D,w,x6,D$),this.core=D,this.logger=w}}class oB extends z0{constructor(D,w){super(D,w,h6,D$),this.core=D,this.logger=w}}class sB extends z0{constructor(D,w){super(D,w,u6,D$,(C)=>C.id),this.core=D,this.logger=w}}class f1 extends Kw{constructor(D){super(D),this.protocol=pB,this.version=nB,this.name=tC.name,this.events=new mD,this.on=(C,$)=>this.events.on(C,$),this.once=(C,$)=>this.events.once(C,$),this.off=(C,$)=>this.events.off(C,$),this.removeListener=(C,$)=>this.events.removeListener(C,$),this.removeAllListeners=(C)=>this.events.removeAllListeners(C),this.connect=async(C)=>{try{return await this.engine.connect(C)}catch($){throw this.logger.error($.message),$}},this.pair=async(C)=>{try{return await this.engine.pair(C)}catch($){throw this.logger.error($.message),$}},this.approve=async(C)=>{try{return await this.engine.approve(C)}catch($){throw this.logger.error($.message),$}},this.reject=async(C)=>{try{return await this.engine.reject(C)}catch($){throw this.logger.error($.message),$}},this.update=async(C)=>{try{return await this.engine.update(C)}catch($){throw this.logger.error($.message),$}},this.extend=async(C)=>{try{return await this.engine.extend(C)}catch($){throw this.logger.error($.message),$}},this.request=async(C)=>{try{return await this.engine.request(C)}catch($){throw this.logger.error($.message),$}},this.respond=async(C)=>{try{return await this.engine.respond(C)}catch($){throw this.logger.error($.message),$}},this.ping=async(C)=>{try{return await this.engine.ping(C)}catch($){throw this.logger.error($.message),$}},this.emit=async(C)=>{try{return await this.engine.emit(C)}catch($){throw this.logger.error($.message),$}},this.disconnect=async(C)=>{try{return await this.engine.disconnect(C)}catch($){throw this.logger.error($.message),$}},this.find=(C)=>{try{return this.engine.find(C)}catch($){throw this.logger.error($.message),$}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(C){throw this.logger.error(C.message),C}},this.name=D?.name||tC.name,this.metadata=D?.metadata||tK();let w=typeof D?.logger<"u"&&typeof D?.logger!="string"?D.logger:e8.default(j0({level:D?.logger||tC.logger}));this.core=D?.core||new dB(D),this.logger=LD(w,this.name),this.session=new oB(this.core,this.logger),this.proposal=new rB(this.core,this.logger),this.pendingRequest=new sB(this.core,this.logger),this.engine=new iB(this)}static async init(D){let w=new f1(D);return await w.initialize(),w}get context(){return HD(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.engine.init(),this.core.verify.init({verifyUrl:this.metadata.verifyUrl}),this.logger.info("SignClient Initialization Success")}catch(D){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(D.message),D}}}var{defineProperty:p6,defineProperties:n6,getOwnPropertyDescriptors:l6,getOwnPropertySymbols:aB}=Object,i6=Object.prototype.hasOwnProperty,r6=Object.prototype.propertyIsEnumerable,tB=(D,w,C)=>(w in D)?p6(D,w,{enumerable:!0,configurable:!0,writable:!0,value:C}):D[w]=C,o6=(D,w)=>{for(var C in w||(w={}))i6.call(w,C)&&tB(D,C,w[C]);if(aB)for(var C of aB(w))r6.call(w,C)&&tB(D,C,w[C]);return D},s6=(D,w)=>n6(D,l6(w)),$$=(D,w,C)=>{if(!w.has(D))throw TypeError("Cannot "+C)},e=(D,w,C)=>($$(D,w,"read from private field"),C?C.call(D):w.get(D)),l8=(D,w,C)=>{if(w.has(D))throw TypeError("Cannot add the same private member more than once");w instanceof WeakSet?w.add(D):w.set(D,C)},U1=(D,w,C,$)=>($$(D,w,"write to private field"),$?$.call(D,C):w.set(D,C),C),TD=(D,w,C)=>($$(D,w,"access private method"),C),i8,A0,P3,OD,w$,DJ,SD,xD,C$,eB;class a6{constructor(D){l8(this,w$),l8(this,SD),l8(this,C$),l8(this,i8,void 0),l8(this,A0,void 0),l8(this,P3,void 0),l8(this,OD,void 0),U1(this,i8,D),U1(this,A0,TD(this,w$,DJ).call(this)),TD(this,SD,xD).call(this)}async connect(D){let{requiredNamespaces:w,optionalNamespaces:C}=D;return new Promise(async($,X)=>{await TD(this,SD,xD).call(this);let Y=e(this,A0).subscribeModal((Q)=>{Q.open||(Y(),X(new Error("Modal closed")))}),{uri:E,approval:K}=await e(this,OD).connect(D);if(E){let Q=new Set;w&&Object.values(w).forEach(({chains:Z})=>{Z&&Z.forEach((B)=>Q.add(B))}),C&&Object.values(C).forEach(({chains:Z})=>{Z&&Z.forEach((B)=>Q.add(B))}),await e(this,A0).openModal({uri:E,chains:Array.from(Q)})}try{let Q=await K();$(Q)}catch(Q){X(Q)}finally{Y(),e(this,A0).closeModal()}})}async disconnect(D){await TD(this,SD,xD).call(this),await e(this,OD).disconnect(D)}async request(D){return await TD(this,SD,xD).call(this),await e(this,OD).request(D)}async getSessions(){return await TD(this,SD,xD).call(this),e(this,OD).session.getAll()}async getSession(){return await TD(this,SD,xD).call(this),e(this,OD).session.getAll().at(-1)}async onSessionEvent(D){await TD(this,SD,xD).call(this),e(this,OD).on("session_event",D)}async offSessionEvent(D){await TD(this,SD,xD).call(this),e(this,OD).off("session_event",D)}async onSessionUpdate(D){await TD(this,SD,xD).call(this),e(this,OD).on("session_update",D)}async offSessionUpdate(D){await TD(this,SD,xD).call(this),e(this,OD).off("session_update",D)}async onSessionDelete(D){await TD(this,SD,xD).call(this),e(this,OD).on("session_delete",D)}async offSessionDelete(D){await TD(this,SD,xD).call(this),e(this,OD).off("session_delete",D)}async onSessionExpire(D){await TD(this,SD,xD).call(this),e(this,OD).on("session_expire",D)}async offSessionExpire(D){await TD(this,SD,xD).call(this),e(this,OD).off("session_expire",D)}}i8=new WeakMap,A0=new WeakMap,P3=new WeakMap,OD=new WeakMap,w$=new WeakSet,DJ=function(){let{modalOptions:D,projectId:w}=e(this,i8);return new T1(s6(o6({},D),{projectId:w}))},SD=new WeakSet,xD=async function(){return e(this,OD)?!0:(!e(this,P3)&&typeof window<"u"&&U1(this,P3,TD(this,C$,eB).call(this)),e(this,P3))},C$=new WeakSet,eB=async function(){U1(this,OD,await f1.init({metadata:e(this,i8).metadata,projectId:e(this,i8).projectId,relayUrl:e(this,i8).relayUrl}));let D=await e(this,OD).core.crypto.getClientId();try{localStorage.setItem("WCM_WALLETCONNECT_CLIENT_ID",D)}catch{console.info("Unable to set client id")}};export{a6 as WalletConnectModalSign};

//# debugId=6FF44DC59BC0B7B864756E2164756E21
